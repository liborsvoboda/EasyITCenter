function ChangeSchemeTo(n){$("#portal-color-scheme").attr("href",Metro.storage.getItem("BackendServerAddress",null)+"/metro/css/schemes/"+n);$("#scheme-name").html(n);Metro.storage.setItem("WebScheme",n)}function hidePageLoading(){Metro.activity.close(pageLoader)}function showPageLoading(){if(pageLoader!=undefined)if(pageLoader[0]["DATASET:UID:M4Q"]==undefined)pageLoader=null;else try{Metro.activity.close(pageLoader)}catch{try{pageLoader.close()}catch{pageLoader=pageLoader[0]["DATASET:UID:M4Q"].dialog;pageLoader.close()}pageLoader=null}pageLoader=Metro.activity.open({type:"atom",style:"dark",overlayClickClose:!0})}function googleTranslateElementInit(){$(document).ready(function(){new google.translate.TranslateElement({pageLanguage:"cs",layout:google.translate.TranslateElement.InlineLayout.HORIZONTAL,autoDisplay:!1},"google_translate_element");let n=Metro.storage.getItem("AutomaticDetectedLanguageTranslate",null)==null||Metro.storage.getItem("AutomaticDetectedLanguageTranslate",null)==!1?!1:!0;n&&document.querySelector("#google_translate_element select")!=null&&setTimeout(function(){let n=document.querySelector("#google_translate_element select");n.value=Metro.storage.getItem("DetectedLanguage",null);n.dispatchEvent(new Event("change"))},1e3)})}function CancelTranslation(){setTimeout(function(){let n=document.querySelector("#google_translate_element select");n.selectedIndex=1;n.dispatchEvent(new Event("change"));n.value!=""&&setTimeout(function(){let n=document.querySelector("#google_translate_element select");n.selectedIndex=0;n.dispatchEvent(new Event("change"));n.value!=""&&setTimeout(function(){let n=document.querySelector("#google_translate_element select");n.selectedIndex=0;n.dispatchEvent(new Event("change"))},2e3)},2e3)},1e3)}function ApplyLoadedWebSetting(){Metro.storage.getItem("WebPagesName",null)!=null?$("#WebPagesName").html(Metro.storage.getItem("WebPagesName",null)+"<small id='WebPageMottos'>"+(Metro.storage.getItem("CycleWebPageMottosEnabled",null)==null?Metro.storage.getItem("WebPagesNameSmall",null):"")+"<\/small>"):$("#WebPagesName").html("EDC+ESB IT GroupWare-Solution.Eu <small id='WebPageMottos'>Celé IT v 1 Řešení v každém jazyce<\/small>");document.getElementsByClassName("YTPOverlay")[0]==undefined?(document.getElementsByClassName("overlay")[0].style.opacity=Metro.storage.getItem("BackgroundOpacitySetting",null)/100,document.getElementsByClassName("overlay")[0].style.backgroundColor=Metro.storage.getItem("BackgroundColorSetting",null)):(document.getElementsByClassName("YTPOverlay")[0].style.opacity=Metro.storage.getItem("BackgroundOpacitySetting",null)/100,document.getElementsByClassName("YTPOverlay")[0].style.backgroundColor=Metro.storage.getItem("BackgroundColorSetting",null));$("#body")[0].style.backgroundImage='url("'+Metro.storage.getItem("BackgroundImageSetting",null)+'")';try{$("#backgroundPlayer")[0].dataset.property="{ videoURL:'"+Metro.storage.getItem("BackgroundVideoSetting",null)+"', containment: '#body', showControls: false, autoPlay: true, loop: true, mute: true, startAt: 0, opacity: 1, quality: 'default', optimizeDisplay: true }"}catch{}try{$(".player").YTPChangeMovie({videoURL:Metro.storage.getItem("BackgroundVideoSetting",null),containment:"#body",showControls:!1,autoPlay:!0,loop:!0,mute:!0,startAt:0,opacity:1,quality:"default",optimizeDisplay:!0})}catch{}setTimeout(function(){$(".player").YTPPlay()},1e3)}function SetWebMenuPanel(){let n=Metro.storage.getItem("WebMenuList",null);if(n.length>0){let t="",i=null;n.forEach(n=>{i!=n.groupId&&(t+=t.length>0?"<\/ul><\/li>":"",t+="<li ><a href='#' onclick='"+n.group.onclick.toString().replace('"','"')+"' class='dropdown-toggle' data-role='ripple' data-ripple-color='#CE352C' data-ripple-alpha='.2' >"+n.group.name+"<\/a>",t+="<ul class='d-menu' data-role='dropdown'>"),t+=Metro.storage.getItem("ReloadContentOnly",null)!=null&&Metro.storage.getItem("ReloadContentOnly",null)?"<li onclick=SetWebMenuContent('"+n.id.toString()+"') class='"+(n.menuClass!=null?n.menuClass:"")+"' "+(n.description!=null&&n.description.length>0?" data-role='hint' data-cls-hint='supertop' data-hint-position='bottom' data-hint-text='"+n.description+"'":"")+" ><a href='#"+n.id.toString()+"-"+n.name.replace(/\s+/g,"")+"' >"+n.name+"<\/a><\/li>":"<li onclick=window.location.href='"+(window.location.protocol=="file:"?window.location.pathname.replace(window.location.pathname.split("/").pop(),""):"/")+n.id.toString()+"-"+n.name.replace(/\s+/g,"")+(window.location.protocol=="file:"?".html":"")+"' class='"+(n.menuClass!=null?n.menuClass:"")+"' "+(n.description!=null&&n.description.length>0?"data-role='hint' data-cls-hint='supertop' data-hint-position='bottom' data-hint-text='"+n.description+"'":"")+" ><a href='#' >"+n.name+"<\/a><\/li>",i=n.groupId});t+="<\/ul><\/li>";t+="<li><div data-role='hint' data-hint-position='bottom' data-hint-text='Přeložit do libovolného jazyku' class='c-pointer mif-language mif-2x fg-white p-3 ani-hover-heartbeat' onclick='ShowToolPanel()'><\/div><\/li>";$("#WebMainMenuPanel").html(t)}}async function SetWebMenuContent(n){window.showPageLoading();let i=await fetch(Metro.storage.getItem("ApiOriginSuffix",null)+(Metro.storage.getItem("ApiToken",null)==null?"/WebPages/GetWebMenuListById/"+n:"/WebPages/GetAuthWebMenuListById/"+n),{method:"GET",headers:{"Content-type":"application/json",Authorization:"Bearer "+Metro.storage.getItem("ApiToken",null)}}),t=await i.json();t.Status=="error"?ShowBlockedMessage():($("#WebPageHTMLContent").html(t.htmlContent),document.querySelector("#WebPageHTMLContent").style.position="absolute",document.querySelector("#WebPageHTMLContent").style.position="relative",document.querySelector("#WebPageHTMLContent").style.top="70px");setTimeout(function(){try{$(".player").YTPPlay()}catch{}},1e3);await GetWebMenuList();window.hidePageLoading()}async function SetWebMenuHtml(){setTimeout(async function(){window.showPageLoading();let n=0;n=window.location.pathname!="/"?window.location.pathname.split("/").pop().split("-")[0]:0;let i=await fetch(Metro.storage.getItem("ApiOriginSuffix",null)+(Metro.storage.getItem("ApiToken",null)==null?"/WebPages/GetWebMenuListById/"+n:"/WebPages/GetAuthWebMenuListById/"+n),{method:"GET",headers:{"Content-type":"application/json",Authorization:"Bearer "+Metro.storage.getItem("ApiToken",null)}}),t=await i.json();t.Status=="error"?ShowBlockedMessage():($("#WebPageHTMLContent").html(t.htmlContent),document.querySelector("#WebPageHTMLContent").style.position="absolute",document.querySelector("#WebPageHTMLContent").style.position="relative",document.querySelector("#WebPageHTMLContent").style.top="70px");setTimeout(function(){try{$(".player").YTPPlay()}catch{}},1e3);await GetWebMenuList();window.hidePageLoading()},100)}function PrintElement(n){try{$("#"+n).printElement({pageTitle:n.split("_")[1]+".html",printMode:"popup"})}catch(t){}}function DownloadHtmlElement(n){try{var t=document.body.appendChild(document.createElement("a"));t.download=n+".html";t.href="data:text/html;charset=utf-8,"+encodeURIComponent(document.getElementById(n).innerHTML);t.click()}catch(i){}}async function CopyElement(n){try{let t=document.getElementById(n).innerHTML;await navigator.clipboard.writeText(t)}catch(t){}}function ImageFromElement(n){try{$("document").ready(function(){html2canvas($("#"+n),{onrendered:function(t){$("#previewImage").append(t);var r=t.toDataURL("image/png"),u=r.replace(/^data:image\/png/,"data:application/octet-stream"),i=document.body.appendChild(document.createElement("a"));i.download=n+".png";i.href=u;i.click()}})})}catch(t){}}let pageLoader,charms