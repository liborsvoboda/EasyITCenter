<!DOCTYPE html>
<html><head><title>HtmlToXamlConverter.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(2724);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EASYTools.HTMLEditorNoImg/XamlToHtmlParser/HtmlToXamlConverter.cs" target="_top">XamlToHtmlParser\HtmlToXamlConverter.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EASYTools.HTMLEditorNoImg" target="_top">..\..\..\EASY-TOOLS\EASYTools.HTMLEditorNoImg\EASYTools.HTMLEditorNoImg.csproj</a> (EASYTools.HTMLEditorNoImg)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">//---------------------------------------------------------------------------</span>
<span class="c">// </span>
<span class="c">// File: HtmlXamlConverter.cs</span>
<span class="c">//</span>
<span class="c">// Copyright (C) Microsoft Corporation.  All rights reserved.</span>
<span class="c">//</span>
<span class="c">// Description: Prototype for Html - Xaml conversion </span>
<span class="c">//</span>
<span class="c">//---------------------------------------------------------------------------</span>
 
<b>namespace</b> <span class="i n">EASYTools</span>.<span class="i n">HTMLEditorNoImg</span>
{
    <b>using</b> <span class="i n">System</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Xml</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
 
    <b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>; <span class="c">// DependencyProperty</span>
    <b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Documents</span>;
	<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>; <span class="c">// TextElement</span>
  
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> HtmlToXamlConverter is a static class that takes an HTML string</span>
    <span class="c">///</span><span class="c"> and converts it into XAML</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public static class</b> <a id="158b9827bfdab150" href="../R/158b9827bfdab150.html" target="n" data-glyph="0,0" class="t t">HtmlToXamlConverter</a>
    {
        <span class="c">// ---------------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Internal Methods</span>
        <span class="c">//</span>
        <span class="c">// ---------------------------------------------------------------------</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts an html string into xaml string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">htmlString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Input html which may be badly formated xml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">asFlowDocument</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true indicates that we need a FlowDocument as a root element;</span>
        <span class="c">///</span><span class="c"> false means that Section or Span elements will be used</span>
        <span class="c">///</span><span class="c"> dependeing on StartFragment/EndFragment comments locations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Well-formed xml representing XAML equivalent for the input html string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="6630db8e8e382a71" href="../R/6630db8e8e382a71.html" target="n" data-glyph="72,1" class="i method">ConvertHtmlToXaml</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">htmlString</span>, <b>bool</b> <span id="r1 rd" class="r1 r">asFlowDocument</span>)
        {
            <span class="c">// Create well-formed Xml from Html string</span>
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r2 rd" class="r2 r">htmlElement</span> = <a href="HtmlParser.cs.html#047776b6c421dcb9" class="t t">HtmlParser</a>.<a href="HtmlParser.cs.html#5556078f35e1565a" class="i method">ParseHtml</a>(<span class="r0 r">htmlString</span>);
 
            <span class="c">// Decide what name to use as a root</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">rootElementName</span> = <span class="r1 r">asFlowDocument</span> ? <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#f02b6d9d01bfb455" class="i field">XamlFlowDocument</a> : <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#5c566c4b73f058e4" class="i field">XamlSection</a>;
 
            <span class="c">// Create an XmlDocument for generated xaml</span>
            <a href="@0@System.Xml/A.html#f82a4c1bd1f0ee12" class="t t">XmlDocument</a> <span id="r4 rd" class="r4 r">xamlTree</span> = <b>new</b> <a href="@0@System.Xml/A.html#2d559a81f89e826f" class="t constructor">XmlDocument</a>();
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r5 rd" class="r5 r">xamlFlowDocumentElement</span> = <span class="r4 r">xamlTree</span>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <span class="r3 r">rootElementName</span>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
 
            <span class="c">// Extract style definitions from all STYLE elements in the document</span>
            <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r6 rd" class="r6 r">stylesheet</span> = <b>new</b> <a href="HtmlCssParser.cs.html#ff168ef735a0d41b" class="t constructor">CssStylesheet</a>(<span class="r2 r">htmlElement</span>);
 
            <span class="c">// Source context is a stack of all elements - ancestors of a parentElement</span>
            <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r7 rd" class="r7 r">sourceContext</span> = <b>new</b> <a href="@0@mscorlib/A.html#b65c1a07c4e5b13a" class="t constructor">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt;(10);
 
            <span class="c">// Clear fragment parent</span>
            <a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a> = <b>null</b>;
 
            <span class="c">// convert root html element</span>
            <a href="#3ee8eb9573f99c0a" class="i method">AddBlock</a>(<span class="r5 r">xamlFlowDocumentElement</span>, <span class="r2 r">htmlElement</span>, <b>new</b> <a href="@0@mscorlib/A.html#35eb148f5d60a68c" class="t constructor">Hashtable</a>(), <span class="r6 r">stylesheet</span>, <span class="r7 r">sourceContext</span>);
 
            <span class="c">// In case if the selected fragment is inline, extract it into a separate Span wrapper</span>
            <b>if</b> (!<span class="r1 r">asFlowDocument</span>)
            {
                <span class="r5 r">xamlFlowDocumentElement</span> = <a href="#c788092a685469f6" class="i method">ExtractInlineFragment</a>(<span class="r5 r">xamlFlowDocumentElement</span>);
            }
 
            <span class="c">// Return a string representing resulting Xaml</span>
            <span class="r5 r">xamlFlowDocumentElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<span class="s">&quot;xml:space&quot;</span>, <span class="s">&quot;preserve&quot;</span>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r8 rd" class="r8 r">xaml</span> = <span class="r5 r">xamlFlowDocumentElement</span>.<a href="@0@System.Xml/A.html#83aaee867e1523fb" class="i property">OuterXml</a>;
 
            <b>return</b> <span class="r8 r">xaml</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a value for an attribute by its name (ignoring casing)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">element</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement in which we are trying to find the specified attribute</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">attributeName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> String representing the attribute name to be searched for</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="bb4e7e205aef385f" href="../R/bb4e7e205aef385f.html" target="n" data-glyph="74,1" class="i method">GetAttribute</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r9 rd" class="r9 r">element</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r10 rd" class="r10 r">attributeName</span>)
        {
			<b>if</b> (!<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r10 r">attributeName</span>) &amp;&amp; <span class="r9 r">element</span> != <b>null</b>)
			{
				<span class="r10 r">attributeName</span> = <span class="r10 r">attributeName</span>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
 
				<b>foreach</b> (<a href="@0@System.Xml/A.html#32fc4eecc0eb5ba9" class="t t">XmlAttribute</a> <span id="r11 rd" class="r11 r">item</span> <b>in</b> <span class="r9 r">element</span>.<a href="@0@System.Xml/A.html#a4ead10fc0c65e44" class="i property">Attributes</a>)
					<b>if</b> (<span class="r11 r">item</span>.<a href="@0@System.Xml/A.html#9d67d946628ac7d1" class="i property">Name</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="r10 r">attributeName</span>)
						<b>return</b> <span class="r11 r">item</span>.<a href="@0@System.Xml/A.html#9bc9e8ad31fdcd66" class="i property">Value</a>;
 
				<span class="c">//for (int i = 0; i &lt; element.Attributes.Count; i++)</span>
				<span class="c">//{</span>
				<span class="c">//	if (element.Attributes[i].Name.ToLower(CultureInfo.InvariantCulture) == attributeName)</span>
				<span class="c">//	{</span>
				<span class="c">//		return element.Attributes[i].Value;</span>
				<span class="c">//	}</span>
				<span class="c">//}</span>
			}
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns string extracted from quotation marks</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> String representing value enclosed in quotation marks</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="c140b308ad9bb7e2" href="../R/c140b308ad9bb7e2.html" target="n" data-glyph="74,1" class="i method">UnQuote</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r12 rd" class="r12 r">value</span>)
        {
            <b>if</b> (<span class="r12 r">value</span>.<a href="@0@mscorlib/A.html#1c787ba07a7b11ab" class="i method">StartsWith</a>(<span class="s">&quot;\&quot;&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>) &amp;&amp; <span class="r12 r">value</span>.<a href="@0@mscorlib/A.html#41a31e4feec3ef41" class="i method">EndsWith</a>(<span class="s">&quot;\&quot;&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>) || <span class="r12 r">value</span>.<a href="@0@mscorlib/A.html#1c787ba07a7b11ab" class="i method">StartsWith</a>(<span class="s">&quot;&#39;&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>) &amp;&amp; <span class="r12 r">value</span>.<a href="@0@mscorlib/A.html#41a31e4feec3ef41" class="i method">EndsWith</a>(<span class="s">&quot;&#39;&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>))
            {
                <span class="r12 r">value</span> = <span class="r12 r">value</span>.<a href="@0@mscorlib/A.html#8124961f027d9ac9" class="i method">Substring</a>(1, <span class="r12 r">value</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> - 2).<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>();
            }
            <b>return</b> <span class="r12 r">value</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Methods
 
        <span class="c">// ---------------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Private Methods</span>
        <span class="c">//</span>
        <span class="c">// ---------------------------------------------------------------------</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Analyzes the given htmlElement expecting it to be converted</span>
        <span class="c">///</span><span class="c"> into some of xaml Block elements and adds the converted block</span>
        <span class="c">///</span><span class="c"> to the children collection of xamlParentElement.</span>
        <span class="c">///</span><span class="c"> </span>
        <span class="c">///</span><span class="c"> Analyzes the given XmlElement htmlElement, recognizes it as some HTML element</span>
        <span class="c">///</span><span class="c"> and adds it as a child to a xamlParentElement.</span>
        <span class="c">///</span><span class="c"> In some cases several following siblings of the given htmlElement</span>
        <span class="c">///</span><span class="c"> will be consumed too (e.g. LIs encountered without wrapping UL/OL, </span>
        <span class="c">///</span><span class="c"> which must be collected together and wrapped into one implicit List element).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">xamlParentElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parent xaml element, to which new converted element will be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">htmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Source html element subject to convert to xaml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Properties inherited from an outer context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Last processed html node. Normally it should be the same htmlElement</span>
        <span class="c">///</span><span class="c"> as was passed as a paramater, but in some irregular cases</span>
        <span class="c">///</span><span class="c"> it could one of its following siblings.</span>
        <span class="c">///</span><span class="c"> The caller must use this node to get to next sibling from it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <a id="3ee8eb9573f99c0a" href="../R/3ee8eb9573f99c0a.html" target="n" data-glyph="76,1" class="i method">AddBlock</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r13 rd" class="r13 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r14 rd" class="r14 r">htmlNode</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r15 rd" class="r15 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r16 rd" class="r16 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r17 rd" class="r17 r">sourceContext</span>)
        {
            <b>if</b> (<span class="r14 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#fdb35b5b46ded55f" class="t t">XmlComment</a>)
            {
                <a href="#0e15a745618029df" class="i method">DefineInlineFragmentParent</a>((<a href="@0@System.Xml/A.html#fdb35b5b46ded55f" class="t t">XmlComment</a>)<span class="r14 r">htmlNode</span>, <span class="c">/*xamlParentElement:*/</span><b>null</b>);
            }
            <b>else</b> <b>if</b> (<span class="r14 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#5a686adea8810425" class="t t">XmlText</a>)
            {
                <span class="r14 r">htmlNode</span> = <a href="#55abafeab0c2bebb" class="i method">AddImplicitParagraph</a>(<span class="r13 r">xamlParentElement</span>, <span class="r14 r">htmlNode</span>, <span class="r15 r">inheritedProperties</span>, <span class="r16 r">stylesheet</span>, <span class="r17 r">sourceContext</span>);
            }
            <b>else</b> <b>if</b> (<span class="r14 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)
            {
                <span class="c">// Identify element name</span>
                <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r18 rd" class="r18 r">htmlElement</span> = (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r14 r">htmlNode</span>;
 
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r19 rd" class="r19 r">htmlElementName</span> = <span class="r18 r">htmlElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>; <span class="c">// Keep the name case-sensitive to check xml names</span>
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">htmlElementNamespace</span> = <span class="r18 r">htmlElement</span>.<a href="@0@System.Xml/A.html#3adc64551d2eec34" class="i property">NamespaceURI</a>;
 
                <b>if</b> (<span class="r20 r">htmlElementNamespace</span> != <a href="HtmlParser.cs.html#047776b6c421dcb9" class="t t">HtmlParser</a>.<a href="HtmlParser.cs.html#dd5a2f8ccbee6dff" class="i field">XhtmlNamespace</a>)
                {
                    <span class="c">// Non-html element. skip it</span>
                    <span class="c">// Isn&#39;t it too agressive? What if this is just an error in html tag name?</span>
                    <span class="c">// TODO: Consider skipping just a wparrer in recursing into the element tree,</span>
                    <span class="c">// which may produce some garbage though coming from xml fragments.</span>
                    <b>return</b> <span class="r18 r">htmlElement</span>;
                }
 
                <span class="c">// Put source element to the stack</span>
                <span class="r17 r">sourceContext</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r18 r">htmlElement</span>);
 
                <span class="c">// Convert the name to lowercase, because html elements are case-insensitive</span>
				<span class="r19 r">htmlElementName</span> = <span class="r19 r">htmlElementName</span>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
 
                <span class="c">// Switch to an appropriate kind of processing depending on html element name</span>
                <b>switch</b> (<span class="r19 r">htmlElementName</span>)
                {
                    <span class="c">// Sections:</span>
                    <b>case</b> <span class="s">&quot;html&quot;</span>:
                    <b>case</b> <span class="s">&quot;body&quot;</span>:
                    <b>case</b> <span class="s">&quot;div&quot;</span>:
                    <b>case</b> <span class="s">&quot;form&quot;</span>: <span class="c">// not a block according to xhtml spec</span>
                    <b>case</b> <span class="s">&quot;pre&quot;</span>: <span class="c">// Renders text in a fixed-width font</span>
                    <b>case</b> <span class="s">&quot;blockquote&quot;</span>:
                    <b>case</b> <span class="s">&quot;caption&quot;</span>:
                    <b>case</b> <span class="s">&quot;center&quot;</span>:
                    <b>case</b> <span class="s">&quot;cite&quot;</span>:
                        <a href="#371bfd55472d632c" class="i method">AddSection</a>(<span class="r13 r">xamlParentElement</span>, <span class="r18 r">htmlElement</span>, <span class="r15 r">inheritedProperties</span>, <span class="r16 r">stylesheet</span>, <span class="r17 r">sourceContext</span>);
                        <b>break</b>;
 
                    <span class="c">// Paragraphs:</span>
                    <b>case</b> <span class="s">&quot;p&quot;</span>:
                    <b>case</b> <span class="s">&quot;h1&quot;</span>:
                    <b>case</b> <span class="s">&quot;h2&quot;</span>:
                    <b>case</b> <span class="s">&quot;h3&quot;</span>:
                    <b>case</b> <span class="s">&quot;h4&quot;</span>:
                    <b>case</b> <span class="s">&quot;h5&quot;</span>:
                    <b>case</b> <span class="s">&quot;h6&quot;</span>:
                    <b>case</b> <span class="s">&quot;nsrtitle&quot;</span>:
                    <b>case</b> <span class="s">&quot;textarea&quot;</span>:
                    <b>case</b> <span class="s">&quot;dd&quot;</span>: <span class="c">// ???</span>
                    <b>case</b> <span class="s">&quot;dl&quot;</span>: <span class="c">// ???</span>
                    <b>case</b> <span class="s">&quot;dt&quot;</span>: <span class="c">// ???</span>
                    <b>case</b> <span class="s">&quot;tt&quot;</span>: <span class="c">// ???</span>
                        <a href="#7ec40be8c92133d4" class="i method">AddParagraph</a>(<span class="r13 r">xamlParentElement</span>, <span class="r18 r">htmlElement</span>, <span class="r15 r">inheritedProperties</span>, <span class="r16 r">stylesheet</span>, <span class="r17 r">sourceContext</span>);
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;ol&quot;</span>:
                    <b>case</b> <span class="s">&quot;ul&quot;</span>:
                    <b>case</b> <span class="s">&quot;dir&quot;</span>: <span class="c">//  treat as UL element</span>
                    <b>case</b> <span class="s">&quot;menu&quot;</span>: <span class="c">//  treat as UL element</span>
                        <span class="c">// List element conversion</span>
                        <a href="#5c6cda38d9908311" class="i method">AddList</a>(<span class="r13 r">xamlParentElement</span>, <span class="r18 r">htmlElement</span>, <span class="r15 r">inheritedProperties</span>, <span class="r16 r">stylesheet</span>, <span class="r17 r">sourceContext</span>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;li&quot;</span>:
                        <span class="c">// LI outside of OL/UL</span>
                        <span class="c">// Collect all sibling LIs, wrap them into a List and then proceed with the element following the last of LIs</span>
                        <span class="r14 r">htmlNode</span> = <a href="#8acd1c1faf7e30ca" class="i method">AddOrphanListItems</a>(<span class="r13 r">xamlParentElement</span>, <span class="r18 r">htmlElement</span>, <span class="r15 r">inheritedProperties</span>, <span class="r16 r">stylesheet</span>, <span class="r17 r">sourceContext</span>);
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;img&quot;</span>:
                        <span class="c">// TODO: Add image processing</span>
                        <a href="#40ed464ba44fa446" class="i method">AddImage</a>(<span class="r13 r">xamlParentElement</span>, <span class="r18 r">htmlElement</span>, <span class="r15 r">inheritedProperties</span>, <span class="r16 r">stylesheet</span>, <span class="r17 r">sourceContext</span>);
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;table&quot;</span>:
                        <span class="c">// hand off to table parsing function which will perform special table syntax checks</span>
                        <a href="#d3169461fab7df76" class="i method">AddTable</a>(<span class="r13 r">xamlParentElement</span>, <span class="r18 r">htmlElement</span>, <span class="r15 r">inheritedProperties</span>, <span class="r16 r">stylesheet</span>, <span class="r17 r">sourceContext</span>);
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;tbody&quot;</span>:
                    <b>case</b> <span class="s">&quot;tfoot&quot;</span>:
                    <b>case</b> <span class="s">&quot;thead&quot;</span>:
                    <b>case</b> <span class="s">&quot;tr&quot;</span>:
                    <b>case</b> <span class="s">&quot;td&quot;</span>:
                    <b>case</b> <span class="s">&quot;th&quot;</span>:
                        <span class="c">// Table stuff without table wrapper</span>
                        <span class="c">// TODO: add special-case processing here for elements that should be within tables when the</span>
                        <span class="c">// parent element is NOT a table. If the parent element is a table they can be processed normally.</span>
                        <span class="c">// we need to compare against the parent element here, we can&#39;t just break on a switch</span>
                        <b>goto</b> <b>default</b>; <span class="c">// Thus we will skip this element as unknown, but still recurse into it.</span>
 
                    <b>case</b> <span class="s">&quot;style&quot;</span>: <span class="c">// We already pre-processed all style elements. Ignore it now</span>
                    <b>case</b> <span class="s">&quot;meta&quot;</span>:
                    <b>case</b> <span class="s">&quot;head&quot;</span>:
                    <b>case</b> <span class="s">&quot;title&quot;</span>:
                    <b>case</b> <span class="s">&quot;script&quot;</span>:
                        <span class="c">// Ignore these elements</span>
                        <b>break</b>;
 
                    <b>default</b>:
                        <span class="c">// Wrap a sequence of inlines into an implicit paragraph</span>
                        <span class="r14 r">htmlNode</span> = <a href="#55abafeab0c2bebb" class="i method">AddImplicitParagraph</a>(<span class="r13 r">xamlParentElement</span>, <span class="r18 r">htmlElement</span>, <span class="r15 r">inheritedProperties</span>, <span class="r16 r">stylesheet</span>, <span class="r17 r">sourceContext</span>);
                        <b>break</b>;
                }
 
                <span class="c">// Remove the element from the stack</span>
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r17 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 0 &amp;&amp; <span class="r17 r">sourceContext</span><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r17 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1] == <span class="r18 r">htmlElement</span>);
                <span class="r17 r">sourceContext</span>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<span class="r17 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
            }
 
            <span class="c">// Return last processed node</span>
            <b>return</b> <span class="r14 r">htmlNode</span>;
        }
 
        <span class="c">// .............................................................</span>
        <span class="c">//</span>
        <span class="c">// Line Breaks</span>
        <span class="c">//</span>
        <span class="c">// .............................................................</span>
 
        <b>private static void</b> <a id="ca78be984ccab288" href="../R/ca78be984ccab288.html" target="n" data-glyph="76,1" class="i method">AddBreak</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r21 rd" class="r21 r">xamlParentElement</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r22 rd" class="r22 r">htmlElementName</span>)
        {
            <span class="c">// Create new xaml element corresponding to this html element</span>
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r23 rd" class="r23 r">xamlLineBreak</span> = <span class="r21 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<span class="c">/*prefix:*/</span><b>null</b>, <span class="c">/*localName:*/</span><a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#85323a7262308596" class="i field">Xaml_LineBreak</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
            <span class="r21 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r23 r">xamlLineBreak</span>);
            <b>if</b> (<span class="r22 r">htmlElementName</span> == <span class="s">&quot;hr&quot;</span>)
            {
                <a href="@0@System.Xml/A.html#5a686adea8810425" class="t t">XmlText</a> <span id="r24 rd" class="r24 r">xamlHorizontalLine</span> = <span class="r21 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#b2264e21532e454d" class="i method">CreateTextNode</a>(<span class="s">&quot;----------------------&quot;</span>);
                <span class="r21 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r24 r">xamlHorizontalLine</span>);
                <span class="r23 r">xamlLineBreak</span> = <span class="r21 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<span class="c">/*prefix:*/</span><b>null</b>, <span class="c">/*localName:*/</span><a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#85323a7262308596" class="i field">Xaml_LineBreak</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
                <span class="r21 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r23 r">xamlLineBreak</span>);
            }
        }
 
        <span class="c">// .............................................................</span>
        <span class="c">//</span>
        <span class="c">// Text Flow Elements</span>
        <span class="c">//</span>
        <span class="c">// .............................................................</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates Section or Paragraph element from DIV depending whether it contains any block elements or not</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">xamlParentElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml parent to which the converted element should be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">htmlElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html element to be converted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> properties inherited from parent context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true indicates that a content added by this call contains at least one block element</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="371bfd55472d632c" href="../R/371bfd55472d632c.html" target="n" data-glyph="76,1" class="i method">AddSection</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r25 rd" class="r25 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r26 rd" class="r26 r">htmlElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r27 rd" class="r27 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r28 rd" class="r28 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r29 rd" class="r29 r">sourceContext</span>)
        {
            <span class="c">// Analyze the content of htmlElement to decide what xaml element to choose - Section or Paragraph.</span>
            <span class="c">// If this Div has at least one block child then we need to use Section, otherwise use Paragraph</span>
            <b>bool</b> <span id="r30 rd" class="r30 r">htmlElementContainsBlocks</span> = <b>false</b>;
            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r31 rd" class="r31 r">htmlChildNode</span> = <span class="r26 r">htmlElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r31 r">htmlChildNode</span> != <b>null</b>; <span class="r31 r">htmlChildNode</span> = <span class="r31 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
            {
                <b>if</b> (<span class="r31 r">htmlChildNode</span> <b>is</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)
                {
					<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r32 rd" class="r32 r">htmlChildName</span> = ((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r31 r">htmlChildNode</span>).<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                    <b>if</b> (<a href="HtmlSchema.cs.html#55602139b10af512" class="t t">HtmlSchema</a>.<a href="HtmlSchema.cs.html#e98a79a7f75db1f0" class="i method">IsBlockElement</a>(<span class="r32 r">htmlChildName</span>))
                    {
                        <span class="r30 r">htmlElementContainsBlocks</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (!<span class="r30 r">htmlElementContainsBlocks</span>)
            {
                <span class="c">// The Div does not contain any block elements, so we can treat it as a Paragraph</span>
                <a href="#7ec40be8c92133d4" class="i method">AddParagraph</a>(<span class="r25 r">xamlParentElement</span>, <span class="r26 r">htmlElement</span>, <span class="r27 r">inheritedProperties</span>, <span class="r28 r">stylesheet</span>, <span class="r29 r">sourceContext</span>);
            }
            <b>else</b>
            {
                <span class="c">// The Div has some nested blocks, so we treat it as a Section</span>
 
                <span class="c">// Create currentProperties as a compilation of local and inheritedProperties, set localProperties</span>
                <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r33 rd" class="r33 r">localProperties</span>;
                <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r34 rd" class="r34 r">currentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>(<span class="r26 r">htmlElement</span>, <span class="r27 r">inheritedProperties</span>, <b>out</b> <span class="r33 r">localProperties</span>, <span class="r28 r">stylesheet</span>, <span class="r29 r">sourceContext</span>);
 
                <span class="c">// Create a XAML element corresponding to this html element</span>
                <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r35 rd" class="r35 r">xamlElement</span> = <span class="r25 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<span class="c">/*prefix:*/</span><b>null</b>, <span class="c">/*localName:*/</span><a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#5c566c4b73f058e4" class="i field">XamlSection</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
                <a href="#a43c9ee1a751c059" class="i method">ApplyLocalProperties</a>(<span class="r35 r">xamlElement</span>, <span class="r33 r">localProperties</span>, <span class="c">/*isBlock:*/</span><b>true</b>);
 
                <span class="c">// Decide whether we can unwrap this element as not having any formatting significance.</span>
                <b>if</b> (!<span class="r35 r">xamlElement</span>.<a href="@0@System.Xml/A.html#82f93db2137be8ef" class="i property">HasAttributes</a>)
                {
                    <span class="c">// This elements is a group of block elements whitout any additional formatting.</span>
                    <span class="c">// We can add blocks directly to xamlParentElement and avoid</span>
                    <span class="c">// creating unnecessary Sections nesting.</span>
                    <span class="r35 r">xamlElement</span> = <span class="r25 r">xamlParentElement</span>;
                }
 
                <span class="c">// Recurse into element subtree</span>
                <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r36 rd" class="r36 r">htmlChildNode</span> = <span class="r26 r">htmlElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r36 r">htmlChildNode</span> != <b>null</b>; <span class="r36 r">htmlChildNode</span> = <span class="r36 r">htmlChildNode</span> != <b>null</b> ? <span class="r36 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a> : <b>null</b>)
                {
                    <span class="r36 r">htmlChildNode</span> = <a href="#3ee8eb9573f99c0a" class="i method">AddBlock</a>(<span class="r35 r">xamlElement</span>, <span class="r36 r">htmlChildNode</span>, <span class="r34 r">currentProperties</span>, <span class="r28 r">stylesheet</span>, <span class="r29 r">sourceContext</span>);
                }
 
                <span class="c">// Add the new element to the parent.</span>
                <b>if</b> (<span class="r35 r">xamlElement</span> != <span class="r25 r">xamlParentElement</span>)
                {
                    <span class="r25 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r35 r">xamlElement</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates Paragraph element from P, H1-H7, Center etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">xamlParentElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml parent to which the converted element should be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">htmlElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html element to be converted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> properties inherited from parent context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true indicates that a content added by this call contains at least one block element</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="7ec40be8c92133d4" href="../R/7ec40be8c92133d4.html" target="n" data-glyph="76,1" class="i method">AddParagraph</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r37 rd" class="r37 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r38 rd" class="r38 r">htmlElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r39 rd" class="r39 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r40 rd" class="r40 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r41 rd" class="r41 r">sourceContext</span>)
        {
            <span class="c">// Create currentProperties as a compilation of local and inheritedProperties, set localProperties</span>
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r42 rd" class="r42 r">localProperties</span>;
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r43 rd" class="r43 r">currentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>(<span class="r38 r">htmlElement</span>, <span class="r39 r">inheritedProperties</span>, <b>out</b> <span class="r42 r">localProperties</span>, <span class="r40 r">stylesheet</span>, <span class="r41 r">sourceContext</span>);
 
            <span class="c">// Create a XAML element corresponding to this html element</span>
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r44 rd" class="r44 r">xamlElement</span> = <span class="r37 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<span class="c">/*prefix:*/</span><b>null</b>, <span class="c">/*localName:*/</span><a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#7b0f028de022fbee" class="i field">Xaml_Paragraph</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
            <a href="#a43c9ee1a751c059" class="i method">ApplyLocalProperties</a>(<span class="r44 r">xamlElement</span>, <span class="r42 r">localProperties</span>, <span class="c">/*isBlock:*/</span><b>true</b>);
 
            <span class="c">// Recurse into element subtree</span>
            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r45 rd" class="r45 r">htmlChildNode</span> = <span class="r38 r">htmlElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r45 r">htmlChildNode</span> != <b>null</b>; <span class="r45 r">htmlChildNode</span> = <span class="r45 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
            {
                <a href="#8993ebad047b9c66" class="i method">AddInline</a>(<span class="r44 r">xamlElement</span>, <span class="r45 r">htmlChildNode</span>, <span class="r43 r">currentProperties</span>, <span class="r40 r">stylesheet</span>, <span class="r41 r">sourceContext</span>);
            }
 
            <span class="c">// Add the new element to the parent.</span>
            <span class="r37 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r44 r">xamlElement</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a Paragraph element and adds all nodes starting from htmlNode</span>
        <span class="c">///</span><span class="c"> converted to appropriate Inlines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">xamlParentElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml parent to which the converted element should be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">htmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlNode starting a collection of implicitly wrapped inlines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> properties inherited from parent context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true indicates that a content added by this call contains at least one block element</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The last htmlNode added to the implicit paragraph</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <a id="55abafeab0c2bebb" href="../R/55abafeab0c2bebb.html" target="n" data-glyph="76,1" class="i method">AddImplicitParagraph</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r46 rd" class="r46 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r47 rd" class="r47 r">htmlNode</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r48 rd" class="r48 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r49 rd" class="r49 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r50 rd" class="r50 r">sourceContext</span>)
        {
            <span class="c">// Collect all non-block elements and wrap them into implicit Paragraph</span>
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r51 rd" class="r51 r">xamlParagraph</span> = <span class="r46 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<span class="c">/*prefix:*/</span><b>null</b>, <span class="c">/*localName:*/</span><a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#7b0f028de022fbee" class="i field">Xaml_Paragraph</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
            <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r52 rd" class="r52 r">lastNodeProcessed</span> = <b>null</b>;
            <b>while</b> (<span class="r47 r">htmlNode</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r47 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#fdb35b5b46ded55f" class="t t">XmlComment</a>)
                {
                    <a href="#0e15a745618029df" class="i method">DefineInlineFragmentParent</a>((<a href="@0@System.Xml/A.html#fdb35b5b46ded55f" class="t t">XmlComment</a>)<span class="r47 r">htmlNode</span>, <span class="c">/*xamlParentElement:*/</span><b>null</b>);
                }
                <b>else</b> <b>if</b> (<span class="r47 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#5a686adea8810425" class="t t">XmlText</a>)
                {
                    <b>if</b> (<span class="r47 r">htmlNode</span>.<a href="@0@System.Xml/A.html#419e50e206d75bb5" class="i property">Value</a>.<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>().<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> &gt; 0)
                    {
                        <a href="#c0c5173d7d3577f1" class="i method">AddTextRun</a>(<span class="r51 r">xamlParagraph</span>, <span class="r47 r">htmlNode</span>.<a href="@0@System.Xml/A.html#419e50e206d75bb5" class="i property">Value</a>);
                    }
                }
                <b>else</b> <b>if</b> (<span class="r47 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)
                {
					<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r53 rd" class="r53 r">htmlChildName</span> = ((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r47 r">htmlNode</span>).<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                    <b>if</b> (<a href="HtmlSchema.cs.html#55602139b10af512" class="t t">HtmlSchema</a>.<a href="HtmlSchema.cs.html#e98a79a7f75db1f0" class="i method">IsBlockElement</a>(<span class="r53 r">htmlChildName</span>))
                    {
                        <span class="c">// The sequence of non-blocked inlines ended. Stop implicit loop here.</span>
                        <b>break</b>;
                    }
                    <b>else</b>
                    {
                        <a href="#8993ebad047b9c66" class="i method">AddInline</a>(<span class="r51 r">xamlParagraph</span>, (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r47 r">htmlNode</span>, <span class="r48 r">inheritedProperties</span>, <span class="r49 r">stylesheet</span>, <span class="r50 r">sourceContext</span>);
                    }
                }
 
                <span class="c">// Store last processed node to return it at the end</span>
                <span class="r52 r">lastNodeProcessed</span> = <span class="r47 r">htmlNode</span>;
                <span class="r47 r">htmlNode</span> = <span class="r47 r">htmlNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
            }
 
            <span class="c">// Add the Paragraph to the parent</span>
            <span class="c">// If only whitespaces and commens have been encountered,</span>
            <span class="c">// then we have nothing to add in implicit paragraph; forget it.</span>
            <b>if</b> (<span class="r51 r">xamlParagraph</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a> != <b>null</b>)
            {
                <span class="r46 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r51 r">xamlParagraph</span>);
            }
 
            <span class="c">// Need to return last processed node</span>
            <b>return</b> <span class="r52 r">lastNodeProcessed</span>;
        }
 
        <span class="c">// .............................................................</span>
        <span class="c">//</span>
        <span class="c">// Inline Elements</span>
        <span class="c">//</span>
        <span class="c">// .............................................................</span>
 
        <b>private static void</b> <a id="8993ebad047b9c66" href="../R/8993ebad047b9c66.html" target="n" data-glyph="76,1" class="i method">AddInline</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r54 rd" class="r54 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r55 rd" class="r55 r">htmlNode</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r56 rd" class="r56 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r57 rd" class="r57 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r58 rd" class="r58 r">sourceContext</span>)
        {
            <b>if</b> (<span class="r55 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#fdb35b5b46ded55f" class="t t">XmlComment</a>)
            {
                <a href="#0e15a745618029df" class="i method">DefineInlineFragmentParent</a>((<a href="@0@System.Xml/A.html#fdb35b5b46ded55f" class="t t">XmlComment</a>)<span class="r55 r">htmlNode</span>, <span class="r54 r">xamlParentElement</span>);
            }
            <b>else</b> <b>if</b> (<span class="r55 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#5a686adea8810425" class="t t">XmlText</a>)
            {
                <a href="#c0c5173d7d3577f1" class="i method">AddTextRun</a>(<span class="r54 r">xamlParentElement</span>, <span class="r55 r">htmlNode</span>.<a href="@0@System.Xml/A.html#419e50e206d75bb5" class="i property">Value</a>);
            }
            <b>else</b> <b>if</b> (<span class="r55 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)
            {
                <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r59 rd" class="r59 r">htmlElement</span> = (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r55 r">htmlNode</span>;
 
                <span class="c">// Check whether this is an html element</span>
                <b>if</b> (<span class="r59 r">htmlElement</span>.<a href="@0@System.Xml/A.html#3adc64551d2eec34" class="i property">NamespaceURI</a> != <a href="HtmlParser.cs.html#047776b6c421dcb9" class="t t">HtmlParser</a>.<a href="HtmlParser.cs.html#dd5a2f8ccbee6dff" class="i field">XhtmlNamespace</a>)
                {
                    <b>return</b>; <span class="c">// Skip non-html elements</span>
                }
 
                <span class="c">// Identify element name</span>
				<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r60 rd" class="r60 r">htmlElementName</span> = <span class="r59 r">htmlElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
 
                <span class="c">// Put source element to the stack</span>
                <span class="r58 r">sourceContext</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r59 r">htmlElement</span>);
 
                <b>switch</b> (<span class="r60 r">htmlElementName</span>)
                {
                    <b>case</b> <span class="s">&quot;a&quot;</span>:
                        <a href="#678ad6f060a8dfab" class="i method">AddHyperlink</a>(<span class="r54 r">xamlParentElement</span>, <span class="r59 r">htmlElement</span>, <span class="r56 r">inheritedProperties</span>, <span class="r57 r">stylesheet</span>, <span class="r58 r">sourceContext</span>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;img&quot;</span>:
                        <a href="#40ed464ba44fa446" class="i method">AddImage</a>(<span class="r54 r">xamlParentElement</span>, <span class="r59 r">htmlElement</span>, <span class="r56 r">inheritedProperties</span>, <span class="r57 r">stylesheet</span>, <span class="r58 r">sourceContext</span>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;br&quot;</span>:
                    <b>case</b> <span class="s">&quot;hr&quot;</span>:
                        <a href="#ca78be984ccab288" class="i method">AddBreak</a>(<span class="r54 r">xamlParentElement</span>, <span class="r60 r">htmlElementName</span>);
                        <b>break</b>;
                    <b>default</b>:
                        <b>if</b> (<a href="HtmlSchema.cs.html#55602139b10af512" class="t t">HtmlSchema</a>.<a href="HtmlSchema.cs.html#730dd3b26fb25581" class="i method">IsInlineElement</a>(<span class="r60 r">htmlElementName</span>) || <a href="HtmlSchema.cs.html#55602139b10af512" class="t t">HtmlSchema</a>.<a href="HtmlSchema.cs.html#e98a79a7f75db1f0" class="i method">IsBlockElement</a>(<span class="r60 r">htmlElementName</span>))
                        {
                            <span class="c">// Note: actually we do not expect block elements here,</span>
                            <span class="c">// but if it happens to be here, we will treat it as a Span.</span>
 
                            <a href="#0c1e532f9dbcf1bd" class="i method">AddSpanOrRun</a>(<span class="r54 r">xamlParentElement</span>, <span class="r59 r">htmlElement</span>, <span class="r56 r">inheritedProperties</span>, <span class="r57 r">stylesheet</span>, <span class="r58 r">sourceContext</span>);
                        }
                        <b>break</b>;
                }
                <span class="c">// Ignore all other elements non-(block/inline/image)</span>
 
                <span class="c">// Remove the element from the stack</span>
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r58 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 0 &amp;&amp; <span class="r58 r">sourceContext</span><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r58 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1] == <span class="r59 r">htmlElement</span>);
                <span class="r58 r">sourceContext</span>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<span class="r58 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
            }
        }
 
        <b>private static void</b> <a id="0c1e532f9dbcf1bd" href="../R/0c1e532f9dbcf1bd.html" target="n" data-glyph="76,1" class="i method">AddSpanOrRun</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r61 rd" class="r61 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r62 rd" class="r62 r">htmlElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r63 rd" class="r63 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r64 rd" class="r64 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r65 rd" class="r65 r">sourceContext</span>)
        {
            <span class="c">// Decide what XAML element to use for this inline element.</span>
            <span class="c">// Check whether it contains any nested inlines</span>
            <b>bool</b> <span id="r66 rd" class="r66 r">elementHasChildren</span> = <b>false</b>;
            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r67 rd" class="r67 r">htmlNode</span> = <span class="r62 r">htmlElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r67 r">htmlNode</span> != <b>null</b>; <span class="r67 r">htmlNode</span> = <span class="r67 r">htmlNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
            {
                <b>if</b> (<span class="r67 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)
                {
					<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r68 rd" class="r68 r">htmlChildName</span> = ((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r67 r">htmlNode</span>).<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                    <b>if</b> (<a href="HtmlSchema.cs.html#55602139b10af512" class="t t">HtmlSchema</a>.<a href="HtmlSchema.cs.html#730dd3b26fb25581" class="i method">IsInlineElement</a>(<span class="r68 r">htmlChildName</span>) || <a href="HtmlSchema.cs.html#55602139b10af512" class="t t">HtmlSchema</a>.<a href="HtmlSchema.cs.html#e98a79a7f75db1f0" class="i method">IsBlockElement</a>(<span class="r68 r">htmlChildName</span>) || 
                        <span class="r68 r">htmlChildName</span> == <span class="s">&quot;img&quot;</span> || <span class="r68 r">htmlChildName</span> == <span class="s">&quot;br&quot;</span> || <span class="r68 r">htmlChildName</span> == <span class="s">&quot;hr&quot;</span>)
                    {
                        <span class="r66 r">elementHasChildren</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r69 rd" class="r69 r">xamlElementName</span> = <span class="r66 r">elementHasChildren</span> ? <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#aa27ac473c9dde0a" class="i field">XamlSpan</a> : <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#ef7d192703a9b10d" class="i field">XamlRun</a>;
 
            <span class="c">// Create currentProperties as a compilation of local and inheritedProperties, set localProperties</span>
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r70 rd" class="r70 r">localProperties</span>;
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r71 rd" class="r71 r">currentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>(<span class="r62 r">htmlElement</span>, <span class="r63 r">inheritedProperties</span>, <b>out</b> <span class="r70 r">localProperties</span>, <span class="r64 r">stylesheet</span>, <span class="r65 r">sourceContext</span>);
 
            <span class="c">// Create a XAML element corresponding to this html element</span>
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r72 rd" class="r72 r">xamlElement</span> = <span class="r61 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<span class="c">/*prefix:*/</span><b>null</b>, <span class="c">/*localName:*/</span><span class="r69 r">xamlElementName</span>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
            <a href="#a43c9ee1a751c059" class="i method">ApplyLocalProperties</a>(<span class="r72 r">xamlElement</span>, <span class="r70 r">localProperties</span>, <span class="c">/*isBlock:*/</span><b>false</b>);
 
            <span class="c">// Recurse into element subtree</span>
            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r73 rd" class="r73 r">htmlChildNode</span> = <span class="r62 r">htmlElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r73 r">htmlChildNode</span> != <b>null</b>; <span class="r73 r">htmlChildNode</span> = <span class="r73 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
            {
                <a href="#8993ebad047b9c66" class="i method">AddInline</a>(<span class="r72 r">xamlElement</span>, <span class="r73 r">htmlChildNode</span>, <span class="r71 r">currentProperties</span>, <span class="r64 r">stylesheet</span>, <span class="r65 r">sourceContext</span>);
            }
 
            <span class="c">// Add the new element to the parent.</span>
            <span class="r61 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r72 r">xamlElement</span>);
        }
 
        <span class="c">// Adds a text run to a xaml tree</span>
        <b>private static void</b> <a id="c0c5173d7d3577f1" href="../R/c0c5173d7d3577f1.html" target="n" data-glyph="76,1" class="i method">AddTextRun</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r74 rd" class="r74 r">xamlElement</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r75 rd" class="r75 r">textData</span>)
        {
            <span class="c">// Remove control characters</span>
            <b>for</b> (<b>int</b> <span id="r76 rd" class="r76 r">i</span> = 0; <span class="r76 r">i</span> &lt; <span class="r75 r">textData</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a>; <span class="r76 r">i</span>++)
            {
                <b>if</b> (<a href="@0@mscorlib/A.html#02f2b1a33b09362d" class="t t">Char</a>.<a href="@0@mscorlib/A.html#29acbe190c9d859e" class="i method">IsControl</a>(<span class="r75 r">textData</span><a href="@0@mscorlib/A.html#8307d03426b56fe1">[</a><span class="r76 r">i</span>]))
                {
                    <span class="r75 r">textData</span> = <span class="r75 r">textData</span>.<a href="@0@mscorlib/A.html#c1d590f287f2c0de" class="i method">Remove</a>(<span class="r76 r">i</span>--, 1);  <span class="c">// decrement i to compensate for character removal</span>
                }
            }
 
            <span class="c">// Replace No-Breaks by spaces (160 is a code of &amp;nbsp; entity in html)</span>
            <span class="c">//  This is a work around the bug in Avalon which does not render nbsp.</span>
            <span class="r75 r">textData</span> = <span class="r75 r">textData</span>.<a href="@0@mscorlib/A.html#987da5dfb39f1927" class="i method">Replace</a>((<b>char</b>)160, <span class="s">&#39; &#39;</span>);
 
            <b>if</b> (<span class="r75 r">textData</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> &gt; 0)
            {
                <span class="r74 r">xamlElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r74 r">xamlElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#b2264e21532e454d" class="i method">CreateTextNode</a>(<span class="r75 r">textData</span>));
            }
        }
 
        <b>private static void</b> <a id="678ad6f060a8dfab" href="../R/678ad6f060a8dfab.html" target="n" data-glyph="76,1" class="i method">AddHyperlink</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r77 rd" class="r77 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r78 rd" class="r78 r">htmlElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r79 rd" class="r79 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r80 rd" class="r80 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r81 rd" class="r81 r">sourceContext</span>)
        {
            <span class="c">// Convert href attribute into NavigateUri and TargetName</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r82 rd" class="r82 r">href</span> = <a href="#bb4e7e205aef385f" class="i method">GetAttribute</a>(<span class="r78 r">htmlElement</span>, <span class="s">&quot;href&quot;</span>);
            <b>if</b> (<span class="r82 r">href</span> == <b>null</b>)
            {
                <span class="c">// When href attribute is missing - ignore the hyperlink</span>
                <a href="#0c1e532f9dbcf1bd" class="i method">AddSpanOrRun</a>(<span class="r77 r">xamlParentElement</span>, <span class="r78 r">htmlElement</span>, <span class="r79 r">inheritedProperties</span>, <span class="r80 r">stylesheet</span>, <span class="r81 r">sourceContext</span>);
            }
            <b>else</b>
            {
                <span class="c">// Create currentProperties as a compilation of local and inheritedProperties, set localProperties</span>
                <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r83 rd" class="r83 r">localProperties</span>;
                <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r84 rd" class="r84 r">currentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>(<span class="r78 r">htmlElement</span>, <span class="r79 r">inheritedProperties</span>, <b>out</b> <span class="r83 r">localProperties</span>, <span class="r80 r">stylesheet</span>, <span class="r81 r">sourceContext</span>);
 
                <span class="c">// Create a XAML element corresponding to this html element</span>
                <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r85 rd" class="r85 r">xamlElement</span> = <span class="r77 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<span class="c">/*prefix:*/</span><b>null</b>, <span class="c">/*localName:*/</span><a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#fe6871e49c38d029" class="i field">XamlHyperlink</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
                <a href="#a43c9ee1a751c059" class="i method">ApplyLocalProperties</a>(<span class="r85 r">xamlElement</span>, <span class="r83 r">localProperties</span>, <span class="c">/*isBlock:*/</span><b>false</b>);
 
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>[] <span id="r86 rd" class="r86 r">hrefParts</span> = <span class="r82 r">href</span>.<a href="@0@mscorlib/A.html#1c4a9dc78ba38999" class="i method">Split</a>(<b>new</b> <b>char</b>[] { <span class="s">&#39;#&#39;</span> });
                <b>if</b> (<span class="r86 r">hrefParts</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0 &amp;&amp; <span class="r86 r">hrefParts</span>[0].<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>().<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> &gt; 0)
                {
                    <span class="r85 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#7704f3972e52e81a" class="i field">XamlHyperlinkNavigateUri</a>, <span class="r86 r">hrefParts</span>[0].<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>());
                }
                <b>if</b> (<span class="r86 r">hrefParts</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 2 &amp;&amp; <span class="r86 r">hrefParts</span>[1].<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>().<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> &gt; 0)
                {
                    <span class="r85 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#7a85d4c3a78d1f74" class="i field">XamlHyperlinkTargetName</a>, <span class="r86 r">hrefParts</span>[1].<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>());
                }
 
                <span class="c">// Recurse into element subtree</span>
                <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r87 rd" class="r87 r">htmlChildNode</span> = <span class="r78 r">htmlElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r87 r">htmlChildNode</span> != <b>null</b>; <span class="r87 r">htmlChildNode</span> = <span class="r87 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
                {
                    <a href="#8993ebad047b9c66" class="i method">AddInline</a>(<span class="r85 r">xamlElement</span>, <span class="r87 r">htmlChildNode</span>, <span class="r84 r">currentProperties</span>, <span class="r80 r">stylesheet</span>, <span class="r81 r">sourceContext</span>);
                }
 
                <span class="c">// Add the new element to the parent.</span>
                <span class="r77 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r85 r">xamlElement</span>);
            }
        }
 
        <span class="c">// Stores a parent xaml element for the case when selected fragment is inline.</span>
        <b>private static</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <a id="bfbfef985df161cf" href="../R/bfbfef985df161cf.html" target="n" data-glyph="46,1" class="i field">InlineFragmentParentElement</a>;
 
        <span class="c">// Called when html comment is encountered to store a parent element</span>
        <span class="c">// for the case when the fragment is inline - to extract it to a separate</span>
        <span class="c">// Span wrapper after the conversion.</span>
        <b>private static void</b> <a id="0e15a745618029df" href="../R/0e15a745618029df.html" target="n" data-glyph="76,1" class="i method">DefineInlineFragmentParent</a>(<a href="@0@System.Xml/A.html#fdb35b5b46ded55f" class="t t">XmlComment</a> <span id="r88 rd" class="r88 r">htmlComment</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r89 rd" class="r89 r">xamlParentElement</span>)
        {
            <b>if</b> (<span class="r88 r">htmlComment</span>.<a href="@0@System.Xml/A.html#961cdca30873b403" class="i property">Value</a> == <span class="s">&quot;StartFragment&quot;</span>)
            {
                <a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a> = <span class="r89 r">xamlParentElement</span>;
            }
            <b>else</b> <b>if</b> (<span class="r88 r">htmlComment</span>.<a href="@0@System.Xml/A.html#961cdca30873b403" class="i property">Value</a> == <span class="s">&quot;EndFragment&quot;</span>)
            {
                <b>if</b> (<a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a> == <b>null</b> &amp;&amp; <span class="r89 r">xamlParentElement</span> != <b>null</b>)
                {
                    <span class="c">// Normally this cannot happen if comments produced by correct copying code</span>
                    <span class="c">// in Word or IE, but when it is produced manually then fragment boundary</span>
                    <span class="c">// markers can be inconsistent. In this case StartFragment takes precedence,</span>
                    <span class="c">// but if it is not set, then we get the value from EndFragment marker.</span>
                    <a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a> = <span class="r89 r">xamlParentElement</span>;
                }
            }
        }
 
        <span class="c">// Extracts a content of an element stored as InlineFragmentParentElement</span>
        <span class="c">// into a separate Span wrapper.</span>
        <span class="c">// Note: when selected content does not cross paragraph boundaries,</span>
        <span class="c">// the fragment is marked within</span>
        <b>private static</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <a id="c788092a685469f6" href="../R/c788092a685469f6.html" target="n" data-glyph="76,1" class="i method">ExtractInlineFragment</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r90 rd" class="r90 r">xamlFlowDocumentElement</span>)
        {
            <b>if</b> (<a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a> != <b>null</b>)
            {
                <b>if</b> (<a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a> == <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#aa27ac473c9dde0a" class="i field">XamlSpan</a>)
                {
                    <span class="r90 r">xamlFlowDocumentElement</span> = <a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a>;
                }
                <b>else</b>
                {
                    <span class="r90 r">xamlFlowDocumentElement</span> = <span class="r90 r">xamlFlowDocumentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<span class="c">/*prefix:*/</span><b>null</b>, <span class="c">/*localName:*/</span><a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#aa27ac473c9dde0a" class="i field">XamlSpan</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
                    <b>while</b> (<a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a> != <b>null</b>)
                    {
                        <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r91 rd" class="r91 r">copyNode</span> = <a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>;
                        <a href="#bfbfef985df161cf" class="i field">InlineFragmentParentElement</a>.<a href="@0@System.Xml/A.html#2040006854ad41bd" class="i method">RemoveChild</a>(<span class="r91 r">copyNode</span>);
                        <span class="r90 r">xamlFlowDocumentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r91 r">copyNode</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r90 r">xamlFlowDocumentElement</span>;
        }
 
        <span class="c">// .............................................................</span>
        <span class="c">//</span>
        <span class="c">// Images</span>
        <span class="c">//</span>
        <span class="c">// .............................................................</span>
 
        <b>private static void</b> <a id="40ed464ba44fa446" href="../R/40ed464ba44fa446.html" target="n" data-glyph="76,1" class="i method">AddImage</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r92 rd" class="r92 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r93 rd" class="r93 r">htmlElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r94 rd" class="r94 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r95 rd" class="r95 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r96 rd" class="r96 r">sourceContext</span>)
        {
            <span class="c">//  Implement images</span>
        }
 
        <span class="c">// .............................................................</span>
        <span class="c">//</span>
        <span class="c">// Lists</span>
        <span class="c">//</span>
        <span class="c">// .............................................................</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts Html ul or ol element into Xaml list element. During conversion if the ul/ol element has any children </span>
        <span class="c">///</span><span class="c"> that are not li elements, they are ignored and not added to the list element</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">xamlParentElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml parent to which the converted element should be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">htmlListElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html ul/ol element to be converted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> properties inherited from parent context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="5c6cda38d9908311" href="../R/5c6cda38d9908311.html" target="n" data-glyph="76,1" class="i method">AddList</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r97 rd" class="r97 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r98 rd" class="r98 r">htmlListElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r99 rd" class="r99 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r100 rd" class="r100 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r101 rd" class="r101 r">sourceContext</span>)
        {
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r102 rd" class="r102 r">htmlListElementName</span> = <span class="r98 r">htmlListElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
 
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r103 rd" class="r103 r">localProperties</span>;
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r104 rd" class="r104 r">currentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>(<span class="r98 r">htmlListElement</span>, <span class="r99 r">inheritedProperties</span>, <b>out</b> <span class="r103 r">localProperties</span>, <span class="r100 r">stylesheet</span>, <span class="r101 r">sourceContext</span>);
 
            <span class="c">// Create Xaml List element</span>
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r105 rd" class="r105 r">xamlListElement</span> = <span class="r97 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#68b367d2cd7d374a" class="i field">XamlList</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
 
            <span class="c">// Set default list markers</span>
            <b>if</b> (<span class="r102 r">htmlListElementName</span> == <span class="s">&quot;ol&quot;</span>)
            {
                <span class="c">// Ordered list</span>
                <span class="r105 r">xamlListElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#a535ed5ce3fedf1e" class="i field">XamlListMarkerStyle</a>, <a href="#b1d2a61a94e3b3a5" class="i field">Xaml_List_MarkerStyle_Decimal</a>);
            }
            <b>else</b>
            {
                <span class="c">// Unordered list - all elements other than OL treated as unordered lists</span>
                <span class="r105 r">xamlListElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#a535ed5ce3fedf1e" class="i field">XamlListMarkerStyle</a>, <a href="#fe5f24c33eab093b" class="i field">Xaml_List_MarkerStyle_Disc</a>);
            }
 
            <span class="c">// Apply local properties to list to set marker attribute if specified</span>
            <span class="c">// TODO: Should we have separate list attribute processing function?</span>
            <a href="#a43c9ee1a751c059" class="i method">ApplyLocalProperties</a>(<span class="r105 r">xamlListElement</span>, <span class="r103 r">localProperties</span>, <span class="c">/*isBlock:*/</span><b>true</b>);
 
            <span class="c">// Recurse into list subtree</span>
            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r106 rd" class="r106 r">htmlChildNode</span> = <span class="r98 r">htmlListElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r106 r">htmlChildNode</span> != <b>null</b>; <span class="r106 r">htmlChildNode</span> = <span class="r106 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
            {
				<b>if</b> (<span class="r106 r">htmlChildNode</span> <b>is</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> &amp;&amp; <span class="r106 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;li&quot;</span>)
                {
                    <span class="r101 r">sourceContext</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r106 r">htmlChildNode</span>);
                    <a href="#027f067cc263304b" class="i method">AddListItem</a>(<span class="r105 r">xamlListElement</span>, (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r106 r">htmlChildNode</span>, <span class="r104 r">currentProperties</span>, <span class="r100 r">stylesheet</span>, <span class="r101 r">sourceContext</span>);
                    <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r101 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 0 &amp;&amp; <span class="r101 r">sourceContext</span><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r101 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1] == <span class="r106 r">htmlChildNode</span>);
                    <span class="r101 r">sourceContext</span>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<span class="r101 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
                }
                <b>else</b>
                {
                    <span class="c">// Not an li element. Add it to previous ListBoxItem</span>
                    <span class="c">//  We need to append the content to the end</span>
                    <span class="c">// of a previous list item.</span>
                }
            }
 
            <span class="c">// Add the List element to xaml tree - if it is not empty</span>
            <b>if</b> (<span class="r105 r">xamlListElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
            {
                <span class="r97 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r105 r">xamlListElement</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If li items are found without a parent ul/ol element in Html string, creates xamlListElement as their parent and adds</span>
        <span class="c">///</span><span class="c"> them to it. If the previously added node to the same xamlParentElement was a List, adds the elements to that list.</span>
        <span class="c">///</span><span class="c"> Otherwise, we create a new xamlListElement and add them to it. Elements are added as long as li elements appear sequentially.</span>
        <span class="c">///</span><span class="c"> The first non-li or text node stops the addition.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">xamlParentElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parent element for the list</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">htmlLIElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Start Html li element without parent list</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Properties inherited from parent context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlNode representing the first non-li node in the input after one or more li&#39;s have been processed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <a id="8acd1c1faf7e30ca" href="../R/8acd1c1faf7e30ca.html" target="n" data-glyph="76,1" class="i method">AddOrphanListItems</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r107 rd" class="r107 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r108 rd" class="r108 r">htmlLIElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r109 rd" class="r109 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r111 rd" class="r111 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r110 rd" class="r110 r">sourceContext</span>)
        {
			<a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r108 r">htmlLIElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;li&quot;</span>);
 
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r112 rd" class="r112 r">lastProcessedListItemElement</span> = <b>null</b>;
 
            <span class="c">// Find out the last element attached to the xamlParentElement, which is the previous sibling of this node</span>
            <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r113 rd" class="r113 r">xamlListItemElementPreviousSibling</span> = <span class="r107 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#373f7a0306be1c3c" class="i property">LastChild</a>;
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r114 rd" class="r114 r">xamlListElement</span>;
            <b>if</b> (<span class="r113 r">xamlListItemElementPreviousSibling</span> != <b>null</b> &amp;&amp; <span class="r113 r">xamlListItemElementPreviousSibling</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a> == <a href="#68b367d2cd7d374a" class="i field">XamlList</a>)
            {
                <span class="c">// Previously added Xaml element was a list. We will add the new li to it</span>
                <span class="r114 r">xamlListElement</span> = (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r113 r">xamlListItemElementPreviousSibling</span>;
            }
            <b>else</b>
            {
                <span class="c">// No list element near. Create our own.</span>
                <span class="r114 r">xamlListElement</span> = <span class="r107 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#68b367d2cd7d374a" class="i field">XamlList</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
                <span class="r107 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r114 r">xamlListElement</span>);
            }
 
            <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r115 rd" class="r115 r">htmlChildNode</span> = <span class="r108 r">htmlLIElement</span>;
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r116 rd" class="r116 r">htmlChildNodeName</span> = <span class="r115 r">htmlChildNode</span> == <b>null</b> ? <b>null</b> : <span class="r115 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
 
            <span class="c">//  Current element properties missed here.</span>
            <span class="c">//currentProperties = GetElementProperties(htmlLIElement, inheritedProperties, out localProperties, stylesheet);</span>
 
            <span class="c">// Add li elements to the parent xamlListElement we created as long as they appear sequentially</span>
            <span class="c">// Use properties inherited from xamlParentElement for context </span>
            <b>while</b> (<span class="r115 r">htmlChildNode</span> != <b>null</b> &amp;&amp; <span class="r116 r">htmlChildNodeName</span> == <span class="s">&quot;li&quot;</span>)
            {
                <a href="#027f067cc263304b" class="i method">AddListItem</a>(<span class="r114 r">xamlListElement</span>, (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r115 r">htmlChildNode</span>, <span class="r109 r">inheritedProperties</span>, <span class="r111 r">stylesheet</span>, <span class="r110 r">sourceContext</span>);
                <span class="r112 r">lastProcessedListItemElement</span> = (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r115 r">htmlChildNode</span>;
                <span class="r115 r">htmlChildNode</span> = <span class="r115 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
				<span class="r116 r">htmlChildNodeName</span> = <span class="r115 r">htmlChildNode</span> == <b>null</b> ? <b>null</b> : <span class="r115 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
            }
 
            <b>return</b> <span class="r112 r">lastProcessedListItemElement</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts htmlLIElement into Xaml ListItem element, and appends it to the parent xamlListElement</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">xamlListElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml List element to which the converted td/th should be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">htmlLIElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html li element to be converted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Properties inherited from parent context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r120 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<b>private static void</b> <a id="027f067cc263304b" href="../R/027f067cc263304b.html" target="n" data-glyph="76,1" class="i method">AddListItem</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r117 rd" class="r117 r">xamlListElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r118 rd" class="r118 r">htmlLIElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r119 rd" class="r119 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r121 rd" class="r121 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r120 rd" class="r120 r">sourceContext</span>)
        {
            <span class="c">// Parameter validation</span>
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r117 r">xamlListElement</span> != <b>null</b>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r117 r">xamlListElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a> == <a href="#68b367d2cd7d374a" class="i field">XamlList</a>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r118 r">htmlLIElement</span> != <b>null</b>);
			<a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r118 r">htmlLIElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;li&quot;</span>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r119 r">inheritedProperties</span> != <b>null</b>);
 
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r122 rd" class="r122 r">localProperties</span>;
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r123 rd" class="r123 r">currentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>(<span class="r118 r">htmlLIElement</span>, <span class="r119 r">inheritedProperties</span>, <b>out</b> <span class="r122 r">localProperties</span>, <span class="r121 r">stylesheet</span>, <span class="r120 r">sourceContext</span>);
 
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r124 rd" class="r124 r">xamlListItemElement</span> = <span class="r117 r">xamlListElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#07db446592efc7fe" class="i field">Xaml_ListItem</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
 
            <span class="c">// TODO: process local properties for li element</span>
 
            <span class="c">// Process children of the ListItem</span>
            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r125 rd" class="r125 r">htmlChildNode</span> = <span class="r118 r">htmlLIElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r125 r">htmlChildNode</span> != <b>null</b>; <span class="r125 r">htmlChildNode</span> = <span class="r125 r">htmlChildNode</span> != <b>null</b> ? <span class="r125 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a> : <b>null</b>)
            {
                <span class="r125 r">htmlChildNode</span> = <a href="#3ee8eb9573f99c0a" class="i method">AddBlock</a>(<span class="r124 r">xamlListItemElement</span>, <span class="r125 r">htmlChildNode</span>, <span class="r123 r">currentProperties</span>, <span class="r121 r">stylesheet</span>, <span class="r120 r">sourceContext</span>);
            }
 
            <span class="c">// Add resulting ListBoxItem to a xaml parent</span>
            <span class="r117 r">xamlListElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r124 r">xamlListItemElement</span>);
        }
 
        <span class="c">// .............................................................</span>
        <span class="c">//</span>
        <span class="c">// Tables</span>
        <span class="c">//</span>
        <span class="c">// .............................................................</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts htmlTableElement to a Xaml Table element. Adds tbody elements if they are missing so</span>
        <span class="c">///</span><span class="c"> that a resulting Xaml Table element is properly formed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">xamlParentElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parent xaml element to which a converted table must be added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">htmlTableElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement reprsenting the Html table element to be converted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hashtable representing properties inherited from parent context. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="d3169461fab7df76" href="../R/d3169461fab7df76.html" target="n" data-glyph="76,1" class="i method">AddTable</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r126 rd" class="r126 r">xamlParentElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r127 rd" class="r127 r">htmlTableElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r128 rd" class="r128 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r130 rd" class="r130 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r129 rd" class="r129 r">sourceContext</span>)
        {
            <span class="c">// Parameter validation</span>
			<a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r127 r">htmlTableElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;table&quot;</span>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r126 r">xamlParentElement</span> != <b>null</b>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r128 r">inheritedProperties</span> != <b>null</b>);
 
            <span class="c">// Create current properties to be used by children as inherited properties, set local properties</span>
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r131 rd" class="r131 r">localProperties</span>;
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r132 rd" class="r132 r">currentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>(<span class="r127 r">htmlTableElement</span>, <span class="r128 r">inheritedProperties</span>, <b>out</b> <span class="r131 r">localProperties</span>, <span class="r130 r">stylesheet</span>, <span class="r129 r">sourceContext</span>);
 
            <span class="c">// TODO: process localProperties for tables to override defaults, decide cell spacing defaults</span>
 
            <span class="c">// Check if the table contains only one cell - we want to take only its content</span>
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r133 rd" class="r133 r">singleCell</span> = <a href="#ac9be2431fbb4642" class="i method">GetCellFromSingleCellTable</a>(<span class="r127 r">htmlTableElement</span>);
 
            <b>if</b> (<span class="r133 r">singleCell</span> != <b>null</b>)
            {
                <span class="c">//  Need to push skipped table elements onto sourceContext</span>
                <span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r133 r">singleCell</span>);
 
                <span class="c">// Add the cell&#39;s content directly to parent</span>
                <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r134 rd" class="r134 r">htmlChildNode</span> = <span class="r133 r">singleCell</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r134 r">htmlChildNode</span> != <b>null</b>; <span class="r134 r">htmlChildNode</span> = <span class="r134 r">htmlChildNode</span> != <b>null</b> ? <span class="r134 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a> : <b>null</b>)
                {
                    <span class="r134 r">htmlChildNode</span> = <a href="#3ee8eb9573f99c0a" class="i method">AddBlock</a>(<span class="r126 r">xamlParentElement</span>, <span class="r134 r">htmlChildNode</span>, <span class="r132 r">currentProperties</span>, <span class="r130 r">stylesheet</span>, <span class="r129 r">sourceContext</span>);
                }
 
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 0 &amp;&amp; <span class="r129 r">sourceContext</span><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1] == <span class="r133 r">singleCell</span>);
                <span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
            }
            <b>else</b>
            {
                <span class="c">// Create xamlTableElement</span>
                <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r135 rd" class="r135 r">xamlTableElement</span> = <span class="r126 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#de171cbd7064ada6" class="i field">Xaml_Table</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
 
                <span class="c">// Analyze table structure for column widths and rowspan attributes</span>
                <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r136 rd" class="r136 r">columnStarts</span> = <a href="#a8351590d53c4247" class="i method">AnalyzeTableStructure</a>(<span class="r127 r">htmlTableElement</span>, <span class="r130 r">stylesheet</span>);
 
                <span class="c">// Process COLGROUP &amp; COL elements</span>
                <a href="#5cf86fc4c218318a" class="i method">AddColumnInformation</a>(<span class="r127 r">htmlTableElement</span>, <span class="r135 r">xamlTableElement</span>, <span class="r136 r">columnStarts</span>, <span class="r132 r">currentProperties</span>, <span class="r130 r">stylesheet</span>, <span class="r129 r">sourceContext</span>);
 
                <span class="c">// Process table body - TBODY and TR elements</span>
                <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r137 rd" class="r137 r">htmlChildNode</span> = <span class="r127 r">htmlTableElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>;
 
                <b>while</b> (<span class="r137 r">htmlChildNode</span> != <b>null</b>)
                {
					<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r138 rd" class="r138 r">htmlChildName</span> = <span class="r137 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
 
                    <span class="c">// Process the element</span>
                    <b>if</b> (<span class="r138 r">htmlChildName</span> == <span class="s">&quot;tbody&quot;</span> || <span class="r138 r">htmlChildName</span> == <span class="s">&quot;thead&quot;</span> || <span class="r138 r">htmlChildName</span> == <span class="s">&quot;tfoot&quot;</span>)
                    {
                        <span class="c">//  Add more special processing for TableHeader and TableFooter</span>
                        <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r139 rd" class="r139 r">xamlTableBodyElement</span> = <span class="r135 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#cdb5eb4d8115d166" class="i field">Xaml_TableRowGroup</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
                        <span class="r135 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r139 r">xamlTableBodyElement</span>);
 
                        <span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r137 r">htmlChildNode</span>);
 
                        <span class="c">// Get properties of Html tbody element</span>
                        <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r140 rd" class="r140 r">tbodyElementLocalProperties</span>;
                        <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r141 rd" class="r141 r">tbodyElementCurrentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r137 r">htmlChildNode</span>, <span class="r132 r">currentProperties</span>, <b>out</b> <span class="r140 r">tbodyElementLocalProperties</span>, <span class="r130 r">stylesheet</span>, <span class="r129 r">sourceContext</span>);
                        <span class="c">// TODO: apply local properties for tbody</span>
 
                        <span class="c">// Process children of htmlChildNode, which is tbody, for tr elements</span>
                        <a href="#e2adedaa8f3e33b3" class="i method">AddTableRowsToTableBody</a>(<span class="r139 r">xamlTableBodyElement</span>, <span class="r137 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>, <span class="r141 r">tbodyElementCurrentProperties</span>, <span class="r136 r">columnStarts</span>, <span class="r130 r">stylesheet</span>, <span class="r129 r">sourceContext</span>);
                        <b>if</b> (<span class="r139 r">xamlTableBodyElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
                        {
                            <span class="r135 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r139 r">xamlTableBodyElement</span>);
                            <span class="c">// else: if there is no TRs in this TBody, we simply ignore it</span>
                        }
 
                        <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 0 &amp;&amp; <span class="r129 r">sourceContext</span><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1] == <span class="r137 r">htmlChildNode</span>);
                        <span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<span class="r129 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
 
                        <span class="r137 r">htmlChildNode</span> = <span class="r137 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
                    }
                    <b>else</b> <b>if</b> (<span class="r138 r">htmlChildName</span> == <span class="s">&quot;tr&quot;</span>)
                    {
                        <span class="c">// Tbody is not present, but tr element is present. Tr is wrapped in tbody</span>
                        <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r142 rd" class="r142 r">xamlTableBodyElement</span> = <span class="r135 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#cdb5eb4d8115d166" class="i field">Xaml_TableRowGroup</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
 
                        <span class="c">// We use currentProperties of xamlTableElement when adding rows since the tbody element is artificially created and has </span>
                        <span class="c">// no properties of its own</span>
 
                        <span class="r137 r">htmlChildNode</span> = <a href="#e2adedaa8f3e33b3" class="i method">AddTableRowsToTableBody</a>(<span class="r142 r">xamlTableBodyElement</span>, <span class="r137 r">htmlChildNode</span>, <span class="r132 r">currentProperties</span>, <span class="r136 r">columnStarts</span>, <span class="r130 r">stylesheet</span>, <span class="r129 r">sourceContext</span>);
                        <b>if</b> (<span class="r142 r">xamlTableBodyElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
                        {
                            <span class="r135 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r142 r">xamlTableBodyElement</span>);
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// Element is not tbody or tr. Ignore it.</span>
                        <span class="c">// TODO: add processing for thead, tfoot elements and recovery for td elements</span>
                        <span class="r137 r">htmlChildNode</span> = <span class="r137 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
                    }
                }
 
                <b>if</b> (<span class="r135 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
                {
                    <span class="r126 r">xamlParentElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r135 r">xamlTableElement</span>);
                }
            }
        }
 
        <b>private static</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <a id="ac9be2431fbb4642" href="../R/ac9be2431fbb4642.html" target="n" data-glyph="76,1" class="i method">GetCellFromSingleCellTable</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r143 rd" class="r143 r">htmlTableElement</span>)
        {
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r144 rd" class="r144 r">singleCell</span> = <b>null</b>;
 
            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r145 rd" class="r145 r">tableChild</span> = <span class="r143 r">htmlTableElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r145 r">tableChild</span> != <b>null</b>; <span class="r145 r">tableChild</span> = <span class="r145 r">tableChild</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
            {
				<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r146 rd" class="r146 r">elementName</span> = <span class="r145 r">tableChild</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                <b>if</b> (<span class="r146 r">elementName</span> == <span class="s">&quot;tbody&quot;</span> || <span class="r146 r">elementName</span> == <span class="s">&quot;thead&quot;</span> || <span class="r146 r">elementName</span> == <span class="s">&quot;tfoot&quot;</span>)
                {
                    <b>if</b> (<span class="r144 r">singleCell</span> != <b>null</b>)
                    {
                        <b>return</b> <b>null</b>;
                    }
                    <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r147 rd" class="r147 r">tbodyChild</span> = <span class="r145 r">tableChild</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r147 r">tbodyChild</span> != <b>null</b>; <span class="r147 r">tbodyChild</span> = <span class="r147 r">tbodyChild</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
                    {
						<b>if</b> (<span class="r147 r">tbodyChild</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;tr&quot;</span>)
                        {
                            <b>if</b> (<span class="r144 r">singleCell</span> != <b>null</b>)
                            {
                                <b>return</b> <b>null</b>;
                            }
                            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r148 rd" class="r148 r">trChild</span> = <span class="r147 r">tbodyChild</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r148 r">trChild</span> != <b>null</b>; <span class="r148 r">trChild</span> = <span class="r148 r">trChild</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
                            {
								<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r149 rd" class="r149 r">cellName</span> = <span class="r148 r">trChild</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                                <b>if</b> (<span class="r149 r">cellName</span> == <span class="s">&quot;td&quot;</span> || <span class="r149 r">cellName</span> == <span class="s">&quot;th&quot;</span>)
                                {
                                    <b>if</b> (<span class="r144 r">singleCell</span> != <b>null</b>)
                                    {
                                        <b>return</b> <b>null</b>;
                                    }
                                    <span class="r144 r">singleCell</span> = (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r148 r">trChild</span>;
                                }
                            }
                        }
                    }
                }
				<b>else</b> <b>if</b> (<span class="r145 r">tableChild</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;tr&quot;</span>)
                {
                    <b>if</b> (<span class="r144 r">singleCell</span> != <b>null</b>)
                    {
                        <b>return</b> <b>null</b>;
                    }
                    <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r150 rd" class="r150 r">trChild</span> = <span class="r145 r">tableChild</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r150 r">trChild</span> != <b>null</b>; <span class="r150 r">trChild</span> = <span class="r150 r">trChild</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
                    {
						<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r151 rd" class="r151 r">cellName</span> = <span class="r150 r">trChild</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                        <b>if</b> (<span class="r151 r">cellName</span> == <span class="s">&quot;td&quot;</span> || <span class="r151 r">cellName</span> == <span class="s">&quot;th&quot;</span>)
                        {
                            <b>if</b> (<span class="r144 r">singleCell</span> != <b>null</b>)
                            {
                                <b>return</b> <b>null</b>;
                            }
                            <span class="r144 r">singleCell</span> = (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r150 r">trChild</span>;
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r144 r">singleCell</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Processes the information about table columns - COLGROUP and COL html elements.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r152 r">htmlTableElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing a source html table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r153 r">xamlTableElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement repesenting a resulting xaml table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r154 r">columnStartsAllRows</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Array of doubles - column start coordinates.</span>
        <span class="c">///</span><span class="c"> Can be null, which means that column size information is not available</span>
        <span class="c">///</span><span class="c"> and we must use source colgroup/col information.</span>
        <span class="c">///</span><span class="c"> In case wneh it&#39;s not null, we will ignore source colgroup/col information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r155 r">currentProperties</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r156 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r157 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="5cf86fc4c218318a" href="../R/5cf86fc4c218318a.html" target="n" data-glyph="76,1" class="i method">AddColumnInformation</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r152 rd" class="r152 r">htmlTableElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r153 rd" class="r153 r">xamlTableElement</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r154 rd" class="r154 r">columnStartsAllRows</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r155 rd" class="r155 r">currentProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r156 rd" class="r156 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r157 rd" class="r157 r">sourceContext</span>)
        {
            <span class="c">// Add column information</span>
            <b>if</b> (<span class="r154 r">columnStartsAllRows</span> != <b>null</b>)
            {
                <span class="c">// We have consistent information derived from table cells; use it</span>
                <span class="c">// The last element in columnStarts represents the end of the table</span>
                <b>for</b> (<b>int</b> <span id="r158 rd" class="r158 r">columnIndex</span> = 0; <span class="r158 r">columnIndex</span> &lt; <span class="r154 r">columnStartsAllRows</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> - 1; <span class="r158 r">columnIndex</span>++)
                {
                    <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r159 rd" class="r159 r">xamlColumnElement</span>;
 
                    <span class="r159 r">xamlColumnElement</span> = <span class="r153 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#0a7fa65be4ffa2c9" class="i field">Xaml_TableColumn</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
					<span class="r159 r">xamlColumnElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#2fc099b8439a078c" class="i field">Xaml_Width</a>, ((<b>double</b>)<span class="r154 r">columnStartsAllRows</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r158 r">columnIndex</span> + 1] - (<b>double</b>)<span class="r154 r">columnStartsAllRows</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r158 r">columnIndex</span>]).<a href="@0@mscorlib/A.html#102b12e1c4385406" class="i method">ToString</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>));
                    <span class="r153 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r159 r">xamlColumnElement</span>);
                }
            }
            <b>else</b>
            {
                <span class="c">// We do not have consistent information from table cells;</span>
                <span class="c">// Translate blindly colgroups from html.                </span>
                <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r160 rd" class="r160 r">htmlChildNode</span> = <span class="r152 r">htmlTableElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r160 r">htmlChildNode</span> != <b>null</b>; <span class="r160 r">htmlChildNode</span> = <span class="r160 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
                {
					<b>if</b> (<span class="r160 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;colgroup&quot;</span>)
                    {
                        <span class="c">// TODO: add column width information to this function as a parameter and process it</span>
                        <a href="#21fd430726cb740b" class="i method">AddTableColumnGroup</a>(<span class="r153 r">xamlTableElement</span>, (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r160 r">htmlChildNode</span>, <span class="r155 r">currentProperties</span>, <span class="r156 r">stylesheet</span>, <span class="r157 r">sourceContext</span>);
                    }
					<b>else</b> <b>if</b> (<span class="r160 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;col&quot;</span>)
                    {
                        <a href="#f04f60f43a8aa296" class="i method">AddTableColumn</a>(<span class="r153 r">xamlTableElement</span>, (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r160 r">htmlChildNode</span>, <span class="r155 r">currentProperties</span>, <span class="r156 r">stylesheet</span>, <span class="r157 r">sourceContext</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r160 r">htmlChildNode</span> <b>is</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)
                    {
                        <span class="c">// Some element which belongs to table body. Stop column loop.</span>
                        <b>break</b>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts htmlColgroupElement into Xaml TableColumnGroup element, and appends it to the parent</span>
        <span class="c">///</span><span class="c"> xamlTableElement</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r161 r">xamlTableElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml Table element to which the converted column group should be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r162 r">htmlColgroupElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html colgroup element to be converted</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r163 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Properties inherited from parent context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r164 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r165 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="21fd430726cb740b" href="../R/21fd430726cb740b.html" target="n" data-glyph="76,1" class="i method">AddTableColumnGroup</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r161 rd" class="r161 r">xamlTableElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r162 rd" class="r162 r">htmlColgroupElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r163 rd" class="r163 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r165 rd" class="r165 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r164 rd" class="r164 r">sourceContext</span>)
        {
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r166 rd" class="r166 r">localProperties</span>;
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r167 rd" class="r167 r">currentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>(<span class="r162 r">htmlColgroupElement</span>, <span class="r163 r">inheritedProperties</span>, <b>out</b> <span class="r166 r">localProperties</span>, <span class="r165 r">stylesheet</span>, <span class="r164 r">sourceContext</span>);
 
            <span class="c">// TODO: process local properties for colgroup</span>
 
            <span class="c">// Process children of colgroup. Colgroup may contain only col elements.</span>
            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r168 rd" class="r168 r">htmlNode</span> = <span class="r162 r">htmlColgroupElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>; <span class="r168 r">htmlNode</span> != <b>null</b>; <span class="r168 r">htmlNode</span> = <span class="r168 r">htmlNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>)
            {
				<b>if</b> (<span class="r168 r">htmlNode</span> <b>is</b> <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> &amp;&amp; <span class="r168 r">htmlNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;col&quot;</span>)
                {
                    <a href="#f04f60f43a8aa296" class="i method">AddTableColumn</a>(<span class="r161 r">xamlTableElement</span>, (<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r168 r">htmlNode</span>, <span class="r167 r">currentProperties</span>, <span class="r165 r">stylesheet</span>, <span class="r164 r">sourceContext</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts htmlColElement into Xaml TableColumn element, and appends it to the parent</span>
        <span class="c">///</span><span class="c"> xamlTableColumnGroupElement</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">xamlTableElement</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r170 r">htmlColElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html col element to be converted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r171 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> properties inherited from parent context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r172 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r173 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="f04f60f43a8aa296" href="../R/f04f60f43a8aa296.html" target="n" data-glyph="76,1" class="i method">AddTableColumn</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r169 rd" class="r169 r">xamlTableElement</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r170 rd" class="r170 r">htmlColElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r171 rd" class="r171 r">inheritedProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r172 rd" class="r172 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r173 rd" class="r173 r">sourceContext</span>)
        {
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r174 rd" class="r174 r">localProperties</span>;
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r175 rd" class="r175 r">currentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>(<span class="r170 r">htmlColElement</span>, <span class="r171 r">inheritedProperties</span>, <b>out</b> <span class="r174 r">localProperties</span>, <span class="r172 r">stylesheet</span>, <span class="r173 r">sourceContext</span>);
 
            <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r176 rd" class="r176 r">xamlTableColumnElement</span> = <span class="r169 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#0a7fa65be4ffa2c9" class="i field">Xaml_TableColumn</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
 
            <span class="c">// TODO: process local properties for TableColumn element</span>
 
            <span class="c">// Col is an empty element, with no subtree </span>
            <span class="r169 r">xamlTableElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r176 r">xamlTableColumnElement</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds TableRow elements to xamlTableBodyElement. The rows are converted from Html tr elements that</span>
        <span class="c">///</span><span class="c"> may be the children of an Html tbody element or an Html table element with tbody missing</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r177 r">xamlTableBodyElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml TableRowGroup element to which the converted rows should be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r178 r">htmlTRStartNode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing the first tr child of the tbody element to be read</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r179 r">currentProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hashtable representing current properties of the tbody element that are generated and applied in the</span>
        <span class="c">///</span><span class="c"> AddTable function; to be used as inheritedProperties when adding tr elements</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r180 r">columnStarts</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r181 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r182 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlNode representing the current position of the iterator among tr elements</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <a id="e2adedaa8f3e33b3" href="../R/e2adedaa8f3e33b3.html" target="n" data-glyph="76,1" class="i method">AddTableRowsToTableBody</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r177 rd" class="r177 r">xamlTableBodyElement</span>, <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r178 rd" class="r178 r">htmlTRStartNode</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r179 rd" class="r179 r">currentProperties</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r180 rd" class="r180 r">columnStarts</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r181 rd" class="r181 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r182 rd" class="r182 r">sourceContext</span>)
        {
            <span class="c">// Parameter validation</span>
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r177 r">xamlTableBodyElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a> == <a href="#cdb5eb4d8115d166" class="i field">Xaml_TableRowGroup</a>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r179 r">currentProperties</span> != <b>null</b>);
 
            <span class="c">// Initialize child node for iteratimg through children to the first tr element</span>
            <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r183 rd" class="r183 r">htmlChildNode</span> = <span class="r178 r">htmlTRStartNode</span>;
            <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r184 rd" class="r184 r">activeRowSpans</span> = <b>null</b>;
            <b>if</b> (<span class="r180 r">columnStarts</span> != <b>null</b>)
            {
                <span class="r184 r">activeRowSpans</span> = <b>new</b> <a href="@0@mscorlib/A.html#3113636092b18f20" class="t constructor">ArrayList</a>();
                <a href="#4e6f1cf144a9d6d5" class="i method">InitializeActiveRowSpans</a>(<span class="r184 r">activeRowSpans</span>, <span class="r180 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
            }
 
			<b>while</b> (<span class="r183 r">htmlChildNode</span> != <b>null</b> &amp;&amp; <span class="r183 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) != <span class="s">&quot;tbody&quot;</span>)
            {
                <b>if</b> (<span class="r183 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;tr&quot;</span>)
                {
                    <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r185 rd" class="r185 r">xamlTableRowElement</span> = <span class="r177 r">xamlTableBodyElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#45cac16bd8ae387e" class="i field">Xaml_TableRow</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
 
                    <span class="r182 r">sourceContext</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r183 r">htmlChildNode</span>);
 
                    <span class="c">// Get tr element properties</span>
                    <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r186 rd" class="r186 r">trElementLocalProperties</span>;
                    <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r187 rd" class="r187 r">trElementCurrentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r183 r">htmlChildNode</span>, <span class="r179 r">currentProperties</span>, <b>out</b> <span class="r186 r">trElementLocalProperties</span>, <span class="r181 r">stylesheet</span>, <span class="r182 r">sourceContext</span>);
                    <span class="c">// TODO: apply local properties to tr element</span>
 
                    <a href="#c5e31bd5a23020e7" class="i method">AddTableCellsToTableRow</a>(<span class="r185 r">xamlTableRowElement</span>, <span class="r183 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>, <span class="r187 r">trElementCurrentProperties</span>, <span class="r180 r">columnStarts</span>, <span class="r184 r">activeRowSpans</span>, <span class="r181 r">stylesheet</span>, <span class="r182 r">sourceContext</span>);
                    <b>if</b> (<span class="r185 r">xamlTableRowElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
                    {
                        <span class="r177 r">xamlTableBodyElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r185 r">xamlTableRowElement</span>);
                    }
 
                    <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r182 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 0 &amp;&amp; <span class="r182 r">sourceContext</span><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r182 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1] == <span class="r183 r">htmlChildNode</span>);
                    <span class="r182 r">sourceContext</span>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<span class="r182 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
 
                    <span class="c">// Advance</span>
                    <span class="r183 r">htmlChildNode</span> = <span class="r183 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
                    
                }
                <b>else</b> <b>if</b> (<span class="r183 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;td&quot;</span>)
                {
                    <span class="c">// Tr element is not present. We create one and add td elements to it</span>
                    <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r188 rd" class="r188 r">xamlTableRowElement</span> = <span class="r177 r">xamlTableBodyElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#45cac16bd8ae387e" class="i field">Xaml_TableRow</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
                    
                    <span class="c">// This is incorrect formatting and the column starts should not be set in this case</span>
                    <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r180 r">columnStarts</span> == <b>null</b>);
 
                    <span class="r183 r">htmlChildNode</span> = <a href="#c5e31bd5a23020e7" class="i method">AddTableCellsToTableRow</a>(<span class="r188 r">xamlTableRowElement</span>, <span class="r183 r">htmlChildNode</span>, <span class="r179 r">currentProperties</span>, <span class="r180 r">columnStarts</span>, <span class="r184 r">activeRowSpans</span>, <span class="r181 r">stylesheet</span>, <span class="r182 r">sourceContext</span>);
                    <b>if</b> (<span class="r188 r">xamlTableRowElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
                    {
                        <span class="r177 r">xamlTableBodyElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r188 r">xamlTableRowElement</span>);
                    }
                }
                <b>else</b> 
                {
                    <span class="c">// Not a tr or td  element. Ignore it.</span>
                    <span class="c">// TODO: consider better recovery here</span>
                    <span class="r183 r">htmlChildNode</span> = <span class="r183 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
                }
            }
            <b>return</b> <span class="r183 r">htmlChildNode</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds TableCell elements to xamlTableRowElement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r189 r">xamlTableRowElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml TableRow element to which the converted cells should be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r190 r">htmlTDStartNode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing the child of tr or tbody element from which we should start adding td elements</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r191 r">currentProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> properties of the current html tr element to which cells are to be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r192 r">activeRowSpans</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r193 r">columnStarts</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r194 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r195 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing the current position of the iterator among the children of the parent Html tbody/tr element</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <a id="c5e31bd5a23020e7" href="../R/c5e31bd5a23020e7.html" target="n" data-glyph="76,1" class="i method">AddTableCellsToTableRow</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r189 rd" class="r189 r">xamlTableRowElement</span>, <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r190 rd" class="r190 r">htmlTDStartNode</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r191 rd" class="r191 r">currentProperties</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r193 rd" class="r193 r">columnStarts</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r192 rd" class="r192 r">activeRowSpans</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r195 rd" class="r195 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r194 rd" class="r194 r">sourceContext</span>)
        {
            <span class="c">// parameter validation</span>
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r189 r">xamlTableRowElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a> == <a href="#45cac16bd8ae387e" class="i field">Xaml_TableRow</a>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r191 r">currentProperties</span> != <b>null</b>);
            <b>if</b> (<span class="r193 r">columnStarts</span> != <b>null</b>)
            {
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r192 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> == <span class="r193 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
            }
 
            <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r196 rd" class="r196 r">htmlChildNode</span> = <span class="r190 r">htmlTDStartNode</span>;
            <b>double</b> <span id="r197 rd" class="r197 r">columnStart</span> = 0;
            <b>double</b> <span id="r198 rd" class="r198 r">columnWidth</span> = 0;
            <b>int</b> <span id="r199 rd" class="r199 r">columnIndex</span> = 0;
            <b>int</b> <span id="r200 rd" class="r200 r">columnSpan</span> = 0;
 
            <b>while</b> (<span class="r196 r">htmlChildNode</span> != <b>null</b> &amp;&amp; <span class="r196 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) != <span class="s">&quot;tr&quot;</span> &amp;&amp; <span class="r196 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) != <span class="s">&quot;tbody&quot;</span> &amp;&amp; <span class="r196 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) != <span class="s">&quot;thead&quot;</span> &amp;&amp; <span class="r196 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) != <span class="s">&quot;tfoot&quot;</span>)
            {
                <b>if</b> (<span class="r196 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;td&quot;</span> || <span class="r196 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;th&quot;</span>)
                {
                    <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r201 rd" class="r201 r">xamlTableCellElement</span> = <span class="r189 r">xamlTableRowElement</span>.<a href="@0@System.Xml/A.html#664cb1e2891be3b5" class="i property">OwnerDocument</a>.<a href="@0@System.Xml/A.html#fb9ab6648c8bda3e" class="i method">CreateElement</a>(<b>null</b>, <a href="#f12f8d7f9b83570b" class="i field">Xaml_TableCell</a>, <a href="#ac8578bc880ebde2" class="i field">_xamlNamespace</a>);
 
                    <span class="r194 r">sourceContext</span>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r196 r">htmlChildNode</span>);
 
                    <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r202 rd" class="r202 r">tdElementLocalProperties</span>;
                    <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r203 rd" class="r203 r">tdElementCurrentProperties</span> = <a href="#ce2b6fa8597c6309" class="i method">GetElementProperties</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r196 r">htmlChildNode</span>, <span class="r191 r">currentProperties</span>, <b>out</b> <span class="r202 r">tdElementLocalProperties</span>, <span class="r195 r">stylesheet</span>, <span class="r194 r">sourceContext</span>);
 
                    <span class="c">// TODO: determine if localProperties can be used instead of htmlChildNode in this call, and if they can,</span>
                    <span class="c">// make necessary changes and use them instead.</span>
                    <a href="#4a662c3d8be40ab9" class="i method">ApplyPropertiesToTableCellElement</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r196 r">htmlChildNode</span>, <span class="r201 r">xamlTableCellElement</span>);
 
                    <b>if</b> (<span class="r193 r">columnStarts</span> != <b>null</b>)
                    {
                        <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r199 r">columnIndex</span> &lt; <span class="r193 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> - 1);
                        <b>while</b> (<span class="r199 r">columnIndex</span> &lt; <span class="r192 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> &amp;&amp; (<b>int</b>)<span class="r192 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r199 r">columnIndex</span>] &gt; 0)
                        {
                            <span class="r192 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r199 r">columnIndex</span>] = (<b>int</b>)<span class="r192 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r199 r">columnIndex</span>] - 1;
                            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>((<b>int</b>)<span class="r192 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r199 r">columnIndex</span>] &gt;= 0);
                            <span class="r199 r">columnIndex</span>++;
                        }
                        <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r199 r">columnIndex</span> &lt; <span class="r193 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> - 1);
                        <span class="r197 r">columnStart</span> = (<b>double</b>)<span class="r193 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r199 r">columnIndex</span>];
                        <span class="r198 r">columnWidth</span> = <a href="#aff206ced31e6895" class="i method">GetColumnWidth</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r196 r">htmlChildNode</span>);
                        <span class="r200 r">columnSpan</span> = <a href="#2f34938faea4db39" class="i method">CalculateColumnSpan</a>(<span class="r199 r">columnIndex</span>, <span class="r198 r">columnWidth</span>, <span class="r193 r">columnStarts</span>);
                        <b>int</b> <span id="r204 rd" class="r204 r">rowSpan</span> = <a href="#e4ddd3b05583cd92" class="i method">GetRowSpan</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r196 r">htmlChildNode</span>);
 
                        <span class="c">// Column cannot have no span</span>
                        <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r200 r">columnSpan</span> &gt; 0);
                        <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r199 r">columnIndex</span> + <span class="r200 r">columnSpan</span> &lt; <span class="r193 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
 
                        <span class="r201 r">xamlTableCellElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#5e5ead25cd10aa79" class="i field">Xaml_TableCell_ColumnSpan</a>, <span class="r200 r">columnSpan</span>.<a href="@0@mscorlib/A.html#8d6f2d8bc0589463" class="i method">ToString</a>());
                        
                        <span class="c">// Apply row span</span>
                        <b>for</b> (<b>int</b> <span id="r205 rd" class="r205 r">spannedColumnIndex</span> = <span class="r199 r">columnIndex</span>; <span class="r205 r">spannedColumnIndex</span> &lt; <span class="r199 r">columnIndex</span> + <span class="r200 r">columnSpan</span>; <span class="r205 r">spannedColumnIndex</span>++)
                        {
                            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r205 r">spannedColumnIndex</span> &lt; <span class="r192 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
                            <span class="r192 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r205 r">spannedColumnIndex</span>] = (<span class="r204 r">rowSpan</span> - 1);
                            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>((<b>int</b>)<span class="r192 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r205 r">spannedColumnIndex</span>] &gt;= 0);
                        }
 
                        <span class="r199 r">columnIndex</span> = <span class="r199 r">columnIndex</span> + <span class="r200 r">columnSpan</span>;
                    }
 
                    <a href="#290c6ae0c211de81" class="i method">AddDataToTableCell</a>(<span class="r201 r">xamlTableCellElement</span>, <span class="r196 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>, <span class="r203 r">tdElementCurrentProperties</span>, <span class="r195 r">stylesheet</span>, <span class="r194 r">sourceContext</span>);
                    <b>if</b> (<span class="r201 r">xamlTableCellElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
                    {
                        <span class="r189 r">xamlTableRowElement</span>.<a href="@0@System.Xml/A.html#fa87f9fc7daeea9a" class="i method">AppendChild</a>(<span class="r201 r">xamlTableCellElement</span>);
                    }
 
                    <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r194 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> &gt; 0 &amp;&amp; <span class="r194 r">sourceContext</span><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r194 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1] == <span class="r196 r">htmlChildNode</span>);
                    <span class="r194 r">sourceContext</span>.<a href="@0@mscorlib/A.html#3d46113cc199059a" class="i method">RemoveAt</a>(<span class="r194 r">sourceContext</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a> - 1);
 
                    <span class="r196 r">htmlChildNode</span> = <span class="r196 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
                }
                <b>else</b>
                {
                    <span class="c">// Not td element. Ignore it.</span>
                    <span class="c">// TODO: Consider better recovery</span>
                    <span class="r196 r">htmlChildNode</span> = <span class="r196 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
                }
            }
            <b>return</b> <span class="r196 r">htmlChildNode</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> adds table cell data to xamlTableCellElement</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r206 r">xamlTableCellElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml TableCell element to which the converted data should be added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">htmlDataStartNode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing the start element of data to be added to xamlTableCellElement</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r208 r">currentProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Current properties for the html td/th element corresponding to xamlTableCellElement</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r209 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r210 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="290c6ae0c211de81" href="../R/290c6ae0c211de81.html" target="n" data-glyph="76,1" class="i method">AddDataToTableCell</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r206 rd" class="r206 r">xamlTableCellElement</span>, <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r207 rd" class="r207 r">htmlDataStartNode</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r208 rd" class="r208 r">currentProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r210 rd" class="r210 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r209 rd" class="r209 r">sourceContext</span>)
        {
            <span class="c">// Parameter validation</span>
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r206 r">xamlTableCellElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a> == <a href="#f12f8d7f9b83570b" class="i field">Xaml_TableCell</a>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r208 r">currentProperties</span> != <b>null</b>);
 
            <b>for</b> (<a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r211 rd" class="r211 r">htmlChildNode</span> = <span class="r207 r">htmlDataStartNode</span>; <span class="r211 r">htmlChildNode</span> != <b>null</b>; <span class="r211 r">htmlChildNode</span> = <span class="r211 r">htmlChildNode</span> != <b>null</b> ? <span class="r211 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a> : <b>null</b>)
            {
                <span class="c">// Process a new html element and add it to the td element</span>
                <span class="r211 r">htmlChildNode</span> = <a href="#3ee8eb9573f99c0a" class="i method">AddBlock</a>(<span class="r206 r">xamlTableCellElement</span>, <span class="r211 r">htmlChildNode</span>, <span class="r208 r">currentProperties</span>, <span class="r210 r">stylesheet</span>, <span class="r209 r">sourceContext</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Performs a parsing pass over a table to read information about column width and rowspan attributes. This information</span>
        <span class="c">///</span><span class="c"> is used to determine the starting point of each column. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r212 r">htmlTableElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html table whose structure is to be analyzed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r213 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArrayList of type double which contains the function output. If analysis is successful, this ArrayList contains</span>
        <span class="c">///</span><span class="c"> all the points which are the starting position of any column in the table, ordered from left to right.</span>
        <span class="c">///</span><span class="c"> In case if analisys was impossible we return null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <a id="a8351590d53c4247" href="../R/a8351590d53c4247.html" target="n" data-glyph="76,1" class="i method">AnalyzeTableStructure</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r212 rd" class="r212 r">htmlTableElement</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r213 rd" class="r213 r">stylesheet</span>)
        {
            <span class="c">// Parameter validation</span>
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r212 r">htmlTableElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;table&quot;</span>);
            <b>if</b> (!<span class="r212 r">htmlTableElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>bool</b> <span id="r214 rd" class="r214 r">columnWidthsAvailable</span> = <b>true</b>;
 
            <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r215 rd" class="r215 r">columnStarts</span> = <b>new</b> <a href="@0@mscorlib/A.html#3113636092b18f20" class="t constructor">ArrayList</a>();
            <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r216 rd" class="r216 r">activeRowSpans</span> = <b>new</b> <a href="@0@mscorlib/A.html#3113636092b18f20" class="t constructor">ArrayList</a>();
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r215 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> == <span class="r216 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
 
            <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r217 rd" class="r217 r">htmlChildNode</span> = <span class="r212 r">htmlTableElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>;
            <b>double</b> <span id="r218 rd" class="r218 r">tableWidth</span> = 0;  <span class="c">// Keep track of table width which is the width of its widest row</span>
 
            <span class="c">// Analyze tbody and tr elements</span>
            <b>while</b> (<span class="r217 r">htmlChildNode</span> != <b>null</b> &amp;&amp; <span class="r214 r">columnWidthsAvailable</span>)
            {
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r215 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> == <span class="r216 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
 
                <b>switch</b> (<span class="r217 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>))
                {
                    <b>case</b> <span class="s">&quot;tbody&quot;</span>:
                        <span class="c">// Tbody element, we should analyze its children for trows</span>
                        <b>double</b> <span id="r219 rd" class="r219 r">tbodyWidth</span> = <a href="#52c0cf068a63e826" class="i method">AnalyzeTbodyStructure</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r217 r">htmlChildNode</span>, <span class="r215 r">columnStarts</span>, <span class="r216 r">activeRowSpans</span>, <span class="r218 r">tableWidth</span>, <span class="r213 r">stylesheet</span>);
                        <b>if</b> (<span class="r219 r">tbodyWidth</span> &gt; <span class="r218 r">tableWidth</span>)
                        {
                            <span class="c">// Table width must be increased to supported newly added wide row</span>
                            <span class="r218 r">tableWidth</span> = <span class="r219 r">tbodyWidth</span>;
                        }
                        <b>else</b> <b>if</b> (<span class="r219 r">tbodyWidth</span> == 0)
                        {
                            <span class="c">// Tbody analysis may return 0, probably due to unprocessable format. </span>
                            <span class="c">// We should also fail.</span>
                            <span class="r214 r">columnWidthsAvailable</span> = <b>false</b>; <span class="c">// interrupt the analisys</span>
                        }
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;tr&quot;</span>:
                        <span class="c">// Table row. Analyze column structure within row directly</span>
                        <b>double</b> <span id="r220 rd" class="r220 r">trWidth</span> = <a href="#69044d8499d153b5" class="i method">AnalyzeTRStructure</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r217 r">htmlChildNode</span>, <span class="r215 r">columnStarts</span>, <span class="r216 r">activeRowSpans</span>, <span class="r218 r">tableWidth</span>, <span class="r213 r">stylesheet</span>);
                        <b>if</b> (<span class="r220 r">trWidth</span> &gt; <span class="r218 r">tableWidth</span>)
                        {
                            <span class="r218 r">tableWidth</span> = <span class="r220 r">trWidth</span>;
                        }
                        <b>else</b> <b>if</b> (<span class="r220 r">trWidth</span> == 0)
                        {
                            <span class="r214 r">columnWidthsAvailable</span> = <b>false</b>; <span class="c">// interrupt the analisys</span>
                        }
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;td&quot;</span>:
                        <span class="c">// Incorrect formatting, too deep to analyze at this level. Return null.</span>
                        <span class="c">// TODO: implement analysis at this level, possibly by creating a new tr</span>
                        <span class="r214 r">columnWidthsAvailable</span> = <b>false</b>; <span class="c">// interrupt the analisys</span>
                        <b>break</b>;
                    <b>default</b>:
                        <span class="c">// Element should not occur directly in table. Ignore it.</span>
                        <b>break</b>;
                }
 
                <span class="r217 r">htmlChildNode</span> = <span class="r217 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
            }
 
            <b>if</b> (<span class="r214 r">columnWidthsAvailable</span>)
            {
                <span class="c">// Add an item for whole table width</span>
                <span class="r215 r">columnStarts</span>.<a href="@0@mscorlib/A.html#5e9cf3d0a9ed0b29" class="i method">Add</a>(<span class="r218 r">tableWidth</span>);
                <a href="#06d2cc4c51116c93" class="i method">VerifyColumnStartsAscendingOrder</a>(<span class="r215 r">columnStarts</span>);
            }
            <b>else</b>
            {
                <span class="r215 r">columnStarts</span> = <b>null</b>;
            }
 
            <b>return</b> <span class="r215 r">columnStarts</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Performs a parsing pass over a tbody to read information about column width and rowspan attributes. Information read about width</span>
        <span class="c">///</span><span class="c"> attributes is stored in the reference ArrayList parameter columnStarts, which contains a list of all starting</span>
        <span class="c">///</span><span class="c"> positions of all columns in the table, ordered from left to right. Row spans are taken into consideration when </span>
        <span class="c">///</span><span class="c"> computing column starts</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r221 r">htmlTbodyElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html tbody whose structure is to be analyzed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r222 r">columnStarts</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArrayList of type double which contains the function output. If analysis fails, this parameter is set to null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r223 r">tableWidth</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Current width of the table. This is used to determine if a new column when added to the end of table should</span>
        <span class="c">///</span><span class="c"> come after the last column in the table or is actually splitting the last column in two. If it is only splitting</span>
        <span class="c">///</span><span class="c"> the last column it should inherit row span for that column</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r224 r">activeRowSpans</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r225 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calculated width of a tbody.</span>
        <span class="c">///</span><span class="c"> In case of non-analizable column width structure return 0;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static double</b> <a id="52c0cf068a63e826" href="../R/52c0cf068a63e826.html" target="n" data-glyph="76,1" class="i method">AnalyzeTbodyStructure</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r221 rd" class="r221 r">htmlTbodyElement</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r222 rd" class="r222 r">columnStarts</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r224 rd" class="r224 r">activeRowSpans</span>, <b>double</b> <span id="r223 rd" class="r223 r">tableWidth</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r225 rd" class="r225 r">stylesheet</span>)
        {
            <span class="c">// Parameter validation</span>
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r221 r">htmlTbodyElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;tbody&quot;</span>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r222 r">columnStarts</span> != <b>null</b>);
 
            <b>double</b> <span id="r226 rd" class="r226 r">tbodyWidth</span> = 0;
            <b>bool</b> <span id="r227 rd" class="r227 r">columnWidthsAvailable</span> = <b>true</b>;
 
            <b>if</b> (!<span class="r221 r">htmlTbodyElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
            {
                <b>return</b> <span class="r226 r">tbodyWidth</span>;
            }
 
            <span class="c">// Set active row spans to 0 - thus ignoring row spans crossing tbody boundaries</span>
            <a href="#4fcaee64a3865160" class="i method">ClearActiveRowSpans</a>(<span class="r224 r">activeRowSpans</span>);
 
            <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r228 rd" class="r228 r">htmlChildNode</span> = <span class="r221 r">htmlTbodyElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>;
          
            <span class="c">// Analyze tr elements</span>
            <b>while</b> (<span class="r228 r">htmlChildNode</span> != <b>null</b> &amp;&amp; <span class="r227 r">columnWidthsAvailable</span>)
            {
                <b>switch</b> (<span class="r228 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>))
                {
                    <b>case</b> <span class="s">&quot;tr&quot;</span>:
                        <b>double</b> <span id="r229 rd" class="r229 r">trWidth</span> = <a href="#69044d8499d153b5" class="i method">AnalyzeTRStructure</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r228 r">htmlChildNode</span>, <span class="r222 r">columnStarts</span>, <span class="r224 r">activeRowSpans</span>, <span class="r226 r">tbodyWidth</span>, <span class="r225 r">stylesheet</span>);
                        <b>if</b> (<span class="r229 r">trWidth</span> &gt; <span class="r226 r">tbodyWidth</span>)
                        {
                            <span class="r226 r">tbodyWidth</span> = <span class="r229 r">trWidth</span>;
                        }
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;td&quot;</span>:
                        <span class="r227 r">columnWidthsAvailable</span> = <b>false</b>; <span class="c">// interrupt the analisys</span>
                        <b>break</b>;
                    <b>default</b>:
                        <b>break</b>;
                }
                <span class="r228 r">htmlChildNode</span> = <span class="r228 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
            }
 
            <span class="c">// Set active row spans to 0 - thus ignoring row spans crossing tbody boundaries</span>
            <a href="#4fcaee64a3865160" class="i method">ClearActiveRowSpans</a>(<span class="r224 r">activeRowSpans</span>);
 
            <b>return</b> <span class="r227 r">columnWidthsAvailable</span> ? <span class="r226 r">tbodyWidth</span> : 0;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Performs a parsing pass over a tr element to read information about column width and rowspan attributes.  </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r230 r">htmlTRElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html tr element whose structure is to be analyzed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r231 r">columnStarts</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArrayList of type double which contains the function output. If analysis is successful, this ArrayList contains</span>
        <span class="c">///</span><span class="c"> all the points which are the starting position of any column in the tr, ordered from left to right. If analysis fails,</span>
        <span class="c">///</span><span class="c"> the ArrayList is set to null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r232 r">activeRowSpans</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArrayList representing all columns currently spanned by an earlier row span attribute. These columns should</span>
        <span class="c">///</span><span class="c"> not be used for data in this row. The ArrayList actually contains notation for all columns in the table, if the</span>
        <span class="c">///</span><span class="c"> active row span is set to 0 that column is not presently spanned but if it is &gt; 0 the column is presently spanned</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r233 r">tableWidth</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Double value representing the current width of the table.</span>
        <span class="c">///</span><span class="c"> Return 0 if analisys was insuccessful.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r234 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static double</b> <a id="69044d8499d153b5" href="../R/69044d8499d153b5.html" target="n" data-glyph="76,1" class="i method">AnalyzeTRStructure</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r230 rd" class="r230 r">htmlTRElement</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r231 rd" class="r231 r">columnStarts</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r232 rd" class="r232 r">activeRowSpans</span>, <b>double</b> <span id="r233 rd" class="r233 r">tableWidth</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r234 rd" class="r234 r">stylesheet</span>)
        {
            <b>double</b> <span id="r235 rd" class="r235 r">columnWidth</span>;
 
            <span class="c">// Parameter validation</span>
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r230 r">htmlTRElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;tr&quot;</span>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r231 r">columnStarts</span> != <b>null</b>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r232 r">activeRowSpans</span> != <b>null</b>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r231 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> == <span class="r232 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
 
            <b>if</b> (!<span class="r230 r">htmlTRElement</span>.<a href="@0@System.Xml/A.html#e24a222c531aba25" class="i property">HasChildNodes</a>)
            {
                <b>return</b> 0;
            }
 
            <b>bool</b> <span id="r236 rd" class="r236 r">columnWidthsAvailable</span> = <b>true</b>;
 
            <b>double</b> <span id="r237 rd" class="r237 r">columnStart</span> = 0; <span class="c">// starting position of current column</span>
            <a href="@0@System.Xml/A.html#735249b64d244851" class="t t">XmlNode</a> <span id="r238 rd" class="r238 r">htmlChildNode</span> = <span class="r230 r">htmlTRElement</span>.<a href="@0@System.Xml/A.html#a94b83e085390fb4" class="i property">FirstChild</a>;
            <b>int</b> <span id="r239 rd" class="r239 r">columnIndex</span> = 0;
            <b>double</b> <span id="r240 rd" class="r240 r">trWidth</span> = 0;
 
            <span class="c">// Skip spanned columns to get to real column start</span>
            <b>if</b> (<span class="r239 r">columnIndex</span> &lt; <span class="r232 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>)
            {
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>((<b>double</b>)<span class="r231 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] &gt;= <span class="r237 r">columnStart</span>);
                <b>if</b> ((<b>double</b>)<span class="r231 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] == <span class="r237 r">columnStart</span>)
                {
                    <span class="c">// The new column may be in a spanned area</span>
                    <b>while</b> (<span class="r239 r">columnIndex</span> &lt; <span class="r232 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> &amp;&amp; (<b>int</b>)<span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] &gt; 0)
                    {
                        <span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] = (<b>int</b>)<span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] - 1;
                        <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>((<b>int</b>)<span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] &gt;= 0);
                        <span class="r239 r">columnIndex</span>++;
                        <span class="r237 r">columnStart</span> = (<b>double</b>)<span class="r231 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>];
                    }
                }
            }
 
            <b>while</b> (<span class="r238 r">htmlChildNode</span> != <b>null</b> &amp;&amp; <span class="r236 r">columnWidthsAvailable</span>)
            {
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r231 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> == <span class="r232 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
 
                <a href="#06d2cc4c51116c93" class="i method">VerifyColumnStartsAscendingOrder</a>(<span class="r231 r">columnStarts</span>);
 
                <b>switch</b> (<span class="r238 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#a52f290496276b21" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>))
                {
                    <b>case</b> <span class="s">&quot;td&quot;</span>:
                        <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r239 r">columnIndex</span> &lt;= <span class="r231 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
                        <b>if</b> (<span class="r239 r">columnIndex</span> &lt; <span class="r231 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>)
                        {
                            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r237 r">columnStart</span> &lt;= (<b>double</b>)<span class="r231 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>]);
                            <b>if</b> (<span class="r237 r">columnStart</span> &lt; (<b>double</b>)<span class="r231 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>])
                            {
                                <span class="r231 r">columnStarts</span>.<a href="@0@mscorlib/A.html#5ee351afd7f73bf1" class="i method">Insert</a>(<span class="r239 r">columnIndex</span>, <span class="r237 r">columnStart</span>);
                                <span class="c">// There can be no row spans now - the column data will appear here</span>
                                <span class="c">// Row spans may appear only during the column analysis</span>
                                <span class="r232 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#5ee351afd7f73bf1" class="i method">Insert</a>(<span class="r239 r">columnIndex</span>, 0);
                            }
                        }
                        <b>else</b>
                        {
                            <span class="c">// Column start is greater than all previous starts. Row span must still be 0 because</span>
                            <span class="c">// we are either adding after another column of the same row, in which case it should not inherit</span>
                            <span class="c">// the previous column&#39;s span. Otherwise we are adding after the last column of some previous</span>
                            <span class="c">// row, and assuming the table widths line up, we should not be spanned by it. If there is</span>
                            <span class="c">// an incorrect tbale structure where a columns starts in the middle of a row span, we do not</span>
                            <span class="c">// guarantee correct output</span>
                            <span class="r231 r">columnStarts</span>.<a href="@0@mscorlib/A.html#5e9cf3d0a9ed0b29" class="i method">Add</a>(<span class="r237 r">columnStart</span>);
                            <span class="r232 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#5e9cf3d0a9ed0b29" class="i method">Add</a>(0);
                        }
                        <span class="r235 r">columnWidth</span> = <a href="#aff206ced31e6895" class="i method">GetColumnWidth</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r238 r">htmlChildNode</span>);
                        <b>if</b> (<span class="r235 r">columnWidth</span> != -1)
                        {
                            <b>int</b> <span id="r241 rd" class="r241 r">nextColumnIndex</span>;
                            <b>int</b> <span id="r242 rd" class="r242 r">rowSpan</span> = <a href="#e4ddd3b05583cd92" class="i method">GetRowSpan</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r238 r">htmlChildNode</span>);
 
                            <span class="r241 r">nextColumnIndex</span> = <a href="#694395f4bbbaf928" class="i method">GetNextColumnIndex</a>(<span class="r239 r">columnIndex</span>, <span class="r235 r">columnWidth</span>, <span class="r231 r">columnStarts</span>, <span class="r232 r">activeRowSpans</span>);
                            <b>if</b> (<span class="r241 r">nextColumnIndex</span> != -1)
                            {
                                <span class="c">// Entire column width can be processed without hitting conflicting row span. This means that</span>
                                <span class="c">// column widths line up and we can process them</span>
                                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r241 r">nextColumnIndex</span> &lt;= <span class="r231 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
 
                                <span class="c">// Apply row span to affected columns</span>
                                <b>for</b> (<b>int</b> <span id="r243 rd" class="r243 r">spannedColumnIndex</span> = <span class="r239 r">columnIndex</span>; <span class="r243 r">spannedColumnIndex</span> &lt; <span class="r241 r">nextColumnIndex</span>; <span class="r243 r">spannedColumnIndex</span>++)
                                {
                                    <span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r243 r">spannedColumnIndex</span>] = <span class="r242 r">rowSpan</span> - 1;
                                    <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>((<b>int</b>)<span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r243 r">spannedColumnIndex</span>] &gt;= 0);
                                }
 
                                <span class="r239 r">columnIndex</span> = <span class="r241 r">nextColumnIndex</span>;
 
                                <span class="c">// Calculate columnsStart for the next cell</span>
                                <span class="r237 r">columnStart</span> = <span class="r237 r">columnStart</span> + <span class="r235 r">columnWidth</span>;
 
                                <b>if</b> (<span class="r239 r">columnIndex</span> &lt; <span class="r232 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>)
                                {
                                    <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>((<b>double</b>)<span class="r231 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] &gt;= <span class="r237 r">columnStart</span>);
                                    <b>if</b> ((<b>double</b>)<span class="r231 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] == <span class="r237 r">columnStart</span>)
                                    {
                                        <span class="c">// The new column may be in a spanned area</span>
                                        <b>while</b> (<span class="r239 r">columnIndex</span> &lt; <span class="r232 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> &amp;&amp; (<b>int</b>)<span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] &gt; 0)
                                        {
                                            <span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] = (<b>int</b>)<span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] - 1;
                                            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>((<b>int</b>)<span class="r232 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>] &gt;= 0);
                                            <span class="r239 r">columnIndex</span>++;
                                            <span class="r237 r">columnStart</span> = (<b>double</b>)<span class="r231 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r239 r">columnIndex</span>];
                                        }
                                    }
                                    <span class="c">// else: the new column does not start at the same time as a pre existing column</span>
                                    <span class="c">// so we don&#39;t have to check it for active row spans, it starts in the middle</span>
                                    <span class="c">// of another column which has been checked already by the GetNextColumnIndex function</span>
                                }
                            }
                            <b>else</b>
                            {
                                <span class="c">// Full column width cannot be processed without a pre existing row span.</span>
                                <span class="c">// We cannot analyze widths</span>
                                <span class="r236 r">columnWidthsAvailable</span> = <b>false</b>;
                            }
                        }
                        <b>else</b>
                        {
                            <span class="c">// Incorrect column width, stop processing</span>
                            <span class="r236 r">columnWidthsAvailable</span> = <b>false</b>;
                        }
                        <b>break</b>;
                    <b>default</b>:
                        <b>break</b>;
                }
 
                <span class="r238 r">htmlChildNode</span> = <span class="r238 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#353930355b802a85" class="i property">NextSibling</a>;
            }
 
            <span class="c">// The width of the tr element is the position at which it&#39;s last td element ends, which is calculated in</span>
            <span class="c">// the columnStart value after each td element is processed</span>
            <b>if</b> (<span class="r236 r">columnWidthsAvailable</span>)
            {
                <span class="r240 r">trWidth</span> = <span class="r237 r">columnStart</span>;
            }
            <b>else</b>
            {
                <span class="r240 r">trWidth</span> = 0;
            }
 
            <b>return</b> <span class="r240 r">trWidth</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets row span attribute from htmlTDElement. Returns an integer representing the value of the rowspan attribute.</span>
        <span class="c">///</span><span class="c"> Default value if attribute is not specified or if it is invalid is 1</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r244 r">htmlTDElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Html td element to be searched for rowspan attribute</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="e4ddd3b05583cd92" href="../R/e4ddd3b05583cd92.html" target="n" data-glyph="76,1" class="i method">GetRowSpan</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r244 rd" class="r244 r">htmlTDElement</span>)
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r245 rd" class="r245 r">rowSpanAsString</span>;
            <b>int</b> <span id="r246 rd" class="r246 r">rowSpan</span>;
 
            <span class="r245 r">rowSpanAsString</span> = <a href="#bb4e7e205aef385f" class="i method">GetAttribute</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r244 r">htmlTDElement</span>, <span class="s">&quot;rowspan&quot;</span>);
            <b>if</b> (<span class="r245 r">rowSpanAsString</span> != <b>null</b>)
            {
                <b>if</b> (!<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="t t">Int32</a>.<a href="@0@mscorlib/A.html#325507e509229dbc" class="i method">TryParse</a>(<span class="r245 r">rowSpanAsString</span>, <b>out</b> <span class="r246 r">rowSpan</span>))
                {
                    <span class="c">// Ignore invalid value of rowspan; treat it as 1</span>
                    <span class="r246 r">rowSpan</span> = 1;
                }
            }
            <b>else</b>
            {
                <span class="c">// No row span, default is 1</span>
                <span class="r246 r">rowSpan</span> = 1;
            }
            <b>return</b> <span class="r246 r">rowSpan</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets index at which a column should be inseerted into the columnStarts ArrayList. This is</span>
        <span class="c">///</span><span class="c"> decided by the value columnStart. The columnStarts ArrayList is ordered in ascending order.</span>
        <span class="c">///</span><span class="c"> Returns an integer representing the index at which the column should be inserted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r247 r">columnStarts</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Array list representing starting coordinates of all columns in the table</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r248 r">columnWidth</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r249 r">columnIndex</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Int representing the current column index. This acts as a clue while finding the insertion index.</span>
        <span class="c">///</span><span class="c"> If the value of columnStarts at columnIndex is the same as columnStart, then this position alrady exists</span>
        <span class="c">///</span><span class="c"> in the array and we can jsut return columnIndex.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r250 r">activeRowSpans</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="694395f4bbbaf928" href="../R/694395f4bbbaf928.html" target="n" data-glyph="76,1" class="i method">GetNextColumnIndex</a>(<b>int</b> <span id="r249 rd" class="r249 r">columnIndex</span>, <b>double</b> <span id="r248 rd" class="r248 r">columnWidth</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r247 rd" class="r247 r">columnStarts</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r250 rd" class="r250 r">activeRowSpans</span>)
        {
            <b>double</b> <span id="r251 rd" class="r251 r">columnStart</span>;
            <b>int</b> <span id="r252 rd" class="r252 r">spannedColumnIndex</span>;
 
            <span class="c">// Parameter validation</span>
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r247 r">columnStarts</span> != <b>null</b>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(0 &lt;= <span class="r249 r">columnIndex</span> &amp;&amp; <span class="r249 r">columnIndex</span> &lt;= <span class="r247 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r248 r">columnWidth</span> &gt; 0);
 
            <span class="r251 r">columnStart</span> = (<b>double</b>)<span class="r247 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r249 r">columnIndex</span>];
            <span class="r252 r">spannedColumnIndex</span> = <span class="r249 r">columnIndex</span> + 1;
 
            <b>while</b> (<span class="r252 r">spannedColumnIndex</span> &lt; <span class="r247 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> &amp;&amp; (<b>double</b>)<span class="r247 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r252 r">spannedColumnIndex</span>] &lt; <span class="r251 r">columnStart</span> + <span class="r248 r">columnWidth</span> &amp;&amp; <span class="r252 r">spannedColumnIndex</span> != -1)
            {
                <b>if</b> ((<b>int</b>)<span class="r250 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r252 r">spannedColumnIndex</span>] &gt; 0)
                {
                    <span class="c">// The current column should span this area, but something else is already spanning it</span>
                    <span class="c">// Not analyzable</span>
                    <span class="r252 r">spannedColumnIndex</span> = -1;
                }
                <b>else</b>
                {
                    <span class="r252 r">spannedColumnIndex</span>++;
                }
            }
 
            <b>return</b> <span class="r252 r">spannedColumnIndex</span>;
        }
 
        
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used for clearing activeRowSpans array in the beginning/end of each tbody</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r253 r">activeRowSpans</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArrayList representing currently active row spans</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="4fcaee64a3865160" href="../R/4fcaee64a3865160.html" target="n" data-glyph="76,1" class="i method">ClearActiveRowSpans</a>(<a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r253 rd" class="r253 r">activeRowSpans</span>)
        {
            <b>for</b> (<b>int</b> <span id="r254 rd" class="r254 r">columnIndex</span> = 0; <span class="r254 r">columnIndex</span> &lt; <span class="r253 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>; <span class="r254 r">columnIndex</span>++)
            {
                <span class="r253 r">activeRowSpans</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r254 r">columnIndex</span>] = 0;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used for initializing activeRowSpans array in the before adding rows to tbody element</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r255 r">activeRowSpans</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArrayList representing currently active row spans</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r256 r">count</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Size to be give to array list</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="4e6f1cf144a9d6d5" href="../R/4e6f1cf144a9d6d5.html" target="n" data-glyph="76,1" class="i method">InitializeActiveRowSpans</a>(<a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r255 rd" class="r255 r">activeRowSpans</span>, <b>int</b> <span id="r256 rd" class="r256 r">count</span>)
        {
            <b>for</b> (<b>int</b> <span id="r257 rd" class="r257 r">columnIndex</span> = 0; <span class="r257 r">columnIndex</span> &lt; <span class="r256 r">count</span>; <span class="r257 r">columnIndex</span>++)
            {
                <span class="r255 r">activeRowSpans</span>.<a href="@0@mscorlib/A.html#5e9cf3d0a9ed0b29" class="i method">Add</a>(0);
            }
        }
 
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calculates width of next TD element based on starting position of current element and it&#39;s width, which</span>
        <span class="c">///</span><span class="c"> is calculated byt he function</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r258 r">htmlTDElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Html td element whose width is to be read</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r259 r">columnStart</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Starting position of current column</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static double</b> <a id="e26afc3b89a0a03f" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetNextColumnStart</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r258 rd" class="r258 r">htmlTDElement</span>, <b>double</b> <span id="r259 rd" class="r259 r">columnStart</span>)
        {
            <b>double</b> <span id="r260 rd" class="r260 r">columnWidth</span>;
            <b>double</b> <span id="r261 rd" class="r261 r">nextColumnStart</span>;
            
            <span class="c">// Parameter validation</span>
			<a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r258 r">htmlTDElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;td&quot;</span> || <span class="r258 r">htmlTDElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;th&quot;</span>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r259 r">columnStart</span> &gt;= 0);
 
            <span class="r261 r">nextColumnStart</span> = -1;  <span class="c">// -1 indicates inability to calculate columnStart width</span>
 
            <span class="r260 r">columnWidth</span> = <a href="#aff206ced31e6895" class="i method">GetColumnWidth</a>(<span class="r258 r">htmlTDElement</span>);
 
            <b>if</b> (<span class="r260 r">columnWidth</span> == -1)
            {
                <span class="r261 r">nextColumnStart</span> = -1;
            }
            <b>else</b>
            {
                <span class="r261 r">nextColumnStart</span> = <span class="r259 r">columnStart</span> + <span class="r260 r">columnWidth</span>;
            }
 
            <b>return</b> <span class="r261 r">nextColumnStart</span>;
        }
 
 
        <b>private static double</b> <a id="aff206ced31e6895" href="../R/aff206ced31e6895.html" target="n" data-glyph="76,1" class="i method">GetColumnWidth</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r262 rd" class="r262 r">htmlTDElement</span>)
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r263 rd" class="r263 r">columnWidthAsString</span>;
            <b>double</b> <span id="r264 rd" class="r264 r">columnWidth</span>;
 
            <span class="r263 r">columnWidthAsString</span> = <b>null</b>;
            <span class="r264 r">columnWidth</span> = -1;
 
            <span class="c">// Get string valkue for the width</span>
            <span class="r263 r">columnWidthAsString</span> = <a href="#bb4e7e205aef385f" class="i method">GetAttribute</a>(<span class="r262 r">htmlTDElement</span>, <span class="s">&quot;width&quot;</span>);
            <b>if</b> (<span class="r263 r">columnWidthAsString</span> == <b>null</b>)
            {
                <span class="r263 r">columnWidthAsString</span> = <a href="#dcd7a5ff808f5a37" class="i method">GetCssAttribute</a>(<a href="#bb4e7e205aef385f" class="i method">GetAttribute</a>(<span class="r262 r">htmlTDElement</span>, <span class="s">&quot;style&quot;</span>), <span class="s">&quot;width&quot;</span>);
            }
 
            <span class="c">// We do not allow column width to be 0, if specified as 0 we will fail to record it</span>
            <b>if</b> (!<a href="#39b701e9975db0dd" class="i method">TryGetLengthValue</a>(<span class="r263 r">columnWidthAsString</span>, <b>out</b> <span class="r264 r">columnWidth</span>) || <span class="r264 r">columnWidth</span> == 0)
            {
                <span class="r264 r">columnWidth</span> = -1;
            }
            <b>return</b> <span class="r264 r">columnWidth</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calculates column span based the column width and the widths of all other columns. Returns an integer representing </span>
        <span class="c">///</span><span class="c"> the column span</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r265 r">columnIndex</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Index of the current column</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r266 r">columnWidth</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Width of the current column</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r267 r">columnStarts</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArrayList repsenting starting coordinates of all columns</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="2f34938faea4db39" href="../R/2f34938faea4db39.html" target="n" data-glyph="76,1" class="i method">CalculateColumnSpan</a>(<b>int</b> <span id="r265 rd" class="r265 r">columnIndex</span>, <b>double</b> <span id="r266 rd" class="r266 r">columnWidth</span>, <a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r267 rd" class="r267 r">columnStarts</span>)
        {
            <span class="c">// Current status of column width. Indicates the amount of width that has been scanned already</span>
            <b>double</b> <span id="r268 rd" class="r268 r">columnSpanningValue</span>;
            <b>int</b> <span id="r269 rd" class="r269 r">columnSpanningIndex</span>;
            <b>int</b> <span id="r270 rd" class="r270 r">columnSpan</span>;
            <b>double</b> <span id="r271 rd" class="r271 r">subColumnWidth</span>; <span class="c">// Width of the smallest-grain columns in the table</span>
 
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r267 r">columnStarts</span> != <b>null</b>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r265 r">columnIndex</span> &lt; <span class="r267 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> - 1);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>((<b>double</b>)<span class="r267 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r265 r">columnIndex</span>] &gt;= 0);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r266 r">columnWidth</span> &gt; 0);
 
            <span class="r269 r">columnSpanningIndex</span> = <span class="r265 r">columnIndex</span>;
            <span class="r268 r">columnSpanningValue</span> = 0;
            <span class="r270 r">columnSpan</span> = 0;
            <span class="r271 r">subColumnWidth</span> = 0;
 
            <b>while</b> (<span class="r268 r">columnSpanningValue</span> &lt;  <span class="r266 r">columnWidth</span> &amp;&amp; <span class="r269 r">columnSpanningIndex</span> &lt; <span class="r267 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> - 1)
            {
                <span class="r271 r">subColumnWidth</span> = (<b>double</b>)<span class="r267 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r269 r">columnSpanningIndex</span> + 1] - (<b>double</b>)<span class="r267 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r269 r">columnSpanningIndex</span>];
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r271 r">subColumnWidth</span> &gt; 0);
                <span class="r268 r">columnSpanningValue</span> += <span class="r271 r">subColumnWidth</span>;
                <span class="r269 r">columnSpanningIndex</span>++;
            }
 
            <span class="c">// Now, we have either covered the width we needed to cover or reached the end of the table, in which</span>
            <span class="c">// case the column spans all the columns until the end</span>
            <span class="r270 r">columnSpan</span> = <span class="r269 r">columnSpanningIndex</span> - <span class="r265 r">columnIndex</span>;
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r270 r">columnSpan</span> &gt; 0);
 
            <b>return</b> <span class="r270 r">columnSpan</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies that values in columnStart, which represent starting coordinates of all columns, are arranged</span>
        <span class="c">///</span><span class="c"> in ascending order</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r272 r">columnStarts</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArrayList representing starting coordinates of all columns</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="06d2cc4c51116c93" href="../R/06d2cc4c51116c93.html" target="n" data-glyph="76,1" class="i method">VerifyColumnStartsAscendingOrder</a>(<a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r272 rd" class="r272 r">columnStarts</span>)
        {
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r272 r">columnStarts</span> != <b>null</b>);
 
            <b>double</b> <span id="r273 rd" class="r273 r">columnStart</span>;
 
            <span class="r273 r">columnStart</span> = -0.01;
 
            <b>for</b> (<b>int</b> <span id="r274 rd" class="r274 r">columnIndex</span> = 0; <span class="r274 r">columnIndex</span> &lt; <span class="r272 r">columnStarts</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>; <span class="r274 r">columnIndex</span>++)
            {
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r273 r">columnStart</span> &lt; (<b>double</b>)<span class="r272 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r274 r">columnIndex</span>]);
                <span class="r273 r">columnStart</span> = (<b>double</b>)<span class="r272 r">columnStarts</span><a href="@0@mscorlib/A.html#756ae734512a6d77">[</a><span class="r274 r">columnIndex</span>];
            }
        }
 
        <span class="c">// .............................................................</span>
        <span class="c">//</span>
        <span class="c">// Attributes and Properties</span>
        <span class="c">//</span>
        <span class="c">// .............................................................</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Analyzes local properties of Html element, converts them into Xaml equivalents, and applies them to xamlElement</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r275 r">xamlElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml element to which properties are to be applied</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r276 r">localProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hashtable representing local properties of Html element that is converted into xamlElement</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r277 r">isBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="a43c9ee1a751c059" href="../R/a43c9ee1a751c059.html" target="n" data-glyph="76,1" class="i method">ApplyLocalProperties</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r275 rd" class="r275 r">xamlElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r276 rd" class="r276 r">localProperties</span>, <b>bool</b> <span id="r277 rd" class="r277 r">isBlock</span>)
        {
            <b>bool</b> <span id="r278 rd" class="r278 r">marginSet</span> = <b>false</b>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r279 rd" class="r279 r">marginTop</span> = <span class="s">&quot;0&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r280 rd" class="r280 r">marginBottom</span> = <span class="s">&quot;0&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r281 rd" class="r281 r">marginLeft</span> = <span class="s">&quot;0&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r282 rd" class="r282 r">marginRight</span> = <span class="s">&quot;0&quot;</span>;
 
            <b>bool</b> <span id="r283 rd" class="r283 r">paddingSet</span> = <b>false</b>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r284 rd" class="r284 r">paddingTop</span> = <span class="s">&quot;0&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r285 rd" class="r285 r">paddingBottom</span> = <span class="s">&quot;0&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r286 rd" class="r286 r">paddingLeft</span> = <span class="s">&quot;0&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r287 rd" class="r287 r">paddingRight</span> = <span class="s">&quot;0&quot;</span>;
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r288 rd" class="r288 r">borderColor</span> = <b>null</b>;
 
            <b>bool</b> <span id="r289 rd" class="r289 r">borderThicknessSet</span> = <b>false</b>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r290 rd" class="r290 r">borderThicknessTop</span> = <span class="s">&quot;0&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r291 rd" class="r291 r">borderThicknessBottom</span> = <span class="s">&quot;0&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r292 rd" class="r292 r">borderThicknessLeft</span> = <span class="s">&quot;0&quot;</span>;
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r293 rd" class="r293 r">borderThicknessRight</span> = <span class="s">&quot;0&quot;</span>;
 
            <a href="@0@mscorlib/A.html#027d3303c68ed300" class="t t">IDictionaryEnumerator</a> <span id="r294 rd" class="r294 r">propertyEnumerator</span> = <span class="r276 r">localProperties</span>.<a href="@0@mscorlib/A.html#3fe25aaa70fa400b" class="i method">GetEnumerator</a>();
            <b>while</b> (<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#116c28c0f6355e3f" class="i method">MoveNext</a>())
            {
                <b>switch</b> ((<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#42cf145725084ef0" class="i property">Key</a>)
                {
                    <b>case</b> <span class="s">&quot;font-family&quot;</span>:
                        <span class="c">//  Convert from font-family value list into xaml FontFamily value</span>
                        <span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#935d63fd8ea4b627" class="i field">Xaml_FontFamily</a>, (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;font-style&quot;</span>:
                        <span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#f05fa92c2e7f6e7c" class="i field">Xaml_FontStyle</a>, (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;font-variant&quot;</span>:
                        <span class="c">//  Convert from font-variant into xaml property</span>
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;font-weight&quot;</span>:
                        <span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#9c85cc7ba077f8f2" class="i field">Xaml_FontWeight</a>, (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;font-size&quot;</span>:
                        <span class="c">//  Convert from css size into FontSize</span>
                        <span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#548ae1585edcd3b9" class="i field">Xaml_FontSize</a>, (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;color&quot;</span>:
                        <a href="#148f62a9743a49df" class="i method">SetPropertyValue</a>(<span class="r275 r">xamlElement</span>, <a href="@0@PresentationFramework/A.html#e28640b48d79de57" class="t t">TextElement</a>.<a href="@0@PresentationFramework/A.html#e76b7a3f2b462339" class="i field">ForegroundProperty</a>, (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;background-color&quot;</span>:
                        <a href="#148f62a9743a49df" class="i method">SetPropertyValue</a>(<span class="r275 r">xamlElement</span>, <a href="@0@PresentationFramework/A.html#e28640b48d79de57" class="t t">TextElement</a>.<a href="@0@PresentationFramework/A.html#49594ce77d97fbd7" class="i field">BackgroundProperty</a>, (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;text-decoration-underline&quot;</span>:
                        <b>if</b> (!<span class="r277 r">isBlock</span>)
                        {
                            <b>if</b> ((<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a> == <span class="s">&quot;true&quot;</span>)
                            {
                                <span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#c59fe7f637e0341a" class="i field">Xaml_TextDecorations</a>, <a href="#e8388ad601357097" class="i field">Xaml_TextDecorations_Underline</a>);
                            }
                        }
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;text-decoration-none&quot;</span>:
                    <b>case</b> <span class="s">&quot;text-decoration-overline&quot;</span>:
                    <b>case</b> <span class="s">&quot;text-decoration-line-through&quot;</span>:
                    <b>case</b> <span class="s">&quot;text-decoration-blink&quot;</span>:
                        <span class="c">//  Convert from all other text-decorations values</span>
                        <b>if</b> (!<span class="r277 r">isBlock</span>)
                        {
                        }
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;text-transform&quot;</span>:
                        <span class="c">//  Convert from text-transform into xaml property</span>
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;text-indent&quot;</span>:
                        <b>if</b> (<span class="r277 r">isBlock</span>)
                        {
                            <span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#49ae0a3028dfdd67" class="i field">Xaml_TextIndent</a>, (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>);
                        }
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;text-align&quot;</span>:
                        <b>if</b> (<span class="r277 r">isBlock</span>)
                        {
                            <span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#bcde90dbcf5807c6" class="i field">Xaml_TextAlignment</a>, (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>);
                        }
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;width&quot;</span>:
                    <b>case</b> <span class="s">&quot;height&quot;</span>:
                        <span class="c">//  Decide what to do with width and height propeties</span>
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;margin-top&quot;</span>:
                        <span class="r278 r">marginSet</span> = <b>true</b>;
                        <span class="r279 r">marginTop</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;margin-right&quot;</span>:
                        <span class="r278 r">marginSet</span> = <b>true</b>;
                        <span class="r282 r">marginRight</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;margin-bottom&quot;</span>:
                        <span class="r278 r">marginSet</span> = <b>true</b>;
                        <span class="r280 r">marginBottom</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;margin-left&quot;</span>:
                        <span class="r278 r">marginSet</span> = <b>true</b>;
                        <span class="r281 r">marginLeft</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;padding-top&quot;</span>:
                        <span class="r283 r">paddingSet</span> = <b>true</b>;
                        <span class="r284 r">paddingTop</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;padding-right&quot;</span>:
                        <span class="r283 r">paddingSet</span> = <b>true</b>;
                        <span class="r287 r">paddingRight</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;padding-bottom&quot;</span>:
                        <span class="r283 r">paddingSet</span> = <b>true</b>;
                        <span class="r285 r">paddingBottom</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;padding-left&quot;</span>:
                        <span class="r283 r">paddingSet</span> = <b>true</b>;
                        <span class="r286 r">paddingLeft</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
 
                    <span class="c">// NOTE: css names for elementary border styles have side indications in the middle (top/bottom/left/right)</span>
                    <span class="c">// In our internal notation we intentionally put them at the end - to unify processing in ParseCssRectangleProperty method</span>
                    <b>case</b> <span class="s">&quot;border-color-top&quot;</span>:
                        <span class="r288 r">borderColor</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;border-color-right&quot;</span>:
                        <span class="r288 r">borderColor</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;border-color-bottom&quot;</span>:
                        <span class="r288 r">borderColor</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;border-color-left&quot;</span>:
                        <span class="r288 r">borderColor</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;border-style-top&quot;</span>:
                    <b>case</b> <span class="s">&quot;border-style-right&quot;</span>:
                    <b>case</b> <span class="s">&quot;border-style-bottom&quot;</span>:
                    <b>case</b> <span class="s">&quot;border-style-left&quot;</span>:
                        <span class="c">//  Implement conversion from border style</span>
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;border-width-top&quot;</span>:
                        <span class="r289 r">borderThicknessSet</span> = <b>true</b>;
                        <span class="r290 r">borderThicknessTop</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;border-width-right&quot;</span>:
                        <span class="r289 r">borderThicknessSet</span> = <b>true</b>;
                        <span class="r293 r">borderThicknessRight</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;border-width-bottom&quot;</span>:
                        <span class="r289 r">borderThicknessSet</span> = <b>true</b>;
                        <span class="r291 r">borderThicknessBottom</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;border-width-left&quot;</span>:
                        <span class="r289 r">borderThicknessSet</span> = <b>true</b>;
                        <span class="r292 r">borderThicknessLeft</span> = (<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;list-style-type&quot;</span>:
                        <b>if</b> (<span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a> == <a href="#68b367d2cd7d374a" class="i field">XamlList</a>)
                        {
                            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r295 rd" class="r295 r">markerStyle</span>;
							<b>switch</b> (((<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>)<span class="r294 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>).<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>))
                            {
                                <b>case</b> <span class="s">&quot;disc&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#fe5f24c33eab093b" class="i field">Xaml_List_MarkerStyle_Disc</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;circle&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#9abd1ef9dd3d1bd5" class="i field">Xaml_List_MarkerStyle_Circle</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;none&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#1983f824326baf7a" class="i field">Xaml_List_MarkerStyle_None</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;square&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#c3b4754207346a74" class="i field">Xaml_List_MarkerStyle_Square</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;box&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#6043e96f78c14ba1" class="i field">Xaml_List_MarkerStyle_Box</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;lower-latin&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#12c7ac9568ae2c04" class="i field">Xaml_List_MarkerStyle_LowerLatin</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;upper-latin&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#97a65144b2435cea" class="i field">Xaml_List_MarkerStyle_UpperLatin</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;lower-roman&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#bda9f2a9b8655ad6" class="i field">Xaml_List_MarkerStyle_LowerRoman</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;upper-roman&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#a0354431d62711d0" class="i field">Xaml_List_MarkerStyle_UpperRoman</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;decimal&quot;</span>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#b1d2a61a94e3b3a5" class="i field">Xaml_List_MarkerStyle_Decimal</a>;
                                    <b>break</b>;
                                <b>default</b>:
                                    <span class="r295 r">markerStyle</span> = <a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#fe5f24c33eab093b" class="i field">Xaml_List_MarkerStyle_Disc</a>;
                                    <b>break</b>;
                            }
                            <span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#158b9827bfdab150" class="t t">HtmlToXamlConverter</a>.<a href="#a535ed5ce3fedf1e" class="i field">XamlListMarkerStyle</a>, <span class="r295 r">markerStyle</span>);
                        }
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;float&quot;</span>:
                    <b>case</b> <span class="s">&quot;clear&quot;</span>:
                        <b>if</b> (<span class="r277 r">isBlock</span>)
                        {
                            <span class="c">//  Convert float and clear properties</span>
                        }
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;display&quot;</span>:
                        <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r277 r">isBlock</span>)
            {
                <b>if</b> (<span class="r278 r">marginSet</span>)
                {
                    <a href="#0fe6f2cf11d4b64b" class="i method">ComposeThicknessProperty</a>(<span class="r275 r">xamlElement</span>, <a href="#4c9fcf79b9ced14d" class="i field">Xaml_Margin</a>, <span class="r281 r">marginLeft</span>, <span class="r282 r">marginRight</span>, <span class="r279 r">marginTop</span>, <span class="r280 r">marginBottom</span>);
                }
 
                <b>if</b> (<span class="r283 r">paddingSet</span>)
                {
                    <a href="#0fe6f2cf11d4b64b" class="i method">ComposeThicknessProperty</a>(<span class="r275 r">xamlElement</span>, <a href="#553d13b36b8ebce2" class="i field">Xaml_Padding</a>, <span class="r286 r">paddingLeft</span>, <span class="r287 r">paddingRight</span>, <span class="r284 r">paddingTop</span>, <span class="r285 r">paddingBottom</span>);
                }
 
                <b>if</b> (<span class="r288 r">borderColor</span> != <b>null</b>)
                {
                    <span class="c">//  We currently ignore possible difference in brush colors on different border sides. Use the last colored side mentioned</span>
                    <span class="r275 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#5749ed51327fa942" class="i field">Xaml_BorderBrush</a>, <span class="r288 r">borderColor</span>);
                }
 
                <b>if</b> (<span class="r289 r">borderThicknessSet</span>)
                {
                    <a href="#0fe6f2cf11d4b64b" class="i method">ComposeThicknessProperty</a>(<span class="r275 r">xamlElement</span>, <a href="#756b92b5aaa1a150" class="i field">Xaml_BorderThickness</a>, <span class="r292 r">borderThicknessLeft</span>, <span class="r293 r">borderThicknessRight</span>, <span class="r290 r">borderThicknessTop</span>, <span class="r291 r">borderThicknessBottom</span>);
                }
            }
        }
 
        <span class="c">// Create syntactically optimized four-value Thickness</span>
        <b>private static void</b> <a id="0fe6f2cf11d4b64b" href="../R/0fe6f2cf11d4b64b.html" target="n" data-glyph="76,1" class="i method">ComposeThicknessProperty</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r296 rd" class="r296 r">xamlElement</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r297 rd" class="r297 r">propertyName</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r298 rd" class="r298 r">left</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r299 rd" class="r299 r">right</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r300 rd" class="r300 r">top</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r301 rd" class="r301 r">bottom</span>)
        {
            <span class="c">// Xaml syntax:</span>
            <span class="c">// We have a reasonable interpreation for one value (all four edges), two values (horizontal, vertical),</span>
            <span class="c">// and four values (left, top, right, bottom).</span>
            <span class="c">//  switch (i) {</span>
            <span class="c">//    case 1: return new Thickness(lengths[0]);</span>
            <span class="c">//    case 2: return new Thickness(lengths[0], lengths[1], lengths[0], lengths[1]);</span>
            <span class="c">//    case 4: return new Thickness(lengths[0], lengths[1], lengths[2], lengths[3]);</span>
            <span class="c">//  }</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r302 rd" class="r302 r">thickness</span>;
 
            <span class="c">// We do not accept negative margins</span>
            <b>if</b> (<span class="r298 r">left</span>[0] == <span class="s">&#39;0&#39;</span> || <span class="r298 r">left</span>[0] == <span class="s">&#39;-&#39;</span>) <span class="r298 r">left</span> = <span class="s">&quot;0&quot;</span>;
            <b>if</b> (<span class="r299 r">right</span>[0] == <span class="s">&#39;0&#39;</span> || <span class="r299 r">right</span>[0] == <span class="s">&#39;-&#39;</span>) <span class="r299 r">right</span> = <span class="s">&quot;0&quot;</span>;
            <b>if</b> (<span class="r300 r">top</span>[0] == <span class="s">&#39;0&#39;</span> || <span class="r300 r">top</span>[0] == <span class="s">&#39;-&#39;</span>) <span class="r300 r">top</span> = <span class="s">&quot;0&quot;</span>;
            <b>if</b> (<span class="r301 r">bottom</span>[0] == <span class="s">&#39;0&#39;</span> || <span class="r301 r">bottom</span>[0] == <span class="s">&#39;-&#39;</span>) <span class="r301 r">bottom</span> = <span class="s">&quot;0&quot;</span>;
 
            <b>if</b> (<span class="r298 r">left</span> == <span class="r299 r">right</span> &amp;&amp; <span class="r300 r">top</span> == <span class="r301 r">bottom</span>)
            {
                <b>if</b> (<span class="r298 r">left</span> == <span class="r300 r">top</span>)
                {
                    <span class="r302 r">thickness</span> = <span class="r298 r">left</span>;
                }
                <b>else</b>
                {
                    <span class="r302 r">thickness</span> = <span class="r298 r">left</span> + <span class="s">&quot;,&quot;</span> + <span class="r300 r">top</span>;
                }
            }
            <b>else</b>
            {
                <span class="r302 r">thickness</span> = <span class="r298 r">left</span> + <span class="s">&quot;,&quot;</span> + <span class="r300 r">top</span> + <span class="s">&quot;,&quot;</span> + <span class="r299 r">right</span> + <span class="s">&quot;,&quot;</span> + <span class="r301 r">bottom</span>;
            }
 
            <span class="c">//  Need safer processing for a thickness value</span>
            <span class="r296 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<span class="r297 r">propertyName</span>, <span class="r302 r">thickness</span>);
        }
 
        <b>private static void</b> <a id="148f62a9743a49df" href="../R/148f62a9743a49df.html" target="n" data-glyph="76,1" class="i method">SetPropertyValue</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r303 rd" class="r303 r">xamlElement</span>, <a href="@0@WindowsBase/A.html#4a20845df0b86ddd" class="t t">DependencyProperty</a> <span id="r304 rd" class="r304 r">property</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r305 rd" class="r305 r">stringValue</span>)
        {
            <span class="i n">System</span>.<span class="i n">ComponentModel</span>.<a href="@0@System/A.html#5ffdbf35aab9cd1c" class="t t">TypeConverter</a> <span id="r306 rd" class="r306 r">typeConverter</span> = <span class="i n">System</span>.<span class="i n">ComponentModel</span>.<a href="@0@System/A.html#7a0aedc986512dd3" class="t t">TypeDescriptor</a>.<a href="@0@System/A.html#977adff822336d07" class="i method">GetConverter</a>(<span class="r304 r">property</span>.<a href="@0@WindowsBase/A.html#125f2e84d643c020" class="i property">PropertyType</a>);
            <b>try</b>
            {
                <b>object</b> <span id="r307 rd" class="r307 r">convertedValue</span> = <span class="r306 r">typeConverter</span>.<a href="@0@System/A.html#a4f6cd8112ba29f6" class="i method">ConvertFromInvariantString</a>(<span class="r305 r">stringValue</span>);
                <b>if</b> (<span class="r307 r">convertedValue</span> != <b>null</b>)
                {
                    <span class="r303 r">xamlElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<span class="r304 r">property</span>.<a href="@0@WindowsBase/A.html#06e1fecd901f2569" class="i property">Name</a>, <span class="r305 r">stringValue</span>);
                }
            }
            <b>catch</b>(<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
            {
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Analyzes the tag of the htmlElement and infers its associated formatted properties.</span>
        <span class="c">///</span><span class="c"> After that parses style attribute and adds all inline css styles.</span>
        <span class="c">///</span><span class="c"> The resulting style attributes are collected in output parameter localProperties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r308 r">htmlElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r309 r">inheritedProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> set of properties inherited from ancestor elements. Currently not used in the code. Reserved for the future development.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r310 r">localProperties</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> returns all formatting properties defined by this element - implied by its tag, its attributes, or its css inline style</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r311 r">stylesheet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r312 r">sourceContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> returns a combination of previous context with local set of properties.</span>
        <span class="c">///</span><span class="c"> This value is not used in the current code - inntended for the future development.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <a id="ce2b6fa8597c6309" href="../R/ce2b6fa8597c6309.html" target="n" data-glyph="76,1" class="i method">GetElementProperties</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r308 rd" class="r308 r">htmlElement</span>, <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r309 rd" class="r309 r">inheritedProperties</span>, <b>out</b> <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r310 rd" class="r310 r">localProperties</span>, <a href="HtmlCssParser.cs.html#2813905d0ac066a9" class="t t">CssStylesheet</a> <span id="r311 rd" class="r311 r">stylesheet</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>&gt; <span id="r312 rd" class="r312 r">sourceContext</span>)
        {
            <span class="c">// Start with context formatting properties</span>
            <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r313 rd" class="r313 r">currentProperties</span> = <b>new</b> <a href="@0@mscorlib/A.html#35eb148f5d60a68c" class="t constructor">Hashtable</a>();
            <a href="@0@mscorlib/A.html#027d3303c68ed300" class="t t">IDictionaryEnumerator</a> <span id="r314 rd" class="r314 r">propertyEnumerator</span> = <span class="r309 r">inheritedProperties</span>.<a href="@0@mscorlib/A.html#3fe25aaa70fa400b" class="i method">GetEnumerator</a>();
            <b>while</b> (<span class="r314 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#116c28c0f6355e3f" class="i method">MoveNext</a>())
            {
                <span class="r313 r">currentProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="r314 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#42cf145725084ef0" class="i property">Key</a>] = <span class="r314 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
            }
 
            <span class="c">// Identify element name</span>
			<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r315 rd" class="r315 r">elementName</span> = <span class="r308 r">htmlElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r316 rd" class="r316 r">elementNamespace</span> = <span class="r308 r">htmlElement</span>.<a href="@0@System.Xml/A.html#3adc64551d2eec34" class="i property">NamespaceURI</a>;
 
            <span class="c">// update current formatting properties depending on element tag</span>
 
            <span class="r310 r">localProperties</span> = <b>new</b> <a href="@0@mscorlib/A.html#35eb148f5d60a68c" class="t constructor">Hashtable</a>();
            <b>switch</b> (<span class="r315 r">elementName</span>)
            {
                <span class="c">// Character formatting</span>
                <b>case</b> <span class="s">&quot;i&quot;</span>:
                <b>case</b> <span class="s">&quot;italic&quot;</span>:
                <b>case</b> <span class="s">&quot;em&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-style&quot;</span>] = <span class="s">&quot;italic&quot;</span>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;b&quot;</span>:
                <b>case</b> <span class="s">&quot;bold&quot;</span>:
                <b>case</b> <span class="s">&quot;strong&quot;</span>:
                <b>case</b> <span class="s">&quot;dfn&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-weight&quot;</span>] = <span class="s">&quot;bold&quot;</span>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;u&quot;</span>:
                <b>case</b> <span class="s">&quot;underline&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;text-decoration-underline&quot;</span>] = <span class="s">&quot;true&quot;</span>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;font&quot;</span>:
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r317 rd" class="r317 r">attributeValue</span> = <a href="#bb4e7e205aef385f" class="i method">GetAttribute</a>(<span class="r308 r">htmlElement</span>, <span class="s">&quot;face&quot;</span>);
                    <b>if</b> (<span class="r317 r">attributeValue</span> != <b>null</b>)
                    {
                        <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-family&quot;</span>] = <span class="r317 r">attributeValue</span>;
                    }
                    <span class="r317 r">attributeValue</span> = <a href="#bb4e7e205aef385f" class="i method">GetAttribute</a>(<span class="r308 r">htmlElement</span>, <span class="s">&quot;size&quot;</span>);
                    <b>if</b> (<span class="r317 r">attributeValue</span> != <b>null</b>)
                    {
						<b>double</b> <span id="r318 rd" class="r318 r">fontSize</span> = <b>double</b>.<a href="@0@mscorlib/A.html#73cc31e0b47fd637" class="i method">Parse</a>(<span class="r317 r">attributeValue</span>, <a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) * (12.0 / 3.0);
                        <b>if</b> (<span class="r318 r">fontSize</span> &lt; 1.0)
                        {
                            <span class="r318 r">fontSize</span> = 1.0;
                        }
                        <b>else</b> <b>if</b> (<span class="r318 r">fontSize</span> &gt; 1000.0)
                        {
                            <span class="r318 r">fontSize</span> = 1000.0;
                        }
						<span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-size&quot;</span>] = <span class="r318 r">fontSize</span>.<a href="@0@mscorlib/A.html#102b12e1c4385406" class="i method">ToString</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                    }
                    <span class="r317 r">attributeValue</span> = <a href="#bb4e7e205aef385f" class="i method">GetAttribute</a>(<span class="r308 r">htmlElement</span>, <span class="s">&quot;color&quot;</span>);
                    <b>if</b> (<span class="r317 r">attributeValue</span> != <b>null</b>)
                    {
                        <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;color&quot;</span>] = <span class="r317 r">attributeValue</span>;
                    }
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;samp&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-family&quot;</span>] = <span class="s">&quot;Courier New&quot;</span>; <span class="c">// code sample</span>
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-size&quot;</span>] = <a href="#c018455fe0f2b146" class="i field">Xaml_FontSize_XXSmall</a>;
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;text-align&quot;</span>] = <span class="s">&quot;Left&quot;</span>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;sub&quot;</span>:
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;sup&quot;</span>:
                    <b>break</b>;
 
                <span class="c">// Hyperlinks</span>
                <b>case</b> <span class="s">&quot;a&quot;</span>: <span class="c">// href, hreflang, urn, methods, rel, rev, title</span>
                    <span class="c">//  Set default hyperlink properties</span>
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;acronym&quot;</span>:
                    <b>break</b>;
 
                <span class="c">// Paragraph formatting:</span>
                <b>case</b> <span class="s">&quot;p&quot;</span>:
                    <span class="c">//  Set default paragraph properties</span>
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;div&quot;</span>:
                    <span class="c">//  Set default div properties</span>
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;pre&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-family&quot;</span>] = <span class="s">&quot;Courier New&quot;</span>; <span class="c">// renders text in a fixed-width font</span>
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-size&quot;</span>] = <a href="#c018455fe0f2b146" class="i field">Xaml_FontSize_XXSmall</a>;
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;text-align&quot;</span>] = <span class="s">&quot;Left&quot;</span>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;blockquote&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;margin-left&quot;</span>] = <span class="s">&quot;16&quot;</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="s">&quot;h1&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-size&quot;</span>] = <a href="#c49827523c8878c1" class="i field">Xaml_FontSize_XXLarge</a>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;h2&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-size&quot;</span>] = <a href="#a2813145dc9e85aa" class="i field">Xaml_FontSize_XLarge</a>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;h3&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-size&quot;</span>] = <a href="#aa91ebdf72b4143a" class="i field">Xaml_FontSize_Large</a>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;h4&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-size&quot;</span>] = <a href="#df857b327cb3d644" class="i field">Xaml_FontSize_Medium</a>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;h5&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-size&quot;</span>] = <a href="#5739d901a082c749" class="i field">Xaml_FontSize_Small</a>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;h6&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;font-size&quot;</span>] = <a href="#ac597989f24acc37" class="i field">Xaml_FontSize_XSmall</a>;
                    <b>break</b>;
                <span class="c">// List properties</span>
                <b>case</b> <span class="s">&quot;ul&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;list-style-type&quot;</span>] = <span class="s">&quot;disc&quot;</span>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;ol&quot;</span>:
                    <span class="r310 r">localProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="s">&quot;list-style-type&quot;</span>] = <span class="s">&quot;decimal&quot;</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="s">&quot;table&quot;</span>:
                <b>case</b> <span class="s">&quot;body&quot;</span>:
                <b>case</b> <span class="s">&quot;html&quot;</span>:
                    <b>break</b>;
            }
 
            <span class="c">// Override html defaults by css attributes - from stylesheets and inline settings</span>
            <a href="HtmlCssParser.cs.html#b52d12fda7801fd6" class="t t">HtmlCssParser</a>.<a href="HtmlCssParser.cs.html#1675bd235be09b7f" class="i method">GetElementPropertiesFromCssAttributes</a>(<span class="r308 r">htmlElement</span>, <span class="r315 r">elementName</span>, <span class="r311 r">stylesheet</span>, <span class="r310 r">localProperties</span>, <span class="r312 r">sourceContext</span>);
 
            <span class="c">// Combine local properties with context to create new current properties</span>
            <span class="r314 r">propertyEnumerator</span> = <span class="r310 r">localProperties</span>.<a href="@0@mscorlib/A.html#3fe25aaa70fa400b" class="i method">GetEnumerator</a>();
            <b>while</b> (<span class="r314 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#116c28c0f6355e3f" class="i method">MoveNext</a>())
            {
                <span class="r313 r">currentProperties</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="r314 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#42cf145725084ef0" class="i property">Key</a>] = <span class="r314 r">propertyEnumerator</span>.<a href="@0@mscorlib/A.html#10c920dd02dfab19" class="i property">Value</a>;
            }
 
            <b>return</b> <span class="r313 r">currentProperties</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Extracts a value of css attribute from css style definition.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r319 r">cssStyle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Source csll style definition</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r320 r">attributeName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A name of css attribute to extract</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string rrepresentation of an attribute value if found;</span>
        <span class="c">///</span><span class="c"> null if there is no such attribute in a given string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="dcd7a5ff808f5a37" href="../R/dcd7a5ff808f5a37.html" target="n" data-glyph="76,1" class="i method">GetCssAttribute</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r319 rd" class="r319 r">cssStyle</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r320 rd" class="r320 r">attributeName</span>)
        {
            <span class="c">//  This is poor man&#39;s attribute parsing. Replace it by real css parsing</span>
            <b>if</b> (<span class="r319 r">cssStyle</span> != <b>null</b>)
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>[] <span id="r321 rd" class="r321 r">styleValues</span>;
 
				<span class="r320 r">attributeName</span> = <span class="r320 r">attributeName</span>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
 
                <span class="c">// Check for width specification in style string</span>
                <span class="r321 r">styleValues</span> = <span class="r319 r">cssStyle</span>.<a href="@0@mscorlib/A.html#1c4a9dc78ba38999" class="i method">Split</a>(<span class="s">&#39;;&#39;</span>);
 
                <b>for</b> (<b>int</b> <span id="r322 rd" class="r322 r">styleValueIndex</span> = 0; <span class="r322 r">styleValueIndex</span> &lt; <span class="r321 r">styleValues</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r322 r">styleValueIndex</span>++)
                {
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>[] <span id="r323 rd" class="r323 r">styleNameValue</span>;
 
                    <span class="r323 r">styleNameValue</span> = <span class="r321 r">styleValues</span>[<span class="r322 r">styleValueIndex</span>].<a href="@0@mscorlib/A.html#1c4a9dc78ba38999" class="i method">Split</a>(<span class="s">&#39;:&#39;</span>);
                    <b>if</b> (<span class="r323 r">styleNameValue</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 2)
                    {
						<b>if</b> (<span class="r323 r">styleNameValue</span>[0].<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>().<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="r320 r">attributeName</span>)
                        {
                            <b>return</b> <span class="r323 r">styleNameValue</span>[1].<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>();
                        }
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a length value from string representation to a double.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r324 r">lengthAsString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Source string value of a length.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r325 r">length</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="39b701e9975db0dd" href="../R/39b701e9975db0dd.html" target="n" data-glyph="76,1" class="i method">TryGetLengthValue</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r324 rd" class="r324 r">lengthAsString</span>, <b>out double</b> <span id="r325 rd" class="r325 r">length</span>)
        {
            <span class="r325 r">length</span> = <a href="@0@mscorlib/A.html#1a65cbdb09544ba1" class="t t">Double</a>.<a href="@0@mscorlib/A.html#dcd7a869fad1e6bb" class="i field">NaN</a>;
 
            <b>if</b> (<span class="r324 r">lengthAsString</span> != <b>null</b>)
            {
				<span class="r324 r">lengthAsString</span> = <span class="r324 r">lengthAsString</span>.<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>().<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
 
                <span class="c">// We try to convert currentColumnWidthAsString into a double. This will eliminate widths of type &quot;50%&quot;, etc.</span>
                <b>if</b> (<span class="r324 r">lengthAsString</span>.<a href="@0@mscorlib/A.html#41a31e4feec3ef41" class="i method">EndsWith</a>(<span class="s">&quot;pt&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>))
                {
                    <span class="r324 r">lengthAsString</span> = <span class="r324 r">lengthAsString</span>.<a href="@0@mscorlib/A.html#8124961f027d9ac9" class="i method">Substring</a>(0, <span class="r324 r">lengthAsString</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> - 2);
                    <b>if</b> (<a href="@0@mscorlib/A.html#1a65cbdb09544ba1" class="t t">Double</a>.<a href="@0@mscorlib/A.html#4ac3250276256193" class="i method">TryParse</a>(<span class="r324 r">lengthAsString</span>, <b>out</b> <span class="r325 r">length</span>))
                    {
                        <span class="r325 r">length</span> = (<span class="r325 r">length</span> * 96.0) / 72.0; <span class="c">// convert from points to pixels</span>
                    }
                    <b>else</b>
                    {
                        <span class="r325 r">length</span> = <a href="@0@mscorlib/A.html#1a65cbdb09544ba1" class="t t">Double</a>.<a href="@0@mscorlib/A.html#dcd7a869fad1e6bb" class="i field">NaN</a>;
                    }
                }
                <b>else</b> <b>if</b> (<span class="r324 r">lengthAsString</span>.<a href="@0@mscorlib/A.html#41a31e4feec3ef41" class="i method">EndsWith</a>(<span class="s">&quot;px&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>))
                {
                    <span class="r324 r">lengthAsString</span> = <span class="r324 r">lengthAsString</span>.<a href="@0@mscorlib/A.html#8124961f027d9ac9" class="i method">Substring</a>(0, <span class="r324 r">lengthAsString</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> - 2);
                    <b>if</b> (!<a href="@0@mscorlib/A.html#1a65cbdb09544ba1" class="t t">Double</a>.<a href="@0@mscorlib/A.html#4ac3250276256193" class="i method">TryParse</a>(<span class="r324 r">lengthAsString</span>, <b>out</b> <span class="r325 r">length</span>))
                    {
                        <span class="r325 r">length</span> = <a href="@0@mscorlib/A.html#1a65cbdb09544ba1" class="t t">Double</a>.<a href="@0@mscorlib/A.html#dcd7a869fad1e6bb" class="i field">NaN</a>;
                    }
                }
                <b>else</b>
                {
                    <b>if</b> (!<a href="@0@mscorlib/A.html#1a65cbdb09544ba1" class="t t">Double</a>.<a href="@0@mscorlib/A.html#4ac3250276256193" class="i method">TryParse</a>(<span class="r324 r">lengthAsString</span>, <b>out</b> <span class="r325 r">length</span>)) <span class="c">// Assuming pixels</span>
                    {
                        <span class="r325 r">length</span> = <a href="@0@mscorlib/A.html#1a65cbdb09544ba1" class="t t">Double</a>.<a href="@0@mscorlib/A.html#dcd7a869fad1e6bb" class="i field">NaN</a>;
                    }
                }
            }
 
            <b>return</b> !<a href="@0@mscorlib/A.html#1a65cbdb09544ba1" class="t t">Double</a>.<a href="@0@mscorlib/A.html#b3843db5f359a0fd" class="i method">IsNaN</a>(<span class="r325 r">length</span>);
        }
 
        <span class="c">// .................................................................</span>
        <span class="c">//</span>
        <span class="c">// Pasring Color Attribute</span>
        <span class="c">//</span>
        <span class="c">// .................................................................</span>
 
        <b>private static string</b> <a id="208ce52612669b7c" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetColorValue</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r326 rd" class="r326 r">colorValue</span>)
        {
            <span class="c">// TODO: Implement color conversion</span>
            <b>return</b> <span class="r326 r">colorValue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Applies properties to xamlTableCellElement based on the html td element it is converted from.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r327 r">htmlChildNode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Html td/th element to be converted to xaml</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r328 r">xamlTableCellElement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlElement representing Xaml element for which properties are to be processed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TODO: Use the processed properties for htmlChildNode instead of using the node itself </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="4a662c3d8be40ab9" href="../R/4a662c3d8be40ab9.html" target="n" data-glyph="76,1" class="i method">ApplyPropertiesToTableCellElement</a>(<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r327 rd" class="r327 r">htmlChildNode</span>, <a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a> <span id="r328 rd" class="r328 r">xamlTableCellElement</span>)
        {
            <span class="c">// Parameter validation</span>
			<a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r327 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;td&quot;</span> || <span class="r327 r">htmlChildNode</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) == <span class="s">&quot;th&quot;</span>);
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r328 r">xamlTableCellElement</span>.<a href="@0@System.Xml/A.html#60198b2dff854e0e" class="i property">LocalName</a> == <a href="#f12f8d7f9b83570b" class="i field">Xaml_TableCell</a>);
 
            <span class="c">// set default border thickness for xamlTableCellElement to enable gridlines</span>
            <span class="r328 r">xamlTableCellElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#ed5023d3cfc8e4d9" class="i field">Xaml_TableCell_BorderThickness</a>, <span class="s">&quot;1,1,1,1&quot;</span>);
            <span class="r328 r">xamlTableCellElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#2d15548e240a9804" class="i field">Xaml_TableCell_BorderBrush</a>, <a href="#d852c16c4165767f" class="i field">Xaml_Brushes_Black</a>);
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r329 rd" class="r329 r">rowSpanString</span> = <a href="#bb4e7e205aef385f" class="i method">GetAttribute</a>((<a href="@0@System.Xml/A.html#184875ff599860f7" class="t t">XmlElement</a>)<span class="r327 r">htmlChildNode</span>, <span class="s">&quot;rowspan&quot;</span>);
            <b>if</b> (<span class="r329 r">rowSpanString</span> != <b>null</b>)
            {
                <span class="r328 r">xamlTableCellElement</span>.<a href="@0@System.Xml/A.html#763e334f9e96420c" class="i method">SetAttribute</a>(<a href="#c651b12a1c7ae4d0" class="i field">Xaml_TableCell_RowSpan</a>, <span class="r329 r">rowSpanString</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods
 
        <span class="c">// ----------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Internal Constants</span>
        <span class="c">//</span>
        <span class="c">// ----------------------------------------------------------------</span>
 
        <span class="c">// The constants reprtesent all Xaml names used in a conversion</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="f02b6d9d01bfb455" href="../R/f02b6d9d01bfb455.html" target="n" data-glyph="6,1" class="i field">XamlFlowDocument</a> = <span class="s">&quot;FlowDocument&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="ef7d192703a9b10d" href="../R/ef7d192703a9b10d.html" target="n" data-glyph="6,1" class="i field">XamlRun</a> = <span class="s">&quot;Run&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="aa27ac473c9dde0a" href="../R/aa27ac473c9dde0a.html" target="n" data-glyph="6,1" class="i field">XamlSpan</a> = <span class="s">&quot;Span&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="fe6871e49c38d029" href="../R/fe6871e49c38d029.html" target="n" data-glyph="6,1" class="i field">XamlHyperlink</a> = <span class="s">&quot;Hyperlink&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="7704f3972e52e81a" href="../R/7704f3972e52e81a.html" target="n" data-glyph="6,1" class="i field">XamlHyperlinkNavigateUri</a> = <span class="s">&quot;NavigateUri&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="7a85d4c3a78d1f74" href="../R/7a85d4c3a78d1f74.html" target="n" data-glyph="6,1" class="i field">XamlHyperlinkTargetName</a> = <span class="s">&quot;TargetName&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="5c566c4b73f058e4" href="../R/5c566c4b73f058e4.html" target="n" data-glyph="6,1" class="i field">XamlSection</a> = <span class="s">&quot;Section&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="68b367d2cd7d374a" href="../R/68b367d2cd7d374a.html" target="n" data-glyph="6,1" class="i field">XamlList</a> = <span class="s">&quot;List&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="a535ed5ce3fedf1e" href="../R/a535ed5ce3fedf1e.html" target="n" data-glyph="6,1" class="i field">XamlListMarkerStyle</a> = <span class="s">&quot;MarkerStyle&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="1983f824326baf7a" href="../R/1983f824326baf7a.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_None</a> = <span class="s">&quot;None&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="b1d2a61a94e3b3a5" href="../R/b1d2a61a94e3b3a5.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_Decimal</a> = <span class="s">&quot;Decimal&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="fe5f24c33eab093b" href="../R/fe5f24c33eab093b.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_Disc</a> = <span class="s">&quot;Disc&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="9abd1ef9dd3d1bd5" href="../R/9abd1ef9dd3d1bd5.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_Circle</a> = <span class="s">&quot;Circle&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="c3b4754207346a74" href="../R/c3b4754207346a74.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_Square</a> = <span class="s">&quot;Square&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="6043e96f78c14ba1" href="../R/6043e96f78c14ba1.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_Box</a> = <span class="s">&quot;Box&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="12c7ac9568ae2c04" href="../R/12c7ac9568ae2c04.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_LowerLatin</a> = <span class="s">&quot;LowerLatin&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="97a65144b2435cea" href="../R/97a65144b2435cea.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_UpperLatin</a> = <span class="s">&quot;UpperLatin&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="bda9f2a9b8655ad6" href="../R/bda9f2a9b8655ad6.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_LowerRoman</a> = <span class="s">&quot;LowerRoman&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="a0354431d62711d0" href="../R/a0354431d62711d0.html" target="n" data-glyph="6,1" class="i field">Xaml_List_MarkerStyle_UpperRoman</a> = <span class="s">&quot;UpperRoman&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="07db446592efc7fe" href="../R/07db446592efc7fe.html" target="n" data-glyph="6,1" class="i field">Xaml_ListItem</a> = <span class="s">&quot;ListItem&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="85323a7262308596" href="../R/85323a7262308596.html" target="n" data-glyph="6,1" class="i field">Xaml_LineBreak</a> = <span class="s">&quot;LineBreak&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="7b0f028de022fbee" href="../R/7b0f028de022fbee.html" target="n" data-glyph="6,1" class="i field">Xaml_Paragraph</a> = <span class="s">&quot;Paragraph&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="4c9fcf79b9ced14d" href="../R/4c9fcf79b9ced14d.html" target="n" data-glyph="6,1" class="i field">Xaml_Margin</a> = <span class="s">&quot;Margin&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="553d13b36b8ebce2" href="../R/553d13b36b8ebce2.html" target="n" data-glyph="6,1" class="i field">Xaml_Padding</a> = <span class="s">&quot;Padding&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="5749ed51327fa942" href="../R/5749ed51327fa942.html" target="n" data-glyph="6,1" class="i field">Xaml_BorderBrush</a> = <span class="s">&quot;BorderBrush&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="756b92b5aaa1a150" href="../R/756b92b5aaa1a150.html" target="n" data-glyph="6,1" class="i field">Xaml_BorderThickness</a> = <span class="s">&quot;BorderThickness&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="de171cbd7064ada6" href="../R/de171cbd7064ada6.html" target="n" data-glyph="6,1" class="i field">Xaml_Table</a> = <span class="s">&quot;Table&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="0a7fa65be4ffa2c9" href="../R/0a7fa65be4ffa2c9.html" target="n" data-glyph="6,1" class="i field">Xaml_TableColumn</a> = <span class="s">&quot;TableColumn&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="cdb5eb4d8115d166" href="../R/cdb5eb4d8115d166.html" target="n" data-glyph="6,1" class="i field">Xaml_TableRowGroup</a> = <span class="s">&quot;TableRowGroup&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="45cac16bd8ae387e" href="../R/45cac16bd8ae387e.html" target="n" data-glyph="6,1" class="i field">Xaml_TableRow</a> = <span class="s">&quot;TableRow&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="f12f8d7f9b83570b" href="../R/f12f8d7f9b83570b.html" target="n" data-glyph="6,1" class="i field">Xaml_TableCell</a> = <span class="s">&quot;TableCell&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="ed5023d3cfc8e4d9" href="../R/ed5023d3cfc8e4d9.html" target="n" data-glyph="6,1" class="i field">Xaml_TableCell_BorderThickness</a> = <span class="s">&quot;BorderThickness&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="2d15548e240a9804" href="../R/2d15548e240a9804.html" target="n" data-glyph="6,1" class="i field">Xaml_TableCell_BorderBrush</a> = <span class="s">&quot;BorderBrush&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="5e5ead25cd10aa79" href="../R/5e5ead25cd10aa79.html" target="n" data-glyph="6,1" class="i field">Xaml_TableCell_ColumnSpan</a> = <span class="s">&quot;ColumnSpan&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="c651b12a1c7ae4d0" href="../R/c651b12a1c7ae4d0.html" target="n" data-glyph="6,1" class="i field">Xaml_TableCell_RowSpan</a> = <span class="s">&quot;RowSpan&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="2fc099b8439a078c" href="../R/2fc099b8439a078c.html" target="n" data-glyph="6,1" class="i field">Xaml_Width</a> = <span class="s">&quot;Width&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="d852c16c4165767f" href="../R/d852c16c4165767f.html" target="n" data-glyph="6,1" class="i field">Xaml_Brushes_Black</a> = <span class="s">&quot;Black&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="935d63fd8ea4b627" href="../R/935d63fd8ea4b627.html" target="n" data-glyph="6,1" class="i field">Xaml_FontFamily</a> = <span class="s">&quot;FontFamily&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="548ae1585edcd3b9" href="../R/548ae1585edcd3b9.html" target="n" data-glyph="6,1" class="i field">Xaml_FontSize</a> = <span class="s">&quot;FontSize&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="c49827523c8878c1" href="../R/c49827523c8878c1.html" target="n" data-glyph="6,1" class="i field">Xaml_FontSize_XXLarge</a> = <span class="s">&quot;22pt&quot;</span>; <span class="c">// &quot;XXLarge&quot;;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="a2813145dc9e85aa" href="../R/a2813145dc9e85aa.html" target="n" data-glyph="6,1" class="i field">Xaml_FontSize_XLarge</a> = <span class="s">&quot;20pt&quot;</span>; <span class="c">// &quot;XLarge&quot;;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="aa91ebdf72b4143a" href="../R/aa91ebdf72b4143a.html" target="n" data-glyph="6,1" class="i field">Xaml_FontSize_Large</a> = <span class="s">&quot;18pt&quot;</span>; <span class="c">// &quot;Large&quot;;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="df857b327cb3d644" href="../R/df857b327cb3d644.html" target="n" data-glyph="6,1" class="i field">Xaml_FontSize_Medium</a> = <span class="s">&quot;16pt&quot;</span>; <span class="c">// &quot;Medium&quot;;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="5739d901a082c749" href="../R/5739d901a082c749.html" target="n" data-glyph="6,1" class="i field">Xaml_FontSize_Small</a> = <span class="s">&quot;12pt&quot;</span>; <span class="c">// &quot;Small&quot;;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="ac597989f24acc37" href="../R/ac597989f24acc37.html" target="n" data-glyph="6,1" class="i field">Xaml_FontSize_XSmall</a> = <span class="s">&quot;10pt&quot;</span>; <span class="c">// &quot;XSmall&quot;;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="c018455fe0f2b146" href="../R/c018455fe0f2b146.html" target="n" data-glyph="6,1" class="i field">Xaml_FontSize_XXSmall</a> = <span class="s">&quot;8pt&quot;</span>; <span class="c">// &quot;XXSmall&quot;;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="9c85cc7ba077f8f2" href="../R/9c85cc7ba077f8f2.html" target="n" data-glyph="6,1" class="i field">Xaml_FontWeight</a> = <span class="s">&quot;FontWeight&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="1a1852a090ab485e" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">Xaml_FontWeight_Bold</a> = <span class="s">&quot;Bold&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="f05fa92c2e7f6e7c" href="../R/f05fa92c2e7f6e7c.html" target="n" data-glyph="6,1" class="i field">Xaml_FontStyle</a> = <span class="s">&quot;FontStyle&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="b071170e83e8fcb1" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">Xaml_Foreground</a> = <span class="s">&quot;Foreground&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="ccbcd7f238e45720" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">Xaml_Background</a> = <span class="s">&quot;Background&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="c59fe7f637e0341a" href="../R/c59fe7f637e0341a.html" target="n" data-glyph="6,1" class="i field">Xaml_TextDecorations</a> = <span class="s">&quot;TextDecorations&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="e8388ad601357097" href="../R/e8388ad601357097.html" target="n" data-glyph="6,1" class="i field">Xaml_TextDecorations_Underline</a> = <span class="s">&quot;Underline&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="49ae0a3028dfdd67" href="../R/49ae0a3028dfdd67.html" target="n" data-glyph="6,1" class="i field">Xaml_TextIndent</a> = <span class="s">&quot;TextIndent&quot;</span>;
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public const string</b> <a id="bcde90dbcf5807c6" href="../R/bcde90dbcf5807c6.html" target="n" data-glyph="6,1" class="i field">Xaml_TextAlignment</a> = <span class="s">&quot;TextAlignment&quot;</span>;
 
        <span class="c">// ---------------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Private Fields</span>
        <span class="c">//</span>
        <span class="c">// ---------------------------------------------------------------------</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Fields
 
        <b>static string</b> <a id="ac8578bc880ebde2" href="../R/ac8578bc880ebde2.html" target="n" data-glyph="46,1" class="i field">_xamlNamespace</a> = <span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Fields
    }
}
</pre></td></tr></table></div></body></html>
