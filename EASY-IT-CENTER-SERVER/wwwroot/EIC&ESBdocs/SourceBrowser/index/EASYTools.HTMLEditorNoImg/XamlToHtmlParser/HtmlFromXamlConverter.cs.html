<!DOCTYPE html>
<html><head><title>HtmlFromXamlConverter.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(595);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EASYTools.HTMLEditorNoImg/XamlToHtmlParser/HtmlFromXamlConverter.cs" target="_top">XamlToHtmlParser\HtmlFromXamlConverter.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EASYTools.HTMLEditorNoImg" target="_top">..\..\..\EASY-TOOLS\EASYTools.HTMLEditorNoImg\EASYTools.HTMLEditorNoImg.csproj</a> (EASYTools.HTMLEditorNoImg)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">//---------------------------------------------------------------------------</span>
<span class="c">// </span>
<span class="c">// File: HtmlFromXamlConverter.cs</span>
<span class="c">//</span>
<span class="c">// Copyright (C) Microsoft Corporation.  All rights reserved.</span>
<span class="c">//</span>
<span class="c">// Description: Prototype for Xaml - Html conversion </span>
<span class="c">//</span>
<span class="c">//---------------------------------------------------------------------------</span>
 
<b>namespace</b> <span class="i n">EASYTools</span>.<span class="i n">HTMLEditorNoImg</span>
{
	<b>using</b> <span class="i n">System</span>;
	<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
	<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
	<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
	<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
	<b>using</b> <span class="i n">System</span>.<span class="i n">Xml</span>;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> HtmlToXamlConverter is a static class that takes an HTML string</span>
    <span class="c">///</span><span class="c"> and converts it into XAML</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="eb103014d2cca080" href="../R/eb103014d2cca080.html" target="n" data-glyph="2,0" class="t t">HtmlFromXamlConverter</a>
    {
        <span class="c">// ---------------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Internal Methods</span>
        <span class="c">//</span>
        <span class="c">// ---------------------------------------------------------------------</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
        <b>internal static string</b> <a id="47b64d84b48c9a22" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ConvertXamlToHtml</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">xamlString</span>)
        {
            <b>return</b> <a href="#4df240066f8447ea" class="i method">ConvertXamlToHtml</a>(<span class="r0 r">xamlString</span>, <b>true</b>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Main entry point for Xaml-to-Html converter.</span>
        <span class="c">///</span><span class="c"> Converts a xaml string into html string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">xamlString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Xaml strinng to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">asFlowDocument</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Html string produced from a source xaml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="4df240066f8447ea" href="../R/4df240066f8447ea.html" target="n" data-glyph="74,1" class="i method">ConvertXamlToHtml</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r1 rd" class="r1 r">xamlString</span>, <b>bool</b> <span id="r2 rd" class="r2 r">asFlowDocument</span>)
        {
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r3 rd" class="r3 r">htmlStringBuilder</span>;
            <a href="@0@System.Xml/A.html#deba79d6386a7da8" class="t t">XmlTextWriter</a> <span id="r4 rd" class="r4 r">htmlWriter</span>;
 
            <b>if</b> (!<span class="r2 r">asFlowDocument</span>)
            {
                <span class="r1 r">xamlString</span> = <span class="s">&quot;&lt;FlowDocument&gt;&quot;</span> + <span class="r1 r">xamlString</span> + <span class="s">&quot;&lt;/FlowDocument&gt;&quot;</span>;
            }
 
				<b>using</b> (<a href="@0@System.Xml/A.html#fc0e04cc62b78707" class="t t">XmlTextReader</a> <span id="r5 rd" class="r5 r">xamlReader</span> = <b>new</b> <a href="@0@System.Xml/A.html#97fd0828b713b86c" class="t constructor">XmlTextReader</a>(<b>new</b> <a href="@0@mscorlib/A.html#4d3b5652006f956d" class="t constructor">StringReader</a>(<span class="r1 r">xamlString</span>)))
				{
					<span class="r3 r">htmlStringBuilder</span> = <b>new</b> <a href="@0@mscorlib/A.html#ec674e2123a44860" class="t constructor">StringBuilder</a>(100);
					<b>using</b> (<a href="@0@mscorlib/A.html#fd76db5d443fe076" class="t t">StringWriter</a> <span id="r6 rd" class="r6 r">htmlStringWiter</span> = <b>new</b> <a href="@0@mscorlib/A.html#74fafe2990285b4d" class="t constructor">StringWriter</a>(<span class="r3 r">htmlStringBuilder</span>, <a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>))
					{
						<span class="r4 r">htmlWriter</span> = <b>new</b> <a href="@0@System.Xml/A.html#de9301c373f437fe" class="t constructor">XmlTextWriter</a>(<span class="r6 r">htmlStringWiter</span>);
 
						<b>if</b> (!<a href="#6cef55eec9c253a9" class="i method">WriteFlowDocument</a>(<span class="r5 r">xamlReader</span>, <span class="r4 r">htmlWriter</span>))
						{
							<b>return</b> <span class="s">&quot;&quot;</span>;
						}
					}
 
					<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r7 rd" class="r7 r">htmlString</span> = <span class="r3 r">htmlStringBuilder</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>();
					<b>return</b> <span class="r7 r">htmlString</span>;
				}
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Methods
 
        <span class="c">// ---------------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Private Methods</span>
        <span class="c">//</span>
        <span class="c">// ---------------------------------------------------------------------</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Processes a root level element of XAML (normally it&#39;s FlowDocument element).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlTextReader for a source xaml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">htmlWriter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlTextWriter producing resulting html</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="6cef55eec9c253a9" href="../R/6cef55eec9c253a9.html" target="n" data-glyph="76,1" class="i method">WriteFlowDocument</a>(<a href="@0@System.Xml/A.html#fc0e04cc62b78707" class="t t">XmlTextReader</a> <span id="r8 rd" class="r8 r">xamlReader</span>, <a href="@0@System.Xml/A.html#deba79d6386a7da8" class="t t">XmlTextWriter</a> <span id="r9 rd" class="r9 r">htmlWriter</span>)
        {
            <b>if</b> (!<a href="#86a4292bc6bb9126" class="i method">ReadNextToken</a>(<span class="r8 r">xamlReader</span>))
            {
                <span class="c">// Xaml content is empty - nothing to convert</span>
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r8 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> != <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a> || <span class="r8 r">xamlReader</span>.<a href="@0@System.Xml/A.html#f666b27714305669" class="i property">Name</a> != <span class="s">&quot;FlowDocument&quot;</span>)
            {
                <span class="c">// Root FlowDocument elemet is missing</span>
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// Create a buffer StringBuilder for collecting css properties for inline STYLE attributes</span>
            <span class="c">// on every element level (it will be re-initialized on every level).</span>
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r10 rd" class="r10 r">inlineStyle</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
 
            <span class="r9 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#1e9fb3346d2b323c" class="i method">WriteStartElement</a>(<span class="s">&quot;HTML&quot;</span>);
            <span class="r9 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#1e9fb3346d2b323c" class="i method">WriteStartElement</a>(<span class="s">&quot;BODY&quot;</span>);
 
            <a href="#a458a4f3f36e4753" class="i method">WriteFormattingProperties</a>(<span class="r8 r">xamlReader</span>, <span class="r9 r">htmlWriter</span>, <span class="r10 r">inlineStyle</span>);
 
            <a href="#f7aac288cfa295fa" class="i method">WriteElementContent</a>(<span class="r8 r">xamlReader</span>, <span class="r9 r">htmlWriter</span>, <span class="r10 r">inlineStyle</span>);
 
            <span class="r9 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#5aaf146a32f1cd45" class="i method">WriteEndElement</a>();
            <span class="r9 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#5aaf146a32f1cd45" class="i method">WriteEndElement</a>();
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads attributes of the current xaml element and converts</span>
        <span class="c">///</span><span class="c"> them into appropriate html attributes or css styles.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlTextReader which is expected to be at XmlNodeType.Element</span>
        <span class="c">///</span><span class="c"> (opening element tag) position.</span>
        <span class="c">///</span><span class="c"> The reader will remain at the same level after function complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">htmlWriter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlTextWriter for output html, which is expected to be in</span>
        <span class="c">///</span><span class="c"> after WriteStartElement state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">inlineStyle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> String builder for collecting css properties for inline STYLE attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="a458a4f3f36e4753" href="../R/a458a4f3f36e4753.html" target="n" data-glyph="76,1" class="i method">WriteFormattingProperties</a>(<a href="@0@System.Xml/A.html#fc0e04cc62b78707" class="t t">XmlTextReader</a> <span id="r11 rd" class="r11 r">xamlReader</span>, <a href="@0@System.Xml/A.html#deba79d6386a7da8" class="t t">XmlTextWriter</a> <span id="r12 rd" class="r12 r">htmlWriter</span>, <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r13 rd" class="r13 r">inlineStyle</span>)
        {
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> == <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a>);
 
            <span class="c">// Clear string builder for the inline style</span>
            <span class="r13 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#db619a22e1b3d912" class="i method">Remove</a>(0, <span class="r13 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#7d7729bd88adac53" class="i property">Length</a>);
 
            <b>if</b> (!<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#67a4d2500908ef4b" class="i property">HasAttributes</a>)
            {
                <b>return</b>;
            }
 
            <b>bool</b> <span id="r14 rd" class="r14 r">borderSet</span> = <b>false</b>;
 
            <b>while</b> (<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d02e1a47d541e9e1" class="i method">MoveToNextAttribute</a>())
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r15 rd" class="r15 r">css</span> = <b>null</b>;
 
                <b>switch</b> (<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#f666b27714305669" class="i property">Name</a>)
                {
                    <span class="c">// Character fomatting properties</span>
                    <span class="c">// ------------------------------</span>
                    <b>case</b> <span class="s">&quot;Background&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;background-color:&quot;</span> + <a href="#85fe9481488e3075" class="i method">ParseXamlColor</a>(<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontFamily&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;font-family:&quot;</span> + <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontStyle&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;font-style:&quot;</span> + <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontWeight&quot;</span>:
						<span class="r15 r">css</span> = <span class="s">&quot;font-weight:&quot;</span> + <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontStretch&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontSize&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;font-size:&quot;</span> + <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Foreground&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;color:&quot;</span> + <a href="#85fe9481488e3075" class="i method">ParseXamlColor</a>(<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TextDecorations&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;text-decoration:underline;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TextEffects&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Emphasis&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;StandardLigatures&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Variants&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Capitals&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Fraction&quot;</span>:
                        <b>break</b>;
 
                    <span class="c">// Paragraph formatting properties</span>
                    <span class="c">// -------------------------------</span>
                    <b>case</b> <span class="s">&quot;Padding&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;padding:&quot;</span> + <a href="#e931e5b10c193b26" class="i method">ParseXamlThickness</a>(<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Margin&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;margin:&quot;</span> + <a href="#e931e5b10c193b26" class="i method">ParseXamlThickness</a>(<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;BorderThickness&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;border-width:&quot;</span> + <a href="#e931e5b10c193b26" class="i method">ParseXamlThickness</a>(<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>) + <span class="s">&quot;;&quot;</span>;
                        <span class="r14 r">borderSet</span> = <b>true</b>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;BorderBrush&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;border-color:&quot;</span> + <a href="#85fe9481488e3075" class="i method">ParseXamlColor</a>(<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>) + <span class="s">&quot;;&quot;</span>;
                        <span class="r14 r">borderSet</span> = <b>true</b>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;LineHeight&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TextIndent&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;text-indent:&quot;</span> + <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TextAlignment&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;text-align:&quot;</span> + <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;IsKeptTogether&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;IsKeptWithNext&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;ColumnBreakBefore&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;PageBreakBefore&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FlowDirection&quot;</span>:
                        <b>break</b>;
 
                    <span class="c">// Table attributes</span>
                    <span class="c">// ----------------</span>
                    <b>case</b> <span class="s">&quot;Width&quot;</span>:
                        <span class="r15 r">css</span> = <span class="s">&quot;width:&quot;</span> + <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;ColumnSpan&quot;</span>:
                        <span class="r12 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#f31cd6ab33d4e860" class="i method">WriteAttributeString</a>(<span class="s">&quot;COLSPAN&quot;</span>, <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;RowSpan&quot;</span>:
                        <span class="r12 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#f31cd6ab33d4e860" class="i method">WriteAttributeString</a>(<span class="s">&quot;ROWSPAN&quot;</span>, <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>);
                        <b>break</b>;
 
					<span class="c">// Hyperlink Attributes</span>
					<b>case</b> <span class="s">&quot;NavigateUri&quot;</span> :
						<span class="r12 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#f31cd6ab33d4e860" class="i method">WriteAttributeString</a>(<span class="s">&quot;HREF&quot;</span>, <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>);
						<b>break</b>;
                }
 
                <b>if</b> (<span class="r15 r">css</span> != <b>null</b>)
                {
                    <span class="r13 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="r15 r">css</span>);
                }
            }
 
            <b>if</b> (<span class="r14 r">borderSet</span>)
            {
                <span class="r13 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;border-style:solid;mso-element:para-border-div;&quot;</span>);
            }
 
            <span class="c">// Return the xamlReader back to element level</span>
            <span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#9ad0d165b5d320d2" class="i method">MoveToElement</a>();
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r11 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> == <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a>);
        }
 
        <b>private static string</b> <a id="85fe9481488e3075" href="../R/85fe9481488e3075.html" target="n" data-glyph="76,1" class="i method">ParseXamlColor</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r16 rd" class="r16 r">color</span>)
        {
            <b>if</b> (<span class="r16 r">color</span>.<a href="@0@mscorlib/A.html#1c787ba07a7b11ab" class="i method">StartsWith</a>(<span class="s">&quot;#&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>))
            {
                <span class="c">// Remove transparancy value</span>
                <span class="r16 r">color</span> = <span class="s">&quot;#&quot;</span> + <span class="r16 r">color</span>.<a href="@0@mscorlib/A.html#882fa7998d6ca35a" class="i method">Substring</a>(3);
            }
            <b>return</b> <span class="r16 r">color</span>;
        }
 
        <b>private static string</b> <a id="e931e5b10c193b26" href="../R/e931e5b10c193b26.html" target="n" data-glyph="76,1" class="i method">ParseXamlThickness</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r17 rd" class="r17 r">thickness</span>)
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>[] <span id="r18 rd" class="r18 r">values</span> = <span class="r17 r">thickness</span>.<a href="@0@mscorlib/A.html#1c4a9dc78ba38999" class="i method">Split</a>(<span class="s">&#39;,&#39;</span>);
 
            <b>for</b> (<b>int</b> <span id="r19 rd" class="r19 r">i</span> = 0; <span class="r19 r">i</span> &lt; <span class="r18 r">values</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r19 r">i</span>++)
            {
                <b>double</b> <span id="r20 rd" class="r20 r">value</span>;
				<b>if</b> (<b>double</b>.<a href="@0@mscorlib/A.html#4decccd0a1012765" class="i method">TryParse</a>(<span class="r18 r">values</span>[<span class="r19 r">i</span>], <a href="@0@mscorlib/A.html#4523c5163ff35e41" class="t t">NumberStyles</a>.<a href="@0@mscorlib/A.html#0274ad40c9914548" class="i field">AllowDecimalPoint</a>, <a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>, <b>out</b> <span class="r20 r">value</span>))
                {
                    <span class="r18 r">values</span>[<span class="r19 r">i</span>] = <a href="@0@mscorlib/A.html#a4407e67b9a5afad" class="t t">Math</a>.<a href="@0@mscorlib/A.html#1841a5ce24ed9fb3" class="i method">Ceiling</a>(<span class="r20 r">value</span>).<a href="@0@mscorlib/A.html#102b12e1c4385406" class="i method">ToString</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                }
                <b>else</b>
                {
                    <span class="r18 r">values</span>[<span class="r19 r">i</span>] = <span class="s">&quot;1&quot;</span>;
                }
            }
 
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r21 rd" class="r21 r">cssThickness</span>;
            <b>switch</b> (<span class="r18 r">values</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)
            {
                <b>case</b> 1:
                    <span class="r21 r">cssThickness</span> = <span class="r17 r">thickness</span>;
                    <b>break</b>;
                <b>case</b> 2:
                    <span class="r21 r">cssThickness</span> = <span class="r18 r">values</span>[1] + <span class="s">&quot; &quot;</span> + <span class="r18 r">values</span>[0];
                    <b>break</b>;
                <b>case</b> 4:
                    <span class="r21 r">cssThickness</span> = <span class="r18 r">values</span>[1] + <span class="s">&quot; &quot;</span> + <span class="r18 r">values</span>[2] + <span class="s">&quot; &quot;</span> + <span class="r18 r">values</span>[3] + <span class="s">&quot; &quot;</span> + <span class="r18 r">values</span>[0];
                    <b>break</b>;
                <b>default</b>:
                    <span class="r21 r">cssThickness</span> = <span class="r18 r">values</span>[0];
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r21 r">cssThickness</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads a content of current xaml element, converts it</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlTextReader which is expected to be at XmlNodeType.Element</span>
        <span class="c">///</span><span class="c"> (opening element tag) position.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">htmlWriter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> May be null, in which case we are skipping the xaml element;</span>
        <span class="c">///</span><span class="c"> witout producing any output to html.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">inlineStyle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StringBuilder used for collecting css properties for inline STYLE attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="f7aac288cfa295fa" href="../R/f7aac288cfa295fa.html" target="n" data-glyph="76,1" class="i method">WriteElementContent</a>(<a href="@0@System.Xml/A.html#fc0e04cc62b78707" class="t t">XmlTextReader</a> <span id="r22 rd" class="r22 r">xamlReader</span>, <a href="@0@System.Xml/A.html#deba79d6386a7da8" class="t t">XmlTextWriter</a> <span id="r23 rd" class="r23 r">htmlWriter</span>, <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r24 rd" class="r24 r">inlineStyle</span>)
        {
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> == <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a>);
 
            <b>bool</b> <span id="r25 rd" class="r25 r">elementContentStarted</span> = <b>false</b>;
 
            <b>if</b> (<span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#fa0b031db95109bf" class="i property">IsEmptyElement</a>)
            {
                <b>if</b> (<span class="r23 r">htmlWriter</span> != <b>null</b> &amp;&amp; !<span class="r25 r">elementContentStarted</span> &amp;&amp; <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#7d7729bd88adac53" class="i property">Length</a> &gt; 0)
                {
                    <span class="c">// Output STYLE attribute and clear inlineStyle buffer.</span>
                    <span class="r23 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#f31cd6ab33d4e860" class="i method">WriteAttributeString</a>(<span class="s">&quot;STYLE&quot;</span>, <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>());
                    <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#db619a22e1b3d912" class="i method">Remove</a>(0, <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#7d7729bd88adac53" class="i property">Length</a>);
                }
                <span class="r25 r">elementContentStarted</span> = <b>true</b>;
            }
            <b>else</b>
            {
                <b>while</b> (<a href="#86a4292bc6bb9126" class="i method">ReadNextToken</a>(<span class="r22 r">xamlReader</span>) &amp;&amp; <span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> != <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#5771881560afff3b" class="i field">EndElement</a>)
                {
                    <b>switch</b> (<span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a>)
                    {
                        <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a>:
                            <b>if</b> (<span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#f666b27714305669" class="i property">Name</a>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;.&quot;</span>))
                            {
                                <a href="#d4acab742af9780a" class="i method">AddComplexProperty</a>(<span class="r22 r">xamlReader</span>, <span class="r24 r">inlineStyle</span>);
                            }
                            <b>else</b>
                            {
                                <b>if</b> (<span class="r23 r">htmlWriter</span> != <b>null</b> &amp;&amp; !<span class="r25 r">elementContentStarted</span> &amp;&amp; <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#7d7729bd88adac53" class="i property">Length</a> &gt; 0)
                                {
                                    <span class="c">// Output STYLE attribute and clear inlineStyle buffer.</span>
                                    <span class="r23 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#f31cd6ab33d4e860" class="i method">WriteAttributeString</a>(<span class="s">&quot;STYLE&quot;</span>, <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>());
                                    <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#db619a22e1b3d912" class="i method">Remove</a>(0, <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#7d7729bd88adac53" class="i property">Length</a>);
                                }
                                <span class="r25 r">elementContentStarted</span> = <b>true</b>;
                                <a href="#1ebedcbec2022a0c" class="i method">WriteElement</a>(<span class="r22 r">xamlReader</span>, <span class="r23 r">htmlWriter</span>, <span class="r24 r">inlineStyle</span>);
                            }
                            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> == <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#5771881560afff3b" class="i field">EndElement</a> || <span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> == <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a> &amp;&amp; <span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#fa0b031db95109bf" class="i property">IsEmptyElement</a>);
                            <b>break</b>;
                        <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#1057a5f8e27bfcb1" class="i field">Comment</a>:
                            <b>if</b> (<span class="r23 r">htmlWriter</span> != <b>null</b>)
                            {
                                <b>if</b> (!<span class="r25 r">elementContentStarted</span> &amp;&amp; <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#7d7729bd88adac53" class="i property">Length</a> &gt; 0)
                                {
                                    <span class="r23 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#f31cd6ab33d4e860" class="i method">WriteAttributeString</a>(<span class="s">&quot;STYLE&quot;</span>, <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>());
                                }
                                <span class="r23 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#be30e538654a6f24" class="i method">WriteComment</a>(<span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>);
                            }
                            <span class="r25 r">elementContentStarted</span> = <b>true</b>;
                            <b>break</b>;
                        <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#1c9e35f51354e6c8" class="i field">CDATA</a>:
                        <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#3b01892862eda5b3" class="i field">Text</a>:
                        <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#189c4047f37cd78c" class="i field">SignificantWhitespace</a>:
                            <b>if</b> (<span class="r23 r">htmlWriter</span> != <b>null</b>)
                            {
                                <b>if</b> (!<span class="r25 r">elementContentStarted</span> &amp;&amp; <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#7d7729bd88adac53" class="i property">Length</a> &gt; 0)
                                {
                                    <span class="r23 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#f31cd6ab33d4e860" class="i method">WriteAttributeString</a>(<span class="s">&quot;STYLE&quot;</span>, <span class="r24 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>());
                                }
                                <span class="r23 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#5a67fa73534f66c3" class="i method">WriteString</a>(<span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#d12a5166b72fa218" class="i property">Value</a>);
                            }
                            <span class="r25 r">elementContentStarted</span> = <b>true</b>;
                            <b>break</b>;
                    }
                }
 
                <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r22 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> == <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#5771881560afff3b" class="i field">EndElement</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Conberts an element notation of complex property into</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> On entry this XmlTextReader must be on Element start tag;</span>
        <span class="c">///</span><span class="c"> on exit - on EndElement tag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">inlineStyle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StringBuilder containing a value for STYLE attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="d4acab742af9780a" href="../R/d4acab742af9780a.html" target="n" data-glyph="76,1" class="i method">AddComplexProperty</a>(<a href="@0@System.Xml/A.html#fc0e04cc62b78707" class="t t">XmlTextReader</a> <span id="r26 rd" class="r26 r">xamlReader</span>, <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r27 rd" class="r27 r">inlineStyle</span>)
        {
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r26 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> == <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a>);
 
            <b>if</b> (<span class="r27 r">inlineStyle</span> != <b>null</b> &amp;&amp; <span class="r26 r">xamlReader</span>.<a href="@0@System.Xml/A.html#f666b27714305669" class="i property">Name</a>.<a href="@0@mscorlib/A.html#41a31e4feec3ef41" class="i method">EndsWith</a>(<span class="s">&quot;.TextDecorations&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#6c3139b940557bf9" class="i field">OrdinalIgnoreCase</a>))
            {
                <span class="r27 r">inlineStyle</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;text-decoration:underline;&quot;</span>);
            }
 
            <span class="c">// Skip the element representing the complex property</span>
            <a href="#f7aac288cfa295fa" class="i method">WriteElementContent</a>(<span class="r26 r">xamlReader</span>, <span class="c">/*htmlWriter:*/</span><b>null</b>, <span class="c">/*inlineStyle:*/</span><b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a xaml element into an appropriate html element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> On entry this XmlTextReader must be on Element start tag;</span>
        <span class="c">///</span><span class="c"> on exit - on EndElement tag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">htmlWriter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> May be null, in which case we are skipping xaml content</span>
        <span class="c">///</span><span class="c"> without producing any html output</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">inlineStyle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StringBuilder used for collecting css properties for inline STYLE attributes on every level.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="1ebedcbec2022a0c" href="../R/1ebedcbec2022a0c.html" target="n" data-glyph="76,1" class="i method">WriteElement</a>(<a href="@0@System.Xml/A.html#fc0e04cc62b78707" class="t t">XmlTextReader</a> <span id="r28 rd" class="r28 r">xamlReader</span>, <a href="@0@System.Xml/A.html#deba79d6386a7da8" class="t t">XmlTextWriter</a> <span id="r29 rd" class="r29 r">htmlWriter</span>, <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r30 rd" class="r30 r">inlineStyle</span>)
        {
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<span class="r28 r">xamlReader</span>.<a href="@0@System.Xml/A.html#4d8c35c8f5d1dbaa" class="i property">NodeType</a> == <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a>);
 
            <b>if</b> (<span class="r29 r">htmlWriter</span> == <b>null</b>)
            {
                <span class="c">// Skipping mode; recurse into the xaml element without any output</span>
                <a href="#f7aac288cfa295fa" class="i method">WriteElementContent</a>(<span class="r28 r">xamlReader</span>, <span class="c">/*htmlWriter:*/</span><b>null</b>, <b>null</b>);
            }
            <b>else</b>
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r31 rd" class="r31 r">htmlElementName</span> = <b>null</b>;
 
                <b>switch</b> (<span class="r28 r">xamlReader</span>.<a href="@0@System.Xml/A.html#f666b27714305669" class="i property">Name</a>)
                {
                    <b>case</b> <span class="s">&quot;Run&quot;</span> :
                    <b>case</b> <span class="s">&quot;Span&quot;</span>:
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;SPAN&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;InlineUIContainer&quot;</span>:
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;SPAN&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Bold&quot;</span>:
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;B&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Italic&quot;</span> :
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;I&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Paragraph&quot;</span> :
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;P&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;BlockUIContainer&quot;</span>:
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;DIV&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Section&quot;</span>:
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;DIV&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Table&quot;</span>:
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;TABLE&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TableColumn&quot;</span>:
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;COL&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TableRowGroup&quot;</span> :
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;TBODY&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TableRow&quot;</span> :
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;TR&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TableCell&quot;</span> :
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;TD&quot;</span>;						
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;List&quot;</span> :
                        <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r32 rd" class="r32 r">marker</span> = <span class="r28 r">xamlReader</span>.<a href="@0@System.Xml/A.html#ce5104b42e00c5ae" class="i method">GetAttribute</a>(<span class="s">&quot;MarkerStyle&quot;</span>);
                        <b>if</b> (<span class="r32 r">marker</span> == <b>null</b> || <span class="r32 r">marker</span> == <span class="s">&quot;None&quot;</span> || <span class="r32 r">marker</span> == <span class="s">&quot;Disc&quot;</span> || <span class="r32 r">marker</span> == <span class="s">&quot;Circle&quot;</span> || <span class="r32 r">marker</span> == <span class="s">&quot;Square&quot;</span> || <span class="r32 r">marker</span> == <span class="s">&quot;Box&quot;</span>)
							<span class="r31 r">htmlElementName</span> = <span class="s">&quot;UL&quot;</span>;
						<b>else</b>
                            <span class="r31 r">htmlElementName</span> = <span class="s">&quot;OL&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;ListItem&quot;</span> :
                        <span class="r31 r">htmlElementName</span> = <span class="s">&quot;LI&quot;</span>;
                        <b>break</b>;
					<b>case</b> <span class="s">&quot;Hyperlink&quot;</span> :
						<span class="r31 r">htmlElementName</span> = <span class="s">&quot;A&quot;</span>;
						<b>break</b>;
					<b>case</b> <span class="s">&quot;LineBreak&quot;</span> :
						<span class="r29 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#e6df81851f147562" class="i method">WriteRaw</a>(<span class="s">&quot;&lt;BR /&gt;&quot;</span>);
						<b>break</b>;
                    <b>default</b> :
                        <span class="r31 r">htmlElementName</span> = <b>null</b>; <span class="c">// Ignore the element</span>
                        <b>break</b>;
                }
 
                <b>if</b> (<span class="r29 r">htmlWriter</span> != <b>null</b> &amp;&amp; !<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r31 r">htmlElementName</span>))
                {
                    <span class="r29 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#1e9fb3346d2b323c" class="i method">WriteStartElement</a>(<span class="r31 r">htmlElementName</span>);
 
                    <a href="#a458a4f3f36e4753" class="i method">WriteFormattingProperties</a>(<span class="r28 r">xamlReader</span>, <span class="r29 r">htmlWriter</span>, <span class="r30 r">inlineStyle</span>);
 
                    <a href="#f7aac288cfa295fa" class="i method">WriteElementContent</a>(<span class="r28 r">xamlReader</span>, <span class="r29 r">htmlWriter</span>, <span class="r30 r">inlineStyle</span>);
 
                    <span class="r29 r">htmlWriter</span>.<a href="@0@System.Xml/A.html#5aaf146a32f1cd45" class="i method">WriteEndElement</a>();
                }
                <b>else</b>
                {
                    <span class="c">// Skip this unrecognized xaml element</span>
                    <a href="#f7aac288cfa295fa" class="i method">WriteElementContent</a>(<span class="r28 r">xamlReader</span>, <span class="c">/*htmlWriter:*/</span><b>null</b>, <b>null</b>);
                }
            }
        }
 
        <span class="c">// Reader advance helpers</span>
		<span class="c">// ----------------------</span>
				 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads several items from xamlReader skipping all non-significant stuff.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlTextReader from tokens are being read.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if new token is available; false if end of stream reached.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<b>private static bool</b> <a id="86a4292bc6bb9126" href="../R/86a4292bc6bb9126.html" target="n" data-glyph="76,1" class="i method">ReadNextToken</a>(<a href="@0@System.Xml/A.html#086471e5cca0825f" class="t t">XmlReader</a> <span id="r33 rd" class="r33 r">xamlReader</span>)
		{
			<b>while</b> (<span class="r33 r">xamlReader</span>.<a href="@0@System.Xml/A.html#090de36eee7e315a" class="i method">Read</a>())
			{
				<a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#4f55cf5792dfc5e6" class="i method">Assert</a>(<span class="r33 r">xamlReader</span>.<a href="@0@System.Xml/A.html#83b4fe6e83af9090" class="i property">ReadState</a> == <a href="@0@System.Xml/A.html#aa34e54fa5d9e054" class="t t">ReadState</a>.<a href="@0@System.Xml/A.html#05fd015e6a599f13" class="i field">Interactive</a>, <span class="s">&quot;Reader is expected to be in Interactive state (&quot;</span> + <span class="r33 r">xamlReader</span>.<a href="@0@System.Xml/A.html#83b4fe6e83af9090" class="i property">ReadState</a> + <span class="s">&quot;)&quot;</span>);
				<b>switch</b> (<span class="r33 r">xamlReader</span>.<a href="@0@System.Xml/A.html#f6a1bba392856338" class="i property">NodeType</a>)
				{
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#53e0732704d796d8" class="i field">Element</a>: 
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#5771881560afff3b" class="i field">EndElement</a>:
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#c836c18361be0502" class="i field">None</a>:
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#1c9e35f51354e6c8" class="i field">CDATA</a>:
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#3b01892862eda5b3" class="i field">Text</a>:
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#189c4047f37cd78c" class="i field">SignificantWhitespace</a>:
					    <b>return</b> <b>true</b>;
 
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#04f128943244abce" class="i field">Whitespace</a>:
					    <b>if</b> (<span class="r33 r">xamlReader</span>.<a href="@0@System.Xml/A.html#f4a7718319169d37" class="i property">XmlSpace</a> == <a href="@0@System.Xml/A.html#eae9e92bee351c10" class="t t">XmlSpace</a>.<a href="@0@System.Xml/A.html#22fd78fadad59b25" class="i field">Preserve</a>)
					    {
						    <b>return</b> <b>true</b>;
					    }
					    <span class="c">// ignore insignificant whitespace</span>
					    <b>break</b>;
 
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#a23bca979f9f5a71" class="i field">EndEntity</a>:
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#cf474815abac9533" class="i field">EntityReference</a>:
                        <span class="c">//  Implement entity reading</span>
					    <span class="c">//xamlReader.ResolveEntity();</span>
					    <span class="c">//xamlReader.Read();</span>
					    <span class="c">//ReadChildNodes( parent, parentBaseUri, xamlReader, positionInfo);</span>
                        <b>break</b>; <span class="c">// for now we ignore entities as insignificant stuff</span>
 
                    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#1057a5f8e27bfcb1" class="i field">Comment</a>:
                        <b>return</b> <b>true</b>;
                    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#de7f298d17b865f0" class="i field">ProcessingInstruction</a>:
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#409d4342779b0d51" class="i field">DocumentType</a>:
				    <b>case</b> <a href="@0@System.Xml/A.html#8c138925ba744f20" class="t t">XmlNodeType</a>.<a href="@0@System.Xml/A.html#8f256b42e74805df" class="i field">XmlDeclaration</a>:
				    <b>default</b>:
					    <span class="c">// Ignorable stuff</span>
					    <b>break</b>;
				}
            }
            <b>return</b> <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods
 
        <span class="c">// ---------------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Private Fields</span>
        <span class="c">//</span>
        <span class="c">// ---------------------------------------------------------------------</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Fields
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Fields
    }
}
</pre></td></tr></table></div></body></html>
