<!DOCTYPE html>
<html><head><title>App.xaml.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(110);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#RibbonApp/App.xaml.cs" target="_top">App.xaml.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#RibbonApp" target="_top">HelpProjects\WPF-MAIN\WPFprism\RibbonApp\RibbonApp\RibbonApp.csproj</a> (RibbonApp)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Threading</span>;

<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Extensions</span>.<span class="i n">Configuration</span>;

<b>using</b> <span class="i n">Prism</span>.<span class="i n">Ioc</span>;
<b>using</b> <span class="i n">Prism</span>.<span class="i n">Mvvm</span>;
<b>using</b> <span class="i n">Prism</span>.<span class="i n">Unity</span>;

<b>using</b> <span class="i n">RibbonApp</span>.<span class="i n">Constants</span>;
<b>using</b> <span class="i n">RibbonApp</span>.<span class="i n">Contracts</span>.<span class="i n">Services</span>;
<b>using</b> <span class="i n">RibbonApp</span>.<span class="i n">Core</span>.<span class="i n">Contracts</span>.<span class="i n">Services</span>;
<b>using</b> <span class="i n">RibbonApp</span>.<span class="i n">Core</span>.<span class="i n">Services</span>;
<b>using</b> <span class="i n">RibbonApp</span>.<span class="i n">Models</span>;
<b>using</b> <span class="i n">RibbonApp</span>.<span class="i n">Services</span>;
<b>using</b> <span class="i n">RibbonApp</span>.<span class="i n">ViewModels</span>;
<b>using</b> <span class="i n">RibbonApp</span>.<span class="i n">Views</span>;

<b>namespace</b> <span class="i n">RibbonApp</span>
{
    <b>public</b> <a href="P/90816a25f6118122.html" target="s" class="k">partial</a> <b>class</b> <a id="90816a25f6118122" href="R/90816a25f6118122.html" target="n" data-glyph="0,0" class="t t">App</a> : <span class="t t">PrismApplication</span>
    {
        <b>private string</b>[] <a id="c783b3d2cbd928e5" href="R/c783b3d2cbd928e5.html" target="n" data-glyph="46,1" class="i field">_startUpArgs</a>;

        <b>public</b> <a id="6a509a9543e20625" href="R/6a509a9543e20625.html" target="n" data-glyph="72,1" class="t constructor">App</a>()
        {
        }

        <b>protected override</b> <a href="@0@PresentationFramework/A.html#e438dc91640a8d15" class="t t">Window</a> <a id="ef20ef4382c5e978" href="R/ef20ef4382c5e978.html" target="n" data-glyph="75,1" class="i method">CreateShell</a>()
            =&gt; <span class="i property">Container</span>.<span class="i method">Resolve</span>&lt;<a href="P/42b9849b3fbd3a5d.html#42b9849b3fbd3a5d" class="t t">ShellWindow</a>&gt;();

        <b>protected override async void</b> <a id="8c0ea2c3c6e0c028" href="R/8c0ea2c3c6e0c028.html" target="n" data-glyph="75,1" class="i method">OnInitialized</a>()
        {
            <a href="Contracts/Services/IPersistAndRestoreService.cs.html#5c99fd088dae41ee" class="k">var</a> <span id="r0 rd" class="r0 r">persistAndRestoreService</span> = <span class="i property">Container</span>.<span class="i method">Resolve</span>&lt;<a href="Contracts/Services/IPersistAndRestoreService.cs.html#5c99fd088dae41ee" class="t t">IPersistAndRestoreService</a>&gt;();
            <span class="r0 r">persistAndRestoreService</span>.<a href="Contracts/Services/IPersistAndRestoreService.cs.html#20a31c6d44e995d3" class="i method">RestoreData</a>();

            <a href="Contracts/Services/IThemeSelectorService.cs.html#ca4d517f21e348b8" class="k">var</a> <span id="r1 rd" class="r1 r">themeSelectorService</span> = <span class="i property">Container</span>.<span class="i method">Resolve</span>&lt;<a href="Contracts/Services/IThemeSelectorService.cs.html#ca4d517f21e348b8" class="t t">IThemeSelectorService</a>&gt;();
            <span class="r1 r">themeSelectorService</span>.<a href="Contracts/Services/IThemeSelectorService.cs.html#5320d736e496fdf6" class="i method">SetTheme</a>();

            <b>base</b>.<span class="i method">OnInitialized</span>();
            <b>await</b> <a href="@1@System.Runtime/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@1@System.Runtime/A.html#66f1c3e3e272f591" class="i property">CompletedTask</a>;
        }

        <b>protected override void</b> <a id="bdf2f1960bba6c12" href="R/bdf2f1960bba6c12.html" target="n" data-glyph="75,1" class="i method">OnStartup</a>(<a href="@0@PresentationFramework/A.html#062b94c15f90a8f0" class="t t">StartupEventArgs</a> <span id="r2 rd" class="r2 r">e</span>)
        {
            <a href="#c783b3d2cbd928e5" class="i field">_startUpArgs</a> = <span class="r2 r">e</span>.<a href="@0@PresentationFramework/A.html#bb5be4b459319dca" class="i property">Args</a>;
            <b>base</b>.<span class="i method">OnStartup</span>(<span class="r2 r">e</span>);
        }

        <b>protected override void</b> <a id="7053c138bc3ace6b" href="R/7053c138bc3ace6b.html" target="n" data-glyph="75,1" class="i method">RegisterTypes</a>(<span class="t t">IContainerRegistry</span> <span id="r3 rd" class="r3 r">containerRegistry</span>)
        {
            <span class="c">// Core Services</span>
            <span class="r3 r">containerRegistry</span>.<span class="i method">Register</span>&lt;<a href="/RibbonApp.Core/A.html#61bac21eef68c4ae" class="t t">IFileService</a>, <a href="/RibbonApp.Core/A.html#89f065239bc8513c" class="t t">FileService</a>&gt;();

            <span class="c">// App Services</span>
            <span class="r3 r">containerRegistry</span>.<span class="i method">Register</span>&lt;<a href="Contracts/Services/IPersistAndRestoreService.cs.html#5c99fd088dae41ee" class="t t">IPersistAndRestoreService</a>, <a href="Services/PersistAndRestoreService.cs.html#823c422e022e7201" class="t t">PersistAndRestoreService</a>&gt;();
            <span class="r3 r">containerRegistry</span>.<span class="i method">Register</span>&lt;<a href="Contracts/Services/IThemeSelectorService.cs.html#ca4d517f21e348b8" class="t t">IThemeSelectorService</a>, <a href="Services/ThemeSelectorService.cs.html#97bde065e8c8250a" class="t t">ThemeSelectorService</a>&gt;();
            <span class="r3 r">containerRegistry</span>.<span class="i method">Register</span>&lt;<a href="Contracts/Services/ISystemService.cs.html#45f754f8679ac175" class="t t">ISystemService</a>, <a href="Services/SystemService.cs.html#7d25236e833e243e" class="t t">SystemService</a>&gt;();
            <span class="r3 r">containerRegistry</span>.<span class="i method">Register</span>&lt;<a href="/RibbonApp.Core/A.html#fca518a996c996bd" class="t t">ISampleDataService</a>, <a href="/RibbonApp.Core/A.html#995894cff9765ff8" class="t t">SampleDataService</a>&gt;();
            <span class="r3 r">containerRegistry</span>.<span class="i method">RegisterSingleton</span>&lt;<a href="Contracts/Services/IRightPaneService.cs.html#5aa189ac770375f1" class="t t">IRightPaneService</a>, <a href="Services/RightPaneService.cs.html#cfa1f321cccd8162" class="t t">RightPaneService</a>&gt;();

            <span class="c">// Views</span>
            <span class="r3 r">containerRegistry</span>.<span class="i method">RegisterForNavigation</span>&lt;<a href="P/df5bc0087e27ed28.html#df5bc0087e27ed28" class="t t">SettingsPage</a>, <a href="ViewModels/SettingsViewModel.cs.html#1fd43d5c097608c2" class="t t">SettingsViewModel</a>&gt;(<a href="Constants/PageKeys.cs.html#cc0a3cadb8286d00" class="t t">PageKeys</a>.<a href="Constants/PageKeys.cs.html#d96e3e316e01239c" class="i field">Settings</a>);
            <span class="r3 r">containerRegistry</span>.<span class="i method">RegisterForNavigation</span>&lt;<a href="P/29b1e1fbeb2772d6.html#29b1e1fbeb2772d6" class="t t">WebViewPage</a>, <a href="ViewModels/WebViewViewModel.cs.html#ed4fd03f368417a8" class="t t">WebViewViewModel</a>&gt;(<a href="Constants/PageKeys.cs.html#cc0a3cadb8286d00" class="t t">PageKeys</a>.<a href="Constants/PageKeys.cs.html#63f6f3ab2be6a5f8" class="i field">WebView</a>);
            <span class="r3 r">containerRegistry</span>.<span class="i method">RegisterForNavigation</span>&lt;<a href="P/e7f67494d5f4db94.html#e7f67494d5f4db94" class="t t">MasterDetailPage</a>, <a href="ViewModels/MasterDetailViewModel.cs.html#5b3808a659ec01f8" class="t t">MasterDetailViewModel</a>&gt;(<a href="Constants/PageKeys.cs.html#cc0a3cadb8286d00" class="t t">PageKeys</a>.<a href="Constants/PageKeys.cs.html#a25c33f0a0471a32" class="i field">MasterDetail</a>);
            <span class="r3 r">containerRegistry</span>.<span class="i method">RegisterForNavigation</span>&lt;<a href="P/1910cf00c97e0829.html#1910cf00c97e0829" class="t t">MainPage</a>, <a href="ViewModels/MainViewModel.cs.html#53bcbc5b9afd5fb4" class="t t">MainViewModel</a>&gt;(<a href="Constants/PageKeys.cs.html#cc0a3cadb8286d00" class="t t">PageKeys</a>.<a href="Constants/PageKeys.cs.html#6780eb6faab6c06d" class="i field">Main</a>);
            <span class="r3 r">containerRegistry</span>.<span class="i method">RegisterForNavigation</span>&lt;<a href="P/42b9849b3fbd3a5d.html#42b9849b3fbd3a5d" class="t t">ShellWindow</a>, <a href="ViewModels/ShellViewModel.cs.html#50d29670c9fa6634" class="t t">ShellViewModel</a>&gt;();

            <span class="c">// Configuration</span>
            <b>var</b> <span id="r4 rd" class="r4 r">configuration</span> = <a href="#71c2d7066e2e0443" class="i method">BuildConfiguration</a>();
            <a href="Models/AppConfig.cs.html#0836c4951861f85a" class="k">var</a> <span id="r5 rd" class="r5 r">appConfig</span> = <span class="r4 r">configuration</span>
                .<span class="i method">GetSection</span>(<b>nameof</b>(<a href="Models/AppConfig.cs.html#0836c4951861f85a" class="t t">AppConfig</a>))
                .<span class="i method">Get</span>&lt;<a href="Models/AppConfig.cs.html#0836c4951861f85a" class="t t">AppConfig</a>&gt;();

            <span class="c">// Register configurations to IoC</span>
            <span class="r3 r">containerRegistry</span>.<span class="i method">RegisterInstance</span>&lt;<span class="t t">IConfiguration</span>&gt;(<span class="r4 r">configuration</span>);
            <span class="r3 r">containerRegistry</span>.<span class="i method">RegisterInstance</span>&lt;<a href="Models/AppConfig.cs.html#0836c4951861f85a" class="t t">AppConfig</a>&gt;(<span class="r5 r">appConfig</span>);
        }

        <b>private</b> <span class="t t">IConfiguration</span> <a id="71c2d7066e2e0443" href="R/71c2d7066e2e0443.html" target="n" data-glyph="76,1" class="i method">BuildConfiguration</a>()
        {
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r6 rd" class="r6 r">appLocation</span> = <span class="t t">Path</span>.<span class="i method">GetDirectoryName</span>(<a href="@1@System.Runtime/A.html#73b5be5e9c2474b2" class="t t">Assembly</a>.<a href="@1@System.Runtime/A.html#0b58cbf47b813b13" class="i method">GetEntryAssembly</a>().<a href="@1@System.Runtime/A.html#3faa3e0e41d8868b" class="i property">Location</a>);
            <b>return</b> <b>new</b> <span class="t constructor">ConfigurationBuilder</span>()
                .<span class="i method">SetBasePath</span>(<span class="r6 r">appLocation</span>)
                .<span class="i method">AddJsonFile</span>(<span class="s">&quot;appsettings.json&quot;</span>)
                .<span class="i method">AddCommandLine</span>(<a href="#c783b3d2cbd928e5" class="i field">_startUpArgs</a>)
                .<span class="i method">Build</span>();
        }

        <b>private void</b> <a id="a783308357324092" href="R/a783308357324092.html" target="n" data-glyph="76,1" class="i method">OnExit</a>(<b>object</b> <span id="r7 rd" class="r7 r">sender</span>, <a href="@0@PresentationFramework/A.html#ff645319584dbd6e" class="t t">ExitEventArgs</a> <span id="r8 rd" class="r8 r">e</span>)
        {
            <a href="Contracts/Services/IPersistAndRestoreService.cs.html#5c99fd088dae41ee" class="k">var</a> <span id="r9 rd" class="r9 r">persistAndRestoreService</span> = <span class="i property">Container</span>.<span class="i method">Resolve</span>&lt;<a href="Contracts/Services/IPersistAndRestoreService.cs.html#5c99fd088dae41ee" class="t t">IPersistAndRestoreService</a>&gt;();
            <span class="r9 r">persistAndRestoreService</span>.<a href="Contracts/Services/IPersistAndRestoreService.cs.html#4824c14a999f8f9e" class="i method">PersistData</a>();
        }

        <b>private void</b> <a id="800d55b1777da801" href="R/800d55b1777da801.html" target="n" data-glyph="76,1" class="i method">OnDispatcherUnhandledException</a>(<b>object</b> <span id="r10 rd" class="r10 r">sender</span>, <a href="@0@WindowsBase/A.html#4e3a8161c594e859" class="t t">DispatcherUnhandledExceptionEventArgs</a> <span id="r11 rd" class="r11 r">e</span>)
        {
            <span class="c">// TODO WTS: Please handle the exception as appropriate to your scenario</span>
            <span class="c">// For more info see https://docs.microsoft.com/dotnet/api/system.windows.application.dispatcherunhandledexception?view=netcore-3.0</span>

            <span class="c">// e.Handled = true;</span>
        }
    }
}
</pre></td></tr></table></div></body></html>
