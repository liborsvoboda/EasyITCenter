<!DOCTYPE html>
<html><head><title>Calendar.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(85);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EASYTools.Calendar/Calendar.cs" target="_top">Calendar.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EASYTools.Calendar" target="_top">..\..\..\EASY-TOOLS\EASYTools.Calendar\EASYTools.Calendar.csproj</a> (EASYTools.Calendar)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Controls</span>;
 
<b>namespace</b> <span class="i n">EASYTools</span>.<span class="i n">Calendar</span>
{
    <b>public class</b> <a id="3cce9a97761d5c9b" href="R/3cce9a97761d5c9b.html" target="n" data-glyph="0,0" class="t t">Calendar</a> : <a href="@0@PresentationFramework/A.html#6750b721a2294fc5" class="t t">Control</a>
    {
        <b>public</b> <a href="@0@System/A.html#f63ea2601f5edbbb" class="t t">ObservableCollection</a>&lt;<a href="Day.cs.html#7646bd068f5f038b" class="t t">Day</a>&gt; <a id="341fd342d3d7bfcc" href="R/341fd342d3d7bfcc.html" target="n" data-glyph="102,1" class="i property">Days</a> { <b>get</b>; <b>set</b>; }
        <b>public</b> <a href="@0@System/A.html#f63ea2601f5edbbb" class="t t">ObservableCollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; <a id="a7fa6741490a3266" href="R/a7fa6741490a3266.html" target="n" data-glyph="102,1" class="i property">DayNames</a> { <b>get</b>; <b>set</b>; }
        <b>public static readonly</b> <a href="@0@WindowsBase/A.html#4a20845df0b86ddd" class="t t">DependencyProperty</a> <a id="5769d05abf408f9a" href="R/5769d05abf408f9a.html" target="n" data-glyph="42,1" class="i field">CurrentDateProperty</a> = <a href="@0@WindowsBase/A.html#4a20845df0b86ddd" class="t t">DependencyProperty</a>.<a href="@0@WindowsBase/A.html#28c81133f2c673fb" class="i method">Register</a>(<span class="s">&quot;CurrentDate&quot;</span>, <b>typeof</b> (<a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>), <b>typeof</b> (<a href="#3cce9a97761d5c9b" class="t t">Calendar</a>));
 
        <b>public event</b> <a href="@0@mscorlib/A.html#96ed969784b9d510" class="t t">EventHandler</a>&lt;<a href="#67930a58a3275fd8" class="t t">DayChangedEventArgs</a>&gt; <a id="5ecc3060436712cd" href="R/5ecc3060436712cd.html" target="n" data-glyph="30,1" class="i">DayChanged</a>;
 
        <b>public</b> <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a> <a id="367b97339b8ab84d" href="R/367b97339b8ab84d.html" target="n" data-glyph="102,1" class="i property">CurrentDate</a>
        {
            <b>get</b> { <b>return</b> (<a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>) <a href="@0@WindowsBase/A.html#0e1012f338283c7a" class="i method">GetValue</a>(<a href="#5769d05abf408f9a" class="i field">CurrentDateProperty</a>); }
            <b>set</b> { <a href="@0@WindowsBase/A.html#b1809fe135a72ec5" class="i method">SetValue</a>(<a href="#5769d05abf408f9a" class="i field">CurrentDateProperty</a>, <b>value</b>); }
        }
 
        <b>static</b> <a id="2e3f9611d4bd9f09" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">Calendar</a>()
        {
            <a href="@0@PresentationFramework/A.html#6339cc8ec3e1311a" class="i field">DefaultStyleKeyProperty</a>.<a href="@0@WindowsBase/A.html#fe43392fad81405d" class="i method">OverrideMetadata</a>(<b>typeof</b> (<a href="#3cce9a97761d5c9b" class="t t">Calendar</a>), <b>new</b> <a href="@0@PresentationFramework/A.html#69f23b8966049b7c" class="t constructor">FrameworkPropertyMetadata</a>(<b>typeof</b> (<a href="#3cce9a97761d5c9b" class="t t">Calendar</a>)));
        }
 
        <b>public</b> <a id="04c7ae7d134f2b68" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">Calendar</a>()
        {
            <a href="@0@PresentationFramework/A.html#e4aaca7514916173" class="i property">DataContext</a> = <a href="#3cce9a97761d5c9b" class="k">this</a>;
            <a href="#367b97339b8ab84d" class="i property">CurrentDate</a> = <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>.<a href="@0@mscorlib/A.html#013b44cc4074ffd2" class="i property">Today</a>;
 
            <span class="c">//this won&#39;t work in Australia where they start the week with Monday. So remember to test in other </span>
            <span class="c">//places if you plan on using it. </span>
            <a href="#a7fa6741490a3266" class="i property">DayNames</a> = <b>new</b> <a href="@0@System/A.html#a0b7a0640c9feb02" class="t constructor">ObservableCollection</a>&lt;<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>&gt; {<span class="s">&quot;Sunday&quot;</span>, <span class="s">&quot;Monday&quot;</span>, <span class="s">&quot;Tuesday&quot;</span>, <span class="s">&quot;Wednesday&quot;</span>, <span class="s">&quot;Thursday&quot;</span>, <span class="s">&quot;Friday&quot;</span>, <span class="s">&quot;Saturday&quot;</span>};
 
            <a href="#341fd342d3d7bfcc" class="i property">Days</a> = <b>new</b> <a href="@0@System/A.html#a0b7a0640c9feb02" class="t constructor">ObservableCollection</a>&lt;<a href="Day.cs.html#7646bd068f5f038b" class="t t">Day</a>&gt;();
            <a href="#8d857bd7507dad60" class="i method">BuildCalendar</a>(<a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>.<a href="@0@mscorlib/A.html#013b44cc4074ffd2" class="i property">Today</a>);
        }
 
        <b>public void</b> <a id="8d857bd7507dad60" href="R/8d857bd7507dad60.html" target="n" data-glyph="72,1" class="i method">BuildCalendar</a>(<a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a> <span id="r0 rd" class="r0 r">targetDate</span>)
        {
            <a href="#341fd342d3d7bfcc" class="i property">Days</a>.<a href="@0@mscorlib/A.html#1c7184c9f3526d9d" class="i method">Clear</a>();
 
            <span class="c">//Calculate when the first day of the month is and work out an </span>
            <span class="c">//offset so we can fill in any boxes before that.</span>
            <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a> <span id="r1 rd" class="r1 r">d</span> = <b>new</b> <a href="@0@mscorlib/A.html#8a120337def0a93a" class="t constructor">DateTime</a>(<span class="r0 r">targetDate</span>.<a href="@0@mscorlib/A.html#5a53e71f9b1c7639" class="i property">Year</a>, <span class="r0 r">targetDate</span>.<a href="@0@mscorlib/A.html#df67ef2b2c574ba6" class="i property">Month</a>, 1);
            <b>int</b> <span id="r2 rd" class="r2 r">offset</span> = <a href="#56d401822d7fd079" class="i method">DayOfWeekNumber</a>(<span class="r1 r">d</span>.<a href="@0@mscorlib/A.html#e9d121a7c5cf80a8" class="i property">DayOfWeek</a>);
            <b>if</b> (<span class="r2 r">offset</span> != 1) <span class="r1 r">d</span> = <span class="r1 r">d</span>.<a href="@0@mscorlib/A.html#f5cb6edd98581ca2" class="i method">AddDays</a>(-<span class="r2 r">offset</span>);
 
            <span class="c">//Show 6 weeks each with 7 days = 42</span>
            <b>for</b> (<b>int</b> <span id="r3 rd" class="r3 r">box</span> = 1; <span class="r3 r">box</span> &lt;= 42; <span class="r3 r">box</span>++)
            {
                <a href="Day.cs.html#7646bd068f5f038b" class="t t">Day</a> <span id="r4 rd" class="r4 r">day</span> = <b>new</b> <a href="Day.cs.html#7646bd068f5f038b" class="t constructor">Day</a> {<a href="Day.cs.html#5db2f8d2eff44ecb" class="i property">Date</a> = <span class="r1 r">d</span>, <a href="Day.cs.html#ba4bac01edc5d34a" class="i property">Enabled</a> = <b>true</b>, <a href="Day.cs.html#5a9342787c8358d3" class="i property">IsTargetMonth</a> = <span class="r0 r">targetDate</span>.<a href="@0@mscorlib/A.html#df67ef2b2c574ba6" class="i property">Month</a> == <span class="r1 r">d</span>.<a href="@0@mscorlib/A.html#df67ef2b2c574ba6" class="i property">Month</a>};
                <span class="r4 r">day</span>.<a href="Day.cs.html#3bcf0806f228693f" class="i">PropertyChanged</a> += <a href="#bd60969a8a8f5549" class="i method">Day_Changed</a>;
                <span class="r4 r">day</span>.<a href="Day.cs.html#0fc79275798ce11a" class="i property">IsToday</a> = <span class="r1 r">d</span> == <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>.<a href="@0@mscorlib/A.html#013b44cc4074ffd2" class="i property">Today</a>; 
                <a href="#341fd342d3d7bfcc" class="i property">Days</a>.<a href="@0@mscorlib/A.html#5c61cc24de82f7e7" class="i method">Add</a>(<span class="r4 r">day</span>);
                <span class="r1 r">d</span> = <span class="r1 r">d</span>.<a href="@0@mscorlib/A.html#f5cb6edd98581ca2" class="i method">AddDays</a>(1);
            }
        }
 
        <b>private void</b> <a id="bd60969a8a8f5549" href="R/bd60969a8a8f5549.html" target="n" data-glyph="76,1" class="i method">Day_Changed</a>(<b>object</b> <span id="r5 rd" class="r5 r">sender</span>, <a href="@0@System/A.html#f613cfcc9d2b2a4b" class="t t">PropertyChangedEventArgs</a> <span id="r6 rd" class="r6 r">e</span>)
        {
            <b>if</b> (<span class="r6 r">e</span>.<a href="@0@System/A.html#edc039b147e83726" class="i property">PropertyName</a> != <span class="s">&quot;Notes&quot;</span>) <b>return</b>;
            <b>if</b> (<a href="#5ecc3060436712cd" class="i">DayChanged</a> == <b>null</b>) <b>return</b>;
 
            <a href="#5ecc3060436712cd" class="i">DayChanged</a>(<a href="#3cce9a97761d5c9b" class="k">this</a>,<b>new</b> <a href="#707de967620eadf4" class="t constructor">DayChangedEventArgs</a>(<span class="r5 r">sender</span> <b>as</b> <a href="Day.cs.html#7646bd068f5f038b" class="t t">Day</a>));
        }
 
        <b>private static int</b> <a id="56d401822d7fd079" href="R/56d401822d7fd079.html" target="n" data-glyph="76,1" class="i method">DayOfWeekNumber</a>(<a href="@0@mscorlib/A.html#fe3a0e5f847fa6f8" class="t t">DayOfWeek</a> <span id="r7 rd" class="r7 r">dow</span>)
        {
            <b>return</b> <a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#069d595792a157df" class="i method">ToInt32</a>(<span class="r7 r">dow</span>.<a href="@0@mscorlib/A.html#e02a1db31e011144" class="i method">ToString</a>(<span class="s">&quot;D&quot;</span>));
        }
    }
 
    <b>public class</b> <a id="67930a58a3275fd8" href="R/67930a58a3275fd8.html" target="n" data-glyph="0,0" class="t t">DayChangedEventArgs</a> : <a href="@0@mscorlib/A.html#9a1496aa60befd10" class="t t">EventArgs</a>
    {
        <b>public</b> <a href="Day.cs.html#7646bd068f5f038b" class="t t">Day</a> <a id="1e8c950d170c28c9" href="R/1e8c950d170c28c9.html" target="n" data-glyph="102,1" class="i property">Day</a> { <b>get</b>; <b>private set</b>; }
 
        <b>public</b> <a id="707de967620eadf4" href="R/707de967620eadf4.html" target="n" data-glyph="72,1" class="t constructor">DayChangedEventArgs</a>(<a href="Day.cs.html#7646bd068f5f038b" class="t t">Day</a> <span id="r8 rd" class="r8 r">day</span>)
        {
            <a href="#67930a58a3275fd8" class="k">this</a>.<a href="#1e8c950d170c28c9" class="i property">Day</a> = <span class="r8 r">day</span>;
        }
    }
}</pre></td></tr></table></div></body></html>
