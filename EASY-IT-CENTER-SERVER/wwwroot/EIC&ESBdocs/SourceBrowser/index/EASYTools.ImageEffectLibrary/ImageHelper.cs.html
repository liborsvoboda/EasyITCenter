<!DOCTYPE html>
<html><head><title>ImageHelper.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(298);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EASYTools.ImageEffectLibrary/ImageHelper.cs" target="_top">ImageHelper.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EASYTools.ImageEffectLibrary" target="_top">..\..\..\EASY-TOOLS\EASYTools.ImageEffectLibrary\EASYTools.ImageEffectLibrary.csproj</a> (EASYTools.ImageEffectLibrary)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>.<span class="i n">Imaging</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Win32</span>;
 
 
<b>namespace</b> <span class="i n">EASYTools</span>.<span class="i n">ImageEffectLibrary</span> {
 
    <b>public</b> <a href="P/de2d3edb611ebe1b.html" target="s" class="k">partial</a> <b>class</b> <a id="de2d3edb611ebe1b" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">ImageHelper</a> : <a href="@0@System/A.html#fd4b42d7e29d53e5" class="t t">INotifyPropertyChanged</a>
    {
        <b>private bool</b> <a id="0a0bbea3eee7ea6f" href="R/0a0bbea3eee7ea6f.html" target="n" data-glyph="46,1" class="i field">changed</a> = <b>false</b>;
        <b>private string</b> <a id="ec81e8263fd2960e" href="R/ec81e8263fd2960e.html" target="n" data-glyph="46,1" class="i field">fileName</a> = <b>null</b>;
        <b>public enum</b> <a id="ce32b1325fc11454" href="R/ce32b1325fc11454.html" target="n" data-glyph="18,1" class="t t"><span id="5bda5bbe10d87b73">FileType</span></a>
        {
            <a id="e2b74c3955a6952b" href="R/e2b74c3955a6952b.html" target="n" data-glyph="24,2" class="i field">Png</a>,
            <a id="5fdc221604229fbf" href="R/5fdc221604229fbf.html" target="n" data-glyph="24,2" class="i field">Jpeg</a>,
            <a id="e501012f45df69c4" href="R/e501012f45df69c4.html" target="n" data-glyph="24,2" class="i field">Bmp</a>,
            <a id="ebd15c7b842a0f29" href="R/ebd15c7b842a0f29.html" target="n" data-glyph="24,2" class="i field">Gif</a>,
            <a id="0aedbbab3fadf5cf" href="R/0aedbbab3fadf5cf.html" target="n" data-glyph="24,2" class="i field">Tiff</a>,
            <a id="5e0f4316d97477ef" href="R/5e0f4316d97477ef.html" target="n" data-glyph="24,2" class="i field">Wmp</a>
        }
 
        <b>public event</b> <a href="@0@System/A.html#670754815f6804ff" class="t t">PropertyChangedEventHandler</a> <a id="ba66bf11a57ab561" href="R/ba66bf11a57ab561.html" target="n" data-glyph="30,1" class="i">PropertyChanged</a>;
        <b>public</b> <a id="293f05344a1b4e6e" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ImageHelper</a>() { }
 
        <b>public</b> <a href="@0@PresentationCore/A.html#0423ed363f952960" class="t t">BitmapSource</a> <a id="0521abca173158f8" href="R/0521abca173158f8.html" target="n" data-glyph="102,1" class="i property">EditingImage</a> { <b>get</b>; <b>set</b>; }
 
        <b>public</b> <a href="@0@PresentationCore/A.html#ee8d0deab0e263b7" class="t t">BitmapImage</a> <a id="7baf27d2092647f2" href="R/7baf27d2092647f2.html" target="n" data-glyph="102,1" class="i property">OriginImage</a> { <b>get</b>; <b>set</b>; }
 
        <b>public</b> <a href="Image.cs.html#eac4ea18336e3a94" class="t t">IBitmapSource</a> <a id="6ce5e513ace9e7a0" href="R/6ce5e513ace9e7a0.html" target="n" data-glyph="102,1" class="i property">DipLibImage</a> { <b>get</b>; <b>set</b>; }
 
        <b>public string</b> <a id="c3a675da2b8facaa" href="R/c3a675da2b8facaa.html" target="n" data-glyph="102,1" class="i property">FileName</a> { <b>get</b> { <b>return</b> <a href="#ec81e8263fd2960e" class="i field">fileName</a>; } <b>private set</b> { <a href="#ec81e8263fd2960e" class="i field">fileName</a> = <b>value</b>; } }
 
        <b>public bool</b> <a id="1d0d23764064e183" href="R/1d0d23764064e183.html" target="n" data-glyph="102,1" class="i property">Changed</a> { <b>get</b> { <b>return</b> <a href="#0a0bbea3eee7ea6f" class="i field">changed</a>; } <b>private set</b> { <a href="#0a0bbea3eee7ea6f" class="i field">changed</a> = <b>value</b>; } }
 
        <b>public void</b> <a id="0b4a1dad5694be00" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">NewOrigin</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">fileName</span> = <b>null</b>) {
            <a href="#c3a675da2b8facaa" class="i property">FileName</a> = <span class="r0 r">fileName</span>;
            
            <b>if</b> (!<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r0 r">fileName</span>))
            {
                <a href="@0@mscorlib/A.html#1a4dcb744a23ba6f" class="t t">MemoryStream</a> <span id="r1 rd" class="r1 r">ms</span> = <b>new</b> <a href="@0@mscorlib/A.html#d308091cc690e78d" class="t constructor">MemoryStream</a>();
                <a href="@0@PresentationCore/A.html#ee8d0deab0e263b7" class="t t">BitmapImage</a> <span id="r2 rd" class="r2 r">bi</span> = <b>new</b> <a href="@0@PresentationCore/A.html#940e003698ec4c39" class="t constructor">BitmapImage</a>();
                <b>byte</b>[] <span id="r3 rd" class="r3 r">bytArray</span> = <a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#ee8033fcb7e7a677" class="i method">ReadAllBytes</a>(<span class="r0 r">fileName</span>);
                <span class="r1 r">ms</span>.<a href="@0@mscorlib/A.html#a27df287b28d9a2a" class="i method">Write</a>(<span class="r3 r">bytArray</span>, 0, <span class="r3 r">bytArray</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>); <span class="r1 r">ms</span>.<a href="@0@mscorlib/A.html#ad08f8ca81a5a763" class="i property">Position</a> = 0;
                <span class="r2 r">bi</span>.<a href="@0@PresentationCore/A.html#ff48844d9c3da581" class="i method">BeginInit</a>();
                <span class="r2 r">bi</span>.<a href="@0@PresentationCore/A.html#7b4ff2445aefe037" class="i property">StreamSource</a> = <span class="r1 r">ms</span>;
                <span class="r2 r">bi</span>.<a href="@0@PresentationCore/A.html#f13ebd618e2e92dd" class="i method">EndInit</a>();
                <a href="#0521abca173158f8" class="i property">EditingImage</a> = <a href="#7baf27d2092647f2" class="i property">OriginImage</a> = <span class="r2 r">bi</span>;
                <span class="c">//new BitmapImage(new Uri(fileName)) { CacheOption = BitmapCacheOption.OnDemand </span>
            } <b>else</b> { <a href="#0521abca173158f8" class="i property">EditingImage</a> = <a href="#7baf27d2092647f2" class="i property">OriginImage</a> = <b>null</b>; }
            <a href="#1d0d23764064e183" class="i property">Changed</a> = <b>false</b>;
            <a href="#c11413b3d2d5c9ba" class="i method">GetRgbImage</a>();
        }
 
        <b>public</b> <a id="890f3e8c7d67efd5" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ImageHelper</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r4 rd" class="r4 r">fileName</span> = <b>null</b>)
        {
            <a href="#c3a675da2b8facaa" class="i property">FileName</a> = <span class="r4 r">fileName</span>;
 
            <b>if</b> (!<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#55e241b6143365ef" class="i method">IsNullOrWhiteSpace</a>(<span class="r4 r">fileName</span>))
            {
                <a href="@0@mscorlib/A.html#1a4dcb744a23ba6f" class="t t">MemoryStream</a> <span id="r5 rd" class="r5 r">ms</span> = <b>new</b> <a href="@0@mscorlib/A.html#d308091cc690e78d" class="t constructor">MemoryStream</a>();
                <a href="@0@PresentationCore/A.html#ee8d0deab0e263b7" class="t t">BitmapImage</a> <span id="r6 rd" class="r6 r">bi</span> = <b>new</b> <a href="@0@PresentationCore/A.html#940e003698ec4c39" class="t constructor">BitmapImage</a>();
                <b>byte</b>[] <span id="r7 rd" class="r7 r">bytArray</span> = <a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#ee8033fcb7e7a677" class="i method">ReadAllBytes</a>(<span class="r4 r">fileName</span>);
                <span class="r5 r">ms</span>.<a href="@0@mscorlib/A.html#a27df287b28d9a2a" class="i method">Write</a>(<span class="r7 r">bytArray</span>, 0, <span class="r7 r">bytArray</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>); <span class="r5 r">ms</span>.<a href="@0@mscorlib/A.html#ad08f8ca81a5a763" class="i property">Position</a> = 0;
                <span class="r6 r">bi</span>.<a href="@0@PresentationCore/A.html#ff48844d9c3da581" class="i method">BeginInit</a>();
                <span class="r6 r">bi</span>.<a href="@0@PresentationCore/A.html#7b4ff2445aefe037" class="i property">StreamSource</a> = <span class="r5 r">ms</span>;
                <span class="r6 r">bi</span>.<a href="@0@PresentationCore/A.html#f13ebd618e2e92dd" class="i method">EndInit</a>();
                <a href="#0521abca173158f8" class="i property">EditingImage</a> = <a href="#7baf27d2092647f2" class="i property">OriginImage</a> = <span class="r6 r">bi</span>;
                <span class="c">//new BitmapImage(new Uri(fileName)) { CacheOption = BitmapCacheOption.OnDemand </span>
            } <b>else</b> { <a href="#0521abca173158f8" class="i property">EditingImage</a> = <a href="#7baf27d2092647f2" class="i property">OriginImage</a> = <b>null</b>; }
 
            <a href="#1d0d23764064e183" class="i property">Changed</a> = <b>false</b>;
            <a href="#c11413b3d2d5c9ba" class="i method">GetRgbImage</a>();
        }
 
        <b>private void</b> <a id="69495fcbee56b46d" href="R/69495fcbee56b46d.html" target="n" data-glyph="76,1" class="i method">NotifyPropertyChanged</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r8 rd" class="r8 r">name</span>)
        {
            
            <a href="#1d0d23764064e183" class="i property">Changed</a> = <b>true</b>;
            <a href="#ba66bf11a57ab561" class="i">PropertyChanged</a>?.<a href="@0@System/A.html#c66222f7abfe2e28" class="i method">Invoke</a>(<a href="P/de2d3edb611ebe1b.html#de2d3edb611ebe1b" class="k">this</a>, <b>new</b> <a href="@0@System/A.html#76958b0a96ed2a2e" class="t constructor">PropertyChangedEventArgs</a>(<span class="r8 r">name</span>));
        }
 
        <b>private static</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>? <a id="1e74d06d64fa46aa" href="R/1e74d06d64fa46aa.html" target="n" data-glyph="76,1" class="i method">GetFileTypeByExtension</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r9 rd" class="r9 r">extension</span>)
        {
            <b>switch</b> (<span class="r9 r">extension</span>.<a href="@0@mscorlib/A.html#e1eaac9b427f9c78" class="i method">ToLower</a>(<b>new</b> <a href="@0@mscorlib/A.html#cb4dd1c3262abd32" class="t constructor">CultureInfo</a>(<span class="s">&quot;en-US&quot;</span>)))
            {
                <b>case</b> <span class="s">&quot;.png&quot;</span>:
                    <b>return</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#e2b74c3955a6952b" class="i field">Png</a>;
                <b>case</b> <span class="s">&quot;.jpg&quot;</span>:
                <b>case</b> <span class="s">&quot;.jpeg&quot;</span>:
                <b>case</b> <span class="s">&quot;.jpe&quot;</span>:
                <b>case</b> <span class="s">&quot;.jif&quot;</span>:
                <b>case</b> <span class="s">&quot;.jfif&quot;</span>:
                <b>case</b> <span class="s">&quot;.jfi&quot;</span>:
                    <b>return</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#5fdc221604229fbf" class="i field">Jpeg</a>;
                <b>case</b> <span class="s">&quot;.bmp&quot;</span>:
                <b>case</b> <span class="s">&quot;.dib&quot;</span>:
                    <b>return</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#e501012f45df69c4" class="i field">Bmp</a>;
                <b>case</b> <span class="s">&quot;.gif&quot;</span>:
                    <b>return</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#ebd15c7b842a0f29" class="i field">Gif</a>;
                <b>case</b> <span class="s">&quot;.tiff&quot;</span>:
                <b>case</b> <span class="s">&quot;.tif&quot;</span>:
                    <b>return</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#0aedbbab3fadf5cf" class="i field">Tiff</a>;
                <b>case</b> <span class="s">&quot;.wmp&quot;</span>:
                    <b>return</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#5e0f4316d97477ef" class="i field">Wmp</a>;
                <b>default</b>:
                    <b>return</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#e2b74c3955a6952b" class="i field">Png</a>;
            }
        }
 
        <b>private static</b> <a href="@0@PresentationCore/A.html#1f71d406a8dc808b" class="t t">BitmapEncoder</a> <a id="2b5d356da04b33e5" href="R/2b5d356da04b33e5.html" target="n" data-glyph="76,1" class="i method">GetEncoder</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r10 rd" class="r10 r">fileName</span>)
        {
            <b>switch</b> (<a href="#1e74d06d64fa46aa" class="i method">GetFileTypeByExtension</a>(<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#f424e433705aeb09" class="i method">GetExtension</a>(<span class="r10 r">fileName</span>)))
            {
                <b>case</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#e2b74c3955a6952b" class="i field">Png</a>:
                    <b>return</b> <b>new</b> <a href="@0@PresentationCore/A.html#d83082bf870487dc" class="t constructor">PngBitmapEncoder</a>();
                <b>case</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#5fdc221604229fbf" class="i field">Jpeg</a>:
                    <b>return</b> <b>new</b> <a href="@0@PresentationCore/A.html#050753269b0669bf" class="t constructor">JpegBitmapEncoder</a>();
                <b>case</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#e501012f45df69c4" class="i field">Bmp</a>:
                    <b>return</b> <b>new</b> <a href="@0@PresentationCore/A.html#6c360cadf4bd9ef5" class="t constructor">BmpBitmapEncoder</a>();
                <b>case</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#ebd15c7b842a0f29" class="i field">Gif</a>:
                    <b>return</b> <b>new</b> <a href="@0@PresentationCore/A.html#bdac41407b0b5074" class="t constructor">GifBitmapEncoder</a>();
                <b>case</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#0aedbbab3fadf5cf" class="i field">Tiff</a>:
                    <b>return</b> <b>new</b> <a href="@0@PresentationCore/A.html#0e63d429fc5e4332" class="t constructor">TiffBitmapEncoder</a>();
                <b>case</b> <a href="#ce32b1325fc11454" class="t t">FileType</a>.<a href="#5e0f4316d97477ef" class="i field">Wmp</a>:
                    <b>return</b> <b>new</b> <a href="@0@PresentationCore/A.html#0ebdf7defa786a3d" class="t constructor">WmpBitmapEncoder</a>();
                <b>default</b>:
                    <b>return</b> <b>new</b> <a href="@0@PresentationCore/A.html#d83082bf870487dc" class="t constructor">PngBitmapEncoder</a>();
            }
        }
 
        <b>private void</b> <a id="af1aef5aea71aacd" href="R/af1aef5aea71aacd.html" target="n" data-glyph="76,1" class="i method">SaveImage</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r11 rd" class="r11 r">fileName</span>)
        {
            <a href="@0@PresentationCore/A.html#1f71d406a8dc808b" class="k">var</a> <span id="r12 rd" class="r12 r">encoder</span> = <a href="#2b5d356da04b33e5" class="i method">GetEncoder</a>(<span class="r11 r">fileName</span>);
            <span class="r12 r">encoder</span>.<a href="@0@PresentationCore/A.html#73a8e458f99154a3" class="i property">Frames</a>.<a href="@0@mscorlib/A.html#a9319db8c62ae453" class="i method">Add</a>(<a href="@0@PresentationCore/A.html#bad013e46489de54" class="t t">BitmapFrame</a>.<a href="@0@PresentationCore/A.html#249d5611eba74aa4" class="i method">Create</a>(<a href="#0521abca173158f8" class="i property">EditingImage</a>));
            <b>using</b> (<a href="@0@mscorlib/A.html#e23a38af5d11ddd3" class="k">var</a> <span id="r13 rd" class="r13 r">fileStream</span> = <b>new</b> <a href="@0@mscorlib/A.html#66c00a58470ce47d" class="t constructor">FileStream</a>(<span class="r11 r">fileName</span>, <a href="@0@mscorlib/A.html#c0cb6ba6af625b3a" class="t t">FileMode</a>.<a href="@0@mscorlib/A.html#80a500db887477f8" class="i field">OpenOrCreate</a>))
            {
                <span class="r12 r">encoder</span>.<a href="@0@PresentationCore/A.html#6886df05238e625c" class="i method">Save</a>(<span class="r13 r">fileStream</span>);
            }
        }
 
        <b>public void</b> <a id="287cbd3441343f32" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Save</a>() {
            <a href="#af1aef5aea71aacd" class="i method">SaveImage</a>(<a href="#c3a675da2b8facaa" class="i property">FileName</a>);
        }
 
        <b>public void</b> <a id="3a86550e8fb17d6b" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ResetChanges</a>() {
            <a href="#0521abca173158f8" class="i property">EditingImage</a> = <a href="#7baf27d2092647f2" class="i property">OriginImage</a>;
            <a href="#1d0d23764064e183" class="i property">Changed</a> = <b>false</b>;
        }
 
        <b>public void</b> <a id="b1e3194bb139ff0b" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SaveTo</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r14 rd" class="r14 r">fileName</span>)
        {
            <a href="#af1aef5aea71aacd" class="i method">SaveImage</a>(<span class="r14 r">fileName</span>);
        }
 
        <b>public void</b> <a id="fb43e0dbe1813ef5" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SaveAs</a>()
        {
            <a href="@0@PresentationFramework/A.html#1cc3303b6fe0d095" class="k">var</a> <span id="r15 rd" class="r15 r">saveFileDialog</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#809a6b4d2cea3900" class="t constructor">SaveFileDialog</a>();
            <span class="r15 r">saveFileDialog</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;PNG (*.png)|*.png|&quot;</span> +
                                    <span class="s">&quot;JPEG (*.jpg;*.jpeg;*.jpe;*.jif;*.jfif;*.jfi)|*.jpg;*.jpeg;*.jpe;*.jif;*.jfif;*.jfi|&quot;</span> +
                                    <span class="s">&quot;BMP (*.bmp;*.dib)|*.bmp;*.dib|&quot;</span> +
                                    <span class="s">&quot;GIF (*.gif)|*.gif|&quot;</span> +
                                    <span class="s">&quot;TIFF (*.tiff;*.tif)|*.tiff;*.tif|&quot;</span> +
                                    <span class="s">&quot;WMP (*.wmp)|*.wmp|&quot;</span> +
                                    <span class="s">&quot;所有文件 (*.*)|*.*&quot;</span>;
            <b>if</b> (<span class="r15 r">saveFileDialog</span>.<a href="@0@PresentationFramework/A.html#6ac596e833103ec6" class="i method">ShowDialog</a>() != <b>true</b>) <b>return</b>;
            <a href="#af1aef5aea71aacd" class="i method">SaveImage</a>(<span class="r15 r">saveFileDialog</span>.<a href="@0@PresentationFramework/A.html#df29941779e9aecf" class="i property">FileName</a>);
            <a href="#c3a675da2b8facaa" class="i property">FileName</a> = <span class="r15 r">saveFileDialog</span>.<a href="@0@PresentationFramework/A.html#df29941779e9aecf" class="i property">FileName</a>;
        }
 
        <b>private void</b> <a id="921fc174fb5cdfd5" href="R/921fc174fb5cdfd5.html" target="n" data-glyph="76,1" class="i method">RefreshImage</a>()
        {
            <a href="#0521abca173158f8" class="i property">EditingImage</a> = <a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a>.<a href="Image.cs.html#b18865a8e7f95fb5" class="i method">ToBitmapSource</a>(<a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#355a95b92cba1e1b" class="i property">DpiX</a>, <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#47c8b297b8ae1418" class="i property">DpiY</a>);
            <a href="#69495fcbee56b46d" class="i method">NotifyPropertyChanged</a>(<b>nameof</b>(<a href="#0521abca173158f8" class="i property">EditingImage</a>));
        }
    }
 
    <b>public</b> <a href="P/de2d3edb611ebe1b.html" target="s" class="k">partial</a> <b>class</b> <span class="t t">ImageHelper</span> {
        <b>private void</b> <a id="c11413b3d2d5c9ba" href="R/c11413b3d2d5c9ba.html" target="n" data-glyph="76,1" class="i method">GetRgbImage</a>() {
            <b>if</b> (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>is</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>) <b>return</b>;
            <a href="#0521abca173158f8" class="i property">EditingImage</a> = <b>new</b> <a href="@0@PresentationCore/A.html#fc904705a09467e7" class="t constructor">FormatConvertedBitmap</a>(<a href="#7baf27d2092647f2" class="i property">OriginImage</a>, <a href="@0@PresentationCore/A.html#8f8a28423b24bd8e" class="t t">PixelFormats</a>.<a href="@0@PresentationCore/A.html#e4979f3dd8817adb" class="i property">Bgra32</a>, <b>null</b>, 0);
            <b>byte</b>[] <span id="r16 rd" class="r16 r">pixels</span> = <b>new</b> <b>byte</b>[<a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#e88eaeb82217cab6" class="i property">PixelWidth</a> * <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#0807be1f18d7aeef" class="i property">PixelHeight</a> * 4];
            <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#6778f23ec69a0044" class="i method">CopyPixels</a>(<span class="r16 r">pixels</span>, <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#e88eaeb82217cab6" class="i property">PixelWidth</a> * 4, 0);
            <a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> = <b>new</b> <a href="RgbImage.cs.html#ced69117e0c54295" class="t constructor">RgbImage</a>(<span class="r16 r">pixels</span>, <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#e88eaeb82217cab6" class="i property">PixelWidth</a>, <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#0807be1f18d7aeef" class="i property">PixelHeight</a>);
        }
 
        <b>private void</b> <a id="772ebdc46b64710a" href="R/772ebdc46b64710a.html" target="n" data-glyph="76,1" class="i method">GetGrayscaleImage</a>() {
            <b>if</b> (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>is</b> <a href="GrayscaleImage.cs.html#2b3b756cd8bce059" class="t t">GrayscaleImage</a>) <b>return</b>;
            <a href="#0521abca173158f8" class="i property">EditingImage</a> = <b>new</b> <a href="@0@PresentationCore/A.html#fc904705a09467e7" class="t constructor">FormatConvertedBitmap</a>(<a href="#7baf27d2092647f2" class="i property">OriginImage</a>, <a href="@0@PresentationCore/A.html#8f8a28423b24bd8e" class="t t">PixelFormats</a>.<a href="@0@PresentationCore/A.html#20014ee385b9c1d3" class="i property">Gray8</a>, <a href="@0@PresentationCore/A.html#5e1fae8c1b7e6c68" class="t t">BitmapPalettes</a>.<a href="@0@PresentationCore/A.html#567b261f5fda5061" class="i property">Gray256</a>, 0);
            <b>byte</b>[] <span id="r17 rd" class="r17 r">pixels</span> = <b>new</b> <b>byte</b>[<a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#e88eaeb82217cab6" class="i property">PixelWidth</a> * <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#0807be1f18d7aeef" class="i property">PixelHeight</a>];
            <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#6778f23ec69a0044" class="i method">CopyPixels</a>(<span class="r17 r">pixels</span>, <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#e88eaeb82217cab6" class="i property">PixelWidth</a>, 0);
            <a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> = <b>new</b> <a href="GrayscaleImage.cs.html#9d9ce90112cadbb5" class="t constructor">GrayscaleImage</a>(<span class="r17 r">pixels</span>, <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#e88eaeb82217cab6" class="i property">PixelWidth</a>, <a href="#0521abca173158f8" class="i property">EditingImage</a>.<a href="@0@PresentationCore/A.html#0807be1f18d7aeef" class="i property">PixelHeight</a>);
        }
 
        <b>public void</b> <a id="1cad80bcf0e400d0" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ConvertToGrayscale</a>() {
            <a href="#772ebdc46b64710a" class="i method">GetGrayscaleImage</a>();
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="67465eefdd77fb89" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EnhanceVisibility</a>() {
            <b>if</b> (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>is</b> <a href="GrayscaleImage.cs.html#2b3b756cd8bce059" class="t t">GrayscaleImage</a>) (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="GrayscaleImage.cs.html#2b3b756cd8bce059" class="t t">GrayscaleImage</a>).<a href="GrayscaleImage.cs.html#8d2017b273f0cc7b" class="i method">EnhanceVisibility</a>();
            <b>else</b>
            {
                <b>if</b> (!(<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>is</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>)) <a href="#c11413b3d2d5c9ba" class="i method">GetRgbImage</a>();
                (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>).<a href="RgbImage.cs.html#db8ec6ea59e9e1f5" class="i method">EnhanceVisibility</a>();
            }
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="83f34bad1a2e4da7" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">LightnessLinearStretch</a>() {
            <b>if</b> (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>is</b> <a href="GrayscaleImage.cs.html#2b3b756cd8bce059" class="t t">GrayscaleImage</a>) (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="GrayscaleImage.cs.html#2b3b756cd8bce059" class="t t">GrayscaleImage</a>).<a href="GrayscaleImage.cs.html#5b93ef39c11390c7" class="i method">LightnessLinearStretch</a>();
            <b>else</b>
            {
                <b>if</b> (!(<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>is</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>)) <a href="#c11413b3d2d5c9ba" class="i method">GetRgbImage</a>();
                (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>).<a href="RgbImage.cs.html#45dce8ae73cec9b6" class="i method">LightnessLinearStretch</a>();
            }
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="8f258046191a2480" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GrayscaleHistogramEqualization</a>() {
            <a href="#772ebdc46b64710a" class="i method">GetGrayscaleImage</a>();
            (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="GrayscaleImage.cs.html#2b3b756cd8bce059" class="t t">GrayscaleImage</a>).<a href="GrayscaleImage.cs.html#4886bb3a9621f924" class="i method">HistogramEqualization</a>();
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="d0f3f73b49643601" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SaturationHistogramEqualization</a>() {
            <a href="#c11413b3d2d5c9ba" class="i method">GetRgbImage</a>();
            (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>).<a href="RgbImage.cs.html#412c7a1fda410bd7" class="i method">SaturationHistogramEqualization</a>(101);
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="7e0cdc972befedb6" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">LightnessHistogramEqualization</a>() {
            <a href="#c11413b3d2d5c9ba" class="i method">GetRgbImage</a>();
            (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>).<a href="RgbImage.cs.html#6ce2f3a6d1bfa21b" class="i method">LightnessHistogramEqualization</a>(101);
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="5c53a72a92258e73" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">MirrorHorizontally</a>() {
            <a href="#c11413b3d2d5c9ba" class="i method">GetRgbImage</a>();
            (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>).<a href="RgbImage.cs.html#9cfeca3e430175c5" class="i method">MirrorHorizontally</a>();
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="10e99fd93b8a7da2" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">MirrorVertically</a>() {
            <a href="#c11413b3d2d5c9ba" class="i method">GetRgbImage</a>();
            (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>).<a href="RgbImage.cs.html#d8bb19cbfe345a91" class="i method">MirrorVertically</a>();
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="abb84da7c6d7b8dc" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">LaplacianFilter</a>() {
            <a href="#c11413b3d2d5c9ba" class="i method">GetRgbImage</a>();
            (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="RgbImage.cs.html#2f253f640af01fc1" class="t t">RgbImage</a>).<a href="RgbImage.cs.html#5b1f139d5e19bfaf" class="i method">LaplacianFilter</a>();
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
 
 
        <b>private void</b> <a id="2d3bbeab4189258b" href="R/2d3bbeab4189258b.html" target="n" data-glyph="76,1" class="i method">GetBinaryImage</a>() {
            <b>if</b> (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>is</b> <a href="BinaryImage.cs.html#79091e2cec4a2cd2" class="t t">BinaryImage</a>) <b>return</b>;
            <b>if</b> (!(<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>is</b> <a href="GrayscaleImage.cs.html#2b3b756cd8bce059" class="t t">GrayscaleImage</a>)) <a href="#772ebdc46b64710a" class="i method">GetGrayscaleImage</a>();
            <a href="GrayscaleImage.cs.html#2b3b756cd8bce059" class="k">var</a> <span id="r18 rd" class="r18 r">grayscale</span> = <a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="GrayscaleImage.cs.html#2b3b756cd8bce059" class="t t">GrayscaleImage</a>;
            <a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> = <b>new</b> <a href="BinaryImage.cs.html#07ab823493c9b8e6" class="t constructor">BinaryImage</a>(<span class="r18 r">grayscale</span>.<a href="GrayscaleImage.cs.html#9b1caf4ea0d91c16" class="i method">ToPixelsData</a>(), <span class="r18 r">grayscale</span>.<a href="Image.cs.html#54ade488d528add0" class="i property">PixelWidth</a>, <span class="r18 r">grayscale</span>.<a href="Image.cs.html#a7d6e0fa5506e0af" class="i property">PixelHeight</a>);
        }
 
        <b>public void</b> <a id="51501a45c82299d7" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Binarize</a>() {
            <a href="#2d3bbeab4189258b" class="i method">GetBinaryImage</a>();
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="822028ecee8ad89d" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dilation</a>() {
            <a href="#2d3bbeab4189258b" class="i method">GetBinaryImage</a>();
            <a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> = (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="BinaryImage.cs.html#79091e2cec4a2cd2" class="t t">BinaryImage</a>).<a href="BinaryImage.cs.html#9790da5404279b00" class="i method">Dilation</a>(<a href="BinaryImage.cs.html#fa2d84162e748d82" class="t t">StructuringElements</a>.<a href="BinaryImage.cs.html#4701c0f732048d9a" class="i method">Cross</a>(3));
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="f600512c1dfc261a" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Erosion</a>() {
            <a href="#2d3bbeab4189258b" class="i method">GetBinaryImage</a>();
            <a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> = (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="BinaryImage.cs.html#79091e2cec4a2cd2" class="t t">BinaryImage</a>).<a href="BinaryImage.cs.html#ead8cbf8a702b45c" class="i method">Erosion</a>(<a href="BinaryImage.cs.html#fa2d84162e748d82" class="t t">StructuringElements</a>.<a href="BinaryImage.cs.html#4701c0f732048d9a" class="i method">Cross</a>(3));
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="e7121a9ee61a727c" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">MorphologyOpen</a>() {
            <a href="#2d3bbeab4189258b" class="i method">GetBinaryImage</a>();
            <a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> = (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="BinaryImage.cs.html#79091e2cec4a2cd2" class="t t">BinaryImage</a>).<a href="BinaryImage.cs.html#f133eb445f4ac887" class="i method">Open</a>(<a href="BinaryImage.cs.html#fa2d84162e748d82" class="t t">StructuringElements</a>.<a href="BinaryImage.cs.html#4701c0f732048d9a" class="i method">Cross</a>(3));
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
 
        <b>public void</b> <a id="493d89f8d1f795ee" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">MorphologyClose</a>() {
            <a href="#2d3bbeab4189258b" class="i method">GetBinaryImage</a>();
            <a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> = (<a href="#6ce5e513ace9e7a0" class="i property">DipLibImage</a> <b>as</b> <a href="BinaryImage.cs.html#79091e2cec4a2cd2" class="t t">BinaryImage</a>).<a href="BinaryImage.cs.html#38c67d3b22ed9a8f" class="i method">Close</a>(<a href="BinaryImage.cs.html#fa2d84162e748d82" class="t t">StructuringElements</a>.<a href="BinaryImage.cs.html#4701c0f732048d9a" class="i method">Cross</a>(3));
            <a href="#921fc174fb5cdfd5" class="i method">RefreshImage</a>();
        }
    }
}
</pre></td></tr></table></div></body></html>
