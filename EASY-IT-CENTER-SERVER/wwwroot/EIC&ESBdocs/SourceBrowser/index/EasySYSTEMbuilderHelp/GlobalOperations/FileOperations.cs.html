<!DOCTYPE html>
<html><head><title>FileOperations.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(288);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EasySYSTEMbuilderHelp/GlobalOperations/FileOperations.cs" target="_top">GlobalOperations\FileOperations.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EasySYSTEMbuilderHelp" target="_top">HelpProjects\EasySYSTEMbuilderHelp\EasySYSTEMbuilderHelp.vbproj</a> (EasySYSTEMbuilderHelp)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">ICSharpCode</span>.<span class="i">WpfDesign</span>.<span class="i">Designer</span>;
<b>using</b> <span class="i">Newtonsoft</span>.<span class="i">Json</span>;
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Text</span>;
 
<b>namespace</b> <span class="i n">EasyITSystemCenter</span>.<span class="i n">GlobalOperations</span> {
 
    <span class="i">internal</span> <b>class</b> <a id="52d5bf08f6fe959d" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="6468fdabea2c9406">FileOperations</span></a> {
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Application</span> <span class="i">Startup</span> <span class="i">Check</span> <b>and</b> <span class="i">configure</span> <span class="i">Data</span> <b>Structure in</b> <span class="i">folder</span> <span class="i">ProgramData</span> <b>And</b>
        /// <span class="i">required</span> <span class="i">files</span>, <span class="i">load</span> <span class="i">client</span> <span class="i">configuration</span> <span class="i">config</span>.<span class="i">json</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="e2678567a4791bcd" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">LoadSettings</span>() {
            <b>try</b> {
                <b>if</b> (!<span class="i">CheckDirectory</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">reportFolder</span>)) { <span class="i">CreatePath</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">reportFolder</span>); }
                <b>try</b> { <span class="i">ClearFolder</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">reportFolder</span>); } <b>catch</b> { }
                <b>if</b> (!<span class="i">CheckDirectory</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">updateFolder</span>)) { <span class="i">CreatePath</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">updateFolder</span>); }
                <b>try</b> { <span class="i">ClearFolder</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">updateFolder</span>); } <b>catch</b> { }
                <b>if</b> (!<span class="i">CheckDirectory</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">tempFolder</span>)) { <span class="i">CreatePath</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">tempFolder</span>); }
                <b>try</b> { <span class="i">ClearFolder</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">tempFolder</span>); } <b>catch</b> { }
                <b>if</b> (!<span class="i">CheckDirectory</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">galleryFolder</span>)) { <span class="i">CreatePath</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">galleryFolder</span>); }
                <b>try</b> { <span class="i">ClearFolder</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">galleryFolder</span>); } <b>catch</b> { }
 
                <b>if</b> (!<span class="i">CheckFile</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">startupPath</span>, <span class="s">&quot;Data&quot;</span>, <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">appSettingFile</span>))) <span class="i">CopyFile</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">startupPath</span>, <span class="s">&quot;Data&quot;</span>, <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">appSettingFile</span>), <span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">settingFolder</span>, <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">appSettingFile</span>));
                <span class="i">CopyFiles</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">startupPath</span>, <span class="s">&quot;Data&quot;</span>), <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">settingFolder</span>);
                <span class="i">CopyFiles</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">startupPath</span>, <span class="s">&quot;Data&quot;</span>, <span class="s">&quot;SubReports&quot;</span>), <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">reportFolder</span>);
                <b>string</b> <span class="i">json</span> = <span class="i">File</span>.<span class="i">ReadAllText</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">settingFolder</span>, <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">appSettingFile</span>), <span class="i">FileDetectEncoding</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">settingFolder</span>, <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">appSettingFile</span>)));
                <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <span class="i">SettingData</span> = <span class="i">JsonConvert</span>.<span class="i">DeserializeObject</span>&lt;<span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;&gt;(<span class="i">json</span>);
                <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">AddRange</span>(<span class="i">SettingData</span>);
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">ex</span>) { <span class="i">App</span>.<span class="i">log</span>.<span class="i">Fatal</span>(<span class="s">&quot;configuration load error: &quot;</span> + <span class="i">ex</span>.<span class="i">Message</span> + <span class="i">Environment</span>.<span class="i">NewLine</span> + <span class="i">ex</span>.<span class="i">StackTrace</span>); }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <b>Function for</b> <span class="i">saving</span> <span class="i">Application</span> <span class="i">Configuration</span> <span class="i">This</span> <b>is</b> <span class="i">client</span> <span class="i">configuration</span> <span class="i">only</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="9a188d099d86b9ed" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">Exception</a> <span class="i">SaveSettings</span>() {
            <b>try</b> {
                <b>using</b> (<span class="i">StreamWriter</span> <span class="i">sw</span> = <span class="i">File</span>.<span class="i">CreateText</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">settingFolder</span>, <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">appSettingFile</span>))) {
                    <span class="i">sw</span>.<span class="i">Write</span>(<span class="i">DataOperations</span>.<span class="i">ConvertDataSetToJson</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>));
                    <span class="i">sw</span>.<span class="i">Flush</span>(); <span class="i">sw</span>.<span class="i">Close</span>();
                }
                <b>return</b> <span class="i">null</span>;
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">ex</span>) { <b>return</b> <span class="i">ex</span>; }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Unicodes</span> <b>to</b> <span class="i">ut</span> <span class="i">f8</span>.
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;strFrom&quot;</span>&gt;<span class="i">The</span> <b>string</b> <span class="i">from</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static string</b> <span class="i">UnicodeToUTF8</span>(<b>string</b> <span class="i">strFrom</span>) {
            <b>byte</b>[] <span class="i">bytes</span> = <span class="i">Encoding</span>.<b>Default</b>.<span class="i">GetBytes</span>(<span class="i">strFrom</span>);
            <b>return</b> <span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">GetString</span>(<span class="i">bytes</span>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Checks</span> <span class="i">the</span> <span class="i">file</span>.
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;file&quot;</span>&gt;<span class="i">The</span> <span class="i">file</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="dcbdbd3502d7eecc" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">CheckFile</span>(<b>string</b> <span class="i">file</span>) {
            <b>return</b> <span class="i">File</span>.<span class="i">Exists</span>(<span class="i">file</span>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Prepared</span> <span class="i">Method</span> <b>for</b> <span class="i">Files</span> <span class="i">Copy</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;sourcePath&quot;</span>&gt;     &lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;destinationPath&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        <b>public static</b> <a id="e2678567a4791bcd" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">CopyFiles</span>(<b>string</b> <span class="i">sourcePath</span>, <b>string</b> <span class="i">destinationPath</span>) {
            <b>string</b>[] <span class="i">filePaths</span> = <span class="i">Directory</span>.<span class="i">GetFiles</span>(<span class="i">sourcePath</span>);
            <span class="i">foreach</span> (<b>string</b> <span class="i">fullFilePath</span> <b>in</b> <span class="i">filePaths</span>) {
                <b>string</b> <span class="i">fileName</span> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="i">fullFilePath</span>);
                <b>if</b> (!<span class="i">File</span>.<span class="i">Exists</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">destinationPath</span>, <span class="i">fileName</span>))) {
                    <span class="i">File</span>.<span class="i">Copy</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">sourcePath</span>, <span class="i">fileName</span>), <span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">destinationPath</span>, <span class="i">fileName</span>));
                }
            }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Creates</span> <span class="i">the</span> <span class="i">path</span> <span class="i">recursively</span>.
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;path&quot;</span>&gt;<span class="i">The</span> <span class="i">path</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="dcbdbd3502d7eecc" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">CreatePath</span>(<b>string</b> <span class="i">path</span>) {
            <b>try</b> {
                <b>string</b>[] <span class="i">pathParts</span> = <span class="i">path</span>.<span class="i">Split</span>(<span class="c">&#39;\\&#39;);</span>
 
                <b>for</b> (<span class="i">int</span> <span class="i">i</span> = 0; <span class="i">i</span> &lt; <span class="i">pathParts</span>.<span class="i">Length</span>; <span class="i">i</span>++) {
                    <b>if</b> (<span class="i">i</span> &gt; 0)
                        <span class="i">pathParts</span><a id="f3f9eeeac3cf78f4" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">[i]</a> = <a href="@0@PresentationFramework/A.html#ede77210f20e8cf9" class="t t">Path</a>.<span class="i">Combine</span>(<span class="i">pathParts</span>[i - 1], <span class="i">pathParts</span><span class="i">[i]</span>);
 
                    <b>if</b> (!<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="i">pathParts</span><span class="i">[i]</span>))
                        <span class="i">Directory</span>.<span class="i">CreateDirectory</span>(<span class="i">pathParts</span><span class="i">[i]</span>);
                }
                <b>return</b> <b>true</b>;
            } <b>catch</b> {
                <b>return</b> <b>false</b>;
            }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Reads</span> <span class="i">the</span> <span class="i">file</span>.
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;fileName&quot;</span>&gt;<span class="i">Name</span> <b>of</b> <span class="i">the</span> <span class="i">file</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static byte</b>[] <span class="i">ReadFile</span>(<b>string</b> <span class="i">fileName</span>) {
            <span class="i">FileStream</span> <a id="c027bff6e469050c" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">f</a> = <b>new</b> <span class="i">FileStream</span>(<span class="i">fileName</span>, <span class="i">FileMode</span>.<span class="i">Open</span>, <span class="i">FileAccess</span>.<span class="i">Read</span>);
            <span class="i">int</span> <a id="84b39fb6614c1bde" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">size</a> = (<span class="i">int</span>)<span class="i">f</span>.<span class="i">Length</span>;
            <b>byte</b>[] <span class="i">data</span> = <b>new</b> <b>byte</b><span class="i">[size]</span>;
            <span class="i">size</span> = <span class="i">f</span>.<span class="i">Read</span>(<span class="i">data</span>, 0, <span class="i">size</span>);
            <span class="i">f</span>.<span class="i">Close</span>();
            <b>return</b> <span class="i">data</span>;
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Write</span> <span class="i">ByteArray</span> <b>to</b> <span class="i">File</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;fileName&quot;</span>&gt; <span class="i">Name</span> <b>of</b> <span class="i">the</span> <span class="i">file</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;byteArray&quot;</span>&gt;<span class="i">The</span> <b>byte</b> <span class="i">array</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="dcbdbd3502d7eecc" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">ByteArrayToFile</span>(<b>string</b> <span class="i">fileName</span>, <b>byte</b>[] <span class="i">byteArray</span>) {
            <b>try</b> {
                <b>using</b> (<span class="i">var</span> <span class="i">fs</span> = <b>new</b> <span class="i">FileStream</span>(<span class="i">fileName</span>, <span class="i">FileMode</span>.<span class="i">Create</span>, <span class="i">FileAccess</span>.<span class="i">Write</span>)) {
                    <span class="i">fs</span>.<span class="i">Write</span>(<span class="i">byteArray</span>, 0, <span class="i">byteArray</span>.<span class="i">Length</span>);
                    <b>return</b> <b>true</b>;
                }
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">ex</span>) {
                <b>return</b> <b>false</b>;
            }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Prepared</span> <span class="i">Method</span> <b>for</b> <span class="i">Create</span> <span class="i">empty</span> <span class="i">file</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;file&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="dcbdbd3502d7eecc" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">CreateFile</span>(<b>string</b> <span class="i">file</span>) {
            <b>if</b> (!<span class="i">File</span>.<span class="i">Exists</span>(<span class="i">file</span>))
                <span class="i">File</span>.<span class="i">Create</span>(<span class="i">file</span>).<span class="i">Close</span>();
 
            <b>return</b> <span class="i">CheckFile</span>(<span class="i">file</span>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Write</span> <b>String to</b> <span class="i">File</span> <span class="i">Used</span> <b>for</b> <span class="i">JsonSaving</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;file&quot;</span>&gt;   <span class="i">The</span> <span class="i">file</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;content&quot;</span>&gt;<span class="i">The</span> <span class="i">content</span>.&lt;/<span class="i">param</span>&gt;
        <b>public static</b> <a id="e2678567a4791bcd" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">WriteToFile</span>(<b>string</b> <span class="i">file</span>, <b>string</b> <span class="i">content</span>) {
            <span class="i">CreateFile</span>(<span class="i">file</span>);
            <span class="i">StreamWriter</span> <a id="2858aff19a2ab2ed" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">objWriter</a> = <b>new</b> <span class="i">StreamWriter</span>(<span class="i">file</span>, <b>true</b>);
            <span class="i">objWriter</span>.<span class="i">WriteLine</span>(<span class="i">content</span>);
            <span class="i">objWriter</span>.<span class="i">Close</span>();
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Prepared</span> <span class="i">Method</span> <b>for Get</b> <span class="i">Information</span> <b>of</b> <span class="i">File</span> <span class="i">encoding</span> <span class="i">UTF8</span>,<span class="i">WIN1250</span>,<span class="i">etc</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;FileName&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="0597d5d251128c28" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">Encoding</a> <span class="i">FileDetectEncoding</span>(<b>string</b> <span class="i">FileName</span>) {
            <b>string</b> <span class="i">enc</span> = <span class="s">&quot;&quot;</span>;
            <b>if</b> (<span class="i">File</span>.<span class="i">Exists</span>(<span class="i">FileName</span>)) {
                <span class="i">FileStream</span> <a id="263dfdc0709aab45" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">filein</a> = <b>new</b> <span class="i">FileStream</span>(<span class="i">FileName</span>, <span class="i">FileMode</span>.<span class="i">Open</span>, <span class="i">FileAccess</span>.<span class="i">Read</span>);
                <b>if</b> ((<span class="i">filein</span>.<span class="i">CanSeek</span>)) {
                    <b>byte</b>[] <span class="i">bom</span> = <b>new</b> <b>byte</b>[5];
                    <span class="i">filein</span>.<span class="i">Read</span>(<span class="i">bom</span>, 0, 4);
                    // <span class="i">EF</span> <span class="i">BB</span> <span class="i">BF</span> = <span class="i">utf</span>-8 <span class="i">FF</span> <span class="i">FE</span> = <span class="i">ucs</span>-2l<span class="i">e</span>, <span class="i">ucs</span>-4l<span class="i">e</span>, <b>and</b> <span class="i">ucs</span>-16l<span class="i">e</span> <span class="i">FE</span> <span class="i">FF</span> = <span class="i">utf</span>-16 <b>and</b>
                    // <span class="i">ucs</span>-2 00 00 <span class="i">FE</span> <span class="i">FF</span> = <span class="i">ucs</span>-4
                    <b>if</b> ((((<span class="i">bom</span>[0] == 0<span class="i">xEF</span>) &amp;&amp; (<span class="i">bom</span>[1] == 0<span class="i">xBB</span>) &amp;&amp; (<span class="i">bom</span>[2] == 0<span class="i">xBF</span>)) || ((<span class="i">bom</span>[0] == 0<span class="i">xFF</span>) &amp;&amp; (<span class="i">bom</span>[1] == 0<span class="i">xFE</span>)) || ((<span class="i">bom</span>[0] == 0<span class="i">xFE</span>) &amp;&amp; (<span class="i">bom</span>[1] == 0<span class="i">xFF</span>)) || ((<span class="i">bom</span>[0] == 0<span class="i">x0</span>) &amp;&amp; (<span class="i">bom</span>[1] == 0<span class="i">x0</span>) &amp;&amp; (<span class="i">bom</span>[2] == 0<span class="i">xFE</span>) &amp;&amp; (<span class="i">bom</span>[3] == 0<span class="i">xFF</span>))))
                        <span class="i">enc</span> = <span class="s">&quot;Unicode&quot;</span>;
                    <b>else</b>
                        <span class="i">enc</span> = <span class="s">&quot;ASCII&quot;</span>;
                    // <span class="i">Position</span> <span class="i">the</span> <span class="i">file</span> <span class="i">cursor</span> <span class="i">back</span> <b>to</b> <span class="i">the</span> <span class="i">start</span> <b>of</b> <span class="i">the</span> <span class="i">file</span>
                    <span class="i">filein</span>.<span class="i">Seek</span>(0, <span class="i">SeekOrigin</span>.<span class="i">Begin</span>);
                }
                <span class="i">filein</span>.<span class="i">Close</span>();
            }
            <b>if</b> (<span class="i">enc</span> == <span class="s">&quot;Unicode&quot;</span>)
                <b>return</b> <span class="i">Encoding</span>.<span class="i">UTF8</span>;
            <b>else</b>
                <b>return</b> <span class="i">Encoding</span>.<span class="i">Default</span>;
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Deletes</span> <span class="i">the</span> <span class="i">directory</span>.
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;directory&quot;</span>&gt;<span class="i">The</span> <span class="i">directory</span>.&lt;/<span class="i">param</span>&gt;
        <b>public static</b> <a id="e2678567a4791bcd" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">DeleteDirectory</span>(<b>string</b> <span class="i">directory</span>) {
            <b>if</b> (<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="i">directory</span>))
                <span class="i">Directory</span>.<span class="i">Delete</span>(<span class="i">directory</span>, <b>true</b>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Checks</span> <span class="i">the</span> <span class="i">directory</span>.
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;directory&quot;</span>&gt;<span class="i">The</span> <span class="i">directory</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="dcbdbd3502d7eecc" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">CheckDirectory</span>(<b>string</b> <span class="i">directory</span>) {
            <b>return</b> <span class="i">Directory</span>.<span class="i">Exists</span>(<span class="i">directory</span>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Copy</span> <span class="i">Full</span> <span class="i">directory</span>.
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;directory&quot;</span>&gt;<span class="i">The</span> <span class="i">directory</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="e2678567a4791bcd" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">CopyDirectory</span>(<b>string</b> <span class="i">sourcePath</span>, <b>string</b> <span class="i">targetPath</span>) {
            <span class="i">foreach</span> (<b>string</b> <span class="i">dirPath</span> <b>in</b> <span class="i">Directory</span>.<span class="i">GetDirectories</span>(<span class="i">sourcePath</span>, <span class="s">&quot;*&quot;</span>, <span class="i">SearchOption</span>.<span class="i">AllDirectories</span>)) {
                <span class="i">Directory</span>.<span class="i">CreateDirectory</span>(<span class="i">dirPath</span>.<span class="i">Replace</span>(<span class="i">sourcePath</span>, <span class="i">targetPath</span>));
            }
            <span class="i">Directory</span>.<span class="i">CreateDirectory</span>(<span class="i">targetPath</span>);
 
            <span class="i">foreach</span> (<b>string</b> <span class="i">newPath</span> <b>in</b> <span class="i">Directory</span>.<span class="i">GetFiles</span>(<span class="i">sourcePath</span>, <span class="s">&quot;*.*&quot;</span>, <span class="i">SearchOption</span>.<span class="i">AllDirectories</span>)) {
                <span class="i">File</span>.<span class="i">Copy</span>(<span class="i">newPath</span>, <span class="i">newPath</span>.<span class="i">Replace</span>(<span class="i">sourcePath</span>, <span class="i">targetPath</span>), <b>true</b>);
            }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// /
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;from&quot;</span>&gt;<span class="i">From</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;to&quot;</span>&gt;  <b>To</b>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="dcbdbd3502d7eecc" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">CopyFile</span>(<b>string</b> <span class="i">from</span>, <b>string to</b>) {
            <b>try</b> {
                <span class="i">File</span>.<span class="i">Copy</span>(<span class="i">from</span>, <b>to</b>, <b>true</b>);
                <b>return</b> <b>true</b>;
            } <b>catch</b> {
                <b>return</b> <b>false</b>;
            }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Creates</span> <span class="i">the</span> <span class="i">directory</span>.
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;directory&quot;</span>&gt;<span class="i">The</span> <span class="i">directory</span>.&lt;/<span class="i">param</span>&gt;
        <b>public static</b> <a id="e2678567a4791bcd" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">CreateDirectory</span>(<b>string</b> <span class="i">directory</span>) {
            <b>if</b> (!<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="i">directory</span>))
                <span class="i">Directory</span>.<span class="i">CreateDirectory</span>(<span class="i">directory</span>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Deletes</span> <span class="i">the</span> <span class="i">file</span>.
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;file&quot;</span>&gt;<span class="i">The</span> <span class="i">file</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="dcbdbd3502d7eecc" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">DeleteFile</span>(<b>string</b> <span class="i">file</span>) {
            <span class="i">File</span>.<span class="i">Delete</span>(<span class="i">file</span>);
 
            <b>if</b> (!<span class="i">CheckFile</span>(<span class="i">file</span>))
                <b>return</b> <b>true</b>;
            <b>else</b>
                <b>return</b> <b>false</b>;
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Full</span> <span class="i">Clear</span> <span class="i">Folder</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;FolderName&quot;</span>&gt;<span class="i">Name</span> <b>of</b> <span class="i">the</span> <span class="i">folder</span>.&lt;/<span class="i">param</span>&gt;
        <b>public static</b> <a id="e2678567a4791bcd" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">ClearFolder</span>(<b>string</b> <span class="i">FolderName</span>) {
            <span class="i">DirectoryInfo</span> <a id="4ea5121edb617239" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">dir</a> = <b>new</b> <span class="i">DirectoryInfo</span>(<span class="i">FolderName</span>);
 
            <span class="i">foreach</span> (<span class="i">FileInfo</span> <span class="i">fi</span> <b>in</b> <span class="i">dir</span>.<span class="i">GetFiles</span>()) {
                <span class="i">fi</span>.<span class="i">Delete</span>();
            }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Generate</span> <span class="i">ini</span> <span class="i">file</span> <b>for</b> <span class="i">start</span> <span class="i">vns</span> <span class="i">server</span> <b>default</b> <span class="i">password</span>: <span class="i">groupware</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;path&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="dcbdbd3502d7eecc" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">VncServerIniFile</span>(<b>string</b> <span class="i">path</span>) {
            <b>try</b> {
                <b>string</b> <span class="i">iniFileContent</span> = <span class="s">$&quot;</span><span class="s">[Permissions]\r\n[admin]\r\nFileTransferEnabled=1\r\nFTUserImpersonation=0\r\nBlankMonitorEnabled=1\r\nBlankInputsOnly=0\r\nDefaultScale=1\r\nUseDSMPlugin=0\r\nDSMPlugin=\r\nprimary=1\r\nsecondary=0\r\nSocketConnect=1\r\nHTTPConnect=1\r\nAutoPortSelect=1\r\nInputsEnabled=1\r\nLocalInputsDisabled=0\r\nIdleTimeout=0\r\nEnableJapInput=0\r\nEnableUnicodeInput=0\r\nEnableWin8Helper=0\r\nQuerySetting=2\r\nQueryTimeout=10\r\nQueryDisableTime=0\r\nQueryAccept=0\r\nMaxViewerSetting=0\r\nMaxViewers=128\r\nCollabo=0\r\nFrame=0\r\nNotification=1\r\nOSD=0\r\nNotificationSelection=0\r\nLockSetting=0\r\nRemoveWallpaper=0\r\nRemoveEffects=0\r\nRemoveFontSmoothing=0\r\nDebugMode=0\r\nAvilog=0\r\npath=</span>{<span class="i">path</span>}<span class="s">\r\nDebugLevel=0\r\nAllowLoopback=1\r\nLoopbackOnly=0\r\nAllowShutdown=1\r\nAllowProperties=1\r\nAllowInjection=0\r\nAllowEditClients=1\r\nFileTransferTimeout=30\r\nKeepAliveInterval=5\r\nIdleInputTimeout=0\r\nDisableTrayIcon=0\r\nrdpmode=0\r\nnoscreensaver=0\r\nSecure=0\r\nMSLogonRequired=0\r\nNewMSLogon=0\r\nReverseAuthRequired=0\r\nConnectPriority=0\r\nservice_commandline=\r\naccept_reject_mesg=\r\ncloudServer=\r\ncloudEnabled=0\r\n[UltraVNC]\r\npasswd=B16A3A6F32CE4F0B1E\r\npasswd2=B16A3A6F32CE4F0B1E\r\n[poll]\r\nTurboMode=1\r\nPollUnderCursor=0\r\nPollForeground=0\r\nPollFullScreen=1\r\nOnlyPollConsole=0\r\nOnlyPollOnEvent=0\r\nMaxCpu2=100\r\nMaxFPS=25\r\nEnableDriver=1\r\nEnableHook=1\r\nEnableVirtual=0\r\nautocapt=1\r\n</span><span class="s">&quot;</span>;
                <span class="i">File</span>.<span class="i">WriteAllText</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">path</span>, <span class="s">&quot;UltraVNC.ini&quot;</span>), <span class="i">iniFileContent</span>);
                <b>return</b> <b>true</b>;
            } <b>catch</b> { <b>return false</b>; }
        }
    }
}</pre></td></tr></table></div></body></html>
