<!DOCTYPE html>
<html><head><title>TemplateClassListAutoDBTranslationWithSubPage.xaml.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(672);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EasySYSTEMbuilderHelp/FormTemplates/SystemAutoDBLanguagesTemplates/TemplateClassListAutoDBTranslationWithSubPage.xaml.cs" target="_top">FormTemplates\SystemAutoDBLanguagesTemplates\TemplateClassListAutoDBTranslationWithSubPage.xaml.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EasySYSTEMbuilderHelp" target="_top">HelpProjects\EasySYSTEMbuilderHelp\EasySYSTEMbuilderHelp.vbproj</a> (EasySYSTEMbuilderHelp)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">Api</span>;
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">Classes</span>;
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">GlobalClasses</span>;
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">GlobalOperations</span>;
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">GlobalStyles</span>;
<b>using</b> <span class="i">MahApps</span>.<span class="i">Metro</span>.<span class="i">Controls</span>.<span class="i">Dialogs</span>;
<b>using</b> <span class="i">Newtonsoft</span>.<span class="i">Json</span>;
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Data</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Net</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Net</span>.<span class="i">Http</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Threading</span>.<span class="i">Tasks</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Controls</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Input</span>;
 
// <span class="i">This</span> <b>is</b> <span class="i">Template</span> <span class="i">Page</span> <span class="i">ListView</span> + <span class="i">UserForm</span> + <span class="i">Full</span> <span class="i">SubListView</span> <b>And</b> <span class="i">Inserting</span> <span class="i">SubItems</span>
<b>namespace</b> <span class="i n">EasyITSystemCenter</span>.<span class="i n">Pages</span> {
 
    /// &lt;<span class="i">summary</span>&gt;
    /// <span class="i">This</span> <span class="i">standartized</span> <span class="i">Template</span> <b>is</b> <span class="i">only</span> <b>for</b> <span class="i">list</span> <span class="i">view</span> <span class="i">od</span> <span class="i">Data</span> <span class="i">table</span> <span class="i">Called</span> <span class="i">from</span> <span class="i">MainWindow</span>.<span class="i">cs</span> <b>on</b>
    /// <span class="i">open</span> <b>New</b> <span class="i">Tab</span>
    /// &lt;/<span class="i">summary</span>&gt;
    <b>public</b> <b>partial</b> <b>class</b> <a id="af7edd3b46e604dc" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="dfb03842c51a63ad">TemplateClassListAutoDBTranslationWithSubPage</span></a> : <span class="i">UserControl</span> {
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">declaring</span> <b>static</b> <span class="i">page</span> <span class="i">data</span> <b>and</b> <span class="i">selected</span> <span class="i">record</span> <b>for</b> <span class="i">All</span> <span class="i">Pages</span> <span class="i">this</span> <span class="i">method</span> <b>is</b>
        /// <b>for global</b> <span class="i">working</span> <b>with</b> <span class="i">pages</span> <span class="i">Called</span> <span class="i">from</span> <span class="i">MainWindow</span>.<span class="i">cs</span> <b>for</b> <span class="i">Control</span> <b>of</b> <span class="i">Button</span> <span class="i">Menu</span> <b>and</b>
        /// <span class="i">Selections</span> (<span class="i">Report</span>,<span class="i">Filter</span> <b>and</b> <span class="i">more</span>) <span class="i">All</span> <b>is</b> <span class="i">setted</span> <b>as global</b> <span class="i">Classes</span> <b>for</b> <span class="i">All</span> <span class="i">Pages</span> <b>and</b>
        /// <span class="i">Work</span> <b>is</b> <span class="i">Fully</span> <span class="i">automatized</span> <span class="i">by</span> <span class="i">System</span> <span class="i">core</span>
        ///
        /// <span class="i">HERE</span> <span class="i">you</span> <span class="i">Define</span> <span class="i">All</span> <span class="i">Data</span> <span class="i">Variables</span> <b>For</b> <span class="i">This</span> <span class="i">Form</span>
        /// &lt;/<span class="i">summary</span>&gt;
        <b>public static</b> <a id="db852156638de40f" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">DataViewSupport</a> <span class="i">dataViewSupport</span> = <b>new</b> <span class="i">DataViewSupport</span>();
 
        <b>public static</b> <a id="c6d3a49c02f56b8e" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">ExtendedOfferList</a> <span class="i">selectedRecord</span> = <b>new</b> <span class="i">ExtendedOfferList</span>();
 
        <b>private</b> <a id="f2462c30f92511cb" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">SystemDocumentAdviceList</a> <span class="i">DocumentAdviceList</span> = <b>new</b> <span class="i">SystemDocumentAdviceList</span>();
        <b>private</b> <a id="e1ec5d9dd782b4f7" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">List</a>&lt;<span class="i">BasicCurrencyList</span>&gt; <span class="i">CurrencyList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">BasicCurrencyList</span>&gt;();
        <b>private string</b> <span class="i">Supplier</span> = <span class="i">null</span>; <b>private string</b> <span class="i">Customer</span> = <span class="i">null</span>;
        <b>private</b> <a id="e1ec5d9dd782b4f7" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">List</a>&lt;<span class="i">BusinessAddressList</span>&gt; <span class="i">AddressList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">BusinessAddressList</span>&gt;();
        <b>private string</b> <span class="i">LastCustomerCorrectSearch</span>, <span class="i">LastPartNumberCorrectSearch</span> = <span class="s">&quot;&quot;</span>; <b>private</b> <span class="i">bool</span> <span class="i">messageShown</span> = <b>false;
 
        private</b> <a id="e1ec5d9dd782b4f7" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">List</a>&lt;<span class="i">DocumentItemList</span>&gt; <span class="i">DocumentItemList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">DocumentItemList</span>&gt;();
        <b>private</b> <a id="e1ec5d9dd782b4f7" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">List</a>&lt;<span class="i">BasicItemList</span>&gt; <span class="i">ItemList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">BasicItemList</span>&gt;();
        <b>private</b> <a id="e1ec5d9dd782b4f7" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">List</a>&lt;<span class="i">BasicVatList</span>&gt; <span class="i">VatList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">BasicVatList</span>&gt;();
        <b>private</b> <a id="e1ec5d9dd782b4f7" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">List</a>&lt;<span class="i">BusinessNotesList</span>&gt; <span class="i">NotesList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">BusinessNotesList</span>&gt;();
        <b>private</b> <a id="e1ec5d9dd782b4f7" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">List</a>&lt;<span class="i">BasicUnitList</span>&gt; <span class="i">UnitList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">BasicUnitList</span>&gt;();
        <b>private string</b> <span class="i">itemVatPriceFormat</span> = <span class="s">&quot;N2&quot;</span>; <b>private string</b> <span class="i">documentVatPriceFormat</span> = <span class="s">&quot;N0&quot;</span>;
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Initialize</span> <span class="i">page</span> <b>with</b> <span class="i">loading</span> <span class="i">Dictionary</span> <b>and</b> <span class="i">start</span> <span class="i">loding</span> <span class="i">data</span> <span class="i">Manual</span> <span class="i">work</span> <span class="i">needed</span>
        /// <span class="i">Translate</span> <span class="i">All</span> <span class="i">XAML</span> <span class="i">fields</span> <span class="i">by</span> <span class="i">Resources</span> <span class="i">Runned</span> <b>on</b> <span class="i">start</span>
        /// &lt;/<span class="i">summary</span>&gt;
        <b>public</b> <a id="d78a81d17c8ebffb" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">TemplateClassListAutoDBTranslationWithSubPage</a>() {
            <span class="i">InitializeComponent</span>();
            _ = <span class="i">SystemOperations</span>.<span class="i">SetLanguageDictionary</span>(<span class="i">Resources</span>, <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">Key</span> == <span class="s">&quot;sys_defaultLanguage&quot;</span>).<span class="i">Value</span>);
 
            <b>try</b> {
                _ = <span class="i">DataOperations</span>.<span class="i">TranslateFormFields</span>(<span class="i">ListForm</span>);
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">autoEx</span>) { <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<span class="i">autoEx</span>); }
 
            <span class="i">LoadParameters</span>();
            _ = <span class="i">LoadDataList</span>();
            <span class="i">SetRecord</span>(<b>false</b>);
        }
 
        <b>private async</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">LoadParameters</span>() {
            <span class="i">itemVatPriceFormat</span> = <span class="i">await</span> <span class="i">DataOperations</span>.<span class="i">ParameterCheck</span>(<span class="s">&quot;ItemVatPriceFormat&quot;</span>);
            <span class="i">documentVatPriceFormat</span> = <span class="i">await</span> <span class="i">DataOperations</span>.<span class="i">ParameterCheck</span>(<span class="s">&quot;DocumentVatPriceFormat&quot;</span>);
            <span class="i">DgListView</span>.<span class="i">RowHeight</span> = <span class="i">int</span>.<span class="i">Parse</span>(<span class="i">await</span> <span class="i">DataOperations</span>.<span class="i">ParameterCheck</span>(<span class="s">&quot;DocumentRowHeight&quot;</span>));
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">Method</span> <b>for</b> <span class="i">Loading</span> <span class="i">data</span>. <span class="i">Manual</span> <span class="i">Changing</span> <b>is</b> <span class="i">needed</span> <b>for</b> <span class="i">simple</span> <span class="i">form</span> <b>is</b> <span class="i">All</span>
        /// <span class="i">changed</span> <span class="i">By</span> <span class="i">CLASNAME</span> <span class="i">Chage</span>, <span class="i">but</span> <b>If</b> <span class="i">you</span> <span class="i">need</span> <span class="i">More</span> <span class="i">API</span> <span class="i">data</span> <b>for</b> <span class="i">selection</span> <span class="i">Here</span> <span class="i">are</span> <span class="i">Defined</span>
        /// <span class="i">All</span> <span class="i">incoming</span> <span class="i">Data</span> <span class="i">Loading</span> <b>is</b> <span class="i">same</span> <span class="i">centralized</span> <span class="i">only</span> <span class="i">change</span> <span class="i">ClasName</span> <b>For</b> <span class="i">Diferent</span> <span class="i">Dataset</span>
        ///
        /// <span class="i">After</span> <span class="i">all</span> <span class="i">data</span> <b>for</b> <span class="i">DatagridView</span> (<span class="i">List</span> <span class="i">Data</span>) <span class="i">are</span> <span class="i">loaded</span> <span class="i">The</span> <span class="i">ProgressRing</span> <b>is</b> <span class="i">hidden</span> <span class="i">This</span>
        /// <b>is on</b> <span class="i">Every</span> <span class="i">page</span> (<span class="c">&#39;View&#39; and &#39;Form&#39; Types) without &#39;Setting&#39; Type (Name=Setting and</span>
        /// <span class="i">Tag</span>=<span class="i">Setting</span> <b>in</b> <span class="i">XAML</span> <span class="i">part</span>) <span class="i">this</span> <span class="i">method</span> <b>is for global</b> <span class="i">working</span> <b>with</b> <span class="i">pages</span> <span class="i">Called</span> <span class="i">from</span>
        /// <span class="i">MainWindow</span>.<span class="i">cs</span> <b>on</b> <span class="i">Refresh</span> <span class="i">button</span> <span class="i">click</span> <span class="i">Runned</span> <b>on</b> <span class="i">Pageloading</span> <b>or</b> <span class="i">Filter</span> <b>or</b> <span class="i">View</span> <span class="i">Change</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public async</b> <a id="02b3482fb18ab6b1" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">Task</a>&lt;<span class="i">bool</span>&gt; <span class="i">LoadDataList</span>() {
            <span class="i">MainWindow</span>.<span class="i">ProgressRing</span> = <span class="i">Visibility</span>.<span class="i">Visible</span>;
            <span class="i">List</span>&lt;<span class="i">BusinessOfferList</span>&gt; <span class="i">offerList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">BusinessOfferList</span>&gt;();
            <span class="i">List</span>&lt;<span class="i">BusinessExchangeRateList</span>&gt; <span class="i">exchangeRateList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">BusinessExchangeRateList</span>&gt;();
            <span class="i">List</span>&lt;<span class="i">ExtendedOfferList</span>&gt; <span class="i">extendedOfferList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ExtendedOfferList</span>&gt;();
            <span class="i">BusinessBranchList</span> <a id="42c1d64bbcb90abf" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">defaultAddress</a> = <b>new</b> <span class="i">BusinessBranchList</span>();
            <b>try</b> {
                <span class="i">defaultAddress</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">GetApiRequest</span>&lt;<span class="i">BusinessBranchList</span>&gt;(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessBranchList</span>, <span class="s">&quot;Active&quot;</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                <span class="i">DocumentAdviceList</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">GetApiRequest</span>&lt;<span class="i">SystemDocumentAdviceList</span>&gt;(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterSystemDocumentAdviceList</span>, <span class="s">&quot;offer/&quot;</span> + <span class="i">defaultAddress</span>.<span class="i">Id</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                <b>if</b> (<span class="i">DocumentAdviceList</span> == <span class="i">null</span>) { <span class="i">await</span> <span class="i">MainWindow</span>.<span class="i">ShowMessageOnMainWindow</span>(<b>true</b>, <span class="i">Resources</span>[<span class="s">&quot;documentAdviceNotSet&quot;</span>].<span class="i">ToString</span>()); }
                <span class="i">cb_totalCurrency</span>.<span class="i">ItemsSource</span> = <span class="i">CurrencyList</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">GetApiRequest</span>&lt;<span class="i">List</span>&lt;<span class="i">BasicCurrencyList</span>&gt;&gt;(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBasicCurrencyList</span>, <span class="i">null</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                <span class="i">cb_notes</span>.<span class="i">ItemsSource</span> = <span class="i">NotesList</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">GetApiRequest</span>&lt;<span class="i">List</span>&lt;<span class="i">BusinessNotesList</span>&gt;&gt;(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessNotesList</span>, <span class="i">null</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                <span class="i">cb_unit</span>.<span class="i">ItemsSource</span> = <span class="i">UnitList</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">GetApiRequest</span>&lt;<span class="i">List</span>&lt;<span class="i">BasicUnitList</span>&gt;&gt;(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBasicUnitList</span>, <span class="i">null</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                <span class="i">cb_vat</span>.<span class="i">ItemsSource</span> = <span class="i">VatList</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">GetApiRequest</span>&lt;<span class="i">List</span>&lt;<span class="i">BasicVatList</span>&gt;&gt;(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBasicVatList</span>, <span class="i">null</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
 
                <span class="i">CurrencyList</span>.<span class="i">ForEach</span>(<span class="i">async</span> <span class="i">currency</span> =&gt; {
                    <b>if</b> (!<span class="i">currency</span>.<span class="i">Fixed</span>) { <span class="i">currency</span>.<span class="i">ExchangeRate</span> = (<span class="i">await</span> <span class="i">CommApi</span>.<span class="i">GetApiRequest</span>&lt;<span class="i">BusinessExchangeRateList</span>&gt;(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessExchangeRateList</span>, <span class="i">currency</span>.<span class="i">Name</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>)).<span class="i">Value</span>; }
                });
 
                <span class="i">Supplier</span> = <span class="i">defaultAddress</span>.<span class="i">CompanyName</span> + <span class="i">Environment</span>.<span class="i">NewLine</span> +
                            <span class="i">defaultAddress</span>.<span class="i">ContactName</span> + <span class="i">Environment</span>.<span class="i">NewLine</span> +
                            <span class="i">defaultAddress</span>.<span class="i">Street</span> + <span class="i">Environment</span>.<span class="i">NewLine</span> +
                            <span class="i">defaultAddress</span>.<span class="i">PostCode</span> + <span class="s">&quot; &quot;</span> + <span class="i">defaultAddress</span>.<span class="i">City</span> + <span class="i">Environment</span>.<span class="i">NewLine</span> + <span class="i">Environment</span>.<span class="i">NewLine</span> +
                            <span class="i">Resources</span>[<span class="s">&quot;account&quot;</span>].<span class="i">ToString</span>() + <span class="s">&quot;: &quot;</span> + <span class="i">defaultAddress</span>.<span class="i">BankAccount</span> + <span class="i">Environment</span>.<span class="i">NewLine</span> +
                            <span class="i">Resources</span>[<span class="s">&quot;ico&quot;</span>].<span class="i">ToString</span>() + <span class="s">&quot;: &quot;</span> + <span class="i">defaultAddress</span>.<span class="i">Ico</span> + <span class="s">&quot;; &quot;</span> + <span class="i">Resources</span>[<span class="s">&quot;dic&quot;</span>].<span class="i">ToString</span>() + <span class="s">&quot;: &quot;</span> + <span class="i">defaultAddress</span>.<span class="i">Dic</span> + <span class="i">Environment</span>.<span class="i">NewLine</span> +
                            <span class="i">Resources</span>[<span class="s">&quot;phone&quot;</span>].<span class="i">ToString</span>() + <span class="s">&quot;: &quot;</span> + <span class="i">defaultAddress</span>.<span class="i">Phone</span> + <span class="i">Environment</span>.<span class="i">NewLine</span> +
                            <span class="i">Resources</span>[<span class="s">&quot;email&quot;</span>].<span class="i">ToString</span>() + <span class="s">&quot;: &quot;</span> + <span class="i">defaultAddress</span>.<span class="i">Email</span>;
 
                <span class="i">offerList</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">GetApiRequest</span>&lt;<span class="i">List</span>&lt;<span class="i">BusinessOfferList</span>&gt;&gt;(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessOfferList</span>, (<span class="i">dataViewSupport</span>.<span class="i">AdvancedFilter</span> == <span class="i">null</span>) ? <span class="i">null</span> : <span class="s">&quot;Filter/&quot;</span> + <span class="i">WebUtility</span>.<span class="i">UrlEncode</span>(<span class="i">dataViewSupport</span>.<span class="i">AdvancedFilter</span>.<span class="i">Replace</span>(<span class="s">&quot;[!]&quot;</span>, <span class="s">&quot;&quot;</span>).<span class="i">Replace</span>(<span class="s">&quot;{!}&quot;</span>, <span class="s">&quot;&quot;</span>)), <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                <span class="i">offerList</span>.<span class="i">ForEach</span>(<span class="i">record</span> =&gt; {
                    <span class="i">ExtendedOfferList</span> <a id="c3949e544ddad9e1" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">item</a> = <b>new</b> <span class="i">ExtendedOfferList</span>() {
                        <span class="i">Id</span> = <span class="i">record</span>.<span class="i">Id</span>,
                        <span class="i">DocumentNumber</span> = <span class="i">record</span>.<span class="i">DocumentNumber</span>,
                        <span class="i">Supplier</span> = <span class="i">record</span>.<span class="i">Supplier</span>,
                        <span class="i">Customer</span> = <span class="i">record</span>.<span class="i">Customer</span>,
                        <span class="i">OfferValidity</span> = <span class="i">record</span>.<span class="i">OfferValidity</span>,
                        <span class="i">Storned</span> = <span class="i">record</span>.<span class="i">Storned</span>,
                        <span class="i">TotalCurrencyId</span> = <span class="i">record</span>.<span class="i">TotalCurrencyId</span>,
                        <span class="i">Description</span> = <span class="i">record</span>.<span class="i">Description</span>,
                        <span class="i">TotalPriceWithVat</span> = <span class="i">record</span>.<span class="i">TotalPriceWithVat</span>,
                        <span class="i">UserId</span> = <span class="i">record</span>.<span class="i">UserId</span>,
                        <span class="i">TimeStamp</span> = <span class="i">record</span>.<span class="i">TimeStamp</span>,
                        <span class="i">TotalCurrency</span> = <span class="i">CurrencyList</span>.<span class="i">Where</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">Id</span> == <span class="i">record</span>.<span class="i">TotalCurrencyId</span>).<span class="i">First</span>().<span class="i">Name</span>
                    };
                    <span class="i">extendedOfferList</span>.<span class="i">Add</span>(<span class="i">item</span>);
                });
                <span class="i">DgListView</span>.<span class="i">ItemsSource</span> = <span class="i">extendedOfferList</span>;
                <span class="i">DgListView</span>.<span class="i">Items</span>.<span class="i">Refresh</span>();
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">autoEx</span>) { <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<span class="i">autoEx</span>); }
 
            <span class="i">MainWindow</span>.<span class="i">ProgressRing</span> = <span class="i">Visibility</span>.<span class="i">Hidden</span>; <b>return true</b>;
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">method</span> <b>for</b> <span class="i">translating</span> <span class="i">column</span> <span class="i">names</span> <b>of</b> <span class="i">DatagidView</span> (<span class="i">List</span> <span class="i">Data</span>) <span class="i">Manual</span>
        /// <span class="i">Changing</span> <b>is</b> <span class="i">needed</span> <b>for set</b> <span class="i">Translate</span> <b>of</b> <span class="i">Column</span> <span class="i">Names</span> <span class="i">via</span> <span class="i">Dictionary</span> <span class="i">Items</span> <span class="i">Here</span> <span class="i">you</span> <span class="i">can</span>
        /// <b>set</b> <span class="i">Format</span>(<b>Date</b>,<span class="i">time</span>, <span class="i">etc</span>),<span class="i">Index</span> <span class="i">position</span>, <span class="i">Hide</span> <span class="i">Column</span>, <span class="i">Translate</span>, <span class="i">change</span> <span class="i">grahics</span> <span class="i">Style</span>
        /// <span class="i">This</span> <b>is on</b> <span class="i">Every</span> <span class="i">page</span> (<span class="c">&#39;View&#39; and &#39;Form&#39; Types) without &#39;Setting&#39; Type (Name=Setting and</span>
        /// <span class="i">Tag</span>=<span class="i">Setting</span> <b>in</b> <span class="i">XAML</span> <span class="i">part</span>) <span class="i">this</span> <span class="i">method</span> <b>is for global</b> <span class="i">working</span> <b>with</b> <span class="i">page</span> <span class="i">internal</span> <span class="i">reaction</span>
        /// <b>on</b> <span class="i">DatagrigView</span> <span class="i">DataFiling</span> <b>on</b> <span class="i">Start</span> <span class="i">Page</span> <span class="i">Runned</span> <b>On</b> <span class="i">Page</span> <span class="i">Loading</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;sender&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;ex&quot;</span>&gt;    &lt;/<span class="i">param</span>&gt;
        <b>private async</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">DgListView_Translate</span>(<b>object</b> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">ex</span>) {
            <b>try</b> {
                ((<span class="i">DataGrid</span>)<span class="i">sender</span>).<span class="i">Columns</span>.<span class="i">ToList</span>().<span class="i">ForEach</span>(<span class="i">async</span> <span class="i">e</span> =&gt; {
                    <b>string</b> <span class="i">headername</span> = <span class="i">e</span>.<span class="i">Header</span>.<span class="i">ToString</span>();
                    <b>if</b> (<span class="i">headername</span> == <span class="s">&quot;DocumentNumber&quot;</span>) { <span class="i">e</span>.<span class="i">Header</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">headername</span>); <span class="i">e</span>.<span class="i">DisplayIndex</span> = 1; }
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;Supplier&quot;</span>) { <span class="i">e</span>.<span class="i">Header</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">headername</span>); <span class="i">e</span>.<span class="i">DisplayIndex</span> = 2; }
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;Customer&quot;</span>) { <span class="i">e</span>.<span class="i">Header</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">headername</span>); <span class="i">e</span>.<span class="i">DisplayIndex</span> = 3; }
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;OfferValidity&quot;</span>) { <span class="i">e</span>.<span class="i">Header</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">headername</span>); <span class="i">e</span>.<span class="i">CellStyle</span> = <span class="i">ProgramaticStyles</span>.<span class="i">gridTextRightAligment</span>; <span class="i">e</span>.<span class="i">DisplayIndex</span> = 4; }
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;Storned&quot;</span>) { <span class="i">e</span>.<span class="i">Header</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">headername</span>); <span class="i">e</span>.<span class="i">DisplayIndex</span> = 8; }
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;Description&quot;</span>) <span class="i">e</span>.<span class="i">Header</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">headername</span>);
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;TotalPriceWithVat&quot;</span>) { <span class="i">e</span>.<span class="i">Header</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">headername</span>); <span class="i">e</span>.<span class="i">DisplayIndex</span> = 5; <span class="i">e</span>.<span class="i">CellStyle</span> = <span class="i">ProgramaticStyles</span>.<span class="i">gridTextRightAligment</span>; (<span class="i">e</span> <b>as</b> <span class="i">DataGridTextColumn</span>).<span class="i">Binding</span>.<span class="i">StringFormat</span> = <span class="s">&quot;N2&quot;</span>; }
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;TotalCurrency&quot;</span>) { <span class="i">e</span>.<span class="i">Header</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">headername</span>); <span class="i">e</span>.<span class="i">DisplayIndex</span> = 6; }
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;Timestamp&quot;</span>) { <span class="i">e</span>.<span class="i">Header</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">headername</span>); <span class="i">e</span>.<span class="i">CellStyle</span> = <span class="i">ProgramaticStyles</span>.<span class="i">gridTextRightAligment</span>; <span class="i">e</span>.<span class="i">DisplayIndex</span> = <span class="i">DgListView</span>.<span class="i">Columns</span>.<span class="i">Count</span> - 1; }
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;Id&quot;</span>) <span class="i">e</span>.<span class="i">DisplayIndex</span> = 0;
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;UserId&quot;</span>) <span class="i">e</span>.<span class="i">Visibility</span> = <span class="i">Visibility</span>.<span class="i">Hidden</span>;
                    <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;TotalCurrencyId&quot;</span>) <span class="i">e</span>.<span class="i">Visibility</span> = <span class="i">Visibility</span>.<span class="i">Hidden</span>;
                });
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">autoEx</span>) { <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<span class="i">autoEx</span>); }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">method</span> <b>for</b> <span class="i">searching</span> <span class="i">match</span> <b>in</b> <span class="i">setted</span> <span class="i">columns</span>. <span class="i">Searched</span> <span class="i">value</span> <b>is</b> <span class="i">from</span> <span class="i">the</span>
        /// <span class="i">simple</span> <span class="c">&#39;Search Input&#39; for DatagidView (List Data) Manual Changing is needed of filtered</span>
        /// <span class="i">columns</span> <span class="i">by</span> <span class="i">Search</span> <span class="i">Value</span> <span class="i">This</span> <b>is on</b> <span class="i">Every</span> <span class="i">page</span> (<span class="c">&#39;View&#39; and &#39;Form&#39; Types) without</span>
        /// <span class="c">&#39;Setting&#39; Type (Name=Setting and Tag=Setting in XAML part) this method is for global</span>
        /// <span class="i">working</span> <b>with</b> <span class="i">pages</span> <span class="i">Called</span> <span class="i">from</span> <span class="i">MainWindow</span>.<span class="i">cs</span> <span class="i">Dynamicaly</span> <span class="i">Called</span> <span class="i">Only</span> <span class="i">from</span> <span class="i">MainWindow</span>.<span class="i">cs</span>
        /// <b>when</b> <span class="i">Search</span> <span class="i">value</span> <span class="i">Inserted</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;filter&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        <b>public</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">Filter</span>(<b>string</b> <span class="i">filter</span>) {
            <b>try</b> {
                <b>if</b> (<span class="i">filter</span>.<span class="i">Length</span> == 0) { <span class="i">dataViewSupport</span>.<span class="i">FilteredValue</span> = <span class="i">null</span>; <span class="i">DgListView</span>.<span class="i">Items</span>.<span class="i">Filter</span> = <span class="i">null</span>; <b>return</b>; }
                <span class="i">dataViewSupport</span>.<span class="i">FilteredValue</span> = <span class="i">filter</span>;
                <span class="i">DgListView</span>.<span class="i">Items</span>.<span class="i">Filter</span> = (<span class="i">e</span>) =&gt; {
                    <span class="i">ExtendedOfferList</span> <a id="e280c9eef37ce437" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">user</a> = <span class="i">e</span> <b>as</b> <span class="i">ExtendedOfferList</span>;
                    <b>return</b> <span class="i">user</span>.<span class="i">Customer</span>.<span class="i">ToLower</span>().<span class="i">Contains</span>(<span class="i">filter</span>.<span class="i">ToLower</span>())
                    || !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="i">user</span>.<span class="i">Description</span>) &amp;&amp; <span class="i">user</span>.<span class="i">Description</span>.<span class="i">ToLower</span>().<span class="i">Contains</span>(<span class="i">filter</span>.<span class="i">ToLower</span>());
                };
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">autoEx</span>) { <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<span class="i">autoEx</span>); }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">Method</span> <b>on</b> <span class="i">All</span> <span class="i">Pages</span> <b>with</b> <span class="i">Forms</span> <b>for</b> <b>New</b> <span class="i">Record</span> <span class="i">ALL</span> <span class="i">Needed</span> <span class="i">changes</span> <span class="i">Are</span> <span class="i">done</span>
        /// <span class="i">By</span> <span class="i">Replace</span> <span class="i">CLASSNAME</span> <b>not</b> <span class="i">needed</span> <span class="i">manual</span> <span class="i">work</span> <span class="i">Dynamicaly</span> <span class="i">Called</span> <span class="i">Only</span> <span class="i">from</span> <span class="i">MainWindow</span>.<span class="i">cs</span> <b>on</b>
        /// <b>New</b> <span class="i">button</span> <span class="i">Click</span> <span class="i">Only</span> <b>Set</b> <span class="i">Record</span> <b>And</b> <span class="i">Hide</span> <span class="i">Dataview</span> <b>and</b> <span class="i">Show</span> <span class="i">Detail</span>
        /// &lt;/<span class="i">summary</span>&gt;
        <b>public</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">NewRecord</span>() {
            <span class="i">selectedRecord</span> = <b>new</b> <span class="i">ExtendedOfferList</span>();
            <span class="i">dataViewSupport</span>.<span class="i">SelectedRecordId</span> = <span class="i">selectedRecord</span>.<span class="i">Id</span>;
            <span class="i">SetRecord</span>(<b>true</b>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">Method</span> <b>on</b> <span class="i">All</span> <span class="i">Pages</span> <b>with</b> <span class="i">Forms</span> <b>for</b> <b>New</b> <span class="i">Record</span> <span class="i">ALL</span> <span class="i">Needed</span> <span class="i">changes</span> <span class="i">Are</span> <span class="i">done</span>
        /// <span class="i">By</span> <span class="i">Replace</span> <span class="i">CLASSNAME</span> <b>not</b> <span class="i">needed</span> <span class="i">manual</span> <span class="i">work</span> <span class="i">Dynamicaly</span> <span class="i">Called</span> <span class="i">Only</span> <span class="i">from</span> <span class="i">MainWindow</span>.<span class="i">cs</span> <b>on</b>
        /// <span class="i">Edit</span> <span class="i">button</span> <span class="i">Click</span> <span class="i">Only</span> <b>Set</b> <span class="i">Record</span> <b>And</b> <span class="i">Hide</span> <span class="i">Dataview</span> <b>and</b> <span class="i">Show</span> <span class="i">Detail</span> <b>with</b> <span class="i">selected</span> <span class="i">Record</span>
        /// &lt;/<span class="i">summary</span>&gt;
        <b>public</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">EditRecord</span>(<span class="i">bool</span> <span class="i">copy</span>) {
            <span class="i">selectedRecord</span> = (<span class="i">ExtendedOfferList</span>)<span class="i">DgListView</span>.<span class="i">SelectedItem</span>;
            <span class="i">dataViewSupport</span>.<span class="i">SelectedRecordId</span> = <span class="i">selectedRecord</span>.<span class="i">Id</span>;
            <span class="i">SetRecord</span>(<b>true</b>, <span class="i">copy</span>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">Method</span> <b>on</b> <span class="i">All</span> <span class="i">Pages</span> <b>with</b> <span class="i">Forms</span> <b>for</b> <b>New</b> <span class="i">Record</span> <span class="i">ALL</span> <span class="i">Needed</span> <span class="i">changes</span> <span class="i">Are</span> <span class="i">done</span>
        /// <span class="i">By</span> <span class="i">Replace</span> <span class="i">CLASSNAME</span> <b>not</b> <span class="i">needed</span> <span class="i">manual</span> <span class="i">work</span> <span class="i">Dynamicaly</span> <span class="i">Called</span> <span class="i">Only</span> <span class="i">from</span> <span class="i">MainWindow</span>.<span class="i">cs</span> <b>on</b>
        /// <span class="i">Delete</span> <span class="i">button</span> <span class="i">Click</span> <span class="i">Show</span> <span class="i">MainWindow</span> <span class="i">Standartized</span> <span class="i">Message</span> <b>with</b> <span class="i">info</span> <span class="i">About</span> <span class="i">Delete</span> <b>and</b>
        /// <span class="i">After</span> <span class="i">confirm</span> <span class="i">Send</span> <span class="i">DeleteApiRequest</span> <span class="i">Reload</span> <span class="i">Datalist</span> <b>and</b> <span class="i">cancel</span> <span class="i">Selected</span> <span class="i">Record</span>
        /// &lt;/<span class="i">summary</span>&gt;
        <b>public async</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">DeleteRecord</span>() {
            <span class="i">selectedRecord</span> = (<span class="i">ExtendedOfferList</span>)<span class="i">DgListView</span>.<span class="i">SelectedItem</span>;
            <span class="i">dataViewSupport</span>.<span class="i">SelectedRecordId</span> = <span class="i">selectedRecord</span>.<span class="i">Id</span>;
            <span class="i">MessageDialogResult</span> <a id="dc42ff8741c586f7" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">result</a> = <b>await</b> <span class="i">MainWindow</span>.<span class="i">ShowMessageOnMainWindow</span>(<b>false</b>, <span class="i">Resources</span>[<span class="s">&quot;deleteRecordQuestion&quot;</span>].<span class="i">ToString</span>() + <span class="s">&quot; &quot;</span> + <span class="i">selectedRecord</span>.<span class="i">Id</span>.<span class="i">ToString</span>(), <b>true</b>);
            <b>if</b> (<span class="i">result</span> == <span class="i">MessageDialogResult</span>.<span class="i">Affirmative</span>) {
                <span class="i">DBResultMessage</span> <a id="e8a37f8472033687" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">dBResult</a> = <b>await</b> <span class="i">CommApi</span>.<span class="i">DeleteApiRequest</span>(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessOfferList</span>, <span class="i">selectedRecord</span>.<span class="i">Id</span>.<span class="i">ToString</span>(), <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                <b>if</b> (<span class="i">dBResult</span>.<span class="i">RecordCount</span> == 0) <span class="i">await</span> <span class="i">MainWindow</span>.<span class="i">ShowMessageOnMainWindow</span>(<b>true</b>, <span class="s">&quot;Exception Error : &quot;</span> + <span class="i">dBResult</span>.<span class="i">ErrorMessage</span>);
                <span class="i">await</span> <a id="c033e50940cbebc0" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">LoadDataList</a>(); <span class="i">SetRecord</span>(<b>false</b>);
            }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">method</span> <b>for</b> <span class="i">selecting</span> <b>and</b> <span class="i">opening</span> <span class="i">Detail</span> <span class="i">Form</span>. <span class="i">This</span> <b>is</b> <span class="i">only</span> <span class="i">View</span> <span class="i">Page</span>, <span class="i">that</span>
        /// <b>is</b> <span class="i">only</span> <b>for Select</b> <span class="i">record</span> <span class="i">This</span> <b>is</b> <span class="i">full</span> <span class="i">automatic</span>, <b>not</b> <span class="i">needed</span> <span class="i">manual</span> <span class="i">work</span> <span class="i">This</span> <b>is on</b>
        /// <span class="i">Every</span> <span class="i">page</span> (<span class="c">&#39;View&#39; and &#39;Form&#39; Types) without &#39;Setting&#39; Type (Name=Setting and</span>
        /// <span class="i">Tag</span>=<span class="i">Setting</span> <b>in</b> <span class="i">XAML</span> <span class="i">part</span>) <span class="i">this</span> <span class="i">method</span> <b>is for global</b> <span class="i">working</span> <span class="i">page</span> <span class="i">its</span> <span class="i">local</span> <span class="i">control</span> <span class="i">From</span> <span class="i">XAML</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;sender&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;e&quot;</span>&gt;     &lt;/<span class="i">param</span>&gt;
        <b>private</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">DgListView_MouseDoubleClick</span>(<b>object</b> <span class="i">sender</span>, <span class="i">MouseButtonEventArgs</span> <span class="i">e</span>) {
            <b>if</b> (<span class="i">DgListView</span>.<span class="i">SelectedItems</span>.<span class="i">Count</span> == 0) <b>return</b>;
            <span class="i">selectedRecord</span> = (<span class="i">ExtendedOfferList</span>)<span class="i">DgListView</span>.<span class="i">SelectedItem</span>;
            <span class="i">dataViewSupport</span>.<span class="i">SelectedRecordId</span> = <span class="i">selectedRecord</span>.<span class="i">Id</span>;
            <span class="i">SetRecord</span>(<b>true</b>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">method</span> <b>for select</b> <span class="i">one</span> <span class="i">record</span> <span class="i">only</span>. <span class="i">This</span> <b>is</b> <span class="i">full</span> <span class="i">automatic</span>, <b>not</b> <span class="i">needed</span>
        /// <span class="i">manual</span> <span class="i">work</span> <span class="i">This</span> <b>is on</b> <span class="i">Every</span> <span class="i">page</span> (<span class="c">&#39;View&#39; and &#39;Form&#39; Types) without &#39;Setting&#39; Type</span>
        /// (<span class="i">Name</span>=<span class="i">Setting</span> <b>and</b> <span class="i">Tag</span>=<span class="i">Setting</span> <b>in</b> <span class="i">XAML</span> <span class="i">part</span>) <span class="i">this</span> <span class="i">method</span> <b>is for global</b> <span class="i">working</span> <span class="i">page</span> <span class="i">its</span>
        /// <span class="i">local</span> <span class="i">control</span> <span class="i">From</span> <span class="i">XAML</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;sender&quot;</span>&gt;<span class="i">The</span> <span class="i">source</span> <b>of</b> <span class="i">the</span> <b>event</b>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;e&quot;</span>&gt;     
        /// <span class="i">The</span> &lt;<span class="i">see</span> <span class="i">cref</span>=<span class="s">&quot;SelectionChangedEventArgs&quot;</span>/&gt; <span class="i">instance</span> <span class="i">containing</span> <span class="i">the</span> <b>event</b> <span class="i">data</span>.
        /// &lt;/<span class="i">param</span>&gt;
        <b>private</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">DgListView_SelectionChanged</span>(<b>object</b> <span class="i">sender</span>, <span class="i">SelectionChangedEventArgs</span> <span class="i">e</span>) {
            <b>if</b> (<span class="i">DgListView</span>.<span class="i">SelectedItems</span>.<span class="i">Count</span> &gt; 0) { <span class="i">selectedRecord</span> = (<span class="i">ExtendedOfferList</span>)<span class="i">DgListView</span>.<span class="i">SelectedItem</span>; }
            <b>else</b> { <span class="i">selectedRecord</span> = <b>new</b> <span class="i">ExtendedOfferList</span>(); }
            <span class="i">dataViewSupport</span>.<span class="i">SelectedRecordId</span> = <span class="i">selectedRecord</span>.<span class="i">Id</span>;
            <span class="i">SetRecord</span>(<b>false</b>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">method</span> <b>for</b> <span class="i">Save</span> <span class="i">Record</span> <b>And return to</b> <span class="i">Dataview</span>. <span class="i">Manual</span> <span class="i">work</span> <span class="i">need</span>, <span class="i">Here</span> <b>is</b>
        /// <span class="i">Join</span> <span class="i">Betwen</span> <span class="i">XAML</span> <span class="i">inputs</span> <b>and</b> <span class="i">Selected</span> <span class="i">Record</span> <span class="i">Dataset</span> (<span class="i">dataset</span> <b>for</b> <span class="i">Detail</span>): <span class="i">Direction</span> <a id="dda71c9cdb985a49" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">FORM</a>
        /// <b>to</b> <span class="i">SELECTED</span> <span class="i">RECORD</span> <span class="i">By</span> <span class="i">ClasName</span> <span class="i">Replacing</span> <span class="i">All</span> <span class="i">other</span> <span class="i">changes</span> <span class="i">are</span> <span class="i">automaticaly</span>
        /// (<span class="i">API</span>,<span class="i">DatasetType</span>), <span class="i">just</span> <span class="i">must</span> <span class="i">define</span> <b>and</b> <span class="i">control</span> <b>Each</b> <span class="i">Field</span> <b>Of</b> <span class="i">Dataset</span> <span class="i">this</span> <span class="i">method</span> <b>is for</b>
        /// <b>global</b> <span class="i">working</span> <span class="i">page</span> <span class="i">its</span> <span class="i">local</span> <span class="i">control</span> <span class="i">From</span> <span class="i">XAML</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;sender&quot;</span>&gt;<span class="i">The</span> <span class="i">source</span> <b>of</b> <span class="i">the</span> <b>event</b>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;e&quot;</span>&gt;     
        /// <span class="i">The</span> &lt;<span class="i">see</span> <span class="i">cref</span>=<span class="s">&quot;RoutedEventArgs&quot;</span>/&gt; <span class="i">instance</span> <span class="i">containing</span> <span class="i">the</span> <b>event</b> <span class="i">data</span>.
        /// &lt;/<span class="i">param</span>&gt;
        <b>private async</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">BtnSave_Click</span>(<b>object</b> <span class="i">sender</span>, <span class="i">RoutedEventArgs</span> <span class="i">e</span>) {
            <b>try</b> {
                <span class="i">DBResultMessage</span> <a id="e8a37f8472033687" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">dBResult</a>;
                <span class="i">selectedRecord</span>.<span class="i">DocumentNumber</span> = <span class="i">txt_documentNumber</span>.<span class="i">Text</span>;
                <span class="i">selectedRecord</span>.<span class="i">Supplier</span> = <span class="i">txt_supplier</span>.<span class="i">Text</span>;
                <span class="i">selectedRecord</span>.<span class="i">Customer</span> = <span class="i">txt_customer</span>.<span class="i">Text</span>;
                <span class="i">selectedRecord</span>.<span class="i">OfferValidity</span> = (<span class="i">txt_offerValidity</span>.<span class="i">Value</span> == <span class="i">null</span>) ? 30 : (<span class="i">int</span>)<span class="i">txt_offerValidity</span>.<span class="i">Value</span>;
                <span class="i">selectedRecord</span>.<span class="i">Storned</span> = (<span class="i">bool</span>)<span class="i">chb_storned</span>.<span class="i">IsChecked</span>;
                <span class="i">selectedRecord</span>.<span class="i">TotalCurrencyId</span> = ((<span class="i">BasicCurrencyList</span>)<span class="i">cb_totalCurrency</span>.<span class="i">SelectedItem</span>).<span class="i">Id</span>;
                <span class="i">selectedRecord</span>.<span class="i">Description</span> = <span class="i">txt_description</span>.<span class="i">Text</span>;
                <span class="i">selectedRecord</span>.<span class="i">TotalPriceWithVat</span> = <b>decimal</b>.<span class="i">Parse</span>(<span class="i">txt_totalPrice</span>.<span class="i">Text</span>.<span class="i">Split</span>(<span class="c">&#39; &#39;)[0]);</span>
                <span class="i">selectedRecord</span>.<span class="i">UserId</span> = <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Id</span>;
                <span class="i">selectedRecord</span>.<span class="i">TimeStamp</span> = <span class="i">DateTimeOffset</span>.<span class="i">Now</span>.<span class="i">DateTime</span>;
 
                <b>string</b> <span class="i">json</span> = <span class="i">JsonConvert</span>.<span class="i">SerializeObject</span>(<span class="i">selectedRecord</span>);
                <span class="i">StringContent</span> <a id="0298afcaef782a5e" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">httpContent</a> = <b>new</b> <span class="i">StringContent</span>(<span class="i">json</span>, <span class="i n">System</span>.<span class="i n">Text</span>.<a href="@0@mscorlib/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@0@mscorlib/A.html#a10eb90a3d884500" class="i property">UTF8</a>, <span class="s">&quot;application/json&quot;</span>);
                <b>if</b> (<span class="i">selectedRecord</span>.<span class="i">Id</span> == 0) {
                    <span class="i">dBResult</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">PutApiRequest</span>(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessOfferList</span>, <span class="i">httpContent</span>, <span class="i">null</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                }
                <b>else</b> { <span class="i">dBResult</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">PostApiRequest</span>(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessOfferList</span>, <span class="i">httpContent</span>, <span class="i">null</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>); }
 
                <b>if</b> (<span class="i">dBResult</span>.<span class="i">RecordCount</span> &gt; 0) {
                    //<span class="i">Save</span> <span class="i">Items</span>
                    <span class="i">DocumentItemList</span>.<span class="i">ForEach</span>(<span class="i">item</span> =&gt; { <span class="i">item</span>.<span class="i">Id</span> = 0; <span class="i">item</span>.<span class="i">DocumentNumber</span> = <span class="i">dBResult</span>.<span class="i">Status</span>; <span class="i">item</span>.<span class="i">UserId</span> = <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Id</span>; });
                    <span class="i">dBResult</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">DeleteApiRequest</span>(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessOfferSupportList</span>, <span class="i">dBResult</span>.<span class="i">Status</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                    <span class="i">json</span> = <span class="i">JsonConvert</span>.<span class="i">SerializeObject</span>(<span class="i">DocumentItemList</span>); <span class="i">httpContent</span> = <b>new</b> <span class="i">StringContent</span>(<span class="i">json</span>, <span class="i">System</span>.<span class="i">Text</span>.<span class="i">Encoding</span>.<span class="i">UTF8</span>, <span class="s">&quot;application/json&quot;</span>);
                    <span class="i">dBResult</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">PutApiRequest</span>(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessOfferSupportList</span>, <span class="i">httpContent</span>, <span class="i">null</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                    <b>if</b> (<span class="i">dBResult</span>.<span class="i">RecordCount</span> != <span class="i">DocumentItemList</span>.<span class="i">Count</span>()) { <span class="i">await</span> <span class="i">MainWindow</span>.<span class="i">ShowMessageOnMainWindow</span>(<b>true</b>, <span class="i">Resources</span>[<span class="s">&quot;itemsDBError&quot;</span>].<span class="i">ToString</span>() + <span class="i">Environment</span>.<span class="i">NewLine</span> + <span class="i">dBResult</span>.<span class="i">ErrorMessage</span>); }
                    <b>else</b> {
                        <span class="i">selectedRecord</span> = <b>new</b> <span class="i">ExtendedOfferList</span>();
                        <span class="i">await</span> <a id="c033e50940cbebc0" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">LoadDataList</a>();
                        <span class="i">SetRecord</span>(<span class="i">null</span>);
                    }
                }
                <b>else</b> { <span class="i">await</span> <span class="i">MainWindow</span>.<span class="i">ShowMessageOnMainWindow</span>(<b>true</b>, <span class="s">&quot;Exception Error : &quot;</span> + <span class="i">dBResult</span>.<span class="i">ErrorMessage</span>); }
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">autoEx</span>) { <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<span class="i">autoEx</span>); }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">method</span> <b>for</b> <span class="i">cancel</span> <b>of</b> <span class="i">Editing</span>. <span class="i">Hide</span> <span class="i">Detail</span> <b>and</b> <span class="i">Dataview</span> <span class="i">List</span> <b>is</b> <span class="i">Shown</span> <span class="i">This</span>
        /// <b>is</b> <span class="i">full</span> <span class="i">automatic</span>, <b>not</b> <span class="i">needed</span> <span class="i">manual</span> <span class="i">work</span> <span class="i">This</span> <b>is on</b> <span class="i">Every</span> <span class="i">page</span> (<span class="c">&#39;View&#39; and &#39;Form&#39;</span>
        /// <span class="i">Types</span>) <span class="i">without</span> <span class="c">&#39;Setting&#39; Type (Name=Setting and Tag=Setting in XAML part) this method is</span>
        /// <b>for global</b> <span class="i">working</span> <span class="i">page</span> <span class="i">its</span> <span class="i">local</span> <span class="i">control</span> <span class="i">From</span> <span class="i">XAML</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;sender&quot;</span>&gt;<span class="i">The</span> <span class="i">source</span> <b>of</b> <span class="i">the</span> <b>event</b>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;e&quot;</span>&gt;     
        /// <span class="i">The</span> &lt;<span class="i">see</span> <span class="i">cref</span>=<span class="s">&quot;RoutedEventArgs&quot;</span>/&gt; <span class="i">instance</span> <span class="i">containing</span> <span class="i">the</span> <b>event</b> <span class="i">data</span>.
        /// &lt;/<span class="i">param</span>&gt;
        <b>private</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">BtnCancel_Click</span>(<b>object</b> <span class="i">sender</span>, <span class="i">RoutedEventArgs</span> <span class="i">e</span>) {
            <span class="i">selectedRecord</span> = (<span class="i">DgListView</span>.<span class="i">SelectedItems</span>.<span class="i">Count</span> &gt; 0) ? (<span class="i">ExtendedOfferList</span>)<span class="i">DgListView</span>.<span class="i">SelectedItem</span> : <b>new</b> <span class="i">ExtendedOfferList</span>();
            <span class="i">SetRecord</span>(<b>false</b>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">method</span> <b>for ¨Set</b> <b>New</b> <span class="i">Record</span>/ <span class="i">Edit</span> <span class="i">Record</span> / <span class="i">Copy</span> <span class="i">Record</span> <b>And return to</b>
        /// <span class="i">Dataview</span>. <span class="i">Manual</span> <span class="i">work</span> <span class="i">need</span>, <span class="i">Here</span> <b>is</b> <span class="i">Join</span> <span class="i">Betwen</span> <span class="i">XAML</span> <span class="i">inputs</span> <b>and</b> <span class="i">Selected</span> <span class="i">Record</span> <span class="i">Dataset</span>
        /// (<span class="i">dataset</span> <b>for</b> <span class="i">Detail</span>): <span class="i">Direction</span> <a id="80fd45328f67a024" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">Selected</a> <span class="i">record</span> <b>to</b> <span class="i">FORM</span> <span class="i">By</span> <span class="i">ClasName</span> <span class="i">Replacing</span> <span class="i">All</span> <span class="i">other</span>
        /// <span class="i">changes</span> <span class="i">are</span> <span class="i">automaticaly</span> (<span class="i">API</span>,<span class="i">DatasetType</span>), <span class="i">just</span> <span class="i">must</span> <span class="i">define</span> <b>and</b> <span class="i">control</span> <b>Each</b> <span class="i">Field</span> <b>Of</b>
        /// <span class="i">Dataset</span> <span class="i">this</span> <span class="i">method</span> <b>is for global</b> <span class="i">working</span> <span class="i">page</span> <span class="i">its</span> <span class="i">local</span> <span class="i">control</span> <span class="i">From</span> <span class="i">XAML</span>
        ///
        /// <b>In</b> <span class="i">this</span> <span class="i">type</span> <span class="i">Form</span> <span class="i">Here</span> <span class="i">Are</span> <span class="i">loaded</span> <span class="i">Data</span> <b>for</b> <span class="i">SublistView</span> (<b>on</b> <span class="i">knows</span> <span class="i">selected</span> <span class="i">record</span> <b>for</b>
        /// <span class="i">correct</span> <span class="i">join</span>)
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;showForm&quot;</span>&gt;<b>if set to</b> &lt;<span class="i">c</span>&gt;<b>true</b>&lt;/<span class="i">c</span>&gt; [show <span class="i">form</span>].&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;copy&quot;</span>&gt;    <b>if set to</b> &lt;<span class="i">c</span>&gt;<b>true</b>&lt;/<span class="i">c</span>&gt; <span class="i">[copy]</span>.&lt;/<span class="i">param</span>&gt;
        <b>private async</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">SetRecord</span>(<span class="i">bool</span>? <span class="i">showForm</span> = <span class="i">null</span>, <span class="i">bool</span> <span class="i">copy</span> = <b>false</b>) {
            <span class="i">SetSubListsNonActiveOnNewItem</span>(<span class="i">selectedRecord</span>.<span class="i">Id</span> == 0);
            <span class="i">selectedRecord</span>.<span class="i">Id</span> = (<span class="i">copy</span>) ? 0 : <span class="i">selectedRecord</span>.<span class="i">Id</span>;
 
            <b>string</b> <span class="i">originalDocumentNumber</span> = (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="i">selectedRecord</span>.<span class="i">DocumentNumber</span>) &amp;&amp; !<span class="i">string</span>.<span class="i">IsNullOrWhiteSpace</span>(<span class="i">DocumentAdviceList</span>.<span class="i">Number</span>)) ? (<span class="i">DocumentAdviceList</span>.<span class="i">Prefix</span> + (<span class="i">int</span>.<span class="i">Parse</span>(<span class="i">DocumentAdviceList</span>.<span class="i">Number</span>) + 1).<span class="i">ToString</span>(<span class="s">&quot;D&quot;</span> + <span class="i">DocumentAdviceList</span>.<span class="i">Number</span>.<span class="i">Length</span>.<span class="i">ToString</span>())) : <span class="i">selectedRecord</span>.<span class="i">DocumentNumber</span>;
            <b>if</b> (<span class="i">copy</span>) {
                <span class="i">txt_documentNumber</span>.<span class="i">Text</span> = (<span class="i">DocumentAdviceList</span>.<span class="i">Prefix</span> + (<span class="i">int</span>.<span class="i">Parse</span>(<span class="i">DocumentAdviceList</span>.<span class="i">Number</span>) + 1).<span class="i">ToString</span>(<span class="s">&quot;D&quot;</span> + <span class="i">DocumentAdviceList</span>.<span class="i">Number</span>.<span class="i">Length</span>.<span class="i">ToString</span>()));
            }
            <b>else</b> { <span class="i">txt_documentNumber</span>.<span class="i">Text</span> = <span class="i">originalDocumentNumber</span>; }
 
            <span class="i">txt_supplier</span>.<span class="i">Text</span> = (!<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="i">selectedRecord</span>.<span class="i">Supplier</span>)) ? <span class="i">selectedRecord</span>.<span class="i">Supplier</span> : <span class="i">Supplier</span>;
            <span class="i">txt_customer</span>.<span class="i">Text</span> = <span class="i">selectedRecord</span>.<span class="i">Customer</span>;
            <span class="i">txt_offerValidity</span>.<span class="i">Value</span> = (<span class="i">selectedRecord</span>.<span class="i">OfferValidity</span> == 0) ? 30 : <span class="i">selectedRecord</span>.<span class="i">OfferValidity</span>;
            <span class="i">chb_storned</span>.<span class="i">IsChecked</span> = <span class="i">selectedRecord</span>.<span class="i">Storned</span>;
            <span class="i">cb_totalCurrency</span>.<span class="i">Text</span> = <span class="i">selectedRecord</span>.<span class="i">TotalCurrency</span>;
            <span class="i">txt_description</span>.<span class="i">Text</span> = <span class="i">selectedRecord</span>.<span class="i">Description</span>;
 
            <b>if</b> (<span class="i">showForm</span> != <span class="i">null</span> &amp;&amp; <span class="i">showForm</span> == <b>true</b>) {
                <span class="i">DocumentItemList</span> = <span class="i">await</span> <span class="i">CommApi</span>.<span class="i">GetApiRequest</span>&lt;<span class="i">List</span>&lt;<span class="i">DocumentItemList</span>&gt;&gt;(<span class="i">ApiUrls</span>.<span class="i">EasyITCenterBusinessOfferSupportList</span>, <span class="i">originalDocumentNumber</span>, <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Token</span>);
                <span class="i">DgSubListView</span>.<span class="i">ItemsSource</span> = <span class="i">DocumentItemList</span>; <span class="i">DgSubListView</span>.<span class="i">Items</span>.<span class="i">Refresh</span>(); <span class="i">ClearItemsFields</span>(); <span class="i">txt_totalPrice</span>.<span class="i">Text</span> = <span class="i">DocumentItemList</span>.<span class="i">Sum</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">TotalPriceWithVat</span>).<span class="i">ToString</span>(<span class="i">documentVatPriceFormat</span>) + ((<span class="i">cb_totalCurrency</span>.<span class="i">SelectedItem</span> != <span class="i">null</span>) ? <span class="s">&quot; &quot;</span> + ((<span class="i">BasicCurrencyList</span>)<span class="i">cb_totalCurrency</span>.<span class="i">SelectedItem</span>).<span class="i">Name</span> : <span class="s">&quot;&quot;</span>);
                <b>if</b> (<span class="i">CurrencyList</span>.<span class="i">Where</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">Default</span>).<span class="i">Count</span>() == 1 &amp;&amp; <span class="i">cb_totalCurrency</span>.<span class="i">Text</span> == <span class="i">null</span>) { <span class="i">cb_totalCurrency</span>.<span class="i">Text</span> = <span class="i">CurrencyList</span>.<span class="i">First</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<b>Default</b>).<span class="i">Name</span>; }
 
                <span class="i">MainWindow</span>.<span class="i">DataGridSelected</span> = <b>true</b>; <span class="i">MainWindow</span>.<span class="i">DataGridSelectedIdListIndicator</span> = <span class="i">selectedRecord</span>.<span class="i">Id</span> != 0; <span class="i">MainWindow</span>.<span class="i">dataGridSelectedId</span> = <span class="i">selectedRecord</span>.<span class="i">Id</span>; <span class="i">MainWindow</span>.<span class="i">DgRefresh</span> = <b>false</b>;
                <span class="i">ListView</span>.<span class="i">Visibility</span> = <span class="i">Visibility</span>.<span class="i">Hidden</span>; <span class="i">ListForm</span>.<span class="i">Visibility</span> = <span class="i">Visibility</span>.<span class="i">Visible</span>; <span class="i">dataViewSupport</span>.<span class="i">FormShown</span> = <b>true</b>;
            }
            <b>else</b> {
                <span class="i">MainWindow</span>.<span class="i">DataGridSelected</span> = <b>true</b>; <span class="i">MainWindow</span>.<span class="i">DataGridSelectedIdListIndicator</span> = <span class="i">selectedRecord</span>.<span class="i">Id</span> != 0; <span class="i">MainWindow</span>.<span class="i">dataGridSelectedId</span> = <span class="i">selectedRecord</span>.<span class="i">Id</span>; <span class="i">MainWindow</span>.<span class="i">DgRefresh</span> = <b>true</b>;
                <span class="i">ListForm</span>.<span class="i">Visibility</span> = <span class="i">Visibility</span>.<span class="i">Hidden</span>; <span class="i">ListView</span>.<span class="i">Visibility</span> = <span class="i">Visibility</span>.<span class="i">Visible</span>; <span class="i">dataViewSupport</span>.<span class="i">FormShown</span> = <span class="i">showForm</span> == <span class="i">null</span> &amp;&amp; !<span class="i">bool</span>.<span class="i">Parse</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">Key</span> == <span class="s">&quot;beh_CloseFormAfterSave&quot;</span>).<span class="i">Value</span>);
            }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">method</span> <b>for</b> <span class="i">translating</span> <span class="i">column</span> <span class="i">names</span> <b>of</b> <span class="i">SubDatagidView</span> (<span class="i">List</span> <span class="i">Data</span>) <span class="i">Manual</span>
        /// <span class="i">Changing</span> <b>is</b> <span class="i">needed</span> <b>for set</b> <span class="i">Translate</span> <b>of</b> <span class="i">Column</span> <span class="i">Names</span> <span class="i">via</span> <span class="i">Dictionary</span> <span class="i">Items</span> <span class="i">Here</span> <span class="i">you</span> <span class="i">can</span>
        /// <b>set</b> <span class="i">Format</span>(<b>Date</b>,<span class="i">time</span>, <span class="i">etc</span>),<span class="i">Index</span> <span class="i">position</span>, <span class="i">Hide</span> <span class="i">Column</span>, <span class="i">Translate</span>, <span class="i">change</span> <span class="i">grahics</span> <span class="i">Style</span>
        /// <span class="i">This</span> <b>is on</b> <span class="i">Every</span> <span class="i">page</span> (<span class="c">&#39;View&#39; and &#39;Form&#39; Types) without &#39;Setting&#39; Type (Name=Setting and</span>
        /// <span class="i">Tag</span>=<span class="i">Setting</span> <b>in</b> <span class="i">XAML</span> <span class="i">part</span>) <span class="i">this</span> <span class="i">method</span> <b>is for global</b> <span class="i">working</span> <b>with</b> <span class="i">page</span> <span class="i">internal</span> <span class="i">reaction</span>
        /// <b>on</b> <span class="i">DatagrigView</span> <span class="i">DataFiling</span> <b>on</b> <span class="i">Start</span> <span class="i">Page</span> <span class="i">Runned</span> <b>On</b> <span class="i">Page</span> <span class="i">Loading</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;sender&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;ex&quot;</span>&gt;    &lt;/<span class="i">param</span>&gt;
        <b>private</b> <a id="ee6b275f00003595" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">DgSubListView_Translate</span>(<b>object</b> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">ex</span>) {
            ((<span class="i">DataGrid</span>)<span class="i">sender</span>).<span class="i">Columns</span>.<span class="i">ToList</span>().<span class="i">ForEach</span>(<span class="i">e</span> =&gt; {
                <b>string</b> <span class="i">headername</span> = <span class="i">e</span>.<span class="i">Header</span>.<span class="i">ToString</span>();
                <b>if</b> (<span class="i">headername</span> == <span class="s">&quot;PartNumber&quot;</span>) <span class="i">e</span>.<span class="i">Header</span> = <span class="i">Resources</span>[<span class="s">&quot;partNumber&quot;</span>].<span class="i">ToString</span>();
                <b>else if</b> (<span class="i">headername</span> == <span class="s">&quot;Name&quot;</span>) <span class="i">e</span>.<span class="i">Header</span> = <span class="i">Resources</span>[<span class="s">&quot;fname&quot;</span>].ToString();
                else if (headername == &quot;Unit&quot;) { e.Header = Resources[&quot;unit&quot;].ToString(); ; e.CellStyle = ProgramaticStyles.gridTextRightAligment; }
                else if (headername == &quot;PcsPrice&quot;) { e.Header = Resources[&quot;pcsPrice&quot;].ToString(); e.CellStyle = ProgramaticStyles.gridTextRightAligment; }
                else if (headername == &quot;Count&quot;) { e.Header = Resources[&quot;count&quot;].ToString(); e.CellStyle = ProgramaticStyles.gridTextRightAligment; }
                else if (headername == &quot;TotalPrice&quot;) { e.Header = Resources[&quot;totalPrice&quot;].ToString(); e.CellStyle = ProgramaticStyles.gridTextRightAligment; }
                else if (headername == &quot;Vat&quot;) { e.Header = Resources[&quot;vat&quot;].ToString(); e.CellStyle = ProgramaticStyles.gridTextRightAligment; }
                else if (headername == &quot;TotalPriceWithVat&quot;) { e.Header = Resources[&quot;totalPriceWithVat&quot;].ToString(); e.CellStyle = ProgramaticStyles.gridTextRightAligment; }
                else if (headername == &quot;Id&quot;) e.Visibility = Visibility.Hidden;
                else if (headername == &quot;UserId&quot;) e.Visibility = Visibility.Hidden;
                else if (headername == &quot;TimeStamp&quot;) e.Visibility = Visibility.Hidden;
                else if (headername == &quot;DocumentNumber&quot;) e.Visibility = Visibility.Hidden;
            });
        }
 
        #region Customer Selection
 
        /// &lt;summary&gt;
        /// Standartized method indicate start loading all data of SubRecord after Selected in
        /// Combobox This is full automatic, not needed manual work
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     &lt;/param&gt;
        private void SelectGotFocus(object sender, RoutedEventArgs e) =&gt; UpdateCustomerSearchResults();
 
        /// &lt;summary&gt;
        /// Standartized method Filling Customer Input by Selected Value This is full automatic, not
        /// needed manual work
        /// &lt;/summary&gt;
        private async void UpdateCustomerSearchResults() {
            try {
                lv_customerSearchResults.Visibility = Visibility.Visible;
                List&lt;BusinessAddressList&gt; tempAddressList = AddressList.Where(a =&gt; a.CompanyName.ToLower().Contains(!string.IsNullOrWhiteSpace(txt_customerFilter.Text) ? txt_customerFilter.Text.ToLower() : &quot;&quot;)).ToList();
                if (tempAddressList.Count() == 0 &amp;&amp; !messageShown) {
                    messageShown = true;
                    var result = await MainWindow.ShowMessageOnMainWindow(false, Resources[&quot;companyNotExist&quot;].ToString());
                    if (result == MessageDialogResult.Affirmative) { messageShown = false; }
                    txt_customerFilter.Text = LastCustomerCorrectSearch; txt_customerFilter.CaretIndex = txt_customer.Text.Length;
                }
                else {
                    lv_customerSearchResults.ItemsSource = tempAddressList;
                    if (lv_customerSearchResults.Items.Count == 1) {
                        lv_customerSearchResults.SelectedItem = lv_customerSearchResults.Items[0];
                        SetCustomer();
                    }
                    else { lv_customerSearchResults.Visibility = Visibility.Visible; }
                    LastCustomerCorrectSearch = txt_customerFilter.Text;
                }
            } catch (Exception autoEx) { App.ApplicationLogging(autoEx); }
        }
 
        /// &lt;summary&gt;
        /// Standartized method for Keyboard control of SelectBox This is full automatic, not needed
        /// manual work
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     &lt;/param&gt;
        private void Customer_KeyDown(object sender, KeyEventArgs e) {
            if (e.Key == Key.Up &amp;&amp; lv_customerSearchResults.Visibility == Visibility.Visible) { lv_customerSearchResults.Focus(); }
            if (e.Key == Key.Down &amp;&amp; lv_customerSearchResults.Visibility == Visibility.Visible) { lv_customerSearchResults.Focus(); }
            if (e.Key != Key.Down &amp;&amp; e.Key != Key.Up &amp;&amp; e.Key != Key.Enter &amp;&amp; lv_customerSearchResults.Visibility == Visibility.Visible) { txt_customerFilter.Focus(); }
        }
 
        /// &lt;summary&gt;
        /// Standartized methods with Indicate Customer Selection and Start Filling Input This is
        /// full automatic, not needed manual work
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     &lt;/param&gt;
        private void SelectCustomer_Enter(object sender, KeyEventArgs e) { if ((e.Key == Key.Enter) &amp;&amp; lv_customerSearchResults.Visibility == Visibility.Visible) { SetCustomer(); } }
 
        private void MouseSelectCustomer_Click(object sender, MouseButtonEventArgs e) =&gt; SetCustomer();
 
        /// &lt;summary&gt;
        /// Standartized methods For Filling Input after Selection This is full automatic, not
        /// needed manual work
        /// &lt;/summary&gt;
        private void SetCustomer() {
            if (lv_customerSearchResults.SelectedIndex &gt; -1) {
                Customer = ((BusinessAddressList)lv_customerSearchResults.SelectedItem).CompanyName + Environment.NewLine +
                            ((BusinessAddressList)lv_customerSearchResults.SelectedItem).ContactName + Environment.NewLine +
                            ((BusinessAddressList)lv_customerSearchResults.SelectedItem).Street + Environment.NewLine +
                            ((BusinessAddressList)lv_customerSearchResults.SelectedItem).PostCode + &quot; &quot; + ((BusinessAddressList)lv_customerSearchResults.SelectedItem).City + Environment.NewLine + Environment.NewLine +
                            Resources[&quot;account&quot;].ToString() + &quot;: &quot; + ((BusinessAddressList)lv_customerSearchResults.SelectedItem).BankAccount + Environment.NewLine +
                            Resources[&quot;ico&quot;].ToString() + &quot;: &quot; + ((BusinessAddressList)lv_customerSearchResults.SelectedItem).Ico + &quot;; &quot; + Resources[&quot;dic&quot;].ToString() + &quot;: &quot; + ((BusinessAddressList)lv_customerSearchResults.SelectedItem).Dic + Environment.NewLine +
                            Resources[&quot;phone&quot;].ToString() + &quot;: &quot; + ((BusinessAddressList)lv_customerSearchResults.SelectedItem).Phone + Environment.NewLine +
                            Resources[&quot;email&quot;].ToString() + &quot;: &quot; + ((BusinessAddressList)lv_customerSearchResults.SelectedItem).Email;
                txt_customer.Text = Customer;
            }
            else { txt_customer.Text = null; }
            lv_customerSearchResults.Visibility = Visibility.Hidden; txt_customer.Focus();
        }
 
        #endregion Customer Selection
 
        #region SubItem Selection
 
        /// &lt;summary&gt;
        /// Standartized method indicate start loading all data of SubRecord after Selected in
        /// Combobox This is full automatic, not needed manual work
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     &lt;/param&gt;
        private void PartNumberGotFocus(object sender, RoutedEventArgs e) =&gt; UpdatePartNumberSearchResults();
 
        private void NameGotFocus(object sender, RoutedEventArgs e) =&gt; lv_partNumberSearchResults.Visibility = Visibility.Hidden;
 
        /// &lt;summary&gt;
        /// Standartized method Filling Customer Input by Selected Value This is full automatic, not
        /// needed manual work
        /// &lt;/summary&gt;
        private async void UpdatePartNumberSearchResults() {
            try {
                lv_partNumberSearchResults.Visibility = Visibility.Visible;
                List&lt;BasicItemList&gt; tempItemList = ItemList.Where(a =&gt; a.PartNumber.ToLower().Contains(!string.IsNullOrWhiteSpace(txt_partNumber.Text) ? txt_partNumber.Text.ToLower() : &quot;&quot;)).ToList();
                if (tempItemList.Count() == 0 &amp;&amp; !messageShown) {
                    messageShown = true;
                    var result = await MainWindow.ShowMessageOnMainWindow(false, Resources[&quot;itemNotExist&quot;].ToString());
                    if (result == MessageDialogResult.Affirmative) { messageShown = false; }
                    txt_partNumber.Text = LastPartNumberCorrectSearch; txt_partNumber.CaretIndex = txt_customer.Text.Length;
                }
                else {
                    lv_partNumberSearchResults.ItemsSource = tempItemList;
                    if (lv_partNumberSearchResults.Items.Count == 1) {
                        lv_partNumberSearchResults.SelectedItem = lv_partNumberSearchResults.Items[0]; SetPartNumber();
                    }
                    else { lv_partNumberSearchResults.Visibility = Visibility.Visible; }
                    LastPartNumberCorrectSearch = txt_partNumber.Text;
                }
            } catch (Exception autoEx) { App.ApplicationLogging(autoEx); }
        }
 
        /// &lt;summary&gt;
        /// Standartized method for Keyboard control of SelectBox This is full automatic, not needed
        /// manual work
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     &lt;/param&gt;
        private void PartNumber_KeyDown(object sender, KeyEventArgs e) {
            if (e.Key == Key.Up &amp;&amp; lv_partNumberSearchResults.Visibility == Visibility.Visible) { lv_partNumberSearchResults.Focus(); }
            if (e.Key == Key.Down &amp;&amp; lv_partNumberSearchResults.Visibility == Visibility.Visible) { lv_partNumberSearchResults.Focus(); }
            if (e.Key != Key.Down &amp;&amp; e.Key != Key.Up &amp;&amp; e.Key != Key.Enter &amp;&amp; lv_partNumberSearchResults.Visibility == Visibility.Visible) { txt_count.Focus(); }
        }
 
        /// &lt;summary&gt;
        /// Standartized method for select one record only. This is full automatic, not needed
        /// manual work This is on page With Sublist (&#39;View&#39; and &#39;Form&#39; Types) without &#39;Setting&#39;
        /// Type (Name=Setting and Tag=Setting in XAML part) this method is for global working page
        /// its local control From XAML
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;The source of the event.&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     The &lt;see cref=&quot;KeyEventArgs&quot;/&gt; instance containing the event data.&lt;/param&gt;
        private void SelectPartNumber_Enter(object sender, KeyEventArgs e) { if ((e.Key == Key.Enter) &amp;&amp; lv_partNumberSearchResults.Visibility == Visibility.Visible) { SetPartNumber(); } }
 
        private void MouseSelectPartNumber_Click(object sender, MouseButtonEventArgs e) =&gt; SetPartNumber();
 
        private void CountChanged(object sender, RoutedPropertyChangedEventArgs&lt;double?&gt; e) =&gt; CalculateItemVatPrice();
 
        /// &lt;summary&gt;
        /// Standartized methods For Filling Input after Selection This is full automatic, not
        /// needed manual work
        /// &lt;/summary&gt;
        private void SetPartNumber() {
            if (lv_partNumberSearchResults.SelectedIndex &gt; -1) {
                txt_partNumber.Text = ((BasicItemList)lv_partNumberSearchResults.SelectedItem).PartNumber;
                txt_name.Text = ((BasicItemList)lv_partNumberSearchResults.SelectedItem).Name;
                cb_unit.Text = ((BasicItemList)lv_partNumberSearchResults.SelectedItem).Unit;
                txt_pcsPrice.Value = double.Parse(((double)((BasicItemList)lv_partNumberSearchResults.SelectedItem).Price * (1 / (double)CurrencyList.First(a =&gt; a.Name == ((BasicCurrencyList)cb_totalCurrency.SelectedItem).Name).ExchangeRate) * (double)CurrencyList.First(a =&gt; a.Id == ((BasicItemList)lv_partNumberSearchResults.SelectedItem).CurrencyId).ExchangeRate).ToString(itemVatPriceFormat));
                cb_vat.SelectedItem = VatList.First(a =&gt; a.Id == ((BasicItemList)lv_partNumberSearchResults.SelectedItem).VatId);
                CalculateItemVatPrice();
            }
            lv_partNumberSearchResults.Visibility = Visibility.Hidden; txt_count.Focus();
        }
 
        #endregion SubItem Selection
 
        private void VatChanged(object sender, SelectionChangedEventArgs e) {
            CalculateItemVatPrice();
        }
 
        private void CalculateItemVatPrice() {
            try {
                txt_totalPriceWithVat.Text = ((double)txt_count.Value * (double)(txt_pcsPrice.Value + txt_pcsPrice.Value * (double)((BasicVatList)cb_vat.SelectedItem).Value)).ToString(itemVatPriceFormat) + &quot; &quot; + ((BasicCurrencyList)cb_totalCurrency.SelectedItem).Name;
                btn_insert.IsEnabled = true;
            } catch { txt_totalPriceWithVat.Text = null; btn_insert.IsEnabled = false; }
            txt_totalPrice.Text = DocumentItemList.Sum(a =&gt; a.TotalPriceWithVat).ToString(documentVatPriceFormat) + ((cb_totalCurrency.SelectedItem != null) ? &quot; &quot; + ((BasicCurrencyList)cb_totalCurrency.SelectedItem).Name : &quot;&quot;);
        }
 
        /// &lt;summary&gt;
        /// Standartized method for select one record only. This is full automatic, not needed
        /// manual work This is on page With Sublist (&#39;View&#39; and &#39;Form&#39; Types) without &#39;Setting&#39;
        /// Type (Name=Setting and Tag=Setting in XAML part) this method is for global working page
        /// its local control From XAML
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;The source of the event.&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     
        /// The &lt;see cref=&quot;SelectionChangedEventArgs&quot;/&gt; instance containing the event data.
        /// &lt;/param&gt;
        private void dgSubListView_SelectionChanged(object sender, SelectionChangedEventArgs e) {
            if (DgSubListView.SelectedItems.Count &gt; 0) {
                btn_delete.IsEnabled = true;
            }
            else { btn_delete.IsEnabled = false; }
        }
 
        /// &lt;summary&gt;
        /// Standartized method for Direct Insert SubRecord to SubListView Manual work needed, set
        /// correct data set for SubRecord This is on page With Sublist (&#39;View&#39; and &#39;Form&#39; Types)
        /// without &#39;Setting&#39; Type (Name=Setting and Tag=Setting in XAML part) this method is for
        /// global working page its local control From XAML
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;The source of the event.&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     
        /// The &lt;see cref=&quot;RoutedEventArgs&quot;/&gt; instance containing the event data.
        /// &lt;/param&gt;
        private void BtnItemInsert_Click(object sender, RoutedEventArgs e) {
            try {
                DocumentItemList.Add(new DocumentItemList() {
                    DocumentNumber = txt_documentNumber.Text,
                    PartNumber = txt_partNumber.Text,
                    Name = txt_name.Text,
                    Unit = cb_unit.Text,
                    PcsPrice = (decimal)txt_pcsPrice.Value,
                    Count = (decimal)txt_count.Value,
                    TotalPrice = (decimal)txt_pcsPrice.Value * (decimal)txt_count.Value,
                    Vat = ((BasicVatList)cb_vat.SelectedItem).Value,
                    TotalPriceWithVat = decimal.Parse(((double)txt_count.Value * (double)(txt_pcsPrice.Value + txt_pcsPrice.Value * (double)((BasicVatList)cb_vat.SelectedItem).Value)).ToString(itemVatPriceFormat))
                });
            } catch (Exception autoEx) { App.ApplicationLogging(autoEx); }
            DgSubListView.ItemsSource = DocumentItemList;
            DgSubListView.Items.Refresh();
 
            txt_totalPrice.Text = DocumentItemList.Sum(a =&gt; a.TotalPriceWithVat).ToString(documentVatPriceFormat) + ((cb_totalCurrency.SelectedItem != null) ? &quot; &quot; + ((BasicCurrencyList)cb_totalCurrency.SelectedItem).Name : &quot;&quot;);
            ClearItemsFields();
        }
 
        /// &lt;summary&gt;
        /// Standartized method for Direct Delete SubRecord to SubListView Manual work needed, set
        /// correct data set for SubRecord This is on page With Sublist (&#39;View&#39; and &#39;Form&#39; Types)
        /// without &#39;Setting&#39; Type (Name=Setting and Tag=Setting in XAML part) this method is for
        /// global working page its local control From XAML
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;The source of the event.&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     
        /// The &lt;see cref=&quot;RoutedEventArgs&quot;/&gt; instance containing the event data.
        /// &lt;/param&gt;
        private void BtnItemDelete_Click(object sender, RoutedEventArgs e) {
            DocumentItemList.RemoveAt(DgSubListView.SelectedIndex);
            DgSubListView.ItemsSource = DocumentItemList;
            DgSubListView.Items.Refresh();
            txt_totalPrice.Text = DocumentItemList.Sum(a =&gt; a.TotalPriceWithVat).ToString(documentVatPriceFormat) + ((cb_totalCurrency.SelectedItem != null) ? &quot; &quot; + ((BasicCurrencyList)cb_totalCurrency.SelectedItem).Name : &quot;&quot;);
        }
 
        /// &lt;summary&gt;
        /// Standartized Maximal Simle Code with Reaction and Fill input After ParentComboboxSelection
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;     &lt;/param&gt;
        private void NotesChanged(object sender, SelectionChangedEventArgs e) { if (cb_notes.SelectedItem != null) { txt_description.Text = ((BusinessNotesList)cb_notes.SelectedItem).Description; cb_notes.SelectedItem = null; } }
 
        /// &lt;summary&gt;
        /// Standartized Method for Clear SubRecord Input Fields with custom Dataset For Correct
        /// Using must be Fields changed for used dataset
        /// &lt;/summary&gt;
        private void ClearItemsFields() {
            txt_partNumber.Text = txt_name.Text = cb_unit.Text = txt_totalPriceWithVat.Text = null;
            txt_count.Value = txt_pcsPrice.Value = null;
            cb_unit.SelectedItem = cb_vat.SelectedItem = null;
            lv_partNumberSearchResults.Visibility = Visibility.Hidden;
        }
 
        /// &lt;summary&gt;
        /// Standartized Method for Load All SubData which is needed for Working with SubRecord For
        /// Correct Using must be changed for actual datasets
        /// &lt;/summary&gt;
        private async void SetSubListsNonActiveOnNewItem(bool newItem) {
            if (newItem) {
                cb_totalCurrency.ItemsSource = CurrencyList.Where(a =&gt; a.Active).ToList();
                AddressList = (await CommApi.GetApiRequest&lt;List&lt;BusinessAddressList&gt;&gt;(ApiUrls.EasyITCenterBusinessAddressList, null, App.UserData.Authentification.Token)).Where(a =&gt; a.Active).ToList();
                ItemList = (await CommApi.GetApiRequest&lt;List&lt;BasicItemList&gt;&gt;(ApiUrls.EasyITCenterBasicItemList, null, App.UserData.Authentification.Token)).Where(a =&gt; a.Active).ToList();
                cb_notes.ItemsSource = NotesList.Where(a =&gt; a.Active).ToList(); cb_unit.ItemsSource = UnitList.Where(a =&gt; a.Active).ToList(); cb_vat.ItemsSource = VatList.Where(a =&gt; a.Active).ToList();
            }
            else {
                cb_totalCurrency.ItemsSource = CurrencyList;
                AddressList = await CommApi.GetApiRequest&lt;List&lt;BusinessAddressList&gt;&gt;(ApiUrls.EasyITCenterBusinessAddressList, null, App.UserData.Authentification.Token);
                ItemList = await CommApi.GetApiRequest&lt;List&lt;BasicItemList&gt;&gt;(ApiUrls.EasyITCenterBasicItemList, null, App.UserData.Authentification.Token);
                cb_notes.ItemsSource = NotesList; cb_unit.ItemsSource = UnitList; cb_vat.ItemsSource = VatList;
            }
        }
    }
}</pre></td></tr></table></div></body></html>
