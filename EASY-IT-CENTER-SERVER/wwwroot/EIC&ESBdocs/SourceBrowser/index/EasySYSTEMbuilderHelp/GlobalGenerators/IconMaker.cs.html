<!DOCTYPE html>
<html><head><title>IconMaker.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(62);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EasySYSTEMbuilderHelp/GlobalGenerators/IconMaker.cs" target="_top">GlobalGenerators\IconMaker.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EasySYSTEMbuilderHelp" target="_top">HelpProjects\EasySYSTEMbuilderHelp\EasySYSTEMbuilderHelp.vbproj</a> (EasySYSTEMbuilderHelp)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Controls</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Media</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Media</span>.<span class="i">Imaging</span>;
 
<b>namespace</b> <span class="i n">EasyITSystemCenter</span>.<span class="i n">GlobalGenerators</span> {
 
    /// &lt;<span class="i">summary</span>&gt;
    /// <span class="i">System</span> <span class="i">Online</span> <span class="i">Icon</span> <span class="i">Generator</span> <span class="i">from</span> <span class="i">custom</span> <span class="i">Path</span> <span class="i">Its</span> <b>for</b> <span class="i">working</span> <b>with</b> <span class="i">Icon</span> <span class="i">over</span> <span class="i">Database</span> <span class="i">Dynamically</span>
    /// &lt;/<span class="i">summary</span>&gt;
    <b>public class</b> <a id="c937f0a29a4ae158" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="e5352c2ac38e731e">IconMaker</span></a> {
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Generate</span> <span class="i">Custom</span> <span class="i">Icon</span> <span class="i">from</span> <span class="i">Defined</span> <span class="i">Path</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;color&quot;</span>&gt;   <span class="i">The</span> <span class="i">color</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;iconPath&quot;</span>&gt;<span class="i">The</span> <span class="i">icon</span> <span class="i">path</span>.&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="45468c4f560bf6a7" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">BitmapImage</a> <span class="i">Icon</span>(<span class="i">Color</span> <span class="i">color</span>, <b>string</b> <span class="i">iconPath</span> = <span class="i">null</span>) {
            <span class="i">var</span> <a id="c7127a00be6970a7" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">canvas</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#382f8bfec4ebad3c" class="t constructor">Canvas</a> {
                <span class="i">Width</span> = 256,
                <span class="i">Height</span> = 256,
                <span class="i">Background</span> = <b>new</b> <span class="i">SolidColorBrush</span>(<span class="i">Colors</span>.<span class="i">Transparent</span>)
            };
            <span class="i">var</span> <a id="2ba415276d9dab8d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">path</a> = <b>new</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Shapes</span>.<a href="@0@PresentationFramework/A.html#ede77210f20e8cf9" class="t t">Path</a>() {
                <span class="i">Data</span> = <a href="@0@PresentationCore/A.html#22ca37af0d997a39" class="t t">Geometry</a>.<span class="i">Parse</span>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<span class="i">IsNullOrWhiteSpace</span>(<span class="i">iconPath</span>)
                    ? <span class="s">&quot;M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L542.6 400c2.7-7.8 1.3-16.5-3.9-23l-14.9-18.6C495.5 322.9 480 278.8 480 233.4V200c0-75.8-55.5-138.6-128-150.1V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V49.9c-43.9 7-81.5 32.7-104.4 68.7L38.8 5.1zM221.7 148.4C239.6 117.1 273.3 96 312 96h8 8c57.4 0 104 46.6 104 104v33.4c0 32.7 6.4 64.8 18.7 94.5L221.7 148.4zM406.2 416l-60.9-48H168.3c21.2-32.8 34.4-70.3 38.4-109.1L160 222.1v11.4c0 45.4-15.5 89.5-43.8 124.9L101.3 377c-5.8 7.2-6.9 17.1-2.9 25.4s12.4 13.6 21.6 13.6H406.2zM384 448H320 256c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7s18.7-28.3 18.7-45.3z&quot;</span>
                    : <span class="i">iconPath</span>
                    ),
                <span class="i">Stretch</span> = <span class="i">Stretch</span>.<span class="i">Fill</span>,
                <span class="i">Fill</span> = <b>new</b> <span class="i">SolidColorBrush</span>(<span class="i">color</span>),
                <span class="i">Width</span> = 256,
                <span class="i">Height</span> = 256,
            };
            <span class="i">canvas</span>.<span class="i">Children</span>.<span class="i">Add</span>(<span class="i">path</span>);
 
            <span class="i">var</span> <a id="5b977cf46f879ce3" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">size</a> = <b>new</b> <a href="@0@WindowsBase/A.html#a9e92f9d82abccc2" class="t constructor">Size</a>(256, 256);
            <span class="i">canvas</span>.<span class="i">Measure</span>(<span class="i">size</span>);
            <span class="i">canvas</span>.<span class="i">Arrange</span>(<b>new</b> <span class="i">Rect</span>(<span class="i">size</span>));
 
            <span class="i">var</span> <a id="558ff1df80c0d98a" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">rtb</a> = <b>new</b> <span class="t">RenderTargetBitmap</span>((<span class="i">int</span>)<span class="i">size</span>.<span class="i">Width</span>, (<span class="i">int</span>)<span class="i">size</span>.<span class="i">Height</span>, 96, 96, <a href="@0@PresentationCore/A.html#8f8a28423b24bd8e" class="t t">PixelFormats</a>.<a href="@0@PresentationCore/A.html#5c3c2dbdef6c1b4d" class="i property">Pbgra32</a>);
            <span class="i">rtb</span>.<span class="i">Render</span>(<span class="i">canvas</span>);
 
            <span class="i">var</span> <a id="a4556a0cf23fc068" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">png</a> = <b>new</b> <a href="@0@PresentationCore/A.html#d83082bf870487dc" class="t constructor">PngBitmapEncoder</a>();
            <span class="i">png</span>.<span class="i">Frames</span>.<span class="i">Add</span>(<span class="i">BitmapFrame</span>.<span class="i">Create</span>(<span class="i">rtb</span>));
 
            <b>using</b> (<span class="i">var</span> <span class="i">memory</span> = <b>new</b> <span class="i">MemoryStream</span>()) {
                <span class="i">png</span>.<span class="i">Save</span>(<span class="i">memory</span>);
                <span class="i">memory</span>.<span class="i">Position</span> = 0;
 
                <span class="i">var</span> <a id="c7b6a22c32a47104" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">bitmapImage</a> = <b>new</b> <a href="@0@PresentationCore/A.html#940e003698ec4c39" class="t constructor">BitmapImage</a>();
                <span class="i">bitmapImage</span>.<span class="i">BeginInit</span>();
                <span class="i">bitmapImage</span>.<span class="i">StreamSource</span> = <span class="i">memory</span>;
                <span class="i">bitmapImage</span>.<span class="i">CacheOption</span> = <span class="i">BitmapCacheOption</span>.<span class="i">OnLoad</span>;
                <span class="i">bitmapImage</span>.<span class="i">EndInit</span>();
 
                <b>return</b> <span class="i">bitmapImage</span>;
            }
        }
    }
}</pre></td></tr></table></div></body></html>
