<!DOCTYPE html>
<html><head><title>ShellViewModel.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(115);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#MenuBar/ViewModels/ShellViewModel.cs" target="_top">ViewModels\ShellViewModel.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#MenuBar" target="_top">HelpProjects\WPF-MAIN\WPFprism\MenuBar\MenuBar\MenuBar.csproj</a> (MenuBar)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Input</span>;

<b>using</b> <span class="i n">MenuBar</span>.<span class="i n">Constants</span>;
<b>using</b> <span class="i n">MenuBar</span>.<span class="i n">Contracts</span>.<span class="i n">Services</span>;

<b>using</b> <span class="i n">Prism</span>.<span class="i n">Commands</span>;
<b>using</b> <span class="i n">Prism</span>.<span class="i n">Mvvm</span>;
<b>using</b> <span class="i n">Prism</span>.<span class="i n">Regions</span>;

<b>namespace</b> <span class="i n">MenuBar</span>.<span class="i n">ViewModels</span>
{
    <span class="c">// You can show pages in different ways (update main view, navigate, right pane, new windows or dialog)</span>
    <span class="c">// using the NavigationService, RightPaneService and WindowManagerService.</span>
    <span class="c">// Read more about MenuBar project type here:</span>
    <span class="c">// https://github.com/Microsoft/WindowsTemplateStudio/blob/master/docs/WPF/projectTypes/menubar.md</span>
    <b>public class</b> <a id="1c28c070e71a1c87" href="../R/1c28c070e71a1c87.html" target="n" data-glyph="0,0" class="t t">ShellViewModel</a> : <span class="t t">BindableBase</span>
    {
        <b>private readonly</b> <span class="t t">IRegionManager</span> <a id="ca6b6832153b7b9f" href="../R/ca6b6832153b7b9f.html" target="n" data-glyph="46,1" class="i field">_regionManager</a>;
        <b>private readonly</b> <a href="../Contracts/Services/IRightPaneService.cs.html#3c710b85eba866b0" class="t t">IRightPaneService</a> <a id="58329c1ddb1ec929" href="../R/58329c1ddb1ec929.html" target="n" data-glyph="46,1" class="i field">_rightPaneService</a>;
        <b>private</b> <span class="t t">IRegionNavigationService</span> <a id="d6e147a902cc45c2" href="../R/d6e147a902cc45c2.html" target="n" data-glyph="46,1" class="i field">_navigationService</a>;
        <b>private</b> <span class="t t">DelegateCommand</span> <a id="2be56b479aadec99" href="../R/2be56b479aadec99.html" target="n" data-glyph="46,1" class="i field">_goBackCommand</a>;
        <b>private</b> <span class="t t">ICommand</span> <a id="6b5716e12229c536" href="../R/6b5716e12229c536.html" target="n" data-glyph="46,1" class="i field">_menuFileSettingsCommand</a>;
        <b>private</b> <span class="t t">ICommand</span> <a id="895fa8231f6f9049" href="../R/895fa8231f6f9049.html" target="n" data-glyph="46,1" class="i field">_menuViewsWebViewCommand</a>;
        <b>private</b> <span class="t t">ICommand</span> <a id="5caaa8590e63d5a7" href="../R/5caaa8590e63d5a7.html" target="n" data-glyph="46,1" class="i field">_menuViewsMasterDetailCommand</a>;
        <b>private</b> <span class="t t">ICommand</span> <a id="4ca9c1483018f23c" href="../R/4ca9c1483018f23c.html" target="n" data-glyph="46,1" class="i field">_menuViewsMainCommand</a>;
        <b>private</b> <span class="t t">ICommand</span> <a id="98d5350f5d408d5d" href="../R/98d5350f5d408d5d.html" target="n" data-glyph="46,1" class="i field">_loadedCommand</a>;
        <b>private</b> <span class="t t">ICommand</span> <a id="c11c9389c236b6a4" href="../R/c11c9389c236b6a4.html" target="n" data-glyph="46,1" class="i field">_unloadedCommand</a>;
        <b>private</b> <span class="t t">ICommand</span> <a id="d080baf6f24b053a" href="../R/d080baf6f24b053a.html" target="n" data-glyph="46,1" class="i field">_menuFileExitCommand</a>;

        <b>public</b> <span class="t t">DelegateCommand</span> <a id="a06425daf8c914b9" href="../R/a06425daf8c914b9.html" target="n" data-glyph="102,1" class="i property">GoBackCommand</a> =&gt; <a href="#2be56b479aadec99" class="i field">_goBackCommand</a> ?? (<a href="#2be56b479aadec99" class="i field">_goBackCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#aa1854f0fc23d9a5" class="i method">OnGoBack</a>, <a href="#c28f323d7026b4b9" class="i method">CanGoBack</a>));

        <b>public</b> <span class="t t">ICommand</span> <a id="9b35fa62bb64e4d7" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">MenuFileSettingsCommand</a> =&gt; <a href="#6b5716e12229c536" class="i field">_menuFileSettingsCommand</a> ?? (<a href="#6b5716e12229c536" class="i field">_menuFileSettingsCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#ac6d567652479871" class="i method">OnMenuFileSettings</a>));

        <b>public</b> <span class="t t">ICommand</span> <a id="d32d686a85c57f72" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">MenuViewsWebViewCommand</a> =&gt; <a href="#895fa8231f6f9049" class="i field">_menuViewsWebViewCommand</a> ?? (<a href="#895fa8231f6f9049" class="i field">_menuViewsWebViewCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#65290a1a525ce27a" class="i method">OnMenuViewsWebView</a>));

        <b>public</b> <span class="t t">ICommand</span> <a id="fc64663dc5ace41c" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">MenuViewsMasterDetailCommand</a> =&gt; <a href="#5caaa8590e63d5a7" class="i field">_menuViewsMasterDetailCommand</a> ?? (<a href="#5caaa8590e63d5a7" class="i field">_menuViewsMasterDetailCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#ef3b70636a2048ca" class="i method">OnMenuViewsMasterDetail</a>));

        <b>public</b> <span class="t t">ICommand</span> <a id="5547a81132b4992d" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">MenuViewsMainCommand</a> =&gt; <a href="#4ca9c1483018f23c" class="i field">_menuViewsMainCommand</a> ?? (<a href="#4ca9c1483018f23c" class="i field">_menuViewsMainCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#597e39f4b2bc224b" class="i method">OnMenuViewsMain</a>));

        <b>public</b> <span class="t t">ICommand</span> <a id="3de4ddf46fe112a6" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LoadedCommand</a> =&gt; <a href="#98d5350f5d408d5d" class="i field">_loadedCommand</a> ?? (<a href="#98d5350f5d408d5d" class="i field">_loadedCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#fcf9bfeb34b296fe" class="i method">OnLoaded</a>));

        <b>public</b> <span class="t t">ICommand</span> <a id="da5178acd6853eed" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">UnloadedCommand</a> =&gt; <a href="#c11c9389c236b6a4" class="i field">_unloadedCommand</a> ?? (<a href="#c11c9389c236b6a4" class="i field">_unloadedCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#f79650ad4c66abc5" class="i method">OnUnloaded</a>));

        <b>public</b> <span class="t t">ICommand</span> <a id="0eec9ecd07b57b52" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">MenuFileExitCommand</a> =&gt; <a href="#d080baf6f24b053a" class="i field">_menuFileExitCommand</a> ?? (<a href="#d080baf6f24b053a" class="i field">_menuFileExitCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#3c609387ba4593f8" class="i method">OnMenuFileExit</a>));

        <b>public</b> <a id="60e8c80af91462f6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ShellViewModel</a>(<span class="t t">IRegionManager</span> <span id="r0 rd" class="r0 r">regionManager</span>, <a href="../Contracts/Services/IRightPaneService.cs.html#3c710b85eba866b0" class="t t">IRightPaneService</a> <span id="r1 rd" class="r1 r">rightPaneService</span>)
        {
            <a href="#ca6b6832153b7b9f" class="i field">_regionManager</a> = <span class="r0 r">regionManager</span>;
            <a href="#58329c1ddb1ec929" class="i field">_rightPaneService</a> = <span class="r1 r">rightPaneService</span>;
        }

        <b>private void</b> <a id="fcf9bfeb34b296fe" href="../R/fcf9bfeb34b296fe.html" target="n" data-glyph="76,1" class="i method">OnLoaded</a>()
        {
            <a href="#d6e147a902cc45c2" class="i field">_navigationService</a> = <a href="#ca6b6832153b7b9f" class="i field">_regionManager</a>.<span class="i property">Regions</span>[<a href="../Constants/Regions.cs.html#1b2492a4369bfa50" class="t t">Regions</a>.<a href="../Constants/Regions.cs.html#ae2f43042b2c3eb3" class="i field">Main</a>].<span class="i property">NavigationService</span>;
            <a href="#d6e147a902cc45c2" class="i field">_navigationService</a>.<span class="i">Navigated</span> += <a href="#8dbd18f2ba20201b" class="i method">OnNavigated</a>;
        }

        <b>private void</b> <a id="f79650ad4c66abc5" href="../R/f79650ad4c66abc5.html" target="n" data-glyph="76,1" class="i method">OnUnloaded</a>()
        {
            <a href="#d6e147a902cc45c2" class="i field">_navigationService</a>.<span class="i">Navigated</span> -= <a href="#8dbd18f2ba20201b" class="i method">OnNavigated</a>;
            <a href="#ca6b6832153b7b9f" class="i field">_regionManager</a>.<span class="i property">Regions</span>.<span class="i method">Remove</span>(<a href="../Constants/Regions.cs.html#1b2492a4369bfa50" class="t t">Regions</a>.<a href="../Constants/Regions.cs.html#ae2f43042b2c3eb3" class="i field">Main</a>);
            <a href="#58329c1ddb1ec929" class="i field">_rightPaneService</a>.<a href="../Contracts/Services/IRightPaneService.cs.html#719803f500f8e8c1" class="i method">CleanUp</a>();
        }

        <b>private bool</b> <a id="c28f323d7026b4b9" href="../R/c28f323d7026b4b9.html" target="n" data-glyph="76,1" class="i method">CanGoBack</a>()
            =&gt; <a href="#d6e147a902cc45c2" class="i field">_navigationService</a> != <b>null</b> &amp;&amp; <a href="#d6e147a902cc45c2" class="i field">_navigationService</a>.<span class="i property">Journal</span>.<span class="i property">CanGoBack</span>;

        <b>private void</b> <a id="aa1854f0fc23d9a5" href="../R/aa1854f0fc23d9a5.html" target="n" data-glyph="76,1" class="i method">OnGoBack</a>()
            =&gt; <a href="#d6e147a902cc45c2" class="i field">_navigationService</a>.<span class="i property">Journal</span>.<span class="i method">GoBack</span>();

        <b>private bool</b> <a id="5cf416a20864dbac" href="../R/5cf416a20864dbac.html" target="n" data-glyph="76,1" class="i method">RequestNavigate</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r2 rd" class="r2 r">target</span>)
        {
            <b>if</b> (<a href="#d6e147a902cc45c2" class="i field">_navigationService</a>.<a href="../Helpers/IRegionNavigationServiceExtensions.cs.html#5e9db30995ca80df" class="i method">CanNavigate</a>(<span class="r2 r">target</span>))
            {
                <a href="#d6e147a902cc45c2" class="i field">_navigationService</a>.<span class="i method">RequestNavigate</span>(<span class="r2 r">target</span>);
                <b>return</b> <b>true</b>;
            }

            <b>return</b> <b>false</b>;
        }

        <b>private void</b> <a id="9e11f7a2f9bb26c6" href="../R/9e11f7a2f9bb26c6.html" target="n" data-glyph="76,1" class="i method">RequestNavigateOnRightPane</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r3 rd" class="r3 r">target</span>)
            =&gt; <a href="#58329c1ddb1ec929" class="i field">_rightPaneService</a>.<a href="../Contracts/Services/IRightPaneService.cs.html#8c6eac1c1bdd27bd" class="i method">OpenInRightPane</a>(<span class="r3 r">target</span>);

        <b>private void</b> <a id="f353e872b805f48c" href="../R/f353e872b805f48c.html" target="n" data-glyph="76,1" class="i method">RequestNavigateAndCleanJournal</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r4 rd" class="r4 r">target</span>)
        {
            <a href="@1@System.Runtime/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r5 rd" class="r5 r">navigated</span> = <a href="#5cf416a20864dbac" class="i method">RequestNavigate</a>(<span class="r4 r">target</span>);
            <b>if</b> (<span class="r5 r">navigated</span>)
            {
                <a href="#d6e147a902cc45c2" class="i field">_navigationService</a>.<span class="i property">Journal</span>.<span class="i method">Clear</span>();
            }
        }

        <b>private void</b> <a id="8dbd18f2ba20201b" href="../R/8dbd18f2ba20201b.html" target="n" data-glyph="76,1" class="i method">OnNavigated</a>(<b>object</b> <span id="r6 rd" class="r6 r">sender</span>, <span class="t t">RegionNavigationEventArgs</span> <span id="r7 rd" class="r7 r">e</span>)
            =&gt; <a href="#a06425daf8c914b9" class="i property">GoBackCommand</a>.<span class="i method">RaiseCanExecuteChanged</span>();

        <b>private void</b> <a id="3c609387ba4593f8" href="../R/3c609387ba4593f8.html" target="n" data-glyph="76,1" class="i method">OnMenuFileExit</a>()
            =&gt; <a href="@0@PresentationFramework/A.html#cf9c51e402f97b05" class="t t">Application</a>.<a href="@0@PresentationFramework/A.html#e6ee08846cb73154" class="i property">Current</a>.<a href="@0@PresentationFramework/A.html#323f71efbcb142b9" class="i method">Shutdown</a>();

        <b>private void</b> <a id="597e39f4b2bc224b" href="../R/597e39f4b2bc224b.html" target="n" data-glyph="76,1" class="i method">OnMenuViewsMain</a>()
            =&gt; <a href="#f353e872b805f48c" class="i method">RequestNavigateAndCleanJournal</a>(<a href="../Constants/PageKeys.cs.html#53272d5509cc2341" class="t t">PageKeys</a>.<a href="../Constants/PageKeys.cs.html#b1b729d3d216926f" class="i field">Main</a>);

        <b>private void</b> <a id="ef3b70636a2048ca" href="../R/ef3b70636a2048ca.html" target="n" data-glyph="76,1" class="i method">OnMenuViewsMasterDetail</a>()
            =&gt; <a href="#f353e872b805f48c" class="i method">RequestNavigateAndCleanJournal</a>(<a href="../Constants/PageKeys.cs.html#53272d5509cc2341" class="t t">PageKeys</a>.<a href="../Constants/PageKeys.cs.html#4ab20c2607c36570" class="i field">MasterDetail</a>);

        <b>private void</b> <a id="65290a1a525ce27a" href="../R/65290a1a525ce27a.html" target="n" data-glyph="76,1" class="i method">OnMenuViewsWebView</a>()
            =&gt; <a href="#f353e872b805f48c" class="i method">RequestNavigateAndCleanJournal</a>(<a href="../Constants/PageKeys.cs.html#53272d5509cc2341" class="t t">PageKeys</a>.<a href="../Constants/PageKeys.cs.html#0be5051282488801" class="i field">WebView</a>);

        <b>private void</b> <a id="ac6d567652479871" href="../R/ac6d567652479871.html" target="n" data-glyph="76,1" class="i method">OnMenuFileSettings</a>()
            =&gt; <a href="#9e11f7a2f9bb26c6" class="i method">RequestNavigateOnRightPane</a>(<a href="../Constants/PageKeys.cs.html#53272d5509cc2341" class="t t">PageKeys</a>.<a href="../Constants/PageKeys.cs.html#1d8dc7bfc50a3daf" class="i field">Settings</a>);
    }
}
</pre></td></tr></table></div></body></html>
