<!DOCTYPE html>
<html><head><title>MainWindow.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(62);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#HandlingEventOnCommandUsingCode/MainWindow.cs" target="_top">MainWindow.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#HandlingEventOnCommandUsingCode" target="_top">HelpProjects\WPF-MORE\Input and Commands\HandlingEventOnCommandUsingCode\HandlingEventOnCommandUsingCode.csproj</a> (HandlingEventOnCommandUsingCode)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// // Copyright (c) Microsoft. All rights reserved.</span>
<span class="c">// // Licensed under the MIT license. See LICENSE file in the project root for full license information.</span>

<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Controls</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Input</span>;

<b>namespace</b> <span class="i n">HandlingEventOnCommandUsingCode</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     Interaction logic for MainWindow.xaml</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public</b> <a href="P/06ae8dfec334b1fe.html" target="s" class="k">partial</a> <b>class</b> <a id="06ae8dfec334b1fe" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">MainWindow</a> : <a href="@0@PresentationFramework/A.html#e438dc91640a8d15" class="t t">Window</a>
    {
        <b>public</b> <a id="bc65e527d1a2f829" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">MainWindow</a>()
        {
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#fadda7f48f7d3d1a" class="i method">InitializeComponent</a>();
            <a href="@0@PresentationFramework/A.html#a815b4f12f279dee" class="i">Loaded</a> += <a href="#be99d2a0147687f5" class="i method">MainWindow_Loaded</a>;
        }

        <b>private void</b> <a id="be99d2a0147687f5" href="R/be99d2a0147687f5.html" target="n" data-glyph="76,1" class="i method">MainWindow_Loaded</a>(<b>object</b> <span id="r0 rd" class="r0 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r1 rd" class="r1 r">e</span>)
        {
            <span class="c">// Creating the main panel</span>
            <a href="@0@PresentationFramework/A.html#74647d237fc89a63" class="k">var</a> <span id="r2 rd" class="r2 r">mainStackPanel</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#71baf37380eff816" class="t constructor">StackPanel</a>();
            <a href="@0@PresentationFramework/A.html#a18bffadae49bf47" class="i method">AddChild</a>(<span class="r2 r">mainStackPanel</span>);

            <span class="c">// Button used to invoke the command</span>
            <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="k">var</a> <span id="r3 rd" class="r3 r">commandButton</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
            {
                <a href="@0@PresentationFramework/A.html#5b33a4a9a485cbc3" class="i property">Command</a> = <a href="@0@PresentationCore/A.html#f5ce0fa6ad00e8b4" class="t t">ApplicationCommands</a>.<a href="@0@PresentationCore/A.html#ad8a45fe29732c6f" class="i property">Open</a>,
                <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Open (KeyBindings: Ctrl-R, Ctrl-0)&quot;</span>
            };
            <span class="r2 r">mainStackPanel</span>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<span class="r3 r">commandButton</span>);

            <span class="c">// Creating CommandBinding and attaching an Executed and CanExecute handler</span>
            <a href="@0@PresentationCore/A.html#7a2b23189409e3d0" class="k">var</a> <span id="r4 rd" class="r4 r">openCmdBinding</span> = <b>new</b> <a href="@0@PresentationCore/A.html#d77b2f2792ce84cf" class="t constructor">CommandBinding</a>(
                <a href="@0@PresentationCore/A.html#f5ce0fa6ad00e8b4" class="t t">ApplicationCommands</a>.<a href="@0@PresentationCore/A.html#ad8a45fe29732c6f" class="i property">Open</a>,
                <a href="#2f03d153fb261af5" class="i method">OpenCmdExecuted</a>,
                <a href="#e685c4be906a8475" class="i method">OpenCmdCanExecute</a>);

            <a href="@0@PresentationCore/A.html#f7cc4be88f56abe2" class="i property">CommandBindings</a>.<a href="@0@PresentationCore/A.html#8e7311636e497744" class="i method">Add</a>(<span class="r4 r">openCmdBinding</span>);

            <span class="c">// Creating a KeyBinding between the Open command and Ctrl-R</span>
            <a href="@0@PresentationCore/A.html#61fa735cefc6adfe" class="k">var</a> <span id="r5 rd" class="r5 r">openCmdKeyBinding</span> = <b>new</b> <a href="@0@PresentationCore/A.html#f074edaa88cc26ae" class="t constructor">KeyBinding</a>(
                <a href="@0@PresentationCore/A.html#f5ce0fa6ad00e8b4" class="t t">ApplicationCommands</a>.<a href="@0@PresentationCore/A.html#ad8a45fe29732c6f" class="i property">Open</a>,
                <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#c185b6b940ced06b" class="i field">R</a>,
                <a href="@0@WindowsBase/A.html#81f37ca96e12a565" class="t t">ModifierKeys</a>.<a href="@0@WindowsBase/A.html#a83eb77844eeecf0" class="i field">Control</a>);

            <a href="@0@PresentationCore/A.html#983fa575aa2c73f9" class="i property">InputBindings</a>.<a href="@0@PresentationCore/A.html#b66c2fd1f6443555" class="i method">Add</a>(<span class="r5 r">openCmdKeyBinding</span>);
        }

        <b>private void</b> <a id="2f03d153fb261af5" href="R/2f03d153fb261af5.html" target="n" data-glyph="76,1" class="i method">OpenCmdExecuted</a>(<b>object</b> <span id="r6 rd" class="r6 r">target</span>, <a href="@0@PresentationCore/A.html#b5b9242d784d106a" class="t t">ExecutedRoutedEventArgs</a> <span id="r7 rd" class="r7 r">e</span>)
        {
            <a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#d30dae02a986885a" class="i method">Show</a>(<span class="s">&quot;The command has been invoked.&quot;</span>);
        }

        <b>private void</b> <a id="e685c4be906a8475" href="R/e685c4be906a8475.html" target="n" data-glyph="76,1" class="i method">OpenCmdCanExecute</a>(<b>object</b> <span id="r8 rd" class="r8 r">sender</span>, <a href="@0@PresentationCore/A.html#eaa3ff973c551253" class="t t">CanExecuteRoutedEventArgs</a> <span id="r9 rd" class="r9 r">e</span>)
        {
            <span class="r9 r">e</span>.<a href="@0@PresentationCore/A.html#99e32d0d6f6947bd" class="i property">CanExecute</a> = <b>true</b>;
        }
    }
}</pre></td></tr></table></div></body></html>
