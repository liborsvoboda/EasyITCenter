<!DOCTYPE html>
<html><head><title>SearchWindow.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(1257);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#FindTextClient/SearchWindow.cs" target="_top">SearchWindow.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#FindTextClient" target="_top">HelpProjects\WPF-MORE\Accessibility\FindText\FindTextClient\FindTextClient.csproj</a> (FindTextClient)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// // Copyright (c) Microsoft. All rights reserved.</span>
<span class="c">// // Licensed under the MIT license. See LICENSE file in the project root for full license information.</span>

<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Automation</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Controls</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="t">Application</span> = <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Forms</span>.<a href="@0@System.Windows.Forms/A.html#522e1b8d8fc7285d" class="t t">Application</a>;

<b>namespace</b> <span class="i n">FindTextClient</span>
{
    <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     Interaction logic for client and target</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
    <b>public class</b> <a id="0180f6b0062968cd" href="R/0180f6b0062968cd.html" target="n" data-glyph="0,0" class="t t">SearchWindow</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Expand Selection

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Handles the expand to enclosing unit item selected event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="d7f3ec65a5a3041d" href="R/d7f3ec65a5a3041d.html" target="n" data-glyph="76,1" class="i method">ExpandToTextUnit_Change</a>(
            <b>object</b> <span id="r0 rd" class="r0 r">sender</span>, <a href="@0@PresentationFramework/A.html#c488465397cb1452" class="t t">SelectionChangedEventArgs</a> <span id="r1 rd" class="r1 r">e</span>)
        {
            <a href="@0@PresentationFramework/A.html#2ba9dd6838416d6a" class="k">var</a> <span id="r2 rd" class="r2 r">cb</span> = (<a href="@0@PresentationFramework/A.html#2ba9dd6838416d6a" class="t t">ComboBox</a>) <span class="r0 r">sender</span>;

            <span class="c">// Expand the target selection to the selected text unit.</span>
            <b>var</b> <span id="r3 rd" class="r3 r">selectionRanges</span> =
                <a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#2368fc2f913f77bb" class="i method">GetSelection</a>();
            <b>foreach</b> (<a href="@0@UIAutomationClient/A.html#5187586011530a5d" class="k">var</a> <span id="r4 rd" class="r4 r">textRange</span> <b>in</b> <span class="r3 r">selectionRanges</span>)
            {
                <b>switch</b> (<span class="r2 r">cb</span>.<a href="@0@PresentationFramework/A.html#0d4c8aaba2f2a87a" class="i property">SelectedValue</a>.<a href="@0@mscorlib/A.html#ff31a6bf27c58f89" class="i method">ToString</a>())
                {
                    <b>case</b> <span class="s">&quot;None&quot;</span>:
                        <span class="r4 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#761406ddff3904ec" class="i method">MoveEndpointByRange</a>(
                            <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#23290dd73def0efc" class="i field">End</a>,
                            <span class="r4 r">textRange</span>,
                            <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#5ce5bbbd1372bd70" class="i field">Start</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Character&quot;</span>:
                        <span class="r4 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#b0132562bebee088" class="i method">ExpandToEnclosingUnit</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#e060f5cbcde1683e" class="i field">Character</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Format&quot;</span>:
                        <span class="r4 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#b0132562bebee088" class="i method">ExpandToEnclosingUnit</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#a2c77f1ce599288a" class="i field">Format</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Word&quot;</span>:
                        <span class="r4 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#b0132562bebee088" class="i method">ExpandToEnclosingUnit</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#40fcf28fa455af07" class="i field">Word</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Line&quot;</span>:
                        <span class="r4 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#b0132562bebee088" class="i method">ExpandToEnclosingUnit</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#34517eac16d6f735" class="i field">Line</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Paragraph&quot;</span>:
                        <span class="r4 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#b0132562bebee088" class="i method">ExpandToEnclosingUnit</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#3ce36ee64f1d798e" class="i field">Paragraph</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Page&quot;</span>:
                        <span class="r4 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#b0132562bebee088" class="i method">ExpandToEnclosingUnit</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#affe4422df5e6d7f" class="i field">Page</a>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Document&quot;</span>:
                        <span class="r4 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#b0132562bebee088" class="i method">ExpandToEnclosingUnit</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#6a20f9440eec18aa" class="i field">Document</a>);
                        <b>break</b>;
                }
                <span class="r4 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#743826c413a4aaba" class="i method">Select</a>();
                <span class="c">// The WPF target doesn&#39;t show selected text as highlighted unless</span>
                <span class="c">// the window has focus.</span>
                <a href="#4c65c533b215326d" class="i field">_targetWindow</a>.<a href="@0@UIAutomationClient/A.html#58ac36137aa75371" class="i method">SetFocus</a>();
            }
        }

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Expand Highlight

        <span class="k preprocess">#</span><span class="k preprocess">region</span> Member Variables

        <span class="c">// Client application window.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#e438dc91640a8d15" class="t t">Window</a> <a id="740fdffba14dd18e" href="R/740fdffba14dd18e.html" target="n" data-glyph="46,1" class="i field">_clientWindow</a>;
        <span class="c">// Container for all client controls.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#5f9a593483943440" class="t t">DockPanel</a> <a id="350142dcbd0fb5ea" href="R/350142dcbd0fb5ea.html" target="n" data-glyph="46,1" class="i field">_clientDockPanel</a>;
        <span class="c">// Target application window.</span>
        <b>private</b> <a href="@0@UIAutomationClient/A.html#8ca578c7b4242263" class="t t">AutomationElement</a> <a id="4c65c533b215326d" href="R/4c65c533b215326d.html" target="n" data-glyph="46,1" class="i field">_targetWindow</a>;
        <span class="c">// Target text control.</span>
        <b>private</b> <a href="@0@UIAutomationClient/A.html#8ca578c7b4242263" class="t t">AutomationElement</a> <a id="2eb5a86c5c69f9e8" href="R/2eb5a86c5c69f9e8.html" target="n" data-glyph="46,1" class="i field">_targetDocument</a>;
        <span class="c">// Text pattern obtained from the target text control.</span>
        <b>private</b> <a href="@0@UIAutomationClient/A.html#793ac4f7346dda15" class="t t">TextPattern</a> <a id="3a20aa4c67494b5d" href="R/3a20aa4c67494b5d.html" target="n" data-glyph="46,1" class="i field">_targetTextPattern</a>;
        <span class="c">// Text range for entire target text control. </span>
        <b>private</b> <a href="@0@UIAutomationClient/A.html#5187586011530a5d" class="t t">TextPatternRange</a> <a id="813c6b2c244de086" href="R/813c6b2c244de086.html" target="n" data-glyph="46,1" class="i field">_documentRange</a>;
        <span class="c">// Text range for current selection in target text control.</span>
        <b>private</b> <a href="@0@UIAutomationClient/A.html#5187586011530a5d" class="t t">TextPatternRange</a> <a id="1789cbe254e28adc" href="R/1789cbe254e28adc.html" target="n" data-glyph="46,1" class="i field">_searchRange</a>;
        <span class="c">// Target applications based on underlying framework.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="t t">Button</a> <a id="8d267d2204da2e38" href="R/8d267d2204da2e38.html" target="n" data-glyph="46,1" class="i field">_startWpfTargetButton</a>;
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="t t">Button</a> <a id="36676532467cec7c" href="R/36676532467cec7c.html" target="n" data-glyph="46,1" class="i field">_startW32TargetButton</a>;
        <b>private readonly string</b> <a id="e9167b3aaf8f17b4" href="R/e9167b3aaf8f17b4.html" target="n" data-glyph="46,1" class="i field">_wpfTarget</a>;
        <b>private readonly string</b> <a id="f93cfaf8c542b54d" href="R/f93cfaf8c542b54d.html" target="n" data-glyph="46,1" class="i field">_w32Target</a>;
        <span class="c">// Find the target text control.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="t t">Button</a> <a id="a24bdb0a4787a8d3" href="R/a24bdb0a4787a8d3.html" target="n" data-glyph="46,1" class="i field">_findEditButton</a>;
        <span class="c">// Display target status.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#561ac62b5ff618be" class="t t">Label</a> <a id="8d344b10941878ff" href="R/8d344b10941878ff.html" target="n" data-glyph="46,1" class="i field">_targetResult</a>;
        <span class="c">// Layout grid for client controls.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a> <a id="6458a9c3c87c01c1" href="R/6458a9c3c87c01c1.html" target="n" data-glyph="46,1" class="i field">_infoGrid</a>;
        <span class="c">// String to search for in the target text control.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#77a66fa4f401a49f" class="t t">TextBox</a> <a id="5c63b6fd6662b9d6" href="R/5c63b6fd6662b9d6.html" target="n" data-glyph="46,1" class="i field">_searchString</a>;
        <span class="c">// Depending on the location of the selection in the target text</span>
        <span class="c">// control, the client can search forward or backward for the </span>
        <span class="c">// search string.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="t t">Button</a> <a id="7992c6b4c85f12a6" href="R/7992c6b4c85f12a6.html" target="n" data-glyph="46,1" class="i field">_searchBackwardButton</a>;
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="t t">Button</a> <a id="006a1eda86da97a5" href="R/006a1eda86da97a5.html" target="n" data-glyph="46,1" class="i field">_searchForwardButton</a>;
        <span class="c">// Direction of search.</span>
        <b>private bool</b> <a id="7cc986ac95fa1e5c" href="R/7cc986ac95fa1e5c.html" target="n" data-glyph="46,1" class="i field">_searchBackward</a>;
        <span class="c">// Expand the target text selection by the specified text unit.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#2ba9dd6838416d6a" class="t t">ComboBox</a> <a id="37a4e12a7e57b0fb" href="R/37a4e12a7e57b0fb.html" target="n" data-glyph="46,1" class="i field">_expandHighlight</a>;
        <span class="c">// Move the target text selection by the specified text unit. </span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#2ba9dd6838416d6a" class="t t">ComboBox</a> <a id="e369572103b4d236" href="R/e369572103b4d236.html" target="n" data-glyph="46,1" class="i field">_navigateTarget</a>;
        <b>private</b> <a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a> <a id="af5617f7ccc7dcfc" href="R/af5617f7ccc7dcfc.html" target="n" data-glyph="46,1" class="i field">_navigationUnit</a>;
        <span class="c">// Display the target text selection and attributes.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#561ac62b5ff618be" class="t t">Label</a> <a id="6c0e496113fbf038" href="R/6c0e496113fbf038.html" target="n" data-glyph="46,1" class="i field">_targetSelectionLabel</a>;
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#561ac62b5ff618be" class="t t">Label</a> <a id="4075abdc58e232d6" href="R/4075abdc58e232d6.html" target="n" data-glyph="46,1" class="i field">_targetSelectionAttributeLabel</a>;
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#77a66fa4f401a49f" class="t t">TextBox</a> <a id="47088ae24f45e690" href="R/47088ae24f45e690.html" target="n" data-glyph="46,1" class="i field">_targetSelection</a>;
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#77a66fa4f401a49f" class="t t">TextBox</a> <a id="3193938ce7ef6698" href="R/3193938ce7ef6698.html" target="n" data-glyph="46,1" class="i field">_targetSelectionAttributes</a>;
        <span class="c">// Display target text selection details such as child and enclosing unit.</span>
        <b>private readonly</b> <a href="@0@PresentationFramework/A.html#77a66fa4f401a49f" class="t t">TextBox</a> <a id="163908d013a1e59b" href="R/163908d013a1e59b.html" target="n" data-glyph="46,1" class="i field">_targetSelectionDetails</a>;
        <span class="c">// Delegates for updating the client UI based on target application events.</span>
        <b>private delegate void</b> <a id="f5912b33e6412ae2" href="R/../../0000000000.html" target="n" data-glyph="16,1" class="t t"><span id="f32c9db2e68652c5">TextChangeDelegate</span></a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r5 rd" class="r5 r">message</span>);

        <b>private delegate void</b> <a id="4d87318fee14950f" href="R/../../0000000000.html" target="n" data-glyph="16,1" class="t t"><span id="c1fca0ddf10f74d4">SelectionChangeDelegate</span></a>();

        <b>private delegate void</b> <a id="b3f24b74584956c7" href="R/../../0000000000.html" target="n" data-glyph="16,1" class="t t"><span id="e91070297952f985">ProviderCloseDelegate</span></a>();

        <span class="c">// Target applications.</span>
        <b>private enum</b> <a id="a8ebc50dca163505" href="R/a8ebc50dca163505.html" target="n" data-glyph="22,1" class="t t"><span id="ce4c88b7b5ffa2fe">TargetApplication</span></a>
        {
            <a id="f96581e2959d0134" href="R/f96581e2959d0134.html" target="n" data-glyph="24,2" class="i field">FlowDocument</a>,
            <a id="b77b21c5a252e833" href="R/b77b21c5a252e833.html" target="n" data-glyph="24,2" class="i field">WordPad</a>
        }

        <span class="c">// Search and navigation directions.</span>
        <b>private enum</b> <a id="9112c80dde893f26" href="R/9112c80dde893f26.html" target="n" data-glyph="22,1" class="t t"><span id="311edaed3245b16a">TraversalDirection</span></a>
        {
            <a id="5601f94b51d273f9" href="R/5601f94b51d273f9.html" target="n" data-glyph="24,2" class="i field">Backward</a>,
            <a id="ac3df24b39bb11cd" href="R/ac3df24b39bb11cd.html" target="n" data-glyph="24,2" class="i field">Forward</a>
        }

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Member Variables

        <span class="k preprocess">#</span><span class="k preprocess">region</span> Client Setup

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     The class constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Initialize the WPF client application.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>public</b> <a id="5c7a05c89675c8fa" href="R/5c7a05c89675c8fa.html" target="n" data-glyph="72,1" class="t constructor">SearchWindow</a>()
        {
            <span class="c">// Specify the target applications.</span>
            <a href="#e9167b3aaf8f17b4" class="i field">_wpfTarget</a> =
                <a href="@0@System.Windows.Forms/A.html#522e1b8d8fc7285d" class="t t">Application</a>.<a href="@0@System.Windows.Forms/A.html#5192d0366d9b1a8c" class="i property">StartupPath</a> + <span class="s">&quot;\\FindText.exe&quot;</span>;
            <a href="#f93cfaf8c542b54d" class="i field">_w32Target</a> = <span class="s">&quot;WordPad.exe&quot;</span>;

            <span class="c">// Initialize search direction. </span>
            <span class="c">// Search direction buttons are enabled or disabled based on this value.</span>
            <a href="#7cc986ac95fa1e5c" class="i field">_searchBackward</a> = <b>false</b>;

            <span class="c">// Layout the client controls.</span>
            <b>try</b>
            {
                <span class="c">// Specs for Window.</span>
                <b>double</b> <span id="r6 rd" class="r6 r">clientHeight</span> = 600;
                <b>double</b> <span id="r7 rd" class="r7 r">clientWidth</span> = 550;

                <span class="c">// Specs for TextBox.</span>
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r8 rd" class="r8 r">maxSearchLines</span> = 1;
                <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r9 rd" class="r9 r">maxSearchLength</span> = 25;

                <span class="c">// Specs for Buttons.</span>
                <b>double</b> <span id="r10 rd" class="r10 r">buttonWidth</span> = 140;

                <span class="c">// Instantiate the client window and set location and size.</span>
                <a href="#740fdffba14dd18e" class="i field">_clientWindow</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#acf2c0e6565540cd" class="t constructor">Window</a>
                {
                    <a href="@0@PresentationFramework/A.html#df2641c07f10d929" class="i property">Height</a> = <span class="r6 r">clientHeight</span>,
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r7 r">clientWidth</span>,
                    <a href="@0@PresentationFramework/A.html#c3f9155c7db6905b" class="i property">Left</a> = <a href="@0@PresentationFramework/A.html#02007600b4eb5699" class="t t">SystemParameters</a>.<a href="@0@PresentationFramework/A.html#115d0b2c76fbadce" class="i property">WorkArea</a>.<a href="@0@WindowsBase/A.html#717cc8a710da9b90" class="i property">Location</a>.<a href="@0@WindowsBase/A.html#556ea90344bfb3ea" class="i property">X</a> + 50,
                    <a href="@0@PresentationFramework/A.html#d6db15f2bca39f0b" class="i property">Top</a> = <a href="@0@PresentationFramework/A.html#02007600b4eb5699" class="t t">SystemParameters</a>.<a href="@0@PresentationFramework/A.html#115d0b2c76fbadce" class="i property">WorkArea</a>.<a href="@0@WindowsBase/A.html#717cc8a710da9b90" class="i property">Location</a>.<a href="@0@WindowsBase/A.html#0a42b94edb8c27ab" class="i property">Y</a> + 50,
                    <a href="@0@PresentationFramework/A.html#5002b3a8c196a7d1" class="i property">Title</a> = <span class="s">&quot;Find Text&quot;</span>,
                    <a href="@0@PresentationFramework/A.html#9207be05156845c5" class="i property">WindowStyle</a> = <a href="@0@PresentationFramework/A.html#7d54d85f995ca63b" class="t t">WindowStyle</a>.<a href="@0@PresentationFramework/A.html#c133c63d3ddfac53" class="i field">ToolWindow</a>
                };

                <span class="c">// Create a dock panel to hold all controls.</span>
                <a href="#350142dcbd0fb5ea" class="i field">_clientDockPanel</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#10df7c51a0014bc9" class="t constructor">DockPanel</a>
                {
                    <a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#f24f92e6dee837d3" class="t constructor">Thickness</a>(10),
                    <a href="@0@PresentationFramework/A.html#b2242d4cf3fb93b2" class="i property">LastChildFill</a> = <b>true</b>
                };

                <span class="c">// Add the start target buttons.</span>
                <a href="#8d267d2204da2e38" class="i field">_startWpfTargetButton</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
                {
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Start _FlowDocument (WPF)&quot;</span>,
                    <a href="@0@PresentationFramework/A.html#53151b3ab7c73170" class="i property">Tag</a> = <a href="#a8ebc50dca163505" class="t t">TargetApplication</a>.<a href="#f96581e2959d0134" class="i field">FlowDocument</a>
                };
                <a href="#8d267d2204da2e38" class="i field">_startWpfTargetButton</a>.<a href="@0@PresentationFramework/A.html#56b78e5307732315" class="i">Click</a> +=
                    <a href="#a1dc9f98c743305f" class="i method">StartTargetApplication_Click</a>;
                <a href="#36676532467cec7c" class="i field">_startW32TargetButton</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
                {
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Start _WordPad (Win32)&quot;</span>,
                    <a href="@0@PresentationFramework/A.html#53151b3ab7c73170" class="i property">Tag</a> = <a href="#a8ebc50dca163505" class="t t">TargetApplication</a>.<a href="#b77b21c5a252e833" class="i field">WordPad</a>
                };
                <a href="#36676532467cec7c" class="i field">_startW32TargetButton</a>.<a href="@0@PresentationFramework/A.html#56b78e5307732315" class="i">Click</a> +=
                    <a href="#a1dc9f98c743305f" class="i method">StartTargetApplication_Click</a>;
                <a href="@0@PresentationFramework/A.html#5f9a593483943440" class="t t">DockPanel</a>.<a href="@0@PresentationFramework/A.html#1bd631a5c246a5dc" class="i method">SetDock</a>(<a href="#8d267d2204da2e38" class="i field">_startWpfTargetButton</a>, <a href="@0@PresentationFramework/A.html#247b2a9cc539228a" class="t t">Dock</a>.<a href="@0@PresentationFramework/A.html#60fa0559eeaa26e6" class="i field">Top</a>);
                <a href="@0@PresentationFramework/A.html#5f9a593483943440" class="t t">DockPanel</a>.<a href="@0@PresentationFramework/A.html#1bd631a5c246a5dc" class="i method">SetDock</a>(<a href="#36676532467cec7c" class="i field">_startW32TargetButton</a>, <a href="@0@PresentationFramework/A.html#247b2a9cc539228a" class="t t">Dock</a>.<a href="@0@PresentationFramework/A.html#60fa0559eeaa26e6" class="i field">Top</a>);
                <a href="#350142dcbd0fb5ea" class="i field">_clientDockPanel</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#8d267d2204da2e38" class="i field">_startWpfTargetButton</a>);
                <a href="#350142dcbd0fb5ea" class="i field">_clientDockPanel</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#36676532467cec7c" class="i field">_startW32TargetButton</a>);

                <span class="c">// Add the find text control button.</span>
                <a href="#a24bdb0a4787a8d3" class="i field">_findEditButton</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
                {
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;_Find text provider&quot;</span>
                };
                <a href="#a24bdb0a4787a8d3" class="i field">_findEditButton</a>.<a href="@0@PresentationFramework/A.html#56b78e5307732315" class="i">Click</a> +=
                    <a href="#4d020030d186ed72" class="i method">FindTextProvider_Click</a>;
                <a href="#a24bdb0a4787a8d3" class="i field">_findEditButton</a>.<a href="@0@PresentationCore/A.html#69f262dd47fdf2be" class="i property">Visibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#b5dcd78ae53c5916" class="i field">Collapsed</a>;
                <a href="@0@PresentationFramework/A.html#5f9a593483943440" class="t t">DockPanel</a>.<a href="@0@PresentationFramework/A.html#1bd631a5c246a5dc" class="i method">SetDock</a>(<a href="#a24bdb0a4787a8d3" class="i field">_findEditButton</a>, <a href="@0@PresentationFramework/A.html#247b2a9cc539228a" class="t t">Dock</a>.<a href="@0@PresentationFramework/A.html#60fa0559eeaa26e6" class="i field">Top</a>);
                <a href="#350142dcbd0fb5ea" class="i field">_clientDockPanel</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#a24bdb0a4787a8d3" class="i field">_findEditButton</a>);

                <span class="c">// Add the target status label.</span>
                <a href="#8d344b10941878ff" class="i field">_targetResult</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#719de24e788c044e" class="t constructor">Label</a>
                {
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;&quot;</span>,
                    <a href="@0@PresentationFramework/A.html#4913603549554f4b" class="i property">BorderThickness</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#f24f92e6dee837d3" class="t constructor">Thickness</a>(1),
                    <a href="@0@PresentationFramework/A.html#1edea3428fbbbe39" class="i property">BorderBrush</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#4c63c441ae36a080" class="i property">Black</a>,
                    <a href="@0@PresentationFramework/A.html#af1a9620ef03c2dd" class="i property">HorizontalAlignment</a> = <a href="@0@PresentationFramework/A.html#4adb839fdbe93e93" class="t t">HorizontalAlignment</a>.<a href="@0@PresentationFramework/A.html#565e4c897ed23ea7" class="i field">Center</a>,
                    <a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#7d5226ec44f0e6f6" class="t constructor">Thickness</a>(0, 0, 0, 10),
                    <a href="@0@PresentationCore/A.html#69f262dd47fdf2be" class="i property">Visibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#0024ca32be32c247" class="i field">Hidden</a>
                };
                <a href="@0@PresentationFramework/A.html#5f9a593483943440" class="t t">DockPanel</a>.<a href="@0@PresentationFramework/A.html#1bd631a5c246a5dc" class="i method">SetDock</a>(<a href="#8d344b10941878ff" class="i field">_targetResult</a>, <a href="@0@PresentationFramework/A.html#247b2a9cc539228a" class="t t">Dock</a>.<a href="@0@PresentationFramework/A.html#60fa0559eeaa26e6" class="i field">Top</a>);
                <a href="#350142dcbd0fb5ea" class="i field">_clientDockPanel</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#8d344b10941878ff" class="i field">_targetResult</a>);

                <span class="c">// Add the client control layout grid.</span>
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#8200223a7211c338" class="t constructor">Grid</a>
                {
                    <a href="@0@PresentationFramework/A.html#af1a9620ef03c2dd" class="i property">HorizontalAlignment</a> = <a href="@0@PresentationFramework/A.html#4adb839fdbe93e93" class="t t">HorizontalAlignment</a>.<a href="@0@PresentationFramework/A.html#565e4c897ed23ea7" class="i field">Center</a>,
                    <a href="@0@PresentationFramework/A.html#c6fdbbe63a3a42b3" class="i property">VerticalAlignment</a> = <a href="@0@PresentationFramework/A.html#8b1564c617a0b2f5" class="t t">VerticalAlignment</a>.<a href="@0@PresentationFramework/A.html#96f92478ccd71cba" class="i field">Top</a>,
                    <a href="@0@PresentationFramework/A.html#2ce26863b51117a8" class="i property">ShowGridLines</a> = <b>false</b>,
                    <a href="@0@PresentationCore/A.html#69f262dd47fdf2be" class="i property">Visibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#b5dcd78ae53c5916" class="i field">Collapsed</a>,
                    <a href="@0@PresentationFramework/A.html#0c275d66ceac4be8" class="i property">MinWidth</a> = 400
                };
                <span class="c">// Define the columns.</span>
                <a href="@0@PresentationFramework/A.html#4ee17616400c32c7" class="k">var</a> <span id="r11 rd" class="r11 r">colDef1</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#169db1506e375c02" class="t constructor">ColumnDefinition</a>();
                <a href="@0@PresentationFramework/A.html#4ee17616400c32c7" class="k">var</a> <span id="r12 rd" class="r12 r">colDef2</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#169db1506e375c02" class="t constructor">ColumnDefinition</a>();
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#586a925b8abdf5bb" class="i property">ColumnDefinitions</a>.<a href="@0@PresentationFramework/A.html#623348263fd6b23a" class="i method">Add</a>(<span class="r11 r">colDef1</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#586a925b8abdf5bb" class="i property">ColumnDefinitions</a>.<a href="@0@PresentationFramework/A.html#623348263fd6b23a" class="i method">Add</a>(<span class="r12 r">colDef2</span>);
                <span class="c">// Define the rows.</span>
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r13 rd" class="r13 r">rowDef1</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r14 rd" class="r14 r">rowDef2</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r15 rd" class="r15 r">rowDef3</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r16 rd" class="r16 r">rowDef4</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r17 rd" class="r17 r">rowDef5</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r18 rd" class="r18 r">rowDef6</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r19 rd" class="r19 r">rowDef7</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r20 rd" class="r20 r">rowDef8</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r21 rd" class="r21 r">rowDef9</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r22 rd" class="r22 r">rowDef10</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="@0@PresentationFramework/A.html#f283ebec6fac75ba" class="k">var</a> <span id="r23 rd" class="r23 r">rowDef11</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#546bff66ff767474" class="t constructor">RowDefinition</a> {<a href="@0@PresentationFramework/A.html#032580915971adf8" class="i property">Height</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#29cb12d2dd927c25" class="t constructor">GridLength</a>(1, <a href="@0@PresentationFramework/A.html#9f3a8f5ddb555d71" class="t t">GridUnitType</a>.<a href="@0@PresentationFramework/A.html#454fc6cf110572b8" class="i field">Auto</a>)};
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r13 r">rowDef1</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r14 r">rowDef2</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r15 r">rowDef3</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r16 r">rowDef4</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r17 r">rowDef5</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r18 r">rowDef6</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r19 r">rowDef7</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r20 r">rowDef8</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r21 r">rowDef9</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r22 r">rowDef10</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>.<a href="@0@PresentationFramework/A.html#c48d379cbac6b258" class="i method">Add</a>(<span class="r23 r">rowDef11</span>);

                <span class="c">// Define the content of the cells.</span>
                <span class="c">// Row 1 - Search string details.</span>
                <a href="#5c63b6fd6662b9d6" class="i field">_searchString</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#76e5101303fab08d" class="t constructor">TextBox</a>
                {
                    <a href="@0@PresentationFramework/A.html#1d519a9bdfa176e6" class="i property">Name</a> = <span class="s">&quot;SearchString&quot;</span>,
                    <a href="@0@PresentationFramework/A.html#dd6407ee1c2a23d8" class="i property">MaxLines</a> = <span class="r8 r">maxSearchLines</span>,
                    <a href="@0@PresentationFramework/A.html#9f99b9ced6e32ee6" class="i property">MaxLength</a> = <span class="r9 r">maxSearchLength</span>,
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = 200
                };
                <span class="c">//searchString.Height = 25;</span>
                <a href="#5c63b6fd6662b9d6" class="i field">_searchString</a>.<a href="@0@PresentationFramework/A.html#22cd61fb3203047e" class="i">TextChanged</a> +=
                    <a href="#50ea4ea1bb4df649" class="i method">SearchString_Change</a>;
                <a href="#5c63b6fd6662b9d6" class="i field">_searchString</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#5c63b6fd6662b9d6" class="i field">_searchString</a>, 0);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#5c63b6fd6662b9d6" class="i field">_searchString</a>, 1);
                <a href="@0@PresentationFramework/A.html#561ac62b5ff618be" class="k">var</a> <span id="r24 rd" class="r24 r">searchLabel</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#719de24e788c044e" class="t constructor">Label</a>
                {
                    <a href="@0@PresentationFramework/A.html#997af4ee92788988" class="i property">Target</a> = <a href="#5c63b6fd6662b9d6" class="i field">_searchString</a>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;_Search for: &quot;</span>,
                    <a href="@0@PresentationFramework/A.html#c6fdbbe63a3a42b3" class="i property">VerticalAlignment</a> = <a href="@0@PresentationFramework/A.html#8b1564c617a0b2f5" class="t t">VerticalAlignment</a>.<a href="@0@PresentationFramework/A.html#370d572f36d471f7" class="i field">Center</a>
                };
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<span class="r24 r">searchLabel</span>, 0);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<span class="r24 r">searchLabel</span>, 0);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<span class="r24 r">searchLabel</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#5c63b6fd6662b9d6" class="i field">_searchString</a>);

                <span class="c">// Row 2 - Search direction buttons.</span>
                <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
                {
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Search _Backward&quot;</span>,
                    <a href="@0@PresentationFramework/A.html#53151b3ab7c73170" class="i property">Tag</a> = <a href="#9112c80dde893f26" class="t t">TraversalDirection</a>.<a href="#5601f94b51d273f9" class="i field">Backward</a>
                };
                <span class="c">//searchBackwardButton.Height = buttonHeight;</span>
                <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>.<a href="@0@PresentationFramework/A.html#56b78e5307732315" class="i">Click</a> +=
                    <a href="#ab4069dee851956f" class="i method">SearchDirection_Click</a>;
                <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>.<a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#7d5226ec44f0e6f6" class="t constructor">Thickness</a>(0, 0, 0, 10);
                <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>, 1);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>, 0);
                <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
                {
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Search _Forward&quot;</span>,
                    <a href="@0@PresentationFramework/A.html#53151b3ab7c73170" class="i property">Tag</a> = <a href="#9112c80dde893f26" class="t t">TraversalDirection</a>.<a href="#ac3df24b39bb11cd" class="i field">Forward</a>
                };
                <span class="c">//searchForwardButton.Height = buttonHeight;</span>
                <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationFramework/A.html#56b78e5307732315" class="i">Click</a> +=
                    <a href="#ab4069dee851956f" class="i method">SearchDirection_Click</a>;
                <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#7d5226ec44f0e6f6" class="t constructor">Thickness</a>(0, 0, 0, 10);
                <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>, 1);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>, 1);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>);

                <span class="c">// Row 3 - Target selection.</span>
                <a href="#6c0e496113fbf038" class="i field">_targetSelectionLabel</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#719de24e788c044e" class="t constructor">Label</a>
                {
                    <a href="@0@PresentationFramework/A.html#997af4ee92788988" class="i property">Target</a> = <a href="#47088ae24f45e690" class="i field">_targetSelection</a>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Currently selected:&quot;</span>
                };
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#6c0e496113fbf038" class="i field">_targetSelectionLabel</a>, 2);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#6c0e496113fbf038" class="i field">_targetSelectionLabel</a>, 0);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#8aec1eb4ef2c46fd" class="i method">SetColumnSpan</a>(<a href="#6c0e496113fbf038" class="i field">_targetSelectionLabel</a>, 2);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#6c0e496113fbf038" class="i field">_targetSelectionLabel</a>);
                <span class="c">// Row 4.</span>
                <a href="#47088ae24f45e690" class="i field">_targetSelection</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#76e5101303fab08d" class="t constructor">TextBox</a>
                {
                    <a href="@0@PresentationFramework/A.html#3f1347788defaf39" class="i property">TextWrapping</a> = <a href="@0@PresentationCore/A.html#06cbdc94c6ffe9f2" class="t t">TextWrapping</a>.<a href="@0@PresentationCore/A.html#0f519f2db63336a5" class="i field">Wrap</a>,
                    <a href="@0@PresentationFramework/A.html#1941bc06ea9a414e" class="i property">MaxWidth</a> = 400,
                    <a href="@0@PresentationFramework/A.html#df2641c07f10d929" class="i property">Height</a> = 100,
                    <a href="@0@PresentationFramework/A.html#86c382122ed7f5d1" class="i property">VerticalScrollBarVisibility</a> = <a href="@0@PresentationFramework/A.html#cc606f9d55be03ae" class="t t">ScrollBarVisibility</a>.<a href="@0@PresentationFramework/A.html#0ac97049b1a1ea41" class="i field">Auto</a>,
                    <a href="@0@PresentationFramework/A.html#1419ef5999953cca" class="i property">IsReadOnly</a> = <b>true</b>,
                    <a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#7d5226ec44f0e6f6" class="t constructor">Thickness</a>(0, 0, 0, 0)
                };
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#47088ae24f45e690" class="i field">_targetSelection</a>, 3);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#47088ae24f45e690" class="i field">_targetSelection</a>, 0);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#8aec1eb4ef2c46fd" class="i method">SetColumnSpan</a>(<a href="#47088ae24f45e690" class="i field">_targetSelection</a>, 2);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#47088ae24f45e690" class="i field">_targetSelection</a>);

                <span class="c">// Row 5 - Target selection attributes.</span>
                <a href="#4075abdc58e232d6" class="i field">_targetSelectionAttributeLabel</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#719de24e788c044e" class="t constructor">Label</a>
                {
                    <a href="@0@PresentationFramework/A.html#997af4ee92788988" class="i property">Target</a> = <a href="#47088ae24f45e690" class="i field">_targetSelection</a>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Attribute values: &quot;</span>
                };
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#4075abdc58e232d6" class="i field">_targetSelectionAttributeLabel</a>, 4);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#4075abdc58e232d6" class="i field">_targetSelectionAttributeLabel</a>, 0);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#8aec1eb4ef2c46fd" class="i method">SetColumnSpan</a>(<a href="#4075abdc58e232d6" class="i field">_targetSelectionAttributeLabel</a>, 2);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#4075abdc58e232d6" class="i field">_targetSelectionAttributeLabel</a>);
                <span class="c">// Row 6.</span>
                <a href="#3193938ce7ef6698" class="i field">_targetSelectionAttributes</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#76e5101303fab08d" class="t constructor">TextBox</a>
                {
                    <a href="@0@PresentationFramework/A.html#3f1347788defaf39" class="i property">TextWrapping</a> = <a href="@0@PresentationCore/A.html#06cbdc94c6ffe9f2" class="t t">TextWrapping</a>.<a href="@0@PresentationCore/A.html#0f519f2db63336a5" class="i field">Wrap</a>,
                    <a href="@0@PresentationFramework/A.html#1941bc06ea9a414e" class="i property">MaxWidth</a> = 400,
                    <a href="@0@PresentationFramework/A.html#df2641c07f10d929" class="i property">Height</a> = 100,
                    <a href="@0@PresentationFramework/A.html#86c382122ed7f5d1" class="i property">VerticalScrollBarVisibility</a> = <a href="@0@PresentationFramework/A.html#cc606f9d55be03ae" class="t t">ScrollBarVisibility</a>.<a href="@0@PresentationFramework/A.html#0ac97049b1a1ea41" class="i field">Auto</a>,
                    <a href="@0@PresentationFramework/A.html#1419ef5999953cca" class="i property">IsReadOnly</a> = <b>true</b>,
                    <a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#7d5226ec44f0e6f6" class="t constructor">Thickness</a>(0, 0, 0, 10)
                };
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#3193938ce7ef6698" class="i field">_targetSelectionAttributes</a>, 5);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#3193938ce7ef6698" class="i field">_targetSelectionAttributes</a>, 0);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#8aec1eb4ef2c46fd" class="i method">SetColumnSpan</a>(<a href="#3193938ce7ef6698" class="i field">_targetSelectionAttributes</a>, 2);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#3193938ce7ef6698" class="i field">_targetSelectionAttributes</a>);

                <span class="c">// Row 7 - Navigate target details.</span>
                <a href="#e369572103b4d236" class="i field">_navigateTarget</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#fa09a8700d0446b6" class="t constructor">ComboBox</a> {<a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>};
                <a href="#e369572103b4d236" class="i field">_navigateTarget</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#e060f5cbcde1683e" class="i field">Character</a>);
                <a href="#e369572103b4d236" class="i field">_navigateTarget</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#a2c77f1ce599288a" class="i field">Format</a>);
                <a href="#e369572103b4d236" class="i field">_navigateTarget</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#40fcf28fa455af07" class="i field">Word</a>);
                <a href="#e369572103b4d236" class="i field">_navigateTarget</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#34517eac16d6f735" class="i field">Line</a>);
                <a href="#e369572103b4d236" class="i field">_navigateTarget</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#3ce36ee64f1d798e" class="i field">Paragraph</a>);
                <a href="#e369572103b4d236" class="i field">_navigateTarget</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#affe4422df5e6d7f" class="i field">Page</a>);
                <a href="#e369572103b4d236" class="i field">_navigateTarget</a>.<a href="@0@PresentationFramework/A.html#ca98f21336190217" class="i property">SelectedIndex</a> = 0;
                <a href="#e369572103b4d236" class="i field">_navigateTarget</a>.<a href="@0@PresentationFramework/A.html#76f03b62b2915375" class="i">SelectionChanged</a> +=
                    <a href="#86f0d68054a31195" class="i method">NavigationUnit_Change</a>;
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#e369572103b4d236" class="i field">_navigateTarget</a>, 6);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#e369572103b4d236" class="i field">_navigateTarget</a>, 1);
                <a href="@0@PresentationFramework/A.html#561ac62b5ff618be" class="k">var</a> <span id="r25 rd" class="r25 r">navigateLabel</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#719de24e788c044e" class="t constructor">Label</a>
                {
                    <a href="@0@PresentationFramework/A.html#997af4ee92788988" class="i property">Target</a> = <a href="#e369572103b4d236" class="i field">_navigateTarget</a>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;_Navigate target by text unit of: &quot;</span>,
                    <a href="@0@PresentationFramework/A.html#c6fdbbe63a3a42b3" class="i property">VerticalAlignment</a> = <a href="@0@PresentationFramework/A.html#8b1564c617a0b2f5" class="t t">VerticalAlignment</a>.<a href="@0@PresentationFramework/A.html#370d572f36d471f7" class="i field">Center</a>
                };
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<span class="r25 r">navigateLabel</span>, 6);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<span class="r25 r">navigateLabel</span>, 0);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<span class="r25 r">navigateLabel</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#e369572103b4d236" class="i field">_navigateTarget</a>);

                <span class="c">// Row 8 - Navigate target direction buttons.</span>
                <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="k">var</a> <span id="r26 rd" class="r26 r">navigateBackwardButton</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
                {
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;_Backward&quot;</span>,
                    <a href="@0@PresentationFramework/A.html#53151b3ab7c73170" class="i property">Tag</a> = <a href="#9112c80dde893f26" class="t t">TraversalDirection</a>.<a href="#5601f94b51d273f9" class="i field">Backward</a>
                };
                <span class="r26 r">navigateBackwardButton</span>.<a href="@0@PresentationFramework/A.html#56b78e5307732315" class="i">Click</a> += <a href="#88ad3aecca108ad3" class="i method">Navigate_Click</a>;
                <span class="r26 r">navigateBackwardButton</span>.<a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#7d5226ec44f0e6f6" class="t constructor">Thickness</a>(0, 0, 0, 10);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<span class="r26 r">navigateBackwardButton</span>, 7);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<span class="r26 r">navigateBackwardButton</span>, 0);
                <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="k">var</a> <span id="r27 rd" class="r27 r">navigateForwardButton</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
                {
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;_Forward&quot;</span>,
                    <a href="@0@PresentationFramework/A.html#53151b3ab7c73170" class="i property">Tag</a> = <a href="#9112c80dde893f26" class="t t">TraversalDirection</a>.<a href="#ac3df24b39bb11cd" class="i field">Forward</a>
                };
                <span class="r27 r">navigateForwardButton</span>.<a href="@0@PresentationFramework/A.html#56b78e5307732315" class="i">Click</a> += <a href="#88ad3aecca108ad3" class="i method">Navigate_Click</a>;
                <span class="r27 r">navigateForwardButton</span>.<a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#7d5226ec44f0e6f6" class="t constructor">Thickness</a>(0, 0, 0, 10);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<span class="r27 r">navigateForwardButton</span>, 7);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<span class="r27 r">navigateForwardButton</span>, 1);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<span class="r26 r">navigateBackwardButton</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<span class="r27 r">navigateForwardButton</span>);

                <span class="c">// Row 9 - Expand the target selection controls.</span>
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#fa09a8700d0446b6" class="t constructor">ComboBox</a> {<a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>};
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<span class="s">&quot;&quot;</span>);
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<span class="s">&quot;None&quot;</span>);
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#e060f5cbcde1683e" class="i field">Character</a>);
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#a2c77f1ce599288a" class="i field">Format</a>);
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#40fcf28fa455af07" class="i field">Word</a>);
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#34517eac16d6f735" class="i field">Line</a>);
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#3ce36ee64f1d798e" class="i field">Paragraph</a>);
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#affe4422df5e6d7f" class="i field">Page</a>);
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#6a20f9440eec18aa" class="i field">Document</a>);
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#ca98f21336190217" class="i property">SelectedIndex</a> = 0;
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#76f03b62b2915375" class="i">SelectionChanged</a> +=
                    <a href="#d7f3ec65a5a3041d" class="i method">ExpandToTextUnit_Change</a>;
                <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>.<a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#7d5226ec44f0e6f6" class="t constructor">Thickness</a>(0, 0, 0, 10);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>, 8);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>, 1);
                <a href="@0@PresentationFramework/A.html#561ac62b5ff618be" class="k">var</a> <span id="r28 rd" class="r28 r">expandLabel</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#719de24e788c044e" class="t constructor">Label</a>
                {
                    <a href="@0@PresentationFramework/A.html#997af4ee92788988" class="i property">Target</a> = <a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;_Expand selection to text unit of: &quot;</span>,
                    <a href="@0@PresentationFramework/A.html#c6fdbbe63a3a42b3" class="i property">VerticalAlignment</a> = <a href="@0@PresentationFramework/A.html#8b1564c617a0b2f5" class="t t">VerticalAlignment</a>.<a href="@0@PresentationFramework/A.html#370d572f36d471f7" class="i field">Center</a>,
                    <a href="@0@PresentationFramework/A.html#8aedc94268115177" class="i property">Margin</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#7d5226ec44f0e6f6" class="t constructor">Thickness</a>(0, 0, 0, 10)
                };
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<span class="r28 r">expandLabel</span>, 8);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<span class="r28 r">expandLabel</span>, 0);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<span class="r28 r">expandLabel</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#37a4e12a7e57b0fb" class="i field">_expandHighlight</a>);

                <span class="c">// Row 10 - target selection details such as child elements </span>
                <span class="c">//         and enclosing unit.</span>
                <a href="#163908d013a1e59b" class="i field">_targetSelectionDetails</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#76e5101303fab08d" class="t constructor">TextBox</a>
                {
                    <a href="@0@PresentationFramework/A.html#df2641c07f10d929" class="i property">Height</a> = 100,
                    <a href="@0@PresentationFramework/A.html#86c382122ed7f5d1" class="i property">VerticalScrollBarVisibility</a> = <a href="@0@PresentationFramework/A.html#cc606f9d55be03ae" class="t t">ScrollBarVisibility</a>.<a href="@0@PresentationFramework/A.html#0ac97049b1a1ea41" class="i field">Auto</a>,
                    <a href="@0@PresentationFramework/A.html#1419ef5999953cca" class="i property">IsReadOnly</a> = <b>true</b>
                };
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<a href="#163908d013a1e59b" class="i field">_targetSelectionDetails</a>, 9);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<a href="#163908d013a1e59b" class="i field">_targetSelectionDetails</a>, 0);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#8aec1eb4ef2c46fd" class="i method">SetColumnSpan</a>(<a href="#163908d013a1e59b" class="i field">_targetSelectionDetails</a>, 2);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#163908d013a1e59b" class="i field">_targetSelectionDetails</a>);

                <span class="c">// Row 11 - get the child elements and the enclosing unit </span>
                <span class="c">//         of the target selection.</span>
                <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="k">var</a> <span id="r29 rd" class="r29 r">getChildren</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
                {
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Get children of selection&quot;</span>
                };
                <span class="r29 r">getChildren</span>.<a href="@0@PresentationFramework/A.html#56b78e5307732315" class="i">Click</a> += <a href="#c428d5463a0ab7fa" class="i method">GetChildren_Click</a>;
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<span class="r29 r">getChildren</span>, 10);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<span class="r29 r">getChildren</span>, 0);
                <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="k">var</a> <span id="r30 rd" class="r30 r">getEnclosingElement</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#9b9343f1fa48f518" class="t constructor">Button</a>
                {
                    <a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> = <span class="r10 r">buttonWidth</span>,
                    <a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Get enclosing element&quot;</span>
                };
                <span class="r30 r">getEnclosingElement</span>.<a href="@0@PresentationFramework/A.html#56b78e5307732315" class="i">Click</a> += <a href="#cb06571840c77e50" class="i method">GetEnclosingElement_Click</a>;
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#6dc4dd41a364705d" class="i method">SetRow</a>(<span class="r30 r">getEnclosingElement</span>, 10);
                <a href="@0@PresentationFramework/A.html#f9ce1d6be154348a" class="t t">Grid</a>.<a href="@0@PresentationFramework/A.html#52312a81c055b594" class="i method">SetColumn</a>(<span class="r30 r">getEnclosingElement</span>, 1);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<span class="r29 r">getChildren</span>);
                <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<span class="r30 r">getEnclosingElement</span>);

                <span class="c">// Add the grid to the dock panel.</span>
                <a href="@0@PresentationFramework/A.html#5f9a593483943440" class="t t">DockPanel</a>.<a href="@0@PresentationFramework/A.html#1bd631a5c246a5dc" class="i method">SetDock</a>(<a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>, <a href="@0@PresentationFramework/A.html#247b2a9cc539228a" class="t t">Dock</a>.<a href="@0@PresentationFramework/A.html#60fa0559eeaa26e6" class="i field">Top</a>);
                <a href="#350142dcbd0fb5ea" class="i field">_clientDockPanel</a>.<a href="@0@PresentationFramework/A.html#fb9060d71a3afc83" class="i property">Children</a>.<a href="@0@PresentationFramework/A.html#8886057feae649bc" class="i method">Add</a>(<a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>);

                <span class="c">// Add the dock panel to the window.</span>
                <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <a href="#350142dcbd0fb5ea" class="i field">_clientDockPanel</a>;
                <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@PresentationFramework/A.html#56eda567d5245381" class="i method">Show</a>();
            }
                <span class="c">// Do we successfully create the client app?</span>
            <b>catch</b> (<a href="@0@mscorlib/A.html#beac22dfca574cd4" class="t t">InvalidOperationException</a>)
            {
                <span class="c">// TODO: error handling.</span>
            }
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Handles the Start Application button click.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Starts the application that we are going to use for as our</span>
        <span class="c">///</span><span class="c">     root element for this sample.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="a1dc9f98c743305f" href="R/a1dc9f98c743305f.html" target="n" data-glyph="76,1" class="i method">StartTargetApplication_Click</a>(<b>object</b> <span id="r31 rd" class="r31 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r32 rd" class="r32 r">e</span>)
        {
            <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="k">var</a> <span id="r33 rd" class="r33 r">targetOption</span> = (<a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="t t">Button</a>) <span class="r31 r">sender</span>;

            <span class="c">// Start the target selected by the user.</span>
            <a href="#4c65c533b215326d" class="i field">_targetWindow</a> =
                <a href="#3947f8929871c131" class="i method">StartApp</a>((<a href="#a8ebc50dca163505" class="t t">TargetApplication</a>) <span class="r33 r">targetOption</span>.<a href="@0@PresentationFramework/A.html#53151b3ab7c73170" class="i property">Tag</a> == <a href="#a8ebc50dca163505" class="t t">TargetApplication</a>.<a href="#b77b21c5a252e833" class="i field">WordPad</a> ? <a href="#f93cfaf8c542b54d" class="i field">_w32Target</a> : <a href="#e9167b3aaf8f17b4" class="i field">_wpfTarget</a>);

            <span class="c">// Target is not available.</span>
            <a href="@0@System/A.html#632c6da37ce825df" class="t t">Debug</a>.<a href="@0@System/A.html#74ae7c85c0e36e34" class="i method">Assert</a>(<a href="#4c65c533b215326d" class="i field">_targetWindow</a> != <b>null</b>);

            <span class="c">// Set a listener for the window closed event on the target.</span>
            <a href="@0@UIAutomationClient/A.html#c642a9ded5d36ffc" class="t t">Automation</a>.<a href="@0@UIAutomationClient/A.html#f69e142d4884b75c" class="i method">AddAutomationEventHandler</a>(
                <a href="@0@UIAutomationClient/A.html#8f0e6e604f8703cd" class="t t">WindowPattern</a>.<a href="@0@UIAutomationClient/A.html#29e6db542632fde3" class="i field">WindowClosedEvent</a>,
                <a href="#4c65c533b215326d" class="i field">_targetWindow</a>, <a href="@0@UIAutomationTypes/A.html#a1d27540ebadfe65" class="t t">TreeScope</a>.<a href="@0@UIAutomationTypes/A.html#7c11d77300aad618" class="i field">Element</a>, <a href="#5bbb672972036530" class="i method">OnTargetClose</a>);

            <span class="c">// Set size and position of target.</span>
            <span class="c">// Since the target is started and manipulated from the client </span>
            <span class="c">// and both windows show UI changes this section of code just</span>
            <span class="c">// ensures neither window obscures the other.</span>
            <a href="@0@UIAutomationClient/A.html#a0311d01cf30b67d" class="k">var</a> <span id="r34 rd" class="r34 r">targetTransformPattern</span> =
                <a href="#4c65c533b215326d" class="i field">_targetWindow</a>.<a href="@0@UIAutomationClient/A.html#6faef7f55c720cc5" class="i method">GetCurrentPattern</a>(<a href="@0@UIAutomationClient/A.html#a0311d01cf30b67d" class="t t">TransformPattern</a>.<a href="@0@UIAutomationClient/A.html#795c265a84e009a8" class="i field">Pattern</a>)
                    <b>as</b> <a href="@0@UIAutomationClient/A.html#a0311d01cf30b67d" class="t t">TransformPattern</a>;
            <span class="r34 r">targetTransformPattern</span>?.<a href="@0@UIAutomationClient/A.html#a2837b9f5596440c" class="i method">Resize</a>(<a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a>, <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@PresentationFramework/A.html#df2641c07f10d929" class="i property">Height</a>);
            <span class="r34 r">targetTransformPattern</span>.<a href="@0@UIAutomationClient/A.html#fbf6986be10acdda" class="i method">Move</a>(
                <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@PresentationFramework/A.html#c3f9155c7db6905b" class="i property">Left</a> + <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@PresentationFramework/A.html#d0e1f940abafebe8" class="i property">Width</a> + 25, <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@PresentationFramework/A.html#d6db15f2bca39f0b" class="i property">Top</a>);

            <span class="c">// Set visibility of client controls.</span>
            <a href="#8d267d2204da2e38" class="i field">_startWpfTargetButton</a>.<a href="@0@PresentationCore/A.html#69f262dd47fdf2be" class="i property">Visibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#b5dcd78ae53c5916" class="i field">Collapsed</a>;
            <a href="#36676532467cec7c" class="i field">_startW32TargetButton</a>.<a href="@0@PresentationCore/A.html#69f262dd47fdf2be" class="i property">Visibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#b5dcd78ae53c5916" class="i field">Collapsed</a>;
            <a href="#a24bdb0a4787a8d3" class="i field">_findEditButton</a>.<a href="@0@PresentationCore/A.html#69f262dd47fdf2be" class="i property">Visibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#02d18b751f37c2fd" class="i field">Visible</a>;
            <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationCore/A.html#69f262dd47fdf2be" class="i property">Visibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#02d18b751f37c2fd" class="i field">Visible</a>;
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Starts the target application.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">app</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     The application to start.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The automation element for the app main window.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Three WPF documents, a rich text document, and a plain text document</span>
        <span class="c">///</span><span class="c">     are provided in the Content folder of the TextProvider project.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private</b> <a href="@0@UIAutomationClient/A.html#8ca578c7b4242263" class="t t">AutomationElement</a> <a id="3947f8929871c131" href="R/3947f8929871c131.html" target="n" data-glyph="76,1" class="i method">StartApp</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r35 rd" class="r35 r">app</span>)
        {
            <span class="c">// Start application.</span>
            <a href="@0@System/A.html#f8b2e604d6f1fe04" class="k">var</a> <span id="r36 rd" class="r36 r">p</span> = <a href="@0@System/A.html#f8b2e604d6f1fe04" class="t t">Process</a>.<a href="@0@System/A.html#5a01d1705abb24d6" class="i method">Start</a>(<span class="r35 r">app</span>);

            <span class="c">// Give the target application some time to start.</span>
            <span class="c">// For Win32 applications, WaitForInputIdle can be used instead.</span>
            <span class="c">// Another alternative is to listen for WindowOpened events.</span>
            <span class="c">// Otherwise, an ArgumentException results when you try to</span>
            <span class="c">// retrieve an automation element from the window handle.</span>
            <a href="@0@mscorlib/A.html#3980e012bae82e96" class="t t">Thread</a>.<a href="@0@mscorlib/A.html#5f1072b92dae1dd8" class="i method">Sleep</a>(2000);

            <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> =
                <a href="#e9167b3aaf8f17b4" class="i field">_wpfTarget</a> +
                <span class="s">&quot; started. \n\nPlease load a document into the target &quot;</span> +
                <span class="s">&quot;application and click the &#39;Find edit control&#39; button above. &quot;</span> +
                <span class="s">&quot;\n\nNOTE: Documents can be found in the &#39;Content&#39; folder of the FindText project.&quot;</span>;
            <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#09c6ada0a7316117" class="i property">LightGreen</a>;

            <span class="c">// Return the automation element for the app main window.</span>
            <b>return</b> (<a href="@0@UIAutomationClient/A.html#8ca578c7b4242263" class="t t">AutomationElement</a>.<a href="@0@UIAutomationClient/A.html#32b73da488a24b89" class="i method">FromHandle</a>(<span class="r36 r">p</span>.<a href="@0@System/A.html#4a6008b8d55b354b" class="i property">MainWindowHandle</a>));
        }

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Client Setup

        <span class="k preprocess">#</span><span class="k preprocess">region</span> Target Text Info

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Finds the text control in our target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">src</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Initializes the TextPattern object and event handlers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="4d020030d186ed72" href="R/4d020030d186ed72.html" target="n" data-glyph="76,1" class="i method">FindTextProvider_Click</a>(<b>object</b> <span id="r37 rd" class="r37 r">src</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r38 rd" class="r38 r">e</span>)
        {
            <span class="c">// Set up the conditions for finding the text control.</span>
            <a href="@0@UIAutomationClient/A.html#5682c7836c7ada36" class="k">var</a> <span id="r39 rd" class="r39 r">documentControl</span> = <b>new</b> <a href="@0@UIAutomationClient/A.html#d71f410cfd4f99cc" class="t constructor">PropertyCondition</a>(
                <a href="@0@UIAutomationClient/A.html#8ca578c7b4242263" class="t t">AutomationElement</a>.<a href="@0@UIAutomationClient/A.html#10d34aeeb335d087" class="i field">ControlTypeProperty</a>,
                <a href="@0@UIAutomationTypes/A.html#0ac120ae07310aad" class="t t">ControlType</a>.<a href="@0@UIAutomationTypes/A.html#3e17b8ab34539c3d" class="i field">Document</a>);
            <a href="@0@UIAutomationClient/A.html#5682c7836c7ada36" class="k">var</a> <span id="r40 rd" class="r40 r">textPatternAvailable</span> = <b>new</b> <a href="@0@UIAutomationClient/A.html#d71f410cfd4f99cc" class="t constructor">PropertyCondition</a>(
                <a href="@0@UIAutomationClient/A.html#8ca578c7b4242263" class="t t">AutomationElement</a>.<a href="@0@UIAutomationClient/A.html#cb481449094ea658" class="i field">IsTextPatternAvailableProperty</a>, <b>true</b>);
            <a href="@0@UIAutomationClient/A.html#8a7ff98d765a2bc3" class="k">var</a> <span id="r41 rd" class="r41 r">findControl</span> =
                <b>new</b> <a href="@0@UIAutomationClient/A.html#e94e4dbe539f6408" class="t constructor">AndCondition</a>(<span class="r39 r">documentControl</span>, <span class="r40 r">textPatternAvailable</span>);

            <span class="c">// Get the Automation Element for the first text control found.</span>
            <span class="c">// For the purposes of this sample it is sufficient to find the </span>
            <span class="c">// first text control. In other cases there may be multiple text</span>
            <span class="c">// controls to sort through.</span>
            <a href="#2eb5a86c5c69f9e8" class="i field">_targetDocument</a> =
                <a href="#4c65c533b215326d" class="i field">_targetWindow</a>.<a href="@0@UIAutomationClient/A.html#f19eb2af7ee66ec1" class="i method">FindFirst</a>(<a href="@0@UIAutomationTypes/A.html#a1d27540ebadfe65" class="t t">TreeScope</a>.<a href="@0@UIAutomationTypes/A.html#0a53a35d12ae2d84" class="i field">Descendants</a>, <span class="r41 r">findControl</span>);

            <span class="c">// Didn&#39;t find a text control.</span>
            <b>if</b> (<a href="#2eb5a86c5c69f9e8" class="i field">_targetDocument</a> == <b>null</b>)
            {
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> =
                    <a href="#e9167b3aaf8f17b4" class="i field">_wpfTarget</a> +
                    <span class="s">&quot; does not contain a Document control type.&quot;</span>;
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#f4f45f9f22e679dc" class="i property">Salmon</a>;
                <a href="#8d267d2204da2e38" class="i field">_startWpfTargetButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                <b>return</b>;
            }

            <span class="c">// Get required control patterns </span>
            <a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a> =
                <a href="#2eb5a86c5c69f9e8" class="i field">_targetDocument</a>.<a href="@0@UIAutomationClient/A.html#6faef7f55c720cc5" class="i method">GetCurrentPattern</a>(
                    <a href="@0@UIAutomationClient/A.html#793ac4f7346dda15" class="t t">TextPattern</a>.<a href="@0@UIAutomationClient/A.html#5927fdbb4e5a80ca" class="i field">Pattern</a>) <b>as</b> <a href="@0@UIAutomationClient/A.html#793ac4f7346dda15" class="t t">TextPattern</a>;

            <span class="c">// Didn&#39;t find a text control that supports TextPattern.</span>
            <b>if</b> (<a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a> == <b>null</b>)
            {
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> =
                    <a href="#e9167b3aaf8f17b4" class="i field">_wpfTarget</a> +
                    <span class="s">&quot; does not contain an element that supports TextPattern.&quot;</span>;
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#f4f45f9f22e679dc" class="i property">Salmon</a>;
                <a href="#8d267d2204da2e38" class="i field">_startWpfTargetButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                <b>return</b>;
            }

            <span class="c">// Text control is available so display the client controls.</span>
            <a href="#6458a9c3c87c01c1" class="i field">_infoGrid</a>.<a href="@0@PresentationCore/A.html#69f262dd47fdf2be" class="i property">Visibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#02d18b751f37c2fd" class="i field">Visible</a>;

            <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> =
                <span class="s">&quot;Text provider found.&quot;</span>;
            <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#09c6ada0a7316117" class="i property">LightGreen</a>;

            <span class="c">// Initialize the document range for the text of the document.</span>
            <a href="#813c6b2c244de086" class="i field">_documentRange</a> = <a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#bb563b51bd07f29f" class="i property">DocumentRange</a>;

            <span class="c">// Initialize the client&#39;s search buttons.</span>
            <b>if</b> (<a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#bb563b51bd07f29f" class="i property">DocumentRange</a>.<a href="@0@UIAutomationClient/A.html#36b8ef59d383ab51" class="i method">GetText</a>(1).<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> &gt; 0)
            {
                <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>true</b>;
            }
            <span class="c">// Initialize the client&#39;s search TextBox.</span>
            <a href="#5c63b6fd6662b9d6" class="i field">_searchString</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>true</b>;

            <span class="c">// Check if the text control supports text selection</span>
            <b>if</b> (<a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#b7579a312e0e5f7b" class="i property">SupportedTextSelection</a> ==
                <a href="@0@UIAutomationTypes/A.html#d4a8bad5d3a18972" class="t t">SupportedTextSelection</a>.<a href="@0@UIAutomationTypes/A.html#f9ee3db92d735cdd" class="i field">None</a>)
            {
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Unable to select text.&quot;</span>;
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#f4f45f9f22e679dc" class="i property">Salmon</a>;
                <b>return</b>;
            }

            <span class="c">// Edit control found so remove the find button from the client.</span>
            <a href="#a24bdb0a4787a8d3" class="i field">_findEditButton</a>.<a href="@0@PresentationCore/A.html#69f262dd47fdf2be" class="i property">Visibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#b5dcd78ae53c5916" class="i field">Collapsed</a>;

            <span class="c">// Initialize the client with the current target selection, if any.</span>
            <a href="#b994554fbff95f7a" class="i method">NotifySelectionChanged</a>();

            <span class="c">// Search starts at beginning of doc and goes forward</span>
            <a href="#7cc986ac95fa1e5c" class="i field">_searchBackward</a> = <b>false</b>;

            <span class="c">// Initialize a text changed listener.</span>
            <span class="c">// An instance of TextPatternRange will become invalid if </span>
            <span class="c">// one of the following occurs:</span>
            <span class="c">// 1) The text in the provider changes via some user activity.</span>
            <span class="c">// 2) ValuePattern.SetValue is used to programatically change </span>
            <span class="c">// the value of the text in the provider.</span>
            <span class="c">// The only way the client application can detect if the text </span>
            <span class="c">// has changed (to ensure that the ranges are still valid), </span>
            <span class="c">// is by setting a listener for the TextChanged event of </span>
            <span class="c">// the TextPattern. If this event is raised, the client needs </span>
            <span class="c">// to update the targetDocumentRange member data to ensure the </span>
            <span class="c">// user is working with the updated text. </span>
            <span class="c">// Clients must always anticipate the possibility that the text </span>
            <span class="c">// can change underneath them.</span>
            <a href="@0@UIAutomationClient/A.html#c642a9ded5d36ffc" class="t t">Automation</a>.<a href="@0@UIAutomationClient/A.html#f69e142d4884b75c" class="i method">AddAutomationEventHandler</a>(
                <a href="@0@UIAutomationClient/A.html#793ac4f7346dda15" class="t t">TextPattern</a>.<a href="@0@UIAutomationClient/A.html#34b49759aa1f0c49" class="i field">TextChangedEvent</a>,
                <a href="#2eb5a86c5c69f9e8" class="i field">_targetDocument</a>,
                <a href="@0@UIAutomationTypes/A.html#a1d27540ebadfe65" class="t t">TreeScope</a>.<a href="@0@UIAutomationTypes/A.html#7c11d77300aad618" class="i field">Element</a>,
                <a href="#1d1fdbce2b4929a8" class="i method">TextChanged</a>);

            <span class="c">// Initialize a selection changed listener.</span>
            <span class="c">// The target selection is reflected in the client.</span>
            <a href="@0@UIAutomationClient/A.html#c642a9ded5d36ffc" class="t t">Automation</a>.<a href="@0@UIAutomationClient/A.html#f69e142d4884b75c" class="i method">AddAutomationEventHandler</a>(
                <a href="@0@UIAutomationClient/A.html#793ac4f7346dda15" class="t t">TextPattern</a>.<a href="@0@UIAutomationClient/A.html#b0c9757d31fe96ea" class="i field">TextSelectionChangedEvent</a>,
                <a href="#2eb5a86c5c69f9e8" class="i field">_targetDocument</a>,
                <a href="@0@UIAutomationTypes/A.html#a1d27540ebadfe65" class="t t">TreeScope</a>.<a href="@0@UIAutomationTypes/A.html#7c11d77300aad618" class="i field">Element</a>,
                <a href="#c63cde76486408b8" class="i method">OnTextSelectionChange</a>);
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Gets the enclosing element of the target selection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="cb06571840c77e50" href="R/cb06571840c77e50.html" target="n" data-glyph="76,1" class="i method">GetEnclosingElement_Click</a>(<b>object</b> <span id="r42 rd" class="r42 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r43 rd" class="r43 r">e</span>)
        {
            <span class="c">// Obtain the enclosing element.</span>
            <a href="@0@UIAutomationClient/A.html#8ca578c7b4242263" class="t t">AutomationElement</a> <span id="r44 rd" class="r44 r">enclosingElement</span>;
            <b>try</b>
            {
                <span class="r44 r">enclosingElement</span> = <a href="#1789cbe254e28adc" class="i field">_searchRange</a>.<a href="@0@UIAutomationClient/A.html#9eca3c32c8e8818d" class="i method">GetEnclosingElement</a>();
            }
            <b>catch</b> (<a href="@0@UIAutomationTypes/A.html#df7426869f9bcafa" class="t t">ElementNotAvailableException</a>)
            {
                <span class="c">// TODO: error handling.</span>
                <b>return</b>;
            }

            <span class="c">// Assemble the information about the enclosing element.</span>
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="k">var</a> <span id="r45 rd" class="r45 r">enclosingElementInformation</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
            <span class="r45 r">enclosingElementInformation</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(
                <span class="s">&quot;Enclosing element:\t&quot;</span>).<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(
                    <span class="r44 r">enclosingElement</span>.<a href="@0@UIAutomationClient/A.html#ee08ee488f5af65c" class="i property">Current</a>.<a href="@0@UIAutomationClient/A.html#4fe1dc91f427157d" class="i property">ControlType</a>.<a href="@0@UIAutomationTypes/A.html#64da97432ec19d56" class="i property">ProgrammaticName</a>);

            <span class="c">// The WPF target doesn&#39;t show selected text as highlighted unless</span>
            <span class="c">// the window has focus.</span>
            <a href="#4c65c533b215326d" class="i field">_targetWindow</a>.<a href="@0@UIAutomationClient/A.html#58ac36137aa75371" class="i method">SetFocus</a>();

            <span class="c">// Display the enclosing element information in the client.</span>
            <a href="#163908d013a1e59b" class="i field">_targetSelectionDetails</a>.<a href="@0@PresentationFramework/A.html#7b5be95f7a8f33a8" class="i property">Text</a> = <span class="r45 r">enclosingElementInformation</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>();

            <span class="c">// Is the enclosing element the entire document?</span>
            <span class="c">// If so, select the document.</span>
            <b>if</b> (<span class="r44 r">enclosingElement</span> == <a href="#2eb5a86c5c69f9e8" class="i field">_targetDocument</a>)
            {
                <a href="#813c6b2c244de086" class="i field">_documentRange</a> = <a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#bb563b51bd07f29f" class="i property">DocumentRange</a>;
                <a href="#813c6b2c244de086" class="i field">_documentRange</a>.<a href="@0@UIAutomationClient/A.html#743826c413a4aaba" class="i method">Select</a>();
                <b>return</b>;
            }
            <span class="c">// Otherwise, select the range from the child element.</span>
            <a href="@0@UIAutomationClient/A.html#5187586011530a5d" class="k">var</a> <span id="r46 rd" class="r46 r">childRange</span> =
                <a href="#813c6b2c244de086" class="i field">_documentRange</a>.<a href="@0@UIAutomationClient/A.html#1b13066c2b2dcb7f" class="i property">TextPattern</a>.<a href="@0@UIAutomationClient/A.html#df0c4e0746feacbb" class="i method">RangeFromChild</a>(<span class="r44 r">enclosingElement</span>);
            <span class="r46 r">childRange</span>.<a href="@0@UIAutomationClient/A.html#743826c413a4aaba" class="i method">Select</a>();
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Gets the children of the target selection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="c428d5463a0ab7fa" href="R/c428d5463a0ab7fa.html" target="n" data-glyph="76,1" class="i method">GetChildren_Click</a>(<b>object</b> <span id="r47 rd" class="r47 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r48 rd" class="r48 r">e</span>)
        {
            <span class="c">// Obtain an array of child elements.</span>
            <a href="@0@UIAutomationClient/A.html#8ca578c7b4242263" class="t t">AutomationElement</a>[] <span id="r49 rd" class="r49 r">textProviderChildren</span>;
            <b>try</b>
            {
                <span class="r49 r">textProviderChildren</span> = <a href="#1789cbe254e28adc" class="i field">_searchRange</a>.<a href="@0@UIAutomationClient/A.html#0c9678a8c46540a3" class="i method">GetChildren</a>();
            }
            <b>catch</b> (<a href="@0@UIAutomationTypes/A.html#df7426869f9bcafa" class="t t">ElementNotAvailableException</a>)
            {
                <span class="c">// TODO: error handling.</span>
                <b>return</b>;
            }

            <span class="c">// Assemble the information about the enclosing element.</span>
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="k">var</a> <span id="r50 rd" class="r50 r">childInformation</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
            <span class="r50 r">childInformation</span>.<a href="@0@mscorlib/A.html#d55f46892b574e94" class="i method">Append</a>(<span class="r49 r">textProviderChildren</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)
                .<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot; child element(s).&quot;</span>);

            <span class="c">// Iterate through the collection of child elements and obtain</span>
            <span class="c">// information of interest about each.</span>
            <b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r51 rd" class="r51 r">i</span> = 0; <span class="r51 r">i</span> &lt; <span class="r49 r">textProviderChildren</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r51 r">i</span>++)
            {
                <span class="r50 r">childInformation</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;Child&quot;</span>).<a href="@0@mscorlib/A.html#d55f46892b574e94" class="i method">Append</a>(<span class="r51 r">i</span>).<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;:&quot;</span>);
                <span class="c">// Obtain the name of the child control.</span>
                <span class="r50 r">childInformation</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;\tName:\t&quot;</span>)
                    .<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="r49 r">textProviderChildren</span>[<span class="r51 r">i</span>].<a href="@0@UIAutomationClient/A.html#ee08ee488f5af65c" class="i property">Current</a>.<a href="@0@UIAutomationClient/A.html#9491d7a6d7435bb6" class="i property">Name</a>);
                <span class="c">// Obtain the control type.</span>
                <span class="r50 r">childInformation</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;\tControl Type:\t&quot;</span>)
                    .<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="r49 r">textProviderChildren</span>[<span class="r51 r">i</span>].<a href="@0@UIAutomationClient/A.html#ee08ee488f5af65c" class="i property">Current</a>.<a href="@0@UIAutomationClient/A.html#4fe1dc91f427157d" class="i property">ControlType</a>.<a href="@0@UIAutomationTypes/A.html#64da97432ec19d56" class="i property">ProgrammaticName</a>);

                <span class="c">// Obtain the supported control patterns.</span>
                <span class="c">// NOTE: For the purposes of this sample we use GetSupportedPatterns(). </span>
                <span class="c">// However, the use of GetSupportedPatterns() is strongly discouraged </span>
                <span class="c">// as it calls GetCurrentPattern() internally on every known pattern. </span>
                <span class="c">// It is therefore much more efficient to use GetCurrentPattern() for </span>
                <span class="c">// the specific patterns you are interested in.</span>
                <b>var</b> <span id="r52 rd" class="r52 r">childPatterns</span> =
                    <span class="r49 r">textProviderChildren</span>[<span class="r51 r">i</span>].<a href="@0@UIAutomationClient/A.html#b7825d101baebe21" class="i method">GetSupportedPatterns</a>();
                <span class="r50 r">childInformation</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;\tSupported Control Patterns:&quot;</span>);
                <b>if</b> (<span class="r52 r">childPatterns</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &lt;= 0)
                {
                    <span class="r50 r">childInformation</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;\t\t\tNone&quot;</span>);
                }
                <b>else</b>
                {
                    <b>foreach</b> (<a href="@0@UIAutomationTypes/A.html#f89fa4223b09c04a" class="k">var</a> <span id="r53 rd" class="r53 r">pattern</span> <b>in</b> <span class="r52 r">childPatterns</span>)
                    {
                        <span class="r50 r">childInformation</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;\t\t\t&quot;</span>)
                            .<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="r53 r">pattern</span>.<a href="@0@UIAutomationTypes/A.html#64da97432ec19d56" class="i property">ProgrammaticName</a>);
                    }
                }

                <span class="c">// Obtain the child elements, if any, of the child control.</span>
                <a href="@0@UIAutomationClient/A.html#5187586011530a5d" class="k">var</a> <span id="r54 rd" class="r54 r">childRange</span> =
                    <a href="#813c6b2c244de086" class="i field">_documentRange</a>.<a href="@0@UIAutomationClient/A.html#1b13066c2b2dcb7f" class="i property">TextPattern</a>.<a href="@0@UIAutomationClient/A.html#df0c4e0746feacbb" class="i method">RangeFromChild</a>(<span class="r49 r">textProviderChildren</span>[<span class="r51 r">i</span>]);
                <b>var</b> <span id="r55 rd" class="r55 r">childRangeChildren</span> =
                    <span class="r54 r">childRange</span>.<a href="@0@UIAutomationClient/A.html#0c9678a8c46540a3" class="i method">GetChildren</a>();
                <span class="r50 r">childInformation</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;\tChildren: \t&quot;</span>).<a href="@0@mscorlib/A.html#d55f46892b574e94" class="i method">Append</a>(<span class="r55 r">childRangeChildren</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>).<a href="@0@mscorlib/A.html#c0554798fe05ba4f" class="i method">AppendLine</a>();
            }
            <span class="c">// Display the information about the child controls.</span>
            <a href="#163908d013a1e59b" class="i field">_targetSelectionDetails</a>.<a href="@0@PresentationFramework/A.html#7b5be95f7a8f33a8" class="i property">Text</a> = <span class="r50 r">childInformation</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>();
        }

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Target Text Info

        <span class="k preprocess">#</span><span class="k preprocess">region</span> Search Target

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Handles changes to the search text in the client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Reset all controls if user changes search text</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="50ea4ea1bb4df649" href="R/50ea4ea1bb4df649.html" target="n" data-glyph="76,1" class="i method">SearchString_Change</a>(<b>object</b> <span id="r56 rd" class="r56 r">sender</span>, <a href="@0@PresentationFramework/A.html#b619f7b054bda67d" class="t t">TextChangedEventArgs</a> <span id="r57 rd" class="r57 r">e</span>)
        {
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r58 rd" class="r58 r">startPoints</span> = <a href="#813c6b2c244de086" class="i field">_documentRange</a>.<a href="@0@UIAutomationClient/A.html#fa243d03ad050566" class="i method">CompareEndpoints</a>(
                <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#5ce5bbbd1372bd70" class="i field">Start</a>,
                <a href="#1789cbe254e28adc" class="i field">_searchRange</a>,
                <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#5ce5bbbd1372bd70" class="i field">Start</a>);
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r59 rd" class="r59 r">endPoints</span> = <a href="#813c6b2c244de086" class="i field">_documentRange</a>.<a href="@0@UIAutomationClient/A.html#fa243d03ad050566" class="i method">CompareEndpoints</a>(
                <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#23290dd73def0efc" class="i field">End</a>,
                <a href="#1789cbe254e28adc" class="i field">_searchRange</a>,
                <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#23290dd73def0efc" class="i field">End</a>);

            <span class="c">// If the starting endpoints of the document range and the search</span>
            <span class="c">// range are equivalent then we can search forward only since the </span>
            <span class="c">// search range is at the start of the document.</span>
            <b>if</b> (<span class="r58 r">startPoints</span> == 0)
            {
                <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>true</b>;
                <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
            }
            <span class="c">// If the ending endpoints of the document range and the search</span>
            <span class="c">// range are identical then we can search backward only since the </span>
            <span class="c">// search range is at the end of the document.</span>
            <b>else</b> <b>if</b> (<span class="r59 r">endPoints</span> == 0)
            {
                <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>true</b>;
            }
            <span class="c">// Otherwise we can search both directions.</span>
            <b>else</b>
            {
                <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>true</b>;
                <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>true</b>;
            }
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Handles the Search button click.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Find the text specified in the text box.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="ab4069dee851956f" href="R/ab4069dee851956f.html" target="n" data-glyph="76,1" class="i method">SearchDirection_Click</a>(<b>object</b> <span id="r60 rd" class="r60 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r61 rd" class="r61 r">e</span>)
        {
            <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="k">var</a> <span id="r62 rd" class="r62 r">searchDirection</span> = (<a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="t t">Button</a>) <span class="r60 r">sender</span>;

            <span class="c">// Are we searching backward through the text control?</span>
            <a href="#7cc986ac95fa1e5c" class="i field">_searchBackward</a> =
                ((<a href="#9112c80dde893f26" class="t t">TraversalDirection</a>) <span class="r62 r">searchDirection</span>.<a href="@0@PresentationFramework/A.html#53151b3ab7c73170" class="i property">Tag</a> == <a href="#9112c80dde893f26" class="t t">TraversalDirection</a>.<a href="#5601f94b51d273f9" class="i field">Backward</a>);

            <span class="c">// Check if search text entered</span>
            <b>if</b> (<a href="#5c63b6fd6662b9d6" class="i field">_searchString</a>.<a href="@0@PresentationFramework/A.html#7b5be95f7a8f33a8" class="i property">Text</a>.<a href="@0@mscorlib/A.html#06a5f7c688e69307" class="i method">Trim</a>() == <span class="s">&quot;&quot;</span>)
            {
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;No search criteria.&quot;</span>;
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#f4f45f9f22e679dc" class="i property">Salmon</a>;
                <b>return</b>;
            }

            <span class="c">// Does target range support text selection?</span>
            <b>if</b> (<a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#b7579a312e0e5f7b" class="i property">SupportedTextSelection</a> ==
                <a href="@0@UIAutomationTypes/A.html#d4a8bad5d3a18972" class="t t">SupportedTextSelection</a>.<a href="@0@UIAutomationTypes/A.html#f9ee3db92d735cdd" class="i field">None</a>)
            {
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Unable to select text.&quot;</span>;
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#f4f45f9f22e679dc" class="i property">Salmon</a>;
                <b>return</b>;
            }
            <span class="c">// Does target range support multiple selections?</span>
            <b>if</b> (<a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#b7579a312e0e5f7b" class="i property">SupportedTextSelection</a> ==
                <a href="@0@UIAutomationTypes/A.html#d4a8bad5d3a18972" class="t t">SupportedTextSelection</a>.<a href="@0@UIAutomationTypes/A.html#a5010c1c822b27ec" class="i field">Multiple</a>)
            {
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Multiple selections present.&quot;</span>;
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#f4f45f9f22e679dc" class="i property">Salmon</a>;
                <b>return</b>;
            }

            <span class="c">// Clone the document range since we modify the endpoints </span>
            <span class="c">// as we search.</span>
            <a href="@0@UIAutomationClient/A.html#5187586011530a5d" class="k">var</a> <span id="r63 rd" class="r63 r">documentRangeClone</span> = <a href="#813c6b2c244de086" class="i field">_documentRange</a>.<a href="@0@UIAutomationClient/A.html#f7721c99b1bdfb8c" class="i method">Clone</a>();

            <span class="c">// Move the cloned document range endpoints to enable the </span>
            <span class="c">// selection of the next matching text range.</span>
            <b>var</b> <span id="r64 rd" class="r64 r">selectionRange</span> =
                <a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#2368fc2f913f77bb" class="i method">GetSelection</a>();
            <b>if</b> (<span class="r64 r">selectionRange</span>[0] != <b>null</b>)
            {
                <b>if</b> (<a href="#7cc986ac95fa1e5c" class="i field">_searchBackward</a>)
                {
                    <span class="r63 r">documentRangeClone</span>.<a href="@0@UIAutomationClient/A.html#761406ddff3904ec" class="i method">MoveEndpointByRange</a>(
                        <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#23290dd73def0efc" class="i field">End</a>,
                        <span class="r64 r">selectionRange</span>[0],
                        <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#5ce5bbbd1372bd70" class="i field">Start</a>);
                }
                <b>else</b>
                {
                    <span class="r63 r">documentRangeClone</span>.<a href="@0@UIAutomationClient/A.html#761406ddff3904ec" class="i method">MoveEndpointByRange</a>(
                        <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#5ce5bbbd1372bd70" class="i field">Start</a>,
                        <span class="r64 r">selectionRange</span>[0],
                        <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#23290dd73def0efc" class="i field">End</a>);
                }
            }

            <span class="c">// Find the text specified in the Search textbox.</span>
            <span class="c">// Clone the search range since we need to modify it.</span>
            <a href="@0@UIAutomationClient/A.html#5187586011530a5d" class="k">var</a> <span id="r65 rd" class="r65 r">searchRangeClone</span> = <a href="#1789cbe254e28adc" class="i field">_searchRange</a>.<a href="@0@UIAutomationClient/A.html#f7721c99b1bdfb8c" class="i method">Clone</a>();
            <span class="c">// backward = false? -- search forward, otherwise backward.</span>
            <span class="c">// ignoreCase = false? -- search is case sensitive.</span>
            <a href="#1789cbe254e28adc" class="i field">_searchRange</a> =
                <span class="r63 r">documentRangeClone</span>.<a href="@0@UIAutomationClient/A.html#2e126c304137be9b" class="i method">FindText</a>(
                    <a href="#5c63b6fd6662b9d6" class="i field">_searchString</a>.<a href="@0@PresentationFramework/A.html#7b5be95f7a8f33a8" class="i property">Text</a>, <a href="#7cc986ac95fa1e5c" class="i field">_searchBackward</a>, <b>false</b>);

            <span class="c">// Search unsuccessful.</span>
            <b>if</b> (<a href="#1789cbe254e28adc" class="i field">_searchRange</a> == <b>null</b>)
            {
                <span class="c">// Search string not found at all.</span>
                <b>if</b> (<span class="r63 r">documentRangeClone</span>.<a href="@0@UIAutomationClient/A.html#fa243d03ad050566" class="i method">CompareEndpoints</a>(
                    <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#5ce5bbbd1372bd70" class="i field">Start</a>,
                    <span class="r65 r">searchRangeClone</span>,
                    <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#5ce5bbbd1372bd70" class="i field">Start</a>) == 0)
                {
                    <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Text not found.&quot;</span>;
                    <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#7e1b0bc6c286c7b5" class="i property">Wheat</a>;
                    <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                    <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                }
                <span class="c">// End of document (either the start or end of the document </span>
                <span class="c">// range depending on search direction) was reached before </span>
                <span class="c">// finding another occurence of the search string.</span>
                <b>else</b>
                {
                    <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;End of document reached.&quot;</span>;
                    <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#7e1b0bc6c286c7b5" class="i property">Wheat</a>;
                    <b>if</b> (!<a href="#7cc986ac95fa1e5c" class="i field">_searchBackward</a>)
                    {
                        <span class="r65 r">searchRangeClone</span>.<a href="@0@UIAutomationClient/A.html#761406ddff3904ec" class="i method">MoveEndpointByRange</a>(
                            <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#5ce5bbbd1372bd70" class="i field">Start</a>,
                            <a href="#813c6b2c244de086" class="i field">_documentRange</a>,
                            <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#23290dd73def0efc" class="i field">End</a>);
                        <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>true</b>;
                        <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                    }
                    <b>else</b>
                    {
                        <span class="r65 r">searchRangeClone</span>.<a href="@0@UIAutomationClient/A.html#761406ddff3904ec" class="i method">MoveEndpointByRange</a>(
                            <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#23290dd73def0efc" class="i field">End</a>,
                            <a href="#813c6b2c244de086" class="i field">_documentRange</a>,
                            <a href="@0@UIAutomationTypes/A.html#fecf7ad13b652221" class="t t">TextPatternRangeEndpoint</a>.<a href="@0@UIAutomationTypes/A.html#5ce5bbbd1372bd70" class="i field">Start</a>);
                        <a href="#7992c6b4c85f12a6" class="i field">_searchBackwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>false</b>;
                        <a href="#006a1eda86da97a5" class="i field">_searchForwardButton</a>.<a href="@0@PresentationCore/A.html#166ae927a742c046" class="i property">IsEnabled</a> = <b>true</b>;
                    }
                }
                <a href="#1789cbe254e28adc" class="i field">_searchRange</a> = <span class="r65 r">searchRangeClone</span>;
            }
            <span class="c">// The search string was found.</span>
            <b>else</b>
            {
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="s">&quot;Text found.&quot;</span>;
                <a href="#8d344b10941878ff" class="i field">_targetResult</a>.<a href="@0@PresentationFramework/A.html#4e6ce8c1fbfefae7" class="i property">Background</a> = <a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#09c6ada0a7316117" class="i property">LightGreen</a>;
            }

            <a href="#1789cbe254e28adc" class="i field">_searchRange</a>.<a href="@0@UIAutomationClient/A.html#743826c413a4aaba" class="i method">Select</a>();
            <span class="c">// Scroll the selection into view and align with top of viewport</span>
            <a href="#1789cbe254e28adc" class="i field">_searchRange</a>.<a href="@0@UIAutomationClient/A.html#7612d130a167c502" class="i method">ScrollIntoView</a>(<b>true</b>);
            <span class="c">// The WPF target doesn&#39;t show selected text as highlighted unless</span>
            <span class="c">// the window has focus.</span>
            <a href="#4c65c533b215326d" class="i field">_targetWindow</a>.<a href="@0@UIAutomationClient/A.html#58ac36137aa75371" class="i method">SetFocus</a>();
        }

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Search Target

        <span class="k preprocess">#</span><span class="k preprocess">region</span> Target Navigation

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Handles the navigation item selected event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="86f0d68054a31195" href="R/86f0d68054a31195.html" target="n" data-glyph="76,1" class="i method">NavigationUnit_Change</a>(<b>object</b> <span id="r66 rd" class="r66 r">sender</span>, <a href="@0@PresentationFramework/A.html#c488465397cb1452" class="t t">SelectionChangedEventArgs</a> <span id="r67 rd" class="r67 r">e</span>)
        {
            <a href="@0@PresentationFramework/A.html#2ba9dd6838416d6a" class="k">var</a> <span id="r68 rd" class="r68 r">cb</span> = (<a href="@0@PresentationFramework/A.html#2ba9dd6838416d6a" class="t t">ComboBox</a>) <span class="r66 r">sender</span>;
            <a href="#af5617f7ccc7dcfc" class="i field">_navigationUnit</a> = (<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>) <span class="r68 r">cb</span>.<a href="@0@PresentationFramework/A.html#0d4c8aaba2f2a87a" class="i property">SelectedValue</a>;
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Handles the Navigate button click event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="88ad3aecca108ad3" href="R/88ad3aecca108ad3.html" target="n" data-glyph="76,1" class="i method">Navigate_Click</a>(<b>object</b> <span id="r69 rd" class="r69 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r70 rd" class="r70 r">e</span>)
        {
            <a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="k">var</a> <span id="r71 rd" class="r71 r">moveSelection</span> = (<a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="t t">Button</a>) <span class="r69 r">sender</span>;

            <span class="c">// Which direction is the user searching through the text control?</span>
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r72 rd" class="r72 r">navDirection</span> =
                ((<a href="#9112c80dde893f26" class="t t">TraversalDirection</a>) <span class="r71 r">moveSelection</span>.<a href="@0@PresentationFramework/A.html#53151b3ab7c73170" class="i property">Tag</a> == <a href="#9112c80dde893f26" class="t t">TraversalDirection</a>.<a href="#ac3df24b39bb11cd" class="i field">Forward</a>) ? 1 : -1;

            <span class="c">// Obtain the ranges to move.</span>
            <b>var</b> <span id="r73 rd" class="r73 r">selectionRanges</span> =
                <a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#2368fc2f913f77bb" class="i method">GetSelection</a>();

            <span class="c">// Iterate throught the ranges for a text control that supports</span>
            <span class="c">// multiple selections and move the selections the specified text</span>
            <span class="c">// unit and direction.</span>
            <b>foreach</b> (<a href="@0@UIAutomationClient/A.html#5187586011530a5d" class="k">var</a> <span id="r74 rd" class="r74 r">textRange</span> <b>in</b> <span class="r73 r">selectionRanges</span>)
            {
                <span class="r74 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#9717d207e9dda5cc" class="i method">Move</a>(<a href="#af5617f7ccc7dcfc" class="i field">_navigationUnit</a>, <span class="r72 r">navDirection</span>);
                <span class="r74 r">textRange</span>.<a href="@0@UIAutomationClient/A.html#743826c413a4aaba" class="i method">Select</a>();
            }
            <span class="c">// The WPF target doesn&#39;t show selected text as highlighted unless</span>
            <span class="c">// the window has focus.</span>
            <a href="#2eb5a86c5c69f9e8" class="i field">_targetDocument</a>.<a href="@0@UIAutomationClient/A.html#58ac36137aa75371" class="i method">SetFocus</a>();
        }

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Target Navigation

        <span class="k preprocess">#</span><span class="k preprocess">region</span> Target Listeners

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Handles the text changed event in the target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Since the events are happening on a different thread than the</span>
        <span class="c">///</span><span class="c">     client we need to use a Dispatcher delegate to handle them.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="1d1fdbce2b4929a8" href="R/1d1fdbce2b4929a8.html" target="n" data-glyph="76,1" class="i method">TextChanged</a>(<b>object</b> <span id="r75 rd" class="r75 r">sender</span>, <a href="@0@UIAutomationTypes/A.html#14f8c86e50924645" class="t t">AutomationEventArgs</a> <span id="r76 rd" class="r76 r">e</span>)
        {
            <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@WindowsBase/A.html#bd03df1631104fbc" class="i property">Dispatcher</a>.<a href="@0@WindowsBase/A.html#035566f3e2455f79" class="i method">BeginInvoke</a>(
                <a href="@0@WindowsBase/A.html#af2d44a802e4535c" class="t t">DispatcherPriority</a>.<a href="@0@WindowsBase/A.html#246ca2ab395503e0" class="i field">Send</a>,
                <b>new</b> <span class="t">TextChangeDelegate</span>(<a href="#080bcb668a483d2c" class="i method">NotifyTextChanged</a>),
                <span class="s">&quot;Text changed, range reset.\n&quot;</span>);
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     The delegate for the target text changed event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">arg</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">null argument</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A null object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="080bcb668a483d2c" href="R/080bcb668a483d2c.html" target="n" data-glyph="76,1" class="i method">NotifyTextChanged</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r77 rd" class="r77 r">message</span>)
        {
            <span class="c">// Notify the user of the text changed event. </span>
            <a href="#6c0e496113fbf038" class="i field">_targetSelectionLabel</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <span class="r77 r">message</span>;
            <span class="c">// Re-initialize the document range for the text of the document</span>
            <span class="c">// since we don&#39;t know the extent of the changes. For example, a </span>
            <span class="c">// change in the font color attribute, such as on a hyperlink </span>
            <span class="c">// mouseover, raises this event but doesn&#39;t change the content of </span>
            <span class="c">// the text control.</span>
            <a href="#813c6b2c244de086" class="i field">_documentRange</a> = <a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#bb563b51bd07f29f" class="i property">DocumentRange</a>;
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Handles the text selection changed event in the target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Since the events are happening on a different thread than the</span>
        <span class="c">///</span><span class="c">     client we need to use a Dispatcher delegate to handle them.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="c63cde76486408b8" href="R/c63cde76486408b8.html" target="n" data-glyph="76,1" class="i method">OnTextSelectionChange</a>(<b>object</b> <span id="r78 rd" class="r78 r">sender</span>, <a href="@0@UIAutomationTypes/A.html#14f8c86e50924645" class="t t">AutomationEventArgs</a> <span id="r79 rd" class="r79 r">e</span>)
        {
            <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@WindowsBase/A.html#bd03df1631104fbc" class="i property">Dispatcher</a>.<a href="@0@WindowsBase/A.html#bcbefade88f12503" class="i method">BeginInvoke</a>(
                <a href="@0@WindowsBase/A.html#af2d44a802e4535c" class="t t">DispatcherPriority</a>.<a href="@0@WindowsBase/A.html#246ca2ab395503e0" class="i field">Send</a>,
                <b>new</b> <span class="t">SelectionChangeDelegate</span>(<a href="#b994554fbff95f7a" class="i method">NotifySelectionChanged</a>));
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     The delegate for the target text selection changed event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">arg</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">null argument</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A null object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="b994554fbff95f7a" href="R/b994554fbff95f7a.html" target="n" data-glyph="76,1" class="i method">NotifySelectionChanged</a>()
        {
            <span class="c">// Get the array of disjoint selections.</span>
            <b>var</b> <span id="r80 rd" class="r80 r">selectionRanges</span> =
                <a href="#3a20aa4c67494b5d" class="i field">_targetTextPattern</a>.<a href="@0@UIAutomationClient/A.html#2368fc2f913f77bb" class="i method">GetSelection</a>();
            <span class="c">// Update the current search range.</span>
            <span class="c">// For the purposes of this sample only the first selection</span>
            <span class="c">// range will be echoed in the client.</span>
            <a href="#1789cbe254e28adc" class="i field">_searchRange</a> = <span class="r80 r">selectionRanges</span>[0];
            <span class="c">// For performance and security reasons we&#39;ll limit </span>
            <span class="c">// the length of the string retrieved to 100 characters.</span>
            <span class="c">// Alternatively, GetText(-1) will retrieve all selected text.</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r81 rd" class="r81 r">selectedText</span> = <a href="#1789cbe254e28adc" class="i field">_searchRange</a>.<a href="@0@UIAutomationClient/A.html#36b8ef59d383ab51" class="i method">GetText</a>(100);
            <a href="#6c0e496113fbf038" class="i field">_targetSelectionLabel</a>.<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> =
                <span class="s">&quot;Currently selected (100 character maximum): &quot;</span> +
                <span class="r81 r">selectedText</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> + <span class="s">&quot; characters.&quot;</span>;

            <span class="c">// Report target selection details.</span>
            <a href="#91c4a4b95bd69cd1" class="i method">DisplaySelectedTextWithAttributes</a>(<span class="r81 r">selectedText</span>);
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Display the target selection with attribute details in client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">selectedText</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The current target selection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="91c4a4b95bd69cd1" href="R/91c4a4b95bd69cd1.html" target="n" data-glyph="76,1" class="i method">DisplaySelectedTextWithAttributes</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r82 rd" class="r82 r">selectedText</span>)
        {
            <a href="#47088ae24f45e690" class="i field">_targetSelection</a>.<a href="@0@PresentationFramework/A.html#7b5be95f7a8f33a8" class="i property">Text</a> = <span class="r82 r">selectedText</span>;
            <span class="c">// We&#39;re only interested in the FontNameAttribute for the purposes </span>
            <span class="c">// of this sample.</span>
            <a href="#3193938ce7ef6698" class="i field">_targetSelectionAttributes</a>.<a href="@0@PresentationFramework/A.html#7b5be95f7a8f33a8" class="i property">Text</a> =
                <a href="#b9a61d354adcb5d8" class="i method">ParseTextRangeByAttribute</a>(
                    <span class="r82 r">selectedText</span>, <a href="@0@UIAutomationClient/A.html#793ac4f7346dda15" class="t t">TextPattern</a>.<a href="@0@UIAutomationClient/A.html#f569d9ccdfc782f1" class="i field">FontNameAttribute</a>);
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Parse the target selection based on the text attribute of interest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">selectedText</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The current target selection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">automationTextAttribute</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     The text attribute of interest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     A string representing the requested attribute details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private string</b> <a id="b9a61d354adcb5d8" href="R/b9a61d354adcb5d8.html" target="n" data-glyph="76,1" class="i method">ParseTextRangeByAttribute</a>(
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r83 rd" class="r83 r">selectedText</span>,
            <a href="@0@UIAutomationTypes/A.html#b7f8d2c70ce77228" class="t t">AutomationTextAttribute</a> <span id="r84 rd" class="r84 r">automationTextAttribute</span>)
        {
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="k">var</a> <span id="r85 rd" class="r85 r">attributeDetails</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
            <span class="c">// Initialize the current attribute value.</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r86 rd" class="r86 r">attributeValue</span> = <span class="s">&quot;&quot;</span>;
            <span class="c">// Make a copy of the text range.</span>
            <a href="@0@UIAutomationClient/A.html#5187586011530a5d" class="k">var</a> <span id="r87 rd" class="r87 r">searchRangeClone</span> = <a href="#1789cbe254e28adc" class="i field">_searchRange</a>.<a href="@0@UIAutomationClient/A.html#f7721c99b1bdfb8c" class="i method">Clone</a>();
            <span class="c">// Collapse the range to the starting endpoint.</span>
            <span class="r87 r">searchRangeClone</span>.<a href="@0@UIAutomationClient/A.html#9717d207e9dda5cc" class="i method">Move</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#e060f5cbcde1683e" class="i field">Character</a>, -1);
            <span class="c">// Iterate through the range character by character.</span>
            <b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r88 rd" class="r88 r">x</span> = 1; <span class="r88 r">x</span> &lt;= <span class="r83 r">selectedText</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a>; <span class="r88 r">x</span>++)
            {
                <span class="r87 r">searchRangeClone</span>.<a href="@0@UIAutomationClient/A.html#9717d207e9dda5cc" class="i method">Move</a>(<a href="@0@UIAutomationTypes/A.html#f09f23256efdef9f" class="t t">TextUnit</a>.<a href="@0@UIAutomationTypes/A.html#e060f5cbcde1683e" class="i field">Character</a>, 1);
                <span class="c">// Get the attribute value of the current character.</span>
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r89 rd" class="r89 r">newAttributeValue</span> =
                    <span class="r87 r">searchRangeClone</span>.<a href="@0@UIAutomationClient/A.html#8dfd8da3b70ddb06" class="i method">GetAttributeValue</a>(<span class="r84 r">automationTextAttribute</span>).<a href="@0@mscorlib/A.html#ff31a6bf27c58f89" class="i method">ToString</a>();
                <span class="c">// If the new attribute value is not equal to the old then report </span>
                <span class="c">// the new value along with its location within the range.</span>
                <b>if</b> (<span class="r89 r">newAttributeValue</span> != <span class="r86 r">attributeValue</span>)
                {
                    <span class="r85 r">attributeDetails</span>.<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="r84 r">automationTextAttribute</span>.<a href="@0@UIAutomationTypes/A.html#64da97432ec19d56" class="i property">ProgrammaticName</a>)
                        .<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;:\n&lt;&quot;</span>)
                        .<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="r89 r">newAttributeValue</span>)
                        .<a href="@0@mscorlib/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;&gt; at text range position &quot;</span>)
                        .<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="r88 r">x</span>.<a href="@0@mscorlib/A.html#8d6f2d8bc0589463" class="i method">ToString</a>());
                    <span class="r86 r">attributeValue</span> = <span class="r89 r">newAttributeValue</span>;
                }
            }
            <b>return</b> <span class="r85 r">attributeDetails</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>();
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Handles the window closed event in the target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that raised the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="5bbb672972036530" href="R/5bbb672972036530.html" target="n" data-glyph="76,1" class="i method">OnTargetClose</a>(<b>object</b> <span id="r90 rd" class="r90 r">sender</span>, <a href="@0@UIAutomationTypes/A.html#14f8c86e50924645" class="t t">AutomationEventArgs</a> <span id="r91 rd" class="r91 r">e</span>)
        {
            <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@WindowsBase/A.html#bd03df1631104fbc" class="i property">Dispatcher</a>.<a href="@0@WindowsBase/A.html#bcbefade88f12503" class="i method">BeginInvoke</a>(
                <a href="@0@WindowsBase/A.html#af2d44a802e4535c" class="t t">DispatcherPriority</a>.<a href="@0@WindowsBase/A.html#246ca2ab395503e0" class="i field">Send</a>,
                <b>new</b> <span class="t">ProviderCloseDelegate</span>(<a href="#683b06e30de3397d" class="i method">CloseApp</a>));
        }

        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     The delegate for the window closed event in the target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">arg</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">null argument</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A null object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------</span>
        <b>private void</b> <a id="683b06e30de3397d" href="R/683b06e30de3397d.html" target="n" data-glyph="76,1" class="i method">CloseApp</a>()
        {
            <span class="c">// Close the client window when the target window is closed.</span>
            <a href="#740fdffba14dd18e" class="i field">_clientWindow</a>.<a href="@0@PresentationFramework/A.html#9eff3c5633604c43" class="i method">Close</a>();
        }

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Target Listeners
    }
}</pre></td></tr></table></div></body></html>
