<!DOCTYPE html>
<html><head><title>HttpRequestsFullUserInfoDefs.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(89);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EasyITcenter-HELP/ServerCore/Interfaces/HttpRequestsFullUserInfoDefs.cs" target="_top">ServerCore\Interfaces\HttpRequestsFullUserInfoDefs.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EasyITcenter-HELP" target="_top">HelpProjects\EasyITcenter-HELP\EasyITcenter-HELP.csproj</a> (EasyITcenter-HELP)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>.<span class="i n">Security</span>.<span class="i n">Claims</span>;
 
<b>namespace</b> <span class="i n">EasyITCenter</span>.<span class="i n">ServerCoreStructure</span> {
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Server Communication Extensions for Controlling Data Implmented FullUserTokenData For More</span>
    <span class="c">///</span><span class="c"> Info Modify Auth Claims And Add Get Info Here</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="3748c5c828d5ee22" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="5499284c62c808eb">CommunicationController</span></a> : <span class="t t">IHttpContextAccessor</span> {
        <b>private static</b> <span class="t t">IHttpContextAccessor</span>? <a id="7b3f0d99ee40ef9c" href="../../R/7b3f0d99ee40ef9c.html" target="n" data-glyph="46,1" class="i field">_accessor</a> = <b>new</b> <span class="t constructor">HttpContextAccessor</span>();
 
        <span class="t t">HttpContext</span>? <span class="t t">IHttpContextAccessor</span>.<span class="i property">HttpContext</span> { <b>get</b> =&gt; <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>?.<span class="i property">HttpContext</span>; <b>set</b> =&gt; <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>.<span class="i property">HttpContext</span> = <b>value</b>; }
        <b>public</b> <span class="t t">HttpContext</span>? <a id="416b1084ea6566ce" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">HttpContext</a> { <b>get</b> =&gt; <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>.<span class="i property">HttpContext</span>; <b>set</b> =&gt; <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>.<span class="i property">HttpContext</span> = <b>value</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Extension for check Admin Role</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="f6f4673023e89094" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IsAdmin</a>() {
            <b>try</b> {
                <b>var</b> <span id="r0 rd" class="r0 r">context</span> = <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>?.<span class="i property">HttpContext</span>;
                <b>if</b> (<span class="r0 r">context</span> != <b>null</b> &amp;&amp; <span class="r0 r">context</span>.<span class="i property">User</span> != <b>null</b> &amp;&amp; !<span class="r0 r">context</span>.<span class="i property">User</span>.<span class="i method">IsInRole</span>(<span class="s">&quot;admin&quot;</span>)) { <b>return</b> <b>false</b>; } <b>else</b> <b>return</b> <b>true</b>;
            } <b>catch</b> { <b>return</b> <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Extension for check user Role</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="b19627df091f5253" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IsSystemUser</a>() {
            <b>try</b> {
                <b>var</b> <span id="r1 rd" class="r1 r">context</span> = <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>?.<span class="i property">HttpContext</span>;
                <b>if</b> (<span class="r1 r">context</span> != <b>null</b> &amp;&amp; <span class="r1 r">context</span>.<span class="i property">User</span> != <b>null</b> &amp;&amp; !<span class="r1 r">context</span>.<span class="i property">User</span>.<span class="i method">IsInRole</span>(<span class="s">&quot;user&quot;</span>)) { <b>return</b> <b>false</b>; } <b>else</b> <b>return</b> <b>true</b>;
            } <b>catch</b> { <b>return</b> <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Extension for check webuser Role</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="04dde6ef7847aed2" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IsWebUser</a>() {
            <b>try</b> {
                <b>var</b> <span id="r2 rd" class="r2 r">context</span> = <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>?.<span class="i property">HttpContext</span>;
                <b>if</b> (<span class="r2 r">context</span> != <b>null</b> &amp;&amp; <span class="r2 r">context</span>.<span class="i property">User</span> != <b>null</b> &amp;&amp; !<span class="r2 r">context</span>.<span class="i property">User</span>.<span class="i method">IsInRole</span>(<span class="s">&quot;webuser&quot;</span>)) { <b>return</b> <b>false</b>; } <b>else</b> <b>return</b> <b>true</b>;
            } <b>catch</b> { <b>return</b> <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check HTTP if is the Request Logged</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="6ae2785f379276ab" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IsLogged</a>() {
            <b>try</b> {
                <b>var</b> <span id="r3 rd" class="r3 r">context</span> = <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>?.<span class="i property">HttpContext</span>;
                <b>if</b> (<span class="r3 r">context</span> != <b>null</b> &amp;&amp; <span class="r3 r">context</span>.<span class="i property">User</span> != <b>null</b> &amp;&amp; <span class="r3 r">context</span>.<span class="i property">User</span>.<span class="i method">FindFirst</span>(<span class="t t">ClaimTypes</span>.<span class="i field">NameIdentifier</span>.<a href="@1@System.Runtime/A.html#efa5e6c14683e022" class="i method">ToString</a>())?.<span class="i property">Value</span> != <b>null</b>) { <b>return</b> <b>false</b>; } <b>else</b> <b>return</b> <b>true</b>;
            } <b>catch</b> { <b>return</b> <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get UserRole</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static string</b>? <a id="70eb478ee192e855" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetUserRole</a>() {
            <b>try</b> {
                <b>var</b> <span id="r4 rd" class="r4 r">context</span> = <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>?.<span class="i property">HttpContext</span>;
                <b>if</b> (<span class="r4 r">context</span> != <b>null</b> &amp;&amp; <span class="r4 r">context</span>.<span class="i property">User</span> != <b>null</b>) { <b>return</b> <span class="r4 r">context</span>.<span class="i property">User</span>.<span class="i method">FindFirst</span>(<span class="t t">ClaimTypes</span>.<span class="i field">Role</span>.<a href="@1@System.Runtime/A.html#efa5e6c14683e022" class="i method">ToString</a>())?.<span class="i property">Value</span>; } <b>else</b> <b>return</b> <b>null</b>;
            } <b>catch</b> { <b>return</b> <b>null</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get UserId</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static string</b>? <a id="e92b696a7ad77b32" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetUserId</a>() {
            <b>try</b> {
                <b>var</b> <span id="r5 rd" class="r5 r">context</span> = <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>?.<span class="i property">HttpContext</span>;
                <b>if</b> (<span class="r5 r">context</span> != <b>null</b> &amp;&amp; <span class="r5 r">context</span>.<span class="i property">User</span> != <b>null</b>) { <b>return</b> <span class="r5 r">context</span>.<span class="i property">User</span>.<span class="i method">FindFirst</span>(<span class="t t">ClaimTypes</span>.<span class="i field">PrimarySid</span>.<a href="@1@System.Runtime/A.html#efa5e6c14683e022" class="i method">ToString</a>())?.<span class="i property">Value</span>; } <b>else</b> <b>return</b> <b>null</b>;
            } <b>catch</b> { <b>return</b> <b>null</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get UserName</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static string</b>? <a id="0b7dbc5ed1e3d686" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetUserName</a>() {
            <b>try</b> {
                <b>var</b> <span id="r6 rd" class="r6 r">context</span> = <a href="#7b3f0d99ee40ef9c" class="i field">_accessor</a>?.<span class="i property">HttpContext</span>;
                <b>if</b> (<span class="r6 r">context</span> != <b>null</b> &amp;&amp; <span class="r6 r">context</span>.<span class="i property">User</span> != <b>null</b>) { <b>return</b> <span class="r6 r">context</span>.<span class="i property">User</span>.<span class="i method">FindFirst</span>(<span class="t t">ClaimTypes</span>.<span class="i field">NameIdentifier</span>.<a href="@1@System.Runtime/A.html#efa5e6c14683e022" class="i method">ToString</a>())?.<span class="i property">Value</span>; } <b>else</b> <b>return</b> <b>null</b>;
            } <b>catch</b> { <b>return</b> <b>null</b>; }
        }
    }
}</pre></td></tr></table></div></body></html>
