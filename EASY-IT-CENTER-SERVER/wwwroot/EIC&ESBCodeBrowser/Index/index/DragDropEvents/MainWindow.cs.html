<!DOCTYPE html>
<html><head><title>MainWindow.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(109);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#DragDropEvents/MainWindow.cs" target="_top">MainWindow.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#DragDropEvents" target="_top">HelpProjects\WPF-MORE\Drag and Drop\DragDropEvents\DragDropEvents.csproj</a> (DragDropEvents)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// // Copyright (c) Microsoft. All rights reserved.</span>
<span class="c">// // Licensed under the MIT license. See LICENSE file in the project root for full license information.</span>

<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;

<b>namespace</b> <span class="i n">DragDropEvents</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     Interaction logic for MainWindow.xaml</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public</b> <a href="P/5b0e1dfe32a14c9d.html" target="s" class="k">partial</a> <b>class</b> <a id="5b0e1dfe32a14c9d" href="R/5b0e1dfe32a14c9d.html" target="n" data-glyph="0,0" class="t t">MainWindow</a> : <a href="@0@PresentationFramework/A.html#e438dc91640a8d15" class="t t">Window</a>
    {
        <span class="c">// To store the height of the other elements in the grid column containing</span>
        <span class="c">// the event log.</span>
        <b>private readonly double</b> <a id="73bbd30cde124f07" href="R/73bbd30cde124f07.html" target="n" data-glyph="46,1" class="i field">_heightAdjustment</a>;
        <b>private uint</b> <a id="cb8789017ed88bb4" href="R/cb8789017ed88bb4.html" target="n" data-glyph="46,1" class="i field">_eventCount</a>;

        <b>public</b> <a id="228574ea95242385" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">MainWindow</a>()
        {
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#5058bfedb2641afa" class="i method">InitializeComponent</a>();
            <a href="#73bbd30cde124f07" class="i field">_heightAdjustment</a> = <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#37df46d64058c965" class="i field">lblEventLogWindowTitle</a>.<a href="@0@PresentationFramework/A.html#df2641c07f10d929" class="i property">Height</a> + <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#e4db9ccd11555a23" class="i field">lblEventSelectionTitle</a>.<a href="@0@PresentationFramework/A.html#df2641c07f10d929" class="i property">Height</a> + <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#adaf7ab95a0d985a" class="i field">eventChecksGrid</a>.<a href="@0@PresentationFramework/A.html#df2641c07f10d929" class="i property">Height</a>;
        }

        <b>private void</b> <a id="b20d4aa046eaf79f" href="R/b20d4aa046eaf79f.html" target="n" data-glyph="76,1" class="i method">ClickClearEventHistory</a>(<b>object</b> <span id="r0 rd" class="r0 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r1 rd" class="r1 r">args</span>)
        {
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#e997c45c90f5eed5" class="i method">Clear</a>();
            <a href="#cb8789017ed88bb4" class="i field">_eventCount</a> = 0;
        }

        <span class="c">// This event handler fires whenever the main window changes size.  </span>
        <b>private void</b> <a id="f9674d7ea61548dd" href="R/f9674d7ea61548dd.html" target="n" data-glyph="76,1" class="i method">EhEventWindowSizeChanged</a>(<b>object</b> <span id="r2 rd" class="r2 r">sender</span>, <a href="@1@System.Runtime/A.html#9a1496aa60befd10" class="t t">EventArgs</a> <span id="r3 rd" class="r3 r">args</span>)
        {
            <span class="c">// Adjust the size of the TextBox so scrolling works properly.</span>
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#5a7c1405bd87b81d" class="i property">MaxHeight</a> = <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#df2641c07f10d929" class="i property">Height</a> = <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#735c16d1034ddb5b" class="i field">mainGrid</a>.<a href="@0@PresentationFramework/A.html#e6e16a8002a4d90f" class="i property">RowDefinitions</a>[1].<a href="@0@PresentationFramework/A.html#2bcf90783c9002c8" class="i property">ActualHeight</a> - <a href="#73bbd30cde124f07" class="i field">_heightAdjustment</a>;
        }

        <span class="c">// Handlers for the drag/drop events.  </span>
        <b>private void</b> <a id="4322221d540dfd7e" href="R/4322221d540dfd7e.html" target="n" data-glyph="76,1" class="i method">EhDragEnter</a>(<b>object</b> <span id="r4 rd" class="r4 r">sender</span>, <a href="@0@PresentationCore/A.html#04916847ce5fcf2c" class="t t">DragEventArgs</a> <span id="r5 rd" class="r5 r">args</span>)
        {
            <b>if</b> (<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#e90f093e1989762a" class="i field">cbDragEnter</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>.<a href="@1@System.Runtime/A.html#7b38d1fa76071c95" class="i property">Value</a>) <a href="#5946efcacd48041a" class="i method">LogEvent</a>(<a href="#8b39f589a6d7c159" class="t t">EventFireStrings</a>.<a href="#86bd56d97e48b91f" class="i field">DragEnter</a>, <span class="r5 r">args</span>);
        }

        <b>private void</b> <a id="026fffa53f441b7f" href="R/026fffa53f441b7f.html" target="n" data-glyph="76,1" class="i method">EhDragLeave</a>(<b>object</b> <span id="r6 rd" class="r6 r">sender</span>, <a href="@0@PresentationCore/A.html#04916847ce5fcf2c" class="t t">DragEventArgs</a> <span id="r7 rd" class="r7 r">args</span>)
        {
            <b>if</b> (<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#7b9ba4ee94c6aebd" class="i field">cbDragLeave</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>.<a href="@1@System.Runtime/A.html#7b38d1fa76071c95" class="i property">Value</a>) <a href="#5946efcacd48041a" class="i method">LogEvent</a>(<a href="#8b39f589a6d7c159" class="t t">EventFireStrings</a>.<a href="#8ea25a07d62d8444" class="i field">DragLeave</a>, <span class="r7 r">args</span>);
        }

        <b>private void</b> <a id="c55239ecd5701c2f" href="R/c55239ecd5701c2f.html" target="n" data-glyph="76,1" class="i method">EhDragOver</a>(<b>object</b> <span id="r8 rd" class="r8 r">sender</span>, <a href="@0@PresentationCore/A.html#04916847ce5fcf2c" class="t t">DragEventArgs</a> <span id="r9 rd" class="r9 r">args</span>)
        {
            <b>if</b> (<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#f7c25b01685449aa" class="i field">cbDragOver</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>.<a href="@1@System.Runtime/A.html#7b38d1fa76071c95" class="i property">Value</a>) <a href="#5946efcacd48041a" class="i method">LogEvent</a>(<a href="#8b39f589a6d7c159" class="t t">EventFireStrings</a>.<a href="#18377d39efb8937d" class="i field">DragOver</a>, <span class="r9 r">args</span>);
        }

        <b>private void</b> <a id="34c042ef3f7d4a5d" href="R/34c042ef3f7d4a5d.html" target="n" data-glyph="76,1" class="i method">EhDrop</a>(<b>object</b> <span id="r10 rd" class="r10 r">sender</span>, <a href="@0@PresentationCore/A.html#04916847ce5fcf2c" class="t t">DragEventArgs</a> <span id="r11 rd" class="r11 r">args</span>)
        {
            <b>if</b> (<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#e0074207471f893f" class="i field">cbDrop</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>.<a href="@1@System.Runtime/A.html#7b38d1fa76071c95" class="i property">Value</a>) <a href="#5946efcacd48041a" class="i method">LogEvent</a>(<a href="#8b39f589a6d7c159" class="t t">EventFireStrings</a>.<a href="#a2b618f6df1c778e" class="i field">Drop</a>, <span class="r11 r">args</span>);
        }

        <b>private void</b> <a id="b84036f381f56d78" href="R/b84036f381f56d78.html" target="n" data-glyph="76,1" class="i method">EhPreviewDragEnter</a>(<b>object</b> <span id="r12 rd" class="r12 r">sender</span>, <a href="@0@PresentationCore/A.html#04916847ce5fcf2c" class="t t">DragEventArgs</a> <span id="r13 rd" class="r13 r">args</span>)
        {
            <b>if</b> (<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#591650205007c073" class="i field">cbPreviewDragEnter</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>.<a href="@1@System.Runtime/A.html#7b38d1fa76071c95" class="i property">Value</a>) <a href="#5946efcacd48041a" class="i method">LogEvent</a>(<a href="#8b39f589a6d7c159" class="t t">EventFireStrings</a>.<a href="#e3e0503f7ba1e6b5" class="i field">PreviewDragEnter</a>, <span class="r13 r">args</span>);
        }

        <b>private void</b> <a id="60aed095406c8567" href="R/60aed095406c8567.html" target="n" data-glyph="76,1" class="i method">EhPreviewDragLeave</a>(<b>object</b> <span id="r14 rd" class="r14 r">sender</span>, <a href="@0@PresentationCore/A.html#04916847ce5fcf2c" class="t t">DragEventArgs</a> <span id="r15 rd" class="r15 r">args</span>)
        {
            <b>if</b> (<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#f6008fb487579bc9" class="i field">cbPreviewDragLeave</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>.<a href="@1@System.Runtime/A.html#7b38d1fa76071c95" class="i property">Value</a>) <a href="#5946efcacd48041a" class="i method">LogEvent</a>(<a href="#8b39f589a6d7c159" class="t t">EventFireStrings</a>.<a href="#494c6bfbefba10fa" class="i field">PreviewDragLeave</a>, <span class="r15 r">args</span>);
        }

        <b>private void</b> <a id="e45eee18768cce8c" href="R/e45eee18768cce8c.html" target="n" data-glyph="76,1" class="i method">EhPreviewDragOver</a>(<b>object</b> <span id="r16 rd" class="r16 r">sender</span>, <a href="@0@PresentationCore/A.html#04916847ce5fcf2c" class="t t">DragEventArgs</a> <span id="r17 rd" class="r17 r">args</span>)
        {
            <b>if</b> (<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#417ff24a1300076e" class="i field">cbPreviewDragOver</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>.<a href="@1@System.Runtime/A.html#7b38d1fa76071c95" class="i property">Value</a>) <a href="#5946efcacd48041a" class="i method">LogEvent</a>(<a href="#8b39f589a6d7c159" class="t t">EventFireStrings</a>.<a href="#4defaba18690c408" class="i field">PreviewDragOver</a>, <span class="r17 r">args</span>);
        }

        <b>private void</b> <a id="568b96f5aede1486" href="R/568b96f5aede1486.html" target="n" data-glyph="76,1" class="i method">EhPreviewDrop</a>(<b>object</b> <span id="r18 rd" class="r18 r">sender</span>, <a href="@0@PresentationCore/A.html#04916847ce5fcf2c" class="t t">DragEventArgs</a> <span id="r19 rd" class="r19 r">args</span>)
        {
            <b>if</b> (<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#bbd6a3ceb75fb4c8" class="i field">cbPreviewDrop</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>.<a href="@1@System.Runtime/A.html#7b38d1fa76071c95" class="i property">Value</a>) <a href="#5946efcacd48041a" class="i method">LogEvent</a>(<a href="#8b39f589a6d7c159" class="t t">EventFireStrings</a>.<a href="#60017516f1bf51f6" class="i field">PreviewDrop</a>, <span class="r19 r">args</span>);
        }

        <b>private void</b> <a id="5946efcacd48041a" href="R/5946efcacd48041a.html" target="n" data-glyph="76,1" class="i method">LogEvent</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">eventMessage</span>, <a href="@0@PresentationCore/A.html#04916847ce5fcf2c" class="t t">DragEventArgs</a> <span id="r21 rd" class="r21 r">args</span>)
        {
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;[&quot;</span> + (++<a href="#cb8789017ed88bb4" class="i field">_eventCount</a>) + <span class="r20 r">eventMessage</span>);

            <b>if</b> (<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#8d1f7515bc0a18a9" class="i field">cbVerbose</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>.<a href="@1@System.Runtime/A.html#7b38d1fa76071c95" class="i property">Value</a>)
            {
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;     Source Object: &quot;</span> + <span class="r21 r">args</span>.<a href="@0@PresentationCore/A.html#d8bb6e0074ca9326" class="i property">Source</a> + <span class="s">&quot;\n&quot;</span>);
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;     Drag Effects: &quot;</span> + <span class="r21 r">args</span>.<a href="@0@PresentationCore/A.html#6e1cc3a342260a9e" class="i property">Effects</a> + <span class="s">&quot;\n&quot;</span>);
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;     Key States: &quot;</span> + <span class="r21 r">args</span>.<a href="@0@PresentationCore/A.html#ccd6980505b5752b" class="i property">KeyStates</a> + <span class="s">&quot;\n&quot;</span>);
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;     Available Data Formats:\n&quot;</span>);
                <b>foreach</b> (<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r22 rd" class="r22 r">format</span> <b>in</b> <span class="r21 r">args</span>.<a href="@0@PresentationCore/A.html#e542a83d010deabe" class="i property">Data</a>.<a href="@0@PresentationCore/A.html#e99f6de9447fedcc" class="i method">GetFormats</a>())
                {
                    <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;          &quot;</span> + <span class="r22 r">format</span> + <span class="s">&quot;\n&quot;</span>);
                }
            }
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#011526c27e93d3b3" class="i field">tbEventEvents</a>.<a href="@0@PresentationFramework/A.html#e64329493e91db26" class="i method">ScrollToEnd</a>();
        }

        <b>private struct</b> <a id="8b39f589a6d7c159" href="R/8b39f589a6d7c159.html" target="n" data-glyph="112,1" class="t t"><span id="8716250ad8447855">EventFireStrings</span></a>
        {
            <b>public static readonly string</b> <a id="86bd56d97e48b91f" href="R/86bd56d97e48b91f.html" target="n" data-glyph="42,2" class="i field">DragEnter</a> = <span class="s">&quot;]: The DragEnter event just fired.\n&quot;</span>;
            <b>public static readonly string</b> <a id="8ea25a07d62d8444" href="R/8ea25a07d62d8444.html" target="n" data-glyph="42,2" class="i field">DragLeave</a> = <span class="s">&quot;]: The DragLeave event just fired.\n&quot;</span>;
            <b>public static readonly string</b> <a id="18377d39efb8937d" href="R/18377d39efb8937d.html" target="n" data-glyph="42,2" class="i field">DragOver</a> = <span class="s">&quot;]: The DragOver event just fired.\n&quot;</span>;
            <b>public static readonly string</b> <a id="a2b618f6df1c778e" href="R/a2b618f6df1c778e.html" target="n" data-glyph="42,2" class="i field">Drop</a> = <span class="s">&quot;]: The Drop event just fired.\n&quot;</span>;
            <b>public static readonly string</b> <a id="e3e0503f7ba1e6b5" href="R/e3e0503f7ba1e6b5.html" target="n" data-glyph="42,2" class="i field">PreviewDragEnter</a> = <span class="s">&quot;]: The PreviewDragEnter event just fired.\n&quot;</span>;
            <b>public static readonly string</b> <a id="494c6bfbefba10fa" href="R/494c6bfbefba10fa.html" target="n" data-glyph="42,2" class="i field">PreviewDragLeave</a> = <span class="s">&quot;]: The PreviewDragLeave event just fired.\n&quot;</span>;
            <b>public static readonly string</b> <a id="4defaba18690c408" href="R/4defaba18690c408.html" target="n" data-glyph="42,2" class="i field">PreviewDragOver</a> = <span class="s">&quot;]: The PreviewDragOver event just fired.\n&quot;</span>;
            <b>public static readonly string</b> <a id="60017516f1bf51f6" href="R/60017516f1bf51f6.html" target="n" data-glyph="42,2" class="i field">PreviewDrop</a> = <span class="s">&quot;]: The PreviewDrop event just fired.\n&quot;</span>;
        }
    }
}</pre></td></tr></table></div></body></html>
