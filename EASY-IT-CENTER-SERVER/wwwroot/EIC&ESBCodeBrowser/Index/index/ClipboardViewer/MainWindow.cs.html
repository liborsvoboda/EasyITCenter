<!DOCTYPE html>
<html><head><title>MainWindow.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(698);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#ClipboardViewer/MainWindow.cs" target="_top">MainWindow.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#ClipboardViewer" target="_top">HelpProjects\WPF-MORE\Clipboard\ClipboardViewer\ClipboardViewer.csproj</a> (ClipboardViewer)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// // Copyright (c) Microsoft. All rights reserved.</span>
<span class="c">// // Licensed under the MIT license. See LICENSE file in the project root for full license information.</span>

<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Documents</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Win32</span>;

<b>namespace</b> <span class="i n">ClipboardViewer</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     Interaction logic for MainWindow.xaml</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public</b> <a href="P/8c812800c07cf320.html" target="s" class="k">partial</a> <b>class</b> <a id="8c812800c07cf320" href="R/8c812800c07cf320.html" target="n" data-glyph="0,0" class="t t">MainWindow</a> : <a href="@0@PresentationFramework/A.html#e438dc91640a8d15" class="t t">Window</a>
    {
        <b>public</b> <a id="000afc07fff59a33" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">MainWindow</a>()
        {
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#343baf3650d6dbc4" class="i method">InitializeComponent</a>();
        }

        <span class="c">// This is called when UI is laid out, rendered and ready for interaction.</span>
        <b>private void</b> <a id="ccaf117a15fe85b6" href="R/ccaf117a15fe85b6.html" target="n" data-glyph="76,1" class="i method">WindowLoaded</a>(<b>object</b> <span id="r0 rd" class="r0 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r1 rd" class="r1 r">args</span>)
        {
            <span class="c">// Check the current Clipboard data format status</span>
            <a href="#cf41ff779c14a833" class="i method">RefreshClipboardDataFormat</a>();

            <span class="c">// Set the text copy information on RichTextBox</span>
            <a href="#fd3e8565f4f1fd60" class="i method">SetTextOnRichTextBox</a>(<span class="s">&quot;Please type clipboard copy data here!&quot;</span>);
        }

        <b>private void</b> <a id="0a215b12084d9f01" href="R/0a215b12084d9f01.html" target="n" data-glyph="76,1" class="i method">ClearClipboard</a>(<b>object</b> <span id="r2 rd" class="r2 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r3 rd" class="r3 r">args</span>)
        {
            <span class="c">// Clear Clipboard</span>
            <a href="@0@PresentationCore/A.html#bb14b599507febfc" class="t t">Clipboard</a>.<a href="@0@PresentationCore/A.html#2ded514dbdeadd7c" class="i method">Clear</a>();

            <span class="c">// Update the current Clipboard data format status after clear Clipboard</span>
            <a href="#cf41ff779c14a833" class="i method">RefreshClipboardDataFormat</a>();
        }

        <b>private void</b> <a id="74e1191d9e2033cf" href="R/74e1191d9e2033cf.html" target="n" data-glyph="76,1" class="i method">RefreshClipboardDataFormatStatus</a>(<b>object</b> <span id="r4 rd" class="r4 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r5 rd" class="r5 r">args</span>)
        {
            <span class="c">// Refresh the all clipboard data format into the information panel</span>
            <a href="#cf41ff779c14a833" class="i method">RefreshClipboardDataFormat</a>();
        }

        <b>private void</b> <a id="f3fdd7701bd2f2ca" href="R/f3fdd7701bd2f2ca.html" target="n" data-glyph="76,1" class="i method">DumpAllClipboardContents</a>(<b>object</b> <span id="r6 rd" class="r6 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r7 rd" class="r7 r">args</span>)
        {
            <span class="c">// Dump all Clipboard contents on the Clipboard information panel</span>
            <a href="#6a34ff8ea6488d1e" class="i method">DumpAllClipboardContentsInternal</a>();
        }

        <b>private void</b> <a id="b1a700cc383274e9" href="R/b1a700cc383274e9.html" target="n" data-glyph="76,1" class="i method">CopyToClipboard</a>(<b>object</b> <span id="r8 rd" class="r8 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r9 rd" class="r9 r">args</span>)
        {
            <a href="@0@PresentationCore/A.html#e61bfdf1a095bc9f" class="k">var</a> <span id="r10 rd" class="r10 r">dataObject</span> = <b>new</b> <a href="@0@PresentationCore/A.html#189982cfccb62556" class="t constructor">DataObject</a>();

            <span class="c">// Copy data from RichTextBox/File content into DataObject</span>
            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#6b2637da36823f62" class="i field">rbCopyDataFromRichTextBox</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <a href="#b6e659b1a64ec09b" class="i method">CopyDataFromRichTextBox</a>(<span class="r10 r">dataObject</span>);
            }
            <b>else</b>
            {
                <a href="#13b3ef827ce51eca" class="i method">CopyDataFromFile</a>(<span class="r10 r">dataObject</span>);
            }

            <span class="c">// Copy DataObject on the system Clipboard</span>
            <b>if</b> (<span class="r10 r">dataObject</span>.<a href="@0@PresentationCore/A.html#cdad52963a9eef2d" class="i method">GetFormats</a>().<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
            {
                <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#4a90f8198b29e279" class="i field">cbFlushOnCopy</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
                {
                    <span class="c">// Copy data to the system clipboard with flush</span>
                    <a href="@0@PresentationCore/A.html#bb14b599507febfc" class="t t">Clipboard</a>.<a href="@0@PresentationCore/A.html#68ca81bbc84f706a" class="i method">SetDataObject</a>(<span class="r10 r">dataObject</span>, <b>true</b> <span class="c">/*copy*/</span>);
                }
                <b>else</b>
                {
                    <span class="c">// Copy data to the system clipboard without flush</span>
                    <a href="@0@PresentationCore/A.html#bb14b599507febfc" class="t t">Clipboard</a>.<a href="@0@PresentationCore/A.html#68ca81bbc84f706a" class="i method">SetDataObject</a>(<span class="r10 r">dataObject</span>, <b>false</b> <span class="c">/*copy*/</span>);
                }
            }

            <span class="c">// Dump the copied data contents on the information panel</span>
            <a href="#6a34ff8ea6488d1e" class="i method">DumpAllClipboardContentsInternal</a>();
        }

        <b>private void</b> <a id="3bf23bcfac48b4b4" href="R/3bf23bcfac48b4b4.html" target="n" data-glyph="76,1" class="i method">PasteFromClipboard</a>(<b>object</b> <span id="r11 rd" class="r11 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r12 rd" class="r12 r">args</span>)
        {
            <a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="k">var</a> <span id="r13 rd" class="r13 r">dataObject</span> = <a href="#4429f02eb036129c" class="i method">GetDataObjectFromClipboard</a>();

            <b>if</b> (<span class="r13 r">dataObject</span> == <b>null</b>)
            {
                <a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#61ad43de2de82769" class="i method">Show</a>(<span class="s">&quot;Couldn&#39;t get DataObject from system clipboard!\n&quot;</span>, <span class="s">&quot;Clipboard Error&quot;</span>);
                <b>return</b>;
            }

            <a href="@1@System.Runtime/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r14 rd" class="r14 r">autoConvert</span> = (<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#aeee4ea4451f3401" class="i field">cbAutoConvertibleData</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>;
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r15 rd" class="r15 r">pasteDataFormat</span> = <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#c9a3a160aa9f9ab6" class="i field">lbPasteDataFormat</a>.<a href="@0@PresentationFramework/A.html#898a32799f6d6bef" class="i property">SelectedItems</a>[0] <b>as string</b>;

            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#b1c456a8089112bf" class="i field">rbPasteDataToRichTextBox</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <span class="c">// Paste data from Clipboard to RichTextBox</span>
                <a href="#88046451a42ddae2" class="i method">PasteClipboardDataToRichTextBox</a>(<span class="r15 r">pasteDataFormat</span>, <span class="r13 r">dataObject</span>, <span class="r14 r">autoConvert</span>);
            }
            <b>else</b>
            {
                <span class="c">// Paste data from Clipboard to File</span>
                <a href="#c7da7d3baa8445d8" class="i method">PasteClipboardDataToFile</a>(<span class="r15 r">pasteDataFormat</span>, <span class="r13 r">dataObject</span>, <span class="r14 r">autoConvert</span>);
            }
        }

        <b>private void</b> <a id="e4eb49c2d9a38cf0" href="R/e4eb49c2d9a38cf0.html" target="n" data-glyph="76,1" class="i method">ClearRichTextBox</a>(<b>object</b> <span id="r16 rd" class="r16 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r17 rd" class="r17 r">args</span>)
        {
            <a href="#fd3e8565f4f1fd60" class="i method">SetTextOnRichTextBox</a>(<span class="s">&quot;&quot;</span>);
        }

        <span class="c">// Update the data format status and describe all available data formats</span>
        <b>private void</b> <a id="cf41ff779c14a833" href="R/cf41ff779c14a833.html" target="n" data-glyph="76,1" class="i method">RefreshClipboardDataFormat</a>()
        {
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#e997c45c90f5eed5" class="i method">Clear</a>();

            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#c9a3a160aa9f9ab6" class="i field">lbPasteDataFormat</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#ffd0144f9d66cb9d" class="i method">Clear</a>();

            <a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="k">var</a> <span id="r18 rd" class="r18 r">dataObject</span> = <a href="#4429f02eb036129c" class="i method">GetDataObjectFromClipboard</a>();

            <b>if</b> (<span class="r18 r">dataObject</span> == <b>null</b>)
            {
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#7b5be95f7a8f33a8" class="i property">Text</a> = <span class="s">&quot;Can&#39;t access clipboard now! Please click Refresh button again.&quot;</span>;
            }
            <b>else</b>
            {
                <span class="c">// Check the data format whether it is on Clipboard or not</span>
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#c1593f365517f13d" class="i field">cbAudio</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a> = <span class="r18 r">dataObject</span>.<a href="@0@PresentationCore/A.html#5ab0d218c006f20d" class="i method">GetDataPresent</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#b8a4b62ece7ff7e7" class="i field">WaveAudio</a>);
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#e83ab667b5ae73e1" class="i field">cbFileDropList</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a> = <span class="r18 r">dataObject</span>.<a href="@0@PresentationCore/A.html#5ab0d218c006f20d" class="i method">GetDataPresent</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#69acac38a81a1baf" class="i field">FileDrop</a>);
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#922f2117a6ef0eda" class="i field">cbImage</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a> = <span class="r18 r">dataObject</span>.<a href="@0@PresentationCore/A.html#5ab0d218c006f20d" class="i method">GetDataPresent</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#2b28aaca0e50ac04" class="i field">Bitmap</a>);
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#b64c00404e8811f3" class="i field">cbText</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a> = <span class="r18 r">dataObject</span>.<a href="@0@PresentationCore/A.html#5ab0d218c006f20d" class="i method">GetDataPresent</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>);
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#8cab38190d64f689" class="i field">cbRtf</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a> = <span class="r18 r">dataObject</span>.<a href="@0@PresentationCore/A.html#5ab0d218c006f20d" class="i method">GetDataPresent</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>);
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#443d692dce2cd05e" class="i field">cbXaml</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a> = <span class="r18 r">dataObject</span>.<a href="@0@PresentationCore/A.html#5ab0d218c006f20d" class="i method">GetDataPresent</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>);

                <span class="c">// Update the data format into the information panel</span>
                <a href="#04f3287b92cd55da" class="i method">UpdateAvailableDataFormats</a>(<span class="r18 r">dataObject</span>);
            }
        }

        <span class="c">// Update and describe all available data formats</span>
        <b>private void</b> <a id="04f3287b92cd55da" href="R/04f3287b92cd55da.html" target="n" data-glyph="76,1" class="i method">UpdateAvailableDataFormats</a>(<a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="t t">IDataObject</a> <span id="r19 rd" class="r19 r">dataObject</span>)
        {
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;Clipboard DataObject Type: &quot;</span>);
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="r19 r">dataObject</span>.<a href="@1@System.Runtime/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@1@System.Runtime/A.html#3b264aebc8d4c084" class="i method">ToString</a>());

            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;\n\n****************************************************\n\n&quot;</span>);

            <b>var</b> <span id="r20 rd" class="r20 r">formats</span> = <span class="r19 r">dataObject</span>.<a href="@0@PresentationCore/A.html#e99f6de9447fedcc" class="i method">GetFormats</a>();

            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(
                <span class="s">&quot;The following data formats are present in the data object obtained from the clipboard:\n&quot;</span>);

            <b>if</b> (<span class="r20 r">formats</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
            {
                <b>foreach</b> (<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r21 rd" class="r21 r">format</span> <b>in</b> <span class="r20 r">formats</span>)
                {
                    <b>bool</b> <span id="r22 rd" class="r22 r">nativeData</span>;
                    <b>if</b> (<span class="r19 r">dataObject</span>.<a href="@0@PresentationCore/A.html#37d3c615184bf797" class="i method">GetDataPresent</a>(<span class="r21 r">format</span>, <b>false</b>))
                    {
                        <span class="r22 r">nativeData</span> = <b>true</b>;
                        <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;\t- &quot;</span> + <span class="r21 r">format</span> + <span class="s">&quot; (native)\n&quot;</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r22 r">nativeData</span> = <b>false</b>;
                        <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;\t- &quot;</span> + <span class="r21 r">format</span> + <span class="s">&quot; (autoconvertable)\n&quot;</span>);
                    }

                    <b>if</b> (<span class="r22 r">nativeData</span>)
                    {
                        <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#c9a3a160aa9f9ab6" class="i field">lbPasteDataFormat</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<span class="r21 r">format</span>);
                    }
                    <b>else</b> <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#aeee4ea4451f3401" class="i field">cbAutoConvertibleData</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
                    {
                        <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#c9a3a160aa9f9ab6" class="i field">lbPasteDataFormat</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#d8832077b4ca2360" class="i method">Add</a>(<span class="r21 r">format</span>);
                    }
                }

                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#c9a3a160aa9f9ab6" class="i field">lbPasteDataFormat</a>.<a href="@0@PresentationFramework/A.html#ca98f21336190217" class="i property">SelectedIndex</a> = 0;
            }
            <b>else</b>
            {
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;\t- no data formats are present\n&quot;</span>);
            }
        }

        <span class="c">// Dump all available data contents</span>
        <b>private void</b> <a id="6a34ff8ea6488d1e" href="R/6a34ff8ea6488d1e.html" target="n" data-glyph="76,1" class="i method">DumpAllClipboardContentsInternal</a>()
        {
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#e997c45c90f5eed5" class="i method">Clear</a>();

            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#c9a3a160aa9f9ab6" class="i field">lbPasteDataFormat</a>.<a href="@0@PresentationFramework/A.html#54366ee76d2f1106" class="i property">Items</a>.<a href="@0@PresentationFramework/A.html#ffd0144f9d66cb9d" class="i method">Clear</a>();

            <a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="k">var</a> <span id="r23 rd" class="r23 r">dataObject</span> = <a href="#4429f02eb036129c" class="i method">GetDataObjectFromClipboard</a>();

            <b>if</b> (<span class="r23 r">dataObject</span> == <b>null</b>)
            {
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#7b5be95f7a8f33a8" class="i property">Text</a> =
                    <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#7b5be95f7a8f33a8" class="i property">Text</a> =
                        <span class="s">&quot;Can&#39;t access clipboard now! \n\nPlease click Dump All Clipboard Contents button again.&quot;</span>;
            }
            <b>else</b>
            {
                <span class="c">// Update the availabe data formats </span>
                <a href="#04f3287b92cd55da" class="i method">UpdateAvailableDataFormats</a>(<span class="r23 r">dataObject</span>);

                <span class="c">// Update the all available data contents</span>
                <b>var</b> <span id="r24 rd" class="r24 r">formats</span> = <span class="r23 r">dataObject</span>.<a href="@0@PresentationCore/A.html#e99f6de9447fedcc" class="i method">GetFormats</a>();
                <b>foreach</b> (<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r25 rd" class="r25 r">format</span> <b>in</b> <span class="r24 r">formats</span>)
                {
                    <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;\n\n****************************************************\n&quot;</span>);
                    <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="r25 r">format</span> + <span class="s">&quot; data:\n&quot;</span>);
                    <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;****************************************************\n\n&quot;</span>);

                    <a href="@1@System.Runtime/A.html#d9262ceecc1719ab" class="k">var</a> <span id="r26 rd" class="r26 r">data</span> = <a href="#9aa54bee2d473d8a" class="i method">GetDataFromDataObject</a>(<span class="r23 r">dataObject</span>, <span class="r25 r">format</span>, <b>true</b> <span class="c">/*autoConvert*/</span>);

                    <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="r26 r">data</span>?.<a href="@1@System.Runtime/A.html#ff31a6bf27c58f89" class="i method">ToString</a>() ?? <span class="s">&quot;null&quot;</span>);
                }
            }
        }

        <span class="c">// Set the selected data format&#39;s data from RichTextBox&#39;s content </span>
        <span class="c">// into DataObject for copying data on the system clipboard</span>
        <b>private void</b> <a id="b6e659b1a64ec09b" href="R/b6e659b1a64ec09b.html" target="n" data-glyph="76,1" class="i method">CopyDataFromRichTextBox</a>(<a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="t t">IDataObject</a> <span id="r27 rd" class="r27 r">dataObject</span>)
        {
            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#04d9e48e9b493ff4" class="i field">cbCopyTextDataFormat</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r28 rd" class="r28 r">textData</span> = <a href="#25ddd220a96fd866" class="i method">GetTextStringFromRichTextBox</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>);
                <b>if</b> (<span class="r28 r">textData</span> != <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>)
                {
                    <span class="r27 r">dataObject</span>.<a href="@0@PresentationCore/A.html#d6b076fdf744a323" class="i method">SetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>, <span class="r28 r">textData</span>);
                }
            }

            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#3cc68f91bacfb0b2" class="i field">cbCopyXamlDataFormat</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r29 rd" class="r29 r">textData</span> = <a href="#25ddd220a96fd866" class="i method">GetTextStringFromRichTextBox</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>);
                <b>if</b> (<span class="r29 r">textData</span> != <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>)
                {
                    <span class="r27 r">dataObject</span>.<a href="@0@PresentationCore/A.html#d6b076fdf744a323" class="i method">SetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>, <span class="r29 r">textData</span>);
                }
            }

            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#8ac29f466f7b3093" class="i field">cbCopyRtfDataFormat</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r30 rd" class="r30 r">textData</span> = <a href="#25ddd220a96fd866" class="i method">GetTextStringFromRichTextBox</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>);
                <b>if</b> (<span class="r30 r">textData</span> != <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>)
                {
                    <span class="r27 r">dataObject</span>.<a href="@0@PresentationCore/A.html#d6b076fdf744a323" class="i method">SetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>, <span class="r30 r">textData</span>);
                }
            }

            <span class="c">// Finally, consider a custom, application defined format.</span>
            <span class="c">// We use an arbitrary encoding here, for demonstration purposes.</span>
            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#c33824e66a30005d" class="i field">cbCustomSampleDataFormat</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <a href="@1@System.Runtime/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r31 rd" class="r31 r">customStream</span> = <b>new</b> <span class="t constructor">MemoryStream</span>();

                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r32 rd" class="r32 r">textData</span> = <span class="s">&quot;This is Custom Sample Data Start\n\n&quot;</span> +
                               <a href="#25ddd220a96fd866" class="i method">GetTextStringFromRichTextBox</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>) +
                               <span class="s">&quot;\nCustom Sample Data End.&quot;</span>;

                <b>var</b> <span id="r33 rd" class="r33 r">bytesUnicode</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#3ab75dace56ae6d2" class="i property">Unicode</a>.<a href="@1@System.Runtime/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="r32 r">textData</span>);
                <b>var</b> <span id="r34 rd" class="r34 r">bytes</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#4ee1d976f4a41582" class="i method">Convert</a>(<a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#3ab75dace56ae6d2" class="i property">Unicode</a>, <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#a10eb90a3d884500" class="i property">UTF8</a>, <span class="r33 r">bytesUnicode</span>);

                <b>if</b> (<span class="r34 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
                {
                    <span class="r31 r">customStream</span>.<a href="@1@System.Runtime/A.html#809202cd37ae53a9" class="i method">Write</a>(<span class="r34 r">bytes</span>, 0, <span class="r34 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>);
                    <span class="r27 r">dataObject</span>.<a href="@0@PresentationCore/A.html#d6b076fdf744a323" class="i method">SetData</a>(<span class="s">&quot;CustomSample&quot;</span>, <span class="r31 r">customStream</span>);
                }
            }
        }

        <span class="c">// Set the selected data format&#39;s data from the file content </span>
        <span class="c">// into DataObject for copying data on the system clipboard</span>
        <b>private void</b> <a id="13b3ef827ce51eca" href="R/13b3ef827ce51eca.html" target="n" data-glyph="76,1" class="i method">CopyDataFromFile</a>(<a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="t t">IDataObject</a> <span id="r35 rd" class="r35 r">dataObject</span>)
        {
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r36 rd" class="r36 r">fileName</span> = <b>null</b>;

            <a href="@0@PresentationFramework/A.html#abaa785ee8266b3d" class="k">var</a> <span id="r37 rd" class="r37 r">dialog</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#007fad921b514290" class="t constructor">OpenFileDialog</a> {<a href="@0@PresentationFramework/A.html#a6657594201aaea4" class="i property">CheckFileExists</a> = <b>true</b>};

            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#04d9e48e9b493ff4" class="i field">cbCopyTextDataFormat</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;Plain Text (*.txt)|*.txt&quot;</span>;
                <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#6ac596e833103ec6" class="i method">ShowDialog</a>();
                <span class="r36 r">fileName</span> = <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#df29941779e9aecf" class="i property">FileName</a>;

                <b>if</b> (<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r36 r">fileName</span>))
                {
                    <b>return</b>;
                }

                <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="k">var</a> <span id="r38 rd" class="r38 r">fileEncoding</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#1c75de327ad88c0a" class="i property">Default</a>;
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r39 rd" class="r39 r">textData</span> = <a href="#8d054de0a51aef42" class="i method">GetTextStringFromFile</a>(<span class="r36 r">fileName</span>, <span class="r38 r">fileEncoding</span>);
                <b>if</b> (!<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r39 r">textData</span>))
                {
                    <span class="r35 r">dataObject</span>.<a href="@0@PresentationCore/A.html#d6b076fdf744a323" class="i method">SetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>, <span class="r39 r">textData</span>);
                }
            }

            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#8ac29f466f7b3093" class="i field">cbCopyRtfDataFormat</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <span class="r36 r">fileName</span> = <b>null</b>;
                <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;RTF Documents (*.rtf)|*.rtf&quot;</span>;
                <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#6ac596e833103ec6" class="i method">ShowDialog</a>();
                <span class="r36 r">fileName</span> = <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#df29941779e9aecf" class="i property">FileName</a>;

                <b>if</b> (<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r36 r">fileName</span>))
                {
                    <b>return</b>;
                }

                <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="k">var</a> <span id="r40 rd" class="r40 r">fileEncoding</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#65768102b7ace585" class="i property">ASCII</a>;
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r41 rd" class="r41 r">textData</span> = <a href="#8d054de0a51aef42" class="i method">GetTextStringFromFile</a>(<span class="r36 r">fileName</span>, <span class="r40 r">fileEncoding</span>);
                <b>if</b> (!<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r41 r">textData</span>))
                {
                    <span class="r35 r">dataObject</span>.<a href="@0@PresentationCore/A.html#d6b076fdf744a323" class="i method">SetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>, <span class="r41 r">textData</span>);
                }
            }

            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#3cc68f91bacfb0b2" class="i field">cbCopyXamlDataFormat</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <span class="r36 r">fileName</span> = <b>null</b>;
                <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;XAML Flow Documents (*.xaml)|*.xaml&quot;</span>;
                <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#6ac596e833103ec6" class="i method">ShowDialog</a>();
                <span class="r36 r">fileName</span> = <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#df29941779e9aecf" class="i property">FileName</a>;

                <b>if</b> (<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r36 r">fileName</span>))
                {
                    <b>return</b>;
                }

                <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="k">var</a> <span id="r42 rd" class="r42 r">fileEncoding</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#a10eb90a3d884500" class="i property">UTF8</a>;
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r43 rd" class="r43 r">textData</span> = <a href="#8d054de0a51aef42" class="i method">GetTextStringFromFile</a>(<span class="r36 r">fileName</span>, <span class="r42 r">fileEncoding</span>);
                <b>if</b> (!<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r43 r">textData</span>))
                {
                    <span class="r35 r">dataObject</span>.<a href="@0@PresentationCore/A.html#d6b076fdf744a323" class="i method">SetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>, <span class="r43 r">textData</span>);
                }
            }

            <span class="c">// Finally, consider a custom, application defined format.</span>
            <span class="c">// We use an arbitrary encoding here, for demonstartion purposes.</span>
            <b>if</b> ((<b>bool</b>) <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#c33824e66a30005d" class="i field">cbCustomSampleDataFormat</a>.<a href="@0@PresentationFramework/A.html#317d766b8b07ac8c" class="i property">IsChecked</a>)
            {
                <span class="r36 r">fileName</span> = <b>null</b>;
                <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;All Files (*.*)|*.*&quot;</span>;
                <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#6ac596e833103ec6" class="i method">ShowDialog</a>();
                <span class="r36 r">fileName</span> = <span class="r37 r">dialog</span>.<a href="@0@PresentationFramework/A.html#df29941779e9aecf" class="i property">FileName</a>;

                <b>if</b> (<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r36 r">fileName</span>))
                {
                    <b>return</b>;
                }

                <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="k">var</a> <span id="r44 rd" class="r44 r">fileEncoding</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#a10eb90a3d884500" class="i property">UTF8</a>;
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r45 rd" class="r45 r">textData</span> = <a href="#8d054de0a51aef42" class="i method">GetTextStringFromFile</a>(<span class="r36 r">fileName</span>, <span class="r44 r">fileEncoding</span>);
                <b>if</b> (<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r45 r">textData</span>)) <b>return</b>;
                <b>var</b> <span id="r46 rd" class="r46 r">bytesUnicode</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#3ab75dace56ae6d2" class="i property">Unicode</a>.<a href="@1@System.Runtime/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="r45 r">textData</span>);
                <b>var</b> <span id="r47 rd" class="r47 r">bytes</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#4ee1d976f4a41582" class="i method">Convert</a>(<a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#3ab75dace56ae6d2" class="i property">Unicode</a>, <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#a10eb90a3d884500" class="i property">UTF8</a>, <span class="r46 r">bytesUnicode</span>);

                <b>if</b> (<span class="r47 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
                {
                    <b>var</b> <span id="r48 rd" class="r48 r">customStream</span> = <b>new</b> <span class="t constructor">MemoryStream</span>();
                    <span class="r48 r">customStream</span>.<span class="i method">Write</span>(<span class="r47 r">bytes</span>, 0, <span class="r47 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>);
                    <span class="r35 r">dataObject</span>.<a href="@0@PresentationCore/A.html#d6b076fdf744a323" class="i method">SetData</a>(<span class="s">&quot;CustomSample&quot;</span>, <span class="r48 r">customStream</span>);
                }
            }
        }

        <span class="c">// Paste a selected paste data format&#39;s data to RichTextBox</span>
        <b>private void</b> <a id="88046451a42ddae2" href="R/88046451a42ddae2.html" target="n" data-glyph="76,1" class="i method">PasteClipboardDataToRichTextBox</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r49 rd" class="r49 r">dataFormat</span>, <a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="t t">IDataObject</a> <span id="r50 rd" class="r50 r">dataObject</span>, <b>bool</b> <span id="r51 rd" class="r51 r">autoConvert</span>)
        {
            <b>if</b> (<span class="r50 r">dataObject</span> != <b>null</b> &amp;&amp; <span class="r50 r">dataObject</span>.<a href="@0@PresentationCore/A.html#e99f6de9447fedcc" class="i method">GetFormats</a>().<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
            {
                <a href="@1@System.Runtime/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r52 rd" class="r52 r">pasted</span> = <b>false</b>;

                <b>if</b> (<span class="r49 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>)
                {
                    <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r53 rd" class="r53 r">xamlData</span> = <span class="r50 r">dataObject</span>.<a href="@0@PresentationCore/A.html#3d89d7eaeb4f5087" class="i method">GetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>) <b>as string</b>;
                    <b>if</b> (!<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r53 r">xamlData</span>))
                    {
                        <span class="r52 r">pasted</span> = <a href="#efe0f343d6b698b4" class="i method">PasteTextDataToRichTextBox</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>, <span class="r53 r">xamlData</span>);
                    }
                }
                <b>else</b> <b>if</b> (<span class="r49 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>)
                {
                    <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r54 rd" class="r54 r">rtfData</span> = <span class="r50 r">dataObject</span>.<a href="@0@PresentationCore/A.html#3d89d7eaeb4f5087" class="i method">GetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>) <b>as string</b>;
                    <b>if</b> (!<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r54 r">rtfData</span>))
                    {
                        <span class="r52 r">pasted</span> = <a href="#efe0f343d6b698b4" class="i method">PasteTextDataToRichTextBox</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>, <span class="r54 r">rtfData</span>);
                    }
                }
                <b>else</b> <b>if</b> (<span class="r49 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#e08ce10e7fbbbc98" class="i field">UnicodeText</a>
                         || <span class="r49 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>
                         || <span class="r49 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#21e6c71ded6c6661" class="i field">StringFormat</a>)
                {
                    <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r55 rd" class="r55 r">textData</span> = <span class="r50 r">dataObject</span>.<a href="@0@PresentationCore/A.html#3d89d7eaeb4f5087" class="i method">GetData</a>(<span class="r49 r">dataFormat</span>) <b>as string</b>;
                    <b>if</b> (<span class="r55 r">textData</span> != <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#c9f70a27facb27cf" class="i field">Empty</a>)
                    {
                        <a href="#fd3e8565f4f1fd60" class="i method">SetTextOnRichTextBox</a>(<span class="r55 r">textData</span>);
                        <span class="r52 r">pasted</span> = <b>true</b>;
                    }
                }
                <b>else</b> <b>if</b> (<span class="r49 r">dataFormat</span> == <span class="s">&quot;CustomSample&quot;</span>)
                {
                    <span class="c">// Paste the application defined custom data format&#39;s data to RichTextBox content</span>
                    <a href="@1@System.Runtime/A.html#f956b0c07e86df64" class="k">var</a> <span id="r56 rd" class="r56 r">customStream</span> = <span class="r50 r">dataObject</span>.<a href="@0@PresentationCore/A.html#21894fc80af5bd04" class="i method">GetData</a>(<span class="r49 r">dataFormat</span>, <span class="r51 r">autoConvert</span>) <b>as</b> <a href="@1@System.Runtime/A.html#f956b0c07e86df64" class="t t">Stream</a>;
                    <b>if</b> (<span class="r56 r">customStream</span>.<a href="@1@System.Runtime/A.html#48b7e39cfd844dc5" class="i property">Length</a> &gt; 0)
                    {
                        <a href="@0@PresentationFramework/A.html#6c113c5cdd5b9976" class="k">var</a> <span id="r57 rd" class="r57 r">textRange</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#89b123297a8cd9e8" class="t constructor">TextRange</a>(<a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#17cbecf7168fa9c0" class="i field">richTextBox</a>.<a href="@0@PresentationFramework/A.html#15f250b3ed9878d6" class="i property">Document</a>.<a href="@0@PresentationFramework/A.html#038ddae1a0bc6cc1" class="i property">ContentStart</a>,
                            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#17cbecf7168fa9c0" class="i field">richTextBox</a>.<a href="@0@PresentationFramework/A.html#15f250b3ed9878d6" class="i property">Document</a>.<a href="@0@PresentationFramework/A.html#2a6aa9d9cfdb57cd" class="i property">ContentEnd</a>);
                        <span class="r57 r">textRange</span>.<a href="@0@PresentationFramework/A.html#ee57c2b62965e074" class="i method">Load</a>(<span class="r56 r">customStream</span>, <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>);
                        <span class="r52 r">pasted</span> = <b>true</b>;
                    }
                }

                <b>if</b> (!<span class="r52 r">pasted</span>)
                {
                    <a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#27a5faa8fab7f6ba" class="i method">Show</a>(
                        <span class="s">&quot;Can&#39;t paste the selected data format into RichTextBox!\n\nPlease click Refresh button to update the current clipboard format Or select File RadioButton to paste data.&quot;</span>,
                        <span class="s">&quot;Paste Data Format Error&quot;</span>,
                        <a href="@0@PresentationFramework/A.html#57cf33522d50233a" class="t t">MessageBoxButton</a>.<a href="@0@PresentationFramework/A.html#6f4d7963ffc6793b" class="i field">OK</a>,
                        <a href="@0@PresentationFramework/A.html#26947fb9108271b2" class="t t">MessageBoxImage</a>.<a href="@0@PresentationFramework/A.html#205121e33c5a0992" class="i field">Exclamation</a>);
                }
            }
        }

        <span class="c">// Paste a selected paste data format&#39;s data to the fileSSS</span>
        <b>private void</b> <a id="c7da7d3baa8445d8" href="R/c7da7d3baa8445d8.html" target="n" data-glyph="76,1" class="i method">PasteClipboardDataToFile</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r58 rd" class="r58 r">dataFormat</span>, <a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="t t">IDataObject</a> <span id="r59 rd" class="r59 r">dataObject</span>, <b>bool</b> <span id="r60 rd" class="r60 r">autoConvert</span>)
        {
            <a href="@0@PresentationFramework/A.html#1cc3303b6fe0d095" class="k">var</a> <span id="r61 rd" class="r61 r">dialog</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#809a6b4d2cea3900" class="t constructor">SaveFileDialog</a> {<a href="@0@PresentationFramework/A.html#a6657594201aaea4" class="i property">CheckFileExists</a> = <b>false</b>};

            <b>if</b> (<span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>
                || <span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#e08ce10e7fbbbc98" class="i field">UnicodeText</a>
                || <span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#21e6c71ded6c6661" class="i field">StringFormat</a>)
            {
                <span class="r61 r">dialog</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;Plain Text (*.txt)|*.txt | All Files (*.*)|*.*&quot;</span>;
            }
            <b>else</b> <b>if</b> (<span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>)
            {
                <span class="r61 r">dialog</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;XAML Flow Documents (*.xaml)|*.xaml | All Files (*.*)|*.*&quot;</span>;
            }
            <b>else</b> <b>if</b> (<span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>)
            {
                <span class="r61 r">dialog</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;RTF Documents (*.rtf)|*.rtf | All Files (*.*)|*.*&quot;</span>;
            }
            <b>else</b>
            {
                <span class="r61 r">dialog</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;All Files (*.*)|*.*&quot;</span>;
            }

            <b>if</b> (!(<b>bool</b>) <span class="r61 r">dialog</span>.<a href="@0@PresentationFramework/A.html#6ac596e833103ec6" class="i method">ShowDialog</a>())
            {
                <b>return</b>;
            }

            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r62 rd" class="r62 r">fileName</span> = <span class="r61 r">dialog</span>.<a href="@0@PresentationFramework/A.html#df29941779e9aecf" class="i property">FileName</a>;

            <b>if</b> (<span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>)
            {
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r63 rd" class="r63 r">xamlData</span> = <span class="r59 r">dataObject</span>.<a href="@0@PresentationCore/A.html#3d89d7eaeb4f5087" class="i method">GetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#9150e741152a1230" class="i field">Xaml</a>) <b>as string</b>;
                <b>if</b> (!<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r63 r">xamlData</span>))
                {
                    <a href="#3821782c2a032b0c" class="i method">PasteTextDataToFile</a>(<span class="r58 r">dataFormat</span>, <span class="r63 r">xamlData</span>, <span class="r62 r">fileName</span>, <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#a10eb90a3d884500" class="i property">UTF8</a>);
                }
            }
            <b>else</b> <b>if</b> (<span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>)
            {
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r64 rd" class="r64 r">rtfData</span> = <span class="r59 r">dataObject</span>.<a href="@0@PresentationCore/A.html#3d89d7eaeb4f5087" class="i method">GetData</a>(<a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#5d7ffdc1a872be4f" class="i field">Rtf</a>) <b>as string</b>;
                <b>if</b> (!<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r64 r">rtfData</span>))
                {
                    <a href="#3821782c2a032b0c" class="i method">PasteTextDataToFile</a>(<span class="r58 r">dataFormat</span>, <span class="r64 r">rtfData</span>, <span class="r62 r">fileName</span>, <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#65768102b7ace585" class="i property">ASCII</a>);
                }
            }
            <b>else</b> <b>if</b> (<span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#e08ce10e7fbbbc98" class="i field">UnicodeText</a>
                     || <span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>
                     || <span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#21e6c71ded6c6661" class="i field">StringFormat</a>)
            {
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r65 rd" class="r65 r">textData</span> = <span class="r59 r">dataObject</span>.<a href="@0@PresentationCore/A.html#21894fc80af5bd04" class="i method">GetData</a>(<span class="r58 r">dataFormat</span>, <span class="r60 r">autoConvert</span>) <b>as string</b>;
                <b>if</b> (!<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@1@System.Runtime/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r65 r">textData</span>))
                {
                    <a href="#3821782c2a032b0c" class="i method">PasteTextDataToFile</a>(<span class="r58 r">dataFormat</span>, <span class="r65 r">textData</span>, <span class="r62 r">fileName</span>,
                        <span class="r58 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a> ? <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#1c75de327ad88c0a" class="i property">Default</a> : <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#3ab75dace56ae6d2" class="i property">Unicode</a>);
                }
            }
            <b>else</b>
            {
                <span class="c">// Paste the CustomSample data or others to the file</span>
                <span class="c">//Stream customStream = dataObject.GetData(dataFormat, autoConvert) as Stream;</span>
                <a href="@1@System.Runtime/A.html#f956b0c07e86df64" class="k">var</a> <span id="r66 rd" class="r66 r">customStream</span> = <a href="#9aa54bee2d473d8a" class="i method">GetDataFromDataObject</a>(<span class="r59 r">dataObject</span>, <span class="r58 r">dataFormat</span>, <span class="r60 r">autoConvert</span>) <b>as</b> <a href="@1@System.Runtime/A.html#f956b0c07e86df64" class="t t">Stream</a>;
                <b>if</b> (<span class="r66 r">customStream</span> != <b>null</b> &amp;&amp; <span class="r66 r">customStream</span>.<a href="@1@System.Runtime/A.html#48b7e39cfd844dc5" class="i property">Length</a> &gt; 0)
                {
                    <a href="#22ff71652679af4b" class="i method">PasteStreamDataToFile</a>(<span class="r66 r">customStream</span>, <span class="r62 r">fileName</span>);
                }
            }
        }

        <span class="c">// Get DataObject from the system clipboard</span>
        <b>private</b> <a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="t t">IDataObject</a> <a id="4429f02eb036129c" href="R/4429f02eb036129c.html" target="n" data-glyph="76,1" class="i method">GetDataObjectFromClipboard</a>()
        {
            <a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="t t">IDataObject</a> <span id="r67 rd" class="r67 r">dataObject</span>;

            <b>try</b>
            {
                <span class="r67 r">dataObject</span> = <a href="@0@PresentationCore/A.html#bb14b599507febfc" class="t t">Clipboard</a>.<a href="@0@PresentationCore/A.html#c76491f2ddc581a9" class="i method">GetDataObject</a>();
            }
            <b>catch</b> (<span class="t t">COMException</span>)
            {
                <span class="c">// Clipboard.GetDataObject can be failed by opening the system clipboard </span>
                <span class="c">// from other or processing clipboard operation like as setting data on clipboard</span>
                <span class="r67 r">dataObject</span> = <b>null</b>;
            }

            <b>return</b> <span class="r67 r">dataObject</span>;
        }

        <b>private object</b> <a id="9aa54bee2d473d8a" href="R/9aa54bee2d473d8a.html" target="n" data-glyph="76,1" class="i method">GetDataFromDataObject</a>(<a href="@0@PresentationCore/A.html#cc5703036bea61e8" class="t t">IDataObject</a> <span id="r68 rd" class="r68 r">dataObject</span>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r69 rd" class="r69 r">dataFormat</span>, <b>bool</b> <span id="r70 rd" class="r70 r">autoConvert</span>)
        {
            <b>object</b> <span id="r71 rd" class="r71 r">data</span> = <b>null</b>;

            <b>try</b>
            {
                <span class="r71 r">data</span> = <span class="r68 r">dataObject</span>.<a href="@0@PresentationCore/A.html#21894fc80af5bd04" class="i method">GetData</a>(<span class="r69 r">dataFormat</span>, <span class="r70 r">autoConvert</span>);
            }
            <b>catch</b> (<span class="t t">COMException</span>)
            {
                <span class="c">// Fail to get the data by the invalid value like tymed(DV_E_TYMED) </span>
                <span class="c">// or others(Aspect, Formatetc).</span>
                <span class="c">// It depends on application&#39;s IDataObject::GetData implementation.</span>
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;Fail to get data!!! ***COMException***&quot;</span>);
            }
            <b>catch</b> (<a href="@1@System.Runtime/A.html#23ab5b3ef9ea2683" class="t t">OutOfMemoryException</a>)
            {
                <span class="c">// Fail by the out of memory from getting data on Clipboard. </span>
                <span class="c">// Occurs with the low memory.</span>
                <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#46ceb7e085a48a44" class="i field">clipboardInfo</a>.<a href="@0@PresentationFramework/A.html#43b8b3e333e02f6e" class="i method">AppendText</a>(<span class="s">&quot;Fail to get data!!! ***OutOfMemoryException***&quot;</span>);
            }

            <b>return</b> <span class="r71 r">data</span>;
        }

        <span class="c">// Set the plain text on RichTextBox</span>
        <b>private void</b> <a id="fd3e8565f4f1fd60" href="R/fd3e8565f4f1fd60.html" target="n" data-glyph="76,1" class="i method">SetTextOnRichTextBox</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r72 rd" class="r72 r">text</span>)
        {
            <a href="@0@PresentationFramework/A.html#7049d8a35db73d0e" class="k">var</a> <span id="r73 rd" class="r73 r">document</span> = <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#17cbecf7168fa9c0" class="i field">richTextBox</a>.<a href="@0@PresentationFramework/A.html#15f250b3ed9878d6" class="i property">Document</a>;
            <a href="@0@PresentationFramework/A.html#6c113c5cdd5b9976" class="k">var</a> <span id="r74 rd" class="r74 r">textRange</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#89b123297a8cd9e8" class="t constructor">TextRange</a>(<span class="r73 r">document</span>.<a href="@0@PresentationFramework/A.html#038ddae1a0bc6cc1" class="i property">ContentStart</a>, <span class="r73 r">document</span>.<a href="@0@PresentationFramework/A.html#2a6aa9d9cfdb57cd" class="i property">ContentEnd</a>) {<a href="@0@PresentationFramework/A.html#9bc40088b9689560" class="i property">Text</a> = <span class="r72 r">text</span>};
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#17cbecf7168fa9c0" class="i field">richTextBox</a>.<a href="@0@PresentationCore/A.html#0e11f7ae56f1c30f" class="i method">Focus</a>();
            <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#17cbecf7168fa9c0" class="i field">richTextBox</a>.<a href="@0@PresentationFramework/A.html#cd558e8378436496" class="i method">SelectAll</a>();
        }

        <span class="c">// Get text data string from RichTextBox content which encoded as UTF8</span>
        <b>private string</b> <a id="25ddd220a96fd866" href="R/25ddd220a96fd866.html" target="n" data-glyph="76,1" class="i method">GetTextStringFromRichTextBox</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r75 rd" class="r75 r">dataFormat</span>)
        {
            <a href="@0@PresentationFramework/A.html#7049d8a35db73d0e" class="k">var</a> <span id="r76 rd" class="r76 r">document</span> = <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#17cbecf7168fa9c0" class="i field">richTextBox</a>.<a href="@0@PresentationFramework/A.html#15f250b3ed9878d6" class="i property">Document</a>;
            <a href="@0@PresentationFramework/A.html#6c113c5cdd5b9976" class="k">var</a> <span id="r77 rd" class="r77 r">textRange</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#89b123297a8cd9e8" class="t constructor">TextRange</a>(<span class="r76 r">document</span>.<a href="@0@PresentationFramework/A.html#038ddae1a0bc6cc1" class="i property">ContentStart</a>, <span class="r76 r">document</span>.<a href="@0@PresentationFramework/A.html#2a6aa9d9cfdb57cd" class="i property">ContentEnd</a>);

            <b>if</b> (<span class="r75 r">dataFormat</span> == <a href="@0@PresentationCore/A.html#4a697a81da288477" class="t t">DataFormats</a>.<a href="@0@PresentationCore/A.html#3a3033f12498664c" class="i field">Text</a>)
            {
                <b>return</b> <span class="r77 r">textRange</span>.<a href="@0@PresentationFramework/A.html#9bc40088b9689560" class="i property">Text</a>;
            }
            <a href="@1@System.Runtime/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r78 rd" class="r78 r">contentStream</span> = <b>new</b> <span class="t constructor">MemoryStream</span>();
            <span class="r77 r">textRange</span>.<a href="@0@PresentationFramework/A.html#4ba66959a951c0a6" class="i method">Save</a>(<span class="r78 r">contentStream</span>, <span class="r75 r">dataFormat</span>);

            <b>if</b> (<span class="r78 r">contentStream</span>.<a href="@1@System.Runtime/A.html#48b7e39cfd844dc5" class="i property">Length</a> &gt; 0)
            {
                <b>var</b> <span id="r79 rd" class="r79 r">bytes</span> = <b>new</b> <b>byte</b>[<span class="r78 r">contentStream</span>.<a href="@1@System.Runtime/A.html#48b7e39cfd844dc5" class="i property">Length</a>];

                <span class="r78 r">contentStream</span>.<a href="@1@System.Runtime/A.html#35112b2a53fb536a" class="i property">Position</a> = 0;
                <span class="r78 r">contentStream</span>.<a href="@1@System.Runtime/A.html#6fb9c001d7524ba2" class="i method">Read</a>(<span class="r79 r">bytes</span>, 0, <span class="r79 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>);

                <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="k">var</a> <span id="r80 rd" class="r80 r">utf8Encoding</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#a10eb90a3d884500" class="i property">UTF8</a>;

                <b>return</b> <span class="r80 r">utf8Encoding</span>.<a href="@1@System.Runtime/A.html#7310c9cccfaecd17" class="i method">GetString</a>(<span class="r79 r">bytes</span>);
            }

            <b>return</b> <b>null</b>;
        }

        <span class="c">// Get text data string from file content with the proper encoding</span>
        <b>private string</b> <a id="8d054de0a51aef42" href="R/8d054de0a51aef42.html" target="n" data-glyph="76,1" class="i method">GetTextStringFromFile</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r81 rd" class="r81 r">fileName</span>, <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a> <span id="r82 rd" class="r82 r">fileEncoding</span>)
        {
            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r83 rd" class="r83 r">textString</span> = <b>null</b>;

            <a href="@1@System.Runtime/A.html#e23a38af5d11ddd3" class="t t">FileStream</a> <span id="r84 rd" class="r84 r">fileStream</span>;

            <b>try</b>
            {
                <span class="r84 r">fileStream</span> = <b>new</b> <a href="@1@System.Runtime/A.html#234a29d0d3012e5c" class="t constructor">FileStream</a>(<span class="r81 r">fileName</span>, <a href="@1@System.Runtime/A.html#c0cb6ba6af625b3a" class="t t">FileMode</a>.<a href="@1@System.Runtime/A.html#f4421e1d202f76fa" class="i field">Open</a>, <a href="@1@System.Runtime/A.html#5cc5644ae3acd24b" class="t t">FileAccess</a>.<a href="@1@System.Runtime/A.html#0f1c68c756d0636b" class="i field">Read</a>);
            }
            <b>catch</b> (<a href="@1@System.Runtime/A.html#bf546e435199e83c" class="t t">IOException</a>)
            {
                <a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#61ad43de2de82769" class="i method">Show</a>(<span class="s">&quot;File is not acessible.\n&quot;</span>, <span class="s">&quot;File Open Error&quot;</span>);
                <b>return</b> <b>null</b>;
            }

            <span class="r84 r">fileStream</span>.<a href="@1@System.Runtime/A.html#f2e565bc5ce4ae5f" class="i property">Position</a> = 0;

            <b>var</b> <span id="r85 rd" class="r85 r">bytes</span> = <b>new</b> <b>byte</b>[<span class="r84 r">fileStream</span>.<a href="@1@System.Runtime/A.html#fa88edfdb51ed91c" class="i property">Length</a>];

            <span class="r84 r">fileStream</span>.<a href="@1@System.Runtime/A.html#f54c954df34d7a92" class="i method">Read</a>(<span class="r85 r">bytes</span>, 0, <span class="r85 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>);

            <b>if</b> (<span class="r85 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
            {
                <span class="r83 r">textString</span> = <span class="r82 r">fileEncoding</span>.<a href="@1@System.Runtime/A.html#7310c9cccfaecd17" class="i method">GetString</a>(<span class="r85 r">bytes</span>);
            }

            <span class="r84 r">fileStream</span>.<a href="@1@System.Runtime/A.html#dc4ffe046b847b84" class="i method">Close</a>();

            <b>return</b> <span class="r83 r">textString</span>;
        }

        <span class="c">// Paste text data on RichTextBox as UTF8 encoding</span>
        <b>private bool</b> <a id="efe0f343d6b698b4" href="R/efe0f343d6b698b4.html" target="n" data-glyph="76,1" class="i method">PasteTextDataToRichTextBox</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r86 rd" class="r86 r">dataFormat</span>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r87 rd" class="r87 r">textData</span>)
        {
            <a href="@1@System.Runtime/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r88 rd" class="r88 r">pasted</span> = <b>false</b>;

            <a href="@0@PresentationFramework/A.html#7049d8a35db73d0e" class="k">var</a> <span id="r89 rd" class="r89 r">document</span> = <a href="obj/Debug/netcoreapp3.1/MainWindow.g.cs.html#17cbecf7168fa9c0" class="i field">richTextBox</a>.<a href="@0@PresentationFramework/A.html#15f250b3ed9878d6" class="i property">Document</a>;
            <a href="@0@PresentationFramework/A.html#6c113c5cdd5b9976" class="k">var</a> <span id="r90 rd" class="r90 r">textRange</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#89b123297a8cd9e8" class="t constructor">TextRange</a>(<span class="r89 r">document</span>.<a href="@0@PresentationFramework/A.html#038ddae1a0bc6cc1" class="i property">ContentStart</a>, <span class="r89 r">document</span>.<a href="@0@PresentationFramework/A.html#2a6aa9d9cfdb57cd" class="i property">ContentEnd</a>);

            <a href="@1@System.Runtime/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r91 rd" class="r91 r">stream</span> = <b>new</b> <span class="t constructor">MemoryStream</span>();

            <b>var</b> <span id="r92 rd" class="r92 r">bytesUnicode</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#3ab75dace56ae6d2" class="i property">Unicode</a>.<a href="@1@System.Runtime/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="r87 r">textData</span>);
            <b>var</b> <span id="r93 rd" class="r93 r">bytes</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#4ee1d976f4a41582" class="i method">Convert</a>(<a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#3ab75dace56ae6d2" class="i property">Unicode</a>, <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#a10eb90a3d884500" class="i property">UTF8</a>, <span class="r92 r">bytesUnicode</span>);

            <b>if</b> (<span class="r93 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0 &amp;&amp; <span class="r90 r">textRange</span>.<a href="@0@PresentationFramework/A.html#d9f7e52c1d31e11a" class="i method">CanLoad</a>(<span class="r86 r">dataFormat</span>))
            {
                <span class="r91 r">stream</span>.<a href="@1@System.Runtime/A.html#809202cd37ae53a9" class="i method">Write</a>(<span class="r93 r">bytes</span>, 0, <span class="r93 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>);
                <span class="r90 r">textRange</span>.<a href="@0@PresentationFramework/A.html#ee57c2b62965e074" class="i method">Load</a>(<span class="r91 r">stream</span>, <span class="r86 r">dataFormat</span>);
                <span class="r88 r">pasted</span> = <b>true</b>;
            }

            <b>return</b> <span class="r88 r">pasted</span>;
        }

        <span class="c">// Paste text data to the file with the file encoding</span>
        <b>private void</b> <a id="3821782c2a032b0c" href="R/3821782c2a032b0c.html" target="n" data-glyph="76,1" class="i method">PasteTextDataToFile</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r94 rd" class="r94 r">dataFormat</span>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r95 rd" class="r95 r">textData</span>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r96 rd" class="r96 r">fileName</span>, <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a> <span id="r97 rd" class="r97 r">fileEncoding</span>)
        {
            <a href="@1@System.Runtime/A.html#e23a38af5d11ddd3" class="t t">FileStream</a> <span id="r98 rd" class="r98 r">fileWriteStream</span>;

            <b>try</b>
            {
                <span class="r98 r">fileWriteStream</span> = <b>new</b> <a href="@1@System.Runtime/A.html#234a29d0d3012e5c" class="t constructor">FileStream</a>(<span class="r96 r">fileName</span>, <a href="@1@System.Runtime/A.html#c0cb6ba6af625b3a" class="t t">FileMode</a>.<a href="@1@System.Runtime/A.html#80a500db887477f8" class="i field">OpenOrCreate</a>, <a href="@1@System.Runtime/A.html#5cc5644ae3acd24b" class="t t">FileAccess</a>.<a href="@1@System.Runtime/A.html#4715fa16da583c25" class="i field">Write</a>);
            }
            <b>catch</b> (<a href="@1@System.Runtime/A.html#bf546e435199e83c" class="t t">IOException</a>)
            {
                <a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#61ad43de2de82769" class="i method">Show</a>(<span class="s">&quot;File is not acessible.\n&quot;</span>, <span class="s">&quot;File Write Error&quot;</span>);
                <b>return</b>;
            }

            <span class="r98 r">fileWriteStream</span>.<a href="@1@System.Runtime/A.html#212c0536642e78d6" class="i method">SetLength</a>(0);

            <b>var</b> <span id="r99 rd" class="r99 r">bytesUnicode</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#3ab75dace56ae6d2" class="i property">Unicode</a>.<a href="@1@System.Runtime/A.html#83f2d2c6f22db1a9" class="i method">GetBytes</a>(<span class="r95 r">textData</span>);
            <b>var</b> <span id="r100 rd" class="r100 r">bytes</span> = <a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#4ee1d976f4a41582" class="i method">Convert</a>(<a href="@1@System.Runtime/A.html#3b6090c501893c25" class="t t">Encoding</a>.<a href="@1@System.Runtime/A.html#3ab75dace56ae6d2" class="i property">Unicode</a>, <span class="r97 r">fileEncoding</span>, <span class="r99 r">bytesUnicode</span>);

            <b>if</b> (<span class="r100 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
            {
                <span class="r98 r">fileWriteStream</span>.<a href="@1@System.Runtime/A.html#d32fa48eafb90d8d" class="i method">Write</a>(<span class="r100 r">bytes</span>, 0, <span class="r100 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>);
            }

            <span class="r98 r">fileWriteStream</span>.<a href="@1@System.Runtime/A.html#dc4ffe046b847b84" class="i method">Close</a>();
        }

        <span class="c">// Paste stream data to the file</span>
        <b>private void</b> <a id="22ff71652679af4b" href="R/22ff71652679af4b.html" target="n" data-glyph="76,1" class="i method">PasteStreamDataToFile</a>(<a href="@1@System.Runtime/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r101 rd" class="r101 r">stream</span>, <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r102 rd" class="r102 r">fileName</span>)
        {
            <a href="@1@System.Runtime/A.html#e23a38af5d11ddd3" class="t t">FileStream</a> <span id="r103 rd" class="r103 r">fileWriteStream</span> = <b>null</b>;

            <b>try</b>
            {
                <span class="r103 r">fileWriteStream</span> = <b>new</b> <a href="@1@System.Runtime/A.html#234a29d0d3012e5c" class="t constructor">FileStream</a>(<span class="r102 r">fileName</span>, <a href="@1@System.Runtime/A.html#c0cb6ba6af625b3a" class="t t">FileMode</a>.<a href="@1@System.Runtime/A.html#80a500db887477f8" class="i field">OpenOrCreate</a>, <a href="@1@System.Runtime/A.html#5cc5644ae3acd24b" class="t t">FileAccess</a>.<a href="@1@System.Runtime/A.html#4715fa16da583c25" class="i field">Write</a>);
            }
            <b>catch</b> (<a href="@1@System.Runtime/A.html#bf546e435199e83c" class="t t">IOException</a>)
            {
                <a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#61ad43de2de82769" class="i method">Show</a>(<span class="s">&quot;File is not acessible.\n&quot;</span>, <span class="s">&quot;File Write Error&quot;</span>);
            }

            <span class="r103 r">fileWriteStream</span>.<a href="@1@System.Runtime/A.html#212c0536642e78d6" class="i method">SetLength</a>(0);

            <b>var</b> <span id="r104 rd" class="r104 r">bytes</span> = <b>new</b> <b>byte</b>[<span class="r101 r">stream</span>.<a href="@1@System.Runtime/A.html#48b7e39cfd844dc5" class="i property">Length</a>];

            <span class="r101 r">stream</span>.<a href="@1@System.Runtime/A.html#35112b2a53fb536a" class="i property">Position</a> = 0;
            <span class="r101 r">stream</span>.<a href="@1@System.Runtime/A.html#6fb9c001d7524ba2" class="i method">Read</a>(<span class="r104 r">bytes</span>, 0, <span class="r104 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>);

            <b>if</b> (<span class="r104 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
            {
                <span class="r103 r">fileWriteStream</span>.<a href="@1@System.Runtime/A.html#d32fa48eafb90d8d" class="i method">Write</a>(<span class="r104 r">bytes</span>, 0, <span class="r104 r">bytes</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>);
            }

            <span class="r103 r">fileWriteStream</span>.<a href="@1@System.Runtime/A.html#dc4ffe046b847b84" class="i method">Close</a>();
        }
    }
}</pre></td></tr></table></div></body></html>
