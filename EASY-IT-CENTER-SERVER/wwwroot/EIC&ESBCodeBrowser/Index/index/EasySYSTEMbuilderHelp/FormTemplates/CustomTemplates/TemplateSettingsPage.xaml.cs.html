<!DOCTYPE html>
<html><head><title>TemplateSettingsPage.xaml.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(115);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EasySYSTEMbuilderHelp/FormTemplates/CustomTemplates/TemplateSettingsPage.xaml.cs" target="_top">FormTemplates\CustomTemplates\TemplateSettingsPage.xaml.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EasySYSTEMbuilderHelp" target="_top">HelpProjects\EasySYSTEMbuilderHelp\EasySYSTEMbuilderHelp.vbproj</a> (EasySYSTEMbuilderHelp)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">Api</span>;
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">Classes</span>;
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">GlobalOperations</span>;
<b>using</b> <span class="i">Microsoft</span>.<span class="i">Win32</span>;
<b>using</b> <span class="i">Newtonsoft</span>.<span class="i">Json</span>;
<b>using</b> <span class="i">Org</span>.<span class="i">BouncyCastle</span>.<span class="i">Asn1</span>;
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Net</span>.<span class="i">Http</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Controls</span>;
 
// <span class="i">This</span> <b>is</b> <span class="i">Template</span> <b>Is</b> <span class="i">Customized</span> <b>For</b> <span class="i">Load</span> <b>and</b> <span class="i">Save</span> <span class="i">data</span> <span class="i">without</span> <span class="i">List</span> (<span class="i">Settings</span>) <b>is</b> <span class="i">folded</span> <span class="i">from</span>
// <span class="i">standartized</span> <span class="i">Methods</span>
<b>namespace</b> <span class="i n">EasyITSystemCenter</span>.<span class="i n">Pages</span> {
 
    <b>public</b> <b>partial</b> <b>class</b> <a id="12c5fedf4b509ca9" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="0557c71200fe413c">TemplateSettingsPage</span></a> : <span class="i">UserControl</span> {
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Standartized</span> <span class="i">declaring</span> <b>static</b> <span class="i">page</span> <span class="i">data</span> <b>for global</b> <span class="i">vorking</span> <b>with</b> <span class="i">pages</span>
        /// &lt;/<span class="i">summary</span>&gt;
        <b>public static</b> <a id="c54a7c6dbe17e113" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">DataViewSupport</a> <span class="i">dataViewSupport</span> = <b>new</b> <span class="i">DataViewSupport</span>();
 
        <b>public static</b> <a id="6d40a1b62d54040e" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">TemplateClassList</a> <span class="i">selectedRecord</span> = <b>new</b> <span class="i">TemplateClassList</span>();
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Define</span> <span class="i">Collection</span> <b>For</b> <span class="i">Combobox</span>
        /// &lt;/<span class="i">summary</span>&gt;
        <b>public</b> <a id="6f96db2c669c3e18" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">ObservableCollection</a>&lt;<span class="i">Language</span>&gt; <span class="i">Languages</span> = <b>new</b> <span class="i">ObservableCollection</span>&lt;<span class="i">Language</span>&gt;() {
                                                                <b>new</b> <span class="i">Language</span>() { <span class="i">Name</span> = <span class="s">&quot;System&quot;</span>, <span class="i">Value</span> = <span class="s">&quot;system&quot;</span> },
                                                                <b>new</b> <span class="i">Language</span>() { <span class="i">Name</span> = <span class="s">&quot;Czech&quot;</span>, <span class="i">Value</span> = <span class="s">&quot;cs-CZ&quot;</span> },
                                                                <b>new</b> <span class="i">Language</span>() { <span class="i">Name</span> = <span class="s">&quot;English&quot;</span>, <span class="i">Value</span> = <span class="s">&quot;en-US&quot;</span> }
                                                             };
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Initialize</span> <span class="i">page</span> <b>with</b> <span class="i">loading</span> <span class="i">Dictionary</span> <b>and</b> <span class="i">start</span> <span class="i">loding</span> <span class="i">data</span> <span class="i">Manual</span> <span class="i">work</span> <span class="i">needed</span>
        /// <span class="i">Translate</span> <span class="i">All</span> <span class="i">XAML</span> <span class="i">fields</span> <span class="i">by</span> <span class="i">Resources</span> <span class="i">Runned</span> <b>on</b> <span class="i">start</span>
        /// &lt;/<span class="i">summary</span>&gt;
        <b>public</b> <a id="8bb56e0fb2d9bb80" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">TemplateSettingsPage</a>() {
            <span class="i">InitializeComponent</span>();
            _ = <span class="i">SystemOperations</span>.<span class="i">SetLanguageDictionary</span>(<span class="i">Resources</span>, <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">Key</span> == <span class="s">&quot;sys_defaultLanguage&quot;</span>).<span class="i">Value</span>);
 
            <b>try</b> {
                <span class="i">lbl_apiAddress</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;conn_apiAddress&quot;</span>].<span class="i">ToString</span>();
                <span class="i">lbl_serviceName</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;serviceName&quot;</span>].<span class="i">ToString</span>();
                <span class="i">lbl_writeToLog</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;logging&quot;</span>].<span class="i">ToString</span>();
                <span class="i">lbl_serverCheckIntervalSec</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;serverCheckIntervalSec&quot;</span>].<span class="i">ToString</span>();
                <span class="i">lbl_topMost</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;beh_topMost&quot;</span>].<span class="i">ToString</span>();
                <span class="i">lbl_activeNewInputDefault</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;beh_activeNewInputDefault&quot;</span>].<span class="i">ToString</span>();
                <span class="i">lbl_defaultLanguage</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;sys_defaultLanguage&quot;</span>].<span class="i">ToString</span>();
                <span class="i">lbl_showVerticalPanel</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;showVerticalPanel&quot;</span>].<span class="i">ToString</span>();
                <span class="i">lbl_powerBuilderPath</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;powerBuilderPath&quot;</span>].<span class="i">ToString</span>();
 
                <span class="i">btn_browse</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;browse&quot;</span>].<span class="i">ToString</span>();
                <span class="i">btn_restart</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;restart&quot;</span>].<span class="i">ToString</span>();
                <span class="i">btnApiTest</span>.<span class="i">Content</span> = <span class="i">Resources</span>[<span class="s">&quot;apiConnectionTest&quot;</span>].<span class="i">ToString</span>();
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">autoEx</span>) { <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<span class="i">autoEx</span>); }
 
            //<span class="i">data</span>
            <span class="i">txt_apiAddress</span>.<span class="i">Text</span> = <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">b</span> =&gt; <span class="i">b</span>.<span class="i">Key</span> == <span class="s">&quot;conn_apiAddress&quot;</span>).<span class="i">Value</span>;
            <span class="i">chb_WritetoLog</span>.<span class="i">IsChecked</span> = <span class="i">bool</span>.<span class="i">Parse</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">b</span> =&gt; <span class="i">b</span>.<span class="i">Key</span> == <span class="s">&quot;sys_writeToLog&quot;</span>).<span class="i">Value</span>);
            <span class="i">txt_serverCheckIntervalSec</span>.<span class="i">Value</span> = <span class="i">int</span>.<span class="i">Parse</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">b</span> =&gt; <span class="i">b</span>.<span class="i">Key</span> == <span class="s">&quot;conn_serverCheckInterval&quot;</span>).<span class="i">Value</span>) * 0.001;
            <span class="i">chb_topMost</span>.<span class="i">IsChecked</span> = <span class="i">bool</span>.<span class="i">Parse</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">b</span> =&gt; <span class="i">b</span>.<span class="i">Key</span> == <span class="s">&quot;beh_topMost&quot;</span>).<span class="i">Value</span>);
            <span class="i">chb_activeNewInputDefault</span>.<span class="i">IsChecked</span> = <span class="i">bool</span>.<span class="i">Parse</span>(<span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">Key</span> == <span class="s">&quot;beh_activeNewInputDefault&quot;</span>).<span class="i">Value</span>);
            <span class="i">txt_powerBuilderPath</span>.<span class="i">Text</span> = <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">b</span> =&gt; <span class="i">b</span>.<span class="i">Key</span> == <span class="s">&quot;conn_reportingPath&quot;</span>).<span class="i">Value</span>;
 
            <span class="i">cb_defaultLanguage</span>.<span class="i">ItemsSource</span> = <span class="i">Languages</span>;
 
          
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <span class="i">Customized</span> <b>GET Call</b>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;sender&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;e&quot;</span>&gt;     &lt;/<span class="i">param</span>&gt;
        <b>private async</b> <a id="e5a805638385eeb1" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">BtnApiTest_Click</span>(<b>object</b> <span class="i">sender</span>, <span class="i">RoutedEventArgs</span> <span class="i">e</span>) {
            <b>using</b> (<span class="i">HttpClient</span> <span class="i">httpClient</span> = <b>new</b> <span class="i">HttpClient</span>()) {
                <b>try</b> {
                    <b>string</b> <span class="i">json</span> = <b>await</b> <span class="i">httpClient</span>.<span class="i">GetStringAsync</span>(<span class="i">txt_apiAddress</span>.<span class="i">Text</span> + <span class="s">&quot;/&quot;</span> + <span class="i">ApiUrls</span>.<span class="i">EasyITCenterBackendCheck</span> + <span class="s">&quot;/Db&quot;</span>);
                    <span class="i">await</span> <a id="e805a4279e7215f2" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">MainWindow</a>.<span class="i">ShowMessageOnMainWindow</span>(<b>false</b>, <span class="i">json</span>);
                } <b>catch</b> (<span class="i">Exception</span> <span class="i">ex</span>) { <span class="i">await</span> <span class="i">MainWindow</span>.<span class="i">ShowMessageOnMainWindow</span>(<b>true</b>, <span class="s">&quot;Exception Error : &quot;</span> + <span class="i">ex</span>.<span class="i">StackTrace</span>); }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> <span class="i">helper</span> <span class="i">methods</span>
 
        <b>private class</b> <a id="3c4bcfd3b99cccf9" href="../../R/../../0000000000.html" target="n" data-glyph="4,1" class="t t"><span id="341038c22413003c">ExtensionsItem</span></a> {
 
            <b>public</b> <a id="6a99a04106db7a71" href="../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">ExtensionsItem</a>() {
                <span class="i">ident</span> = <span class="i">null</span>;
                <span class="i">isTrue</span> = <b>false</b>;
                <span class="i">asn1OctetString</span> = <span class="i">null</span>;
            }
 
            <b>public</b> <a id="047539812dfd9015" href="../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">DerObjectIdentifier</a> <span class="i">ident</span> { <b>get; set</b>; }
            <b>public</b> <a id="c8e9fc3295566e60" href="../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">bool</a> <span class="i">isTrue</span> { <b>get; set</b>; }
            <b>public</b> <a id="141b966c69bb5715" href="../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">Asn1OctetString</a> <span class="i">asn1OctetString</span> { <b>get; set</b>; }
        }
 
        <span class="k preprocess">#</span><span class="i">endregion</span> <span class="i">helper</span> <span class="i">methods</span>
 
        <b>private</b> <a id="aa36935e7b195154" href="../../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">void</a> <span class="i">ApiAddress_TextChanged</span>(<b>object</b> <span class="i">sender</span>, <span class="i">TextChangedEventArgs</span> <span class="i">e</span>) =&gt; <span class="i">btnApiTest</span>.<span class="i">IsEnabled</span> = <span class="i">txt_apiAddress</span>.<span class="i">Text</span>.<span class="i">Length</span> &gt; 0;
 
        <b>private</b> <a id="aa36935e7b195154" href="../../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">void</a> <span class="i">BtnRestart_Click</span>(<b>object</b> <span class="i">sender</span>, <span class="i">RoutedEventArgs</span> <span class="i">e</span>) =&gt; <span class="i">App</span>.<span class="i">AppRestart</span>();
 
        <b>private</b> <a id="aa36935e7b195154" href="../../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">void</a> <span class="i">BtnBrowse_Click</span>(<b>object</b> <span class="i">sender</span>, <span class="i">RoutedEventArgs</span> <span class="i">e</span>) {
            <b>try</b> {
                <span class="i">OpenFileDialog</span> <a id="29109faa4ae0cb1a" href="../../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">dlg</a> = <b>new</b> <span class="i">OpenFileDialog</span> { <span class="i">DefaultExt</span> = <span class="s">&quot;.exe&quot;</span>, <span class="i">Filter</span> = <span class="s">&quot;Exe files |*.exe&quot;</span>, <span class="i">Title</span> = <span class="i">Resources</span>[<span class="s">&quot;fileOpenDescription&quot;</span>].<span class="i">ToString</span>() };
                <b>if</b> (<span class="i">dlg</span>.<span class="i">ShowDialog</span>() == <b>true</b>) { <span class="i">txt_powerBuilderPath</span>.<span class="i">Text</span> = <span class="i">dlg</span>.<span class="i">FileName</span>; }
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">autoEx</span>) { <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<span class="i">autoEx</span>); }
        }
    }
}</pre></td></tr></table></div></body></html>
