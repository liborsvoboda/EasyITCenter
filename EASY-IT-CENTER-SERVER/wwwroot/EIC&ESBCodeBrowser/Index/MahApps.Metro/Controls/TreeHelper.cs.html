<!DOCTYPE html>
<html><head><title>TreeHelper.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(336);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#MahApps.Metro/Controls/TreeHelper.cs" target="_top">Controls\TreeHelper.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#MahApps.Metro" target="_top">HelpProjects\WPF-MAIN\MahApps.Metro\src\MahApps.Metro\MahApps.Metro.csproj</a> (MahApps.Metro)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Licensed to the .NET Foundation under one or more agreements.</span>
<span class="c">// The .NET Foundation licenses this file to you under the MIT license.</span>
<span class="c">// See the LICENSE file in the project root for more information.</span>

<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Controls</span>.<span class="i n">Primitives</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>.<span class="i n">Media3D</span>;

<b>namespace</b> <span class="i n">MahApps</span>.<span class="i n">Metro</span>.<span class="i n">Controls</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper methods for UI-related tasks.</span>
    <span class="c">///</span><span class="c"> This class was obtained from Philip Sumi (a fellow WPF Disciples blog)</span>
    <span class="c">///</span><span class="c"> http://www.hardcodet.net/uploads/2009/06/UIHelper.cs</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public static class</b> <a id="401addbd2357e9ae" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">TreeHelper</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Finds a parent of a given item on the visual tree.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of the queried item.</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">child</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A direct or indirect child of the</span>
        <span class="c">///</span><span class="c"> queried item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The first parent item that matches the submitted</span>
        <span class="c">///</span><span class="c"> type parameter. If not matching item can be found, a null</span>
        <span class="c">///</span><span class="c"> reference is being returned.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="r0 r t">T</span>? <a id="cbbe3a66a5b55955" href="../R/cbbe3a66a5b55955.html" target="n" data-glyph="220,1" class="i method">TryFindParent</a>&lt;<span id="r0 rd t" class="r0 r t">T</span>&gt;(<b>this</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a> <span id="r1 rd" class="r1 r">child</span>)
            <b>where</b> <span class="r0 r t">T</span> : <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>
        {
            <span class="c">// get parent item</span>
            <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="k">var</a> <span id="r2 rd" class="r2 r">parentObject</span> = <a href="#4d2f2246d14fb6bb" class="i method">GetParentObject</a>(<span class="r1 r">child</span>);
            <b>while</b> (<span class="r2 r">parentObject</span> <b>is not null</b>)
            {
                <span class="c">// check if the parent matches the type we&#39;re looking for</span>
                <b>if</b> (<span class="r2 r">parentObject</span> <b>is</b> <span class="r0 r t">T</span> <span id="r3 rd" class="r3 r">objectToFind</span>)
                {
                    <b>return</b> <span class="r3 r">objectToFind</span>;
                }

                <span class="r2 r">parentObject</span> = <a href="#4d2f2246d14fb6bb" class="i method">GetParentObject</a>(<span class="r2 r">parentObject</span>);
            }

            <span class="c">// we&#39;ve reached the end of the tree</span>
            <b>return</b> <b>null</b>;
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Finds all Ancestors of a given item on the visual tree.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">child</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A node in a visual tree</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">All ancestors in visual tree of </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">child</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> element</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>&gt; <a id="9601f41b9e7fb065" href="../R/../../0000000000.html" target="n" data-glyph="220,1" class="i method">GetAncestors</a>(<b>this</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a> <span id="r4 rd" class="r4 r">child</span>)
        {
            <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="k">var</a> <span id="r5 rd" class="r5 r">parent</span> = <a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#31ea065317da8a39" class="i method">GetParent</a>(<span class="r4 r">child</span>);
            <b>while</b> (<span class="r5 r">parent</span> <b>is not null</b>)
            {
                <b>yield</b> <b>return</b> <span class="r5 r">parent</span>;
                <span class="r5 r">parent</span> = <a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#31ea065317da8a39" class="i method">GetParent</a>(<span class="r5 r">parent</span>);
            }
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns full visual ancestry, starting at the leaf.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If element is not of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@PresentationCore/A.html#5dae7b267e6db0d6" class="t t">Visual</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@PresentationCore/A.html#7451d0c50ce0730a" class="t t">Visual3D</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> the logical ancestry is used.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">leaf</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The starting object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>&gt; <a id="f31ade219c84288b" href="../R/f31ade219c84288b.html" target="n" data-glyph="220,1" class="i method">GetVisualAncestry</a>(<b>this</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>? <span id="r6 rd" class="r6 r">leaf</span>)
        {
            <b>while</b> (<span class="r6 r">leaf</span> <b>is not null</b>)
            {
                <b>yield</b> <b>return</b> <span class="r6 r">leaf</span>;
                <span class="r6 r">leaf</span> = <span class="r6 r">leaf</span> <b>is</b> <a href="@0@PresentationCore/A.html#5dae7b267e6db0d6" class="t t">Visual</a> <b>or</b> <a href="@0@PresentationCore/A.html#7451d0c50ce0730a" class="t t">Visual3D</a>
                    ? <a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#31ea065317da8a39" class="i method">GetParent</a>(<span class="r6 r">leaf</span>)
                    : <a href="@0@PresentationFramework/A.html#7b6652b52c5711cc" class="t t">LogicalTreeHelper</a>.<a href="@0@PresentationFramework/A.html#3b55685d22fdef3e" class="i method">GetParent</a>(<span class="r6 r">leaf</span>);
            }
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tries to find and returns a visual ancestor, starting at the leaf.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">If element is not of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@PresentationCore/A.html#5dae7b267e6db0d6" class="t t">Visual</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@PresentationCore/A.html#7451d0c50ce0730a" class="t t">Visual3D</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> the logical ancestry is used.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">leaf</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The starting object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="r8 r t">T</span>? <a id="72b106778f5cbda6" href="../R/72b106778f5cbda6.html" target="n" data-glyph="220,1" class="i method">GetVisualAncestor</a>&lt;<span id="r8 rd t" class="r8 r t">T</span>&gt;(<b>this</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>? <span id="r7 rd" class="r7 r">leaf</span>)
            <b>where</b> <span class="r8 r t">T</span> : <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>
        {
            <b>while</b> (<span class="r7 r">leaf</span> <b>is not null</b>)
            {
                <b>if</b> (<span class="r7 r">leaf</span> <b>is</b> <span class="r8 r t">T</span> <span id="r9 rd" class="r9 r">ancestor</span>)
                {
                    <b>return</b> <span class="r9 r">ancestor</span>;
                }

                <span class="r7 r">leaf</span> = <span class="r7 r">leaf</span> <b>is</b> <a href="@0@PresentationCore/A.html#5dae7b267e6db0d6" class="t t">Visual</a> <b>or</b> <a href="@0@PresentationCore/A.html#7451d0c50ce0730a" class="t t">Visual3D</a>
                    ? <a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#31ea065317da8a39" class="i method">GetParent</a>(<span class="r7 r">leaf</span>)
                    : <a href="@0@PresentationFramework/A.html#7b6652b52c5711cc" class="t t">LogicalTreeHelper</a>.<a href="@0@PresentationFramework/A.html#3b55685d22fdef3e" class="i method">GetParent</a>(<span class="r7 r">leaf</span>);
            }

            <b>return</b> <b>default</b>(<span class="r8 r t">T</span>);
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Finds a Child of a given item in the visual tree. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">parent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A direct parent of the queried item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of the queried item.</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">childName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">x:Name or Name of child. </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The first parent item that matches the submitted type parameter. </span>
        <span class="c">///</span><span class="c"> If not matching item can be found, </span>
        <span class="c">///</span><span class="c"> a null parent is being returned.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="r11 r t">T</span>? <a id="fd4ef3489442d829" href="../R/fd4ef3489442d829.html" target="n" data-glyph="220,1" class="i method">FindChild</a>&lt;<span id="r11 rd t" class="r11 r t">T</span>&gt;(<b>this</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>? <span id="r10 rd" class="r10 r">parent</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>? <span id="r12 rd" class="r12 r">childName</span> = <b>null</b>)
            <b>where</b> <span class="r11 r t">T</span> : <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>
        {
            <span class="c">// Confirm parent and childName are valid. </span>
            <b>if</b> (<span class="r10 r">parent</span> <b>is null</b>)
            {
                <b>return</b> <b>null</b>;
            }

            <span class="r11 r t">T</span>? <span id="r13 rd" class="r13 r">foundChild</span> = <b>null</b>;

            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r14 rd" class="r14 r">childrenCount</span> = <a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#d74c0832c61e07fb" class="i method">GetChildrenCount</a>(<span class="r10 r">parent</span>);
            <b>for</b> (<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r15 rd" class="r15 r">i</span> = 0; <span class="r15 r">i</span> &lt; <span class="r14 r">childrenCount</span>; <span class="r15 r">i</span>++)
            {
                <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="k">var</a> <span id="r16 rd" class="r16 r">child</span> = <a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#30089fb0c0679121" class="i method">GetChild</a>(<span class="r10 r">parent</span>, <span class="r15 r">i</span>);

                <span class="c">// If the child is not of the request child type child</span>
                <b>if</b> (<span class="r16 r">child</span> <b>is not</b> <span class="r11 r t">T</span> <span id="r17 rd" class="r17 r">currentChild</span>)
                {
                    <span class="c">// recursively drill down the tree</span>
                    <span class="r13 r">foundChild</span> = <a href="#fd4ef3489442d829" class="i method">FindChild</a>&lt;<span class="r11 r t">T</span>&gt;(<span class="r16 r">child</span>, <span class="r12 r">childName</span>);
                    <span class="c">// If the child is found, break so we do not overwrite the found child. </span>
                    <b>if</b> (<span class="r13 r">foundChild</span> <b>is not null</b>)
                    {
                        <b>break</b>;
                    }
                }
                <b>else</b> <b>if</b> (!<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#23a8597f842071f4" class="i method">IsNullOrEmpty</a>(<span class="r12 r">childName</span>))
                {
                    <span class="c">// If the child&#39;s name is set for search</span>
                    <b>if</b> (<span class="r17 r">currentChild</span> <b>is</b> <a href="@0@PresentationFramework/A.html#3df424bd10576a70" class="t t">IFrameworkInputElement</a> <span id="r18 rd" class="r18 r">frameworkInputElement</span> &amp;&amp; <span class="r18 r">frameworkInputElement</span>.<a href="@0@PresentationFramework/A.html#61f40cfe040b8bee" class="i property">Name</a> == <span class="r12 r">childName</span>)
                    {
                        <span class="c">// if the child&#39;s name is of the request name</span>
                        <span class="r13 r">foundChild</span> = <span class="r17 r">currentChild</span>;
                        <b>break</b>;
                    }

                    <span class="c">// recursively drill down the tree</span>
                    <span class="r13 r">foundChild</span> = <a href="#fd4ef3489442d829" class="i method">FindChild</a>&lt;<span class="r11 r t">T</span>&gt;(<span class="r17 r">currentChild</span>, <span class="r12 r">childName</span>);
                    <span class="c">// If the child is found, break so we do not overwrite the found child. </span>
                    <b>if</b> (<span class="r13 r">foundChild</span> <b>is not null</b>)
                    {
                        <b>break</b>;
                    }
                }
                <b>else</b>
                {
                    <span class="c">// child element found.</span>
                    <span class="r13 r">foundChild</span> = <span class="r17 r">currentChild</span>;
                    <b>break</b>;
                }
            }

            <b>return</b> <span class="r13 r">foundChild</span>;
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Analyzes both visual and logical tree in order to find all elements of a given</span>
        <span class="c">///</span><span class="c"> type that are descendants of the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">source</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of the queried items.</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The root element that marks the source of the search. If the</span>
        <span class="c">///</span><span class="c"> source is already of the requested type, it will not be included in the result.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">forceUsingTheVisualTreeHelper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sometimes it&#39;s better to search in the VisualTree (e.g. in tests)</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">All descendants of </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">source</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that match the requested type.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<span class="r20 r t">T</span>&gt; <a id="7924bc07837f3404" href="../R/7924bc07837f3404.html" target="n" data-glyph="220,1" class="i method">FindChildren</a>&lt;<span id="r20 rd t" class="r20 r t">T</span>&gt;(<b>this</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>? <span id="r19 rd" class="r19 r">source</span>, <b>bool</b> <span id="r21 rd" class="r21 r">forceUsingTheVisualTreeHelper</span> = <b>false</b>)
            <b>where</b> <span class="r20 r t">T</span> : <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>
        {
            <b>if</b> (<span class="r19 r">source</span> <b>is not null</b>)
            {
                <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="k">var</a> <span id="r22 rd" class="r22 r">childObjects</span> = <a href="#4d0bbd98c134a4de" class="i method">GetChildObjects</a>(<span class="r19 r">source</span>, <span class="r21 r">forceUsingTheVisualTreeHelper</span>);
                <b>foreach</b> (<a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="k">var</a> <span id="r23 rd" class="r23 r">child</span> <b>in</b> <span class="r22 r">childObjects</span>)
                {
                    <span class="c">// analyze if children match the requested type</span>
                    <b>if</b> (<span class="r23 r">child</span> <b>is</b> <span class="r20 r t">T</span> <span id="r24 rd" class="r24 r">childToFind</span>)
                    {
                        <b>yield</b> <b>return</b> <span class="r24 r">childToFind</span>;
                    }

                    <span class="c">// recurse tree</span>
                    <b>foreach</b> (<span class="r20 r t">T</span> <span id="r25 rd" class="r25 r">descendant</span> <b>in</b> <a href="#7924bc07837f3404" class="i method">FindChildren</a>&lt;<span class="r20 r t">T</span>&gt;(<span class="r23 r">child</span>, <span class="r21 r">forceUsingTheVisualTreeHelper</span>))
                    {
                        <b>yield</b> <b>return</b> <span class="r25 r">descendant</span>;
                    }
                }
            }
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is an alternative to WPF&#39;s</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#30089fb0c0679121" class="i method">GetChild</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> method, which also</span>
        <span class="c">///</span><span class="c"> supports content elements. Keep in mind that for content elements,</span>
        <span class="c">///</span><span class="c"> this method falls back to the logical tree of the element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">parent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The item to be processed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">forceUsingTheVisualTreeHelper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sometimes it&#39;s better to search in the VisualTree (e.g. in tests)</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The submitted item&#39;s child elements, if available.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="t t">IEnumerable</a>&lt;<a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>&gt; <a id="4d0bbd98c134a4de" href="../R/4d0bbd98c134a4de.html" target="n" data-glyph="220,1" class="i method">GetChildObjects</a>(<b>this</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>? <span id="r26 rd" class="r26 r">parent</span>, <b>bool</b> <span id="r27 rd" class="r27 r">forceUsingTheVisualTreeHelper</span> = <b>false</b>)
        {
            <b>if</b> (<span class="r26 r">parent</span> <b>is not null</b>)
            {
                <b>if</b> (!<span class="r27 r">forceUsingTheVisualTreeHelper</span> &amp;&amp; (<span class="r26 r">parent</span> <b>is</b> <a href="@0@PresentationCore/A.html#110a5eca64130d8f" class="t t">ContentElement</a> || <span class="r26 r">parent</span> <b>is</b> <a href="@0@PresentationFramework/A.html#d2d98a3022fbac2f" class="t t">FrameworkElement</a>))
                {
                    <span class="c">// use the logical tree for content / framework elements</span>
                    <b>foreach</b> (<a href="@0@mscorlib/A.html#d9262ceecc1719ab" class="k">var</a> <span id="r28 rd" class="r28 r">obj</span> <b>in</b> <a href="@0@PresentationFramework/A.html#7b6652b52c5711cc" class="t t">LogicalTreeHelper</a>.<a href="@0@PresentationFramework/A.html#5d3b3dc0e6664c82" class="i method">GetChildren</a>(<span class="r26 r">parent</span>))
                    {
                        <b>if</b> (<span class="r28 r">obj</span> <b>is</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a> <span id="r29 rd" class="r29 r">dependencyObject</span>)
                        {
                            <b>yield</b> <b>return</b> <span class="r29 r">dependencyObject</span>;
                        }
                    }
                }
                <b>else</b> <b>if</b> (<span class="r26 r">parent</span> <b>is</b> <a href="@0@PresentationCore/A.html#5dae7b267e6db0d6" class="t t">Visual</a> || <span class="r26 r">parent</span> <b>is</b> <a href="@0@PresentationCore/A.html#7451d0c50ce0730a" class="t t">Visual3D</a>)
                {
                    <span class="c">// use the visual tree per default</span>
                    <b>int</b> <span id="r30 rd" class="r30 r">count</span> = <a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#d74c0832c61e07fb" class="i method">GetChildrenCount</a>(<span class="r26 r">parent</span>);
                    <b>for</b> (<b>int</b> <span id="r31 rd" class="r31 r">i</span> = 0; <span class="r31 r">i</span> &lt; <span class="r30 r">count</span>; <span class="r31 r">i</span>++)
                    {
                        <b>yield</b> <b>return</b> <a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#30089fb0c0679121" class="i method">GetChild</a>(<span class="r26 r">parent</span>, <span class="r31 r">i</span>);
                    }
                }
            }
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tries to locate a given item within the visual tree,</span>
        <span class="c">///</span><span class="c"> starting with the dependency object at a given position. </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of the element to be found</span>
        <span class="c">///</span><span class="c"> on the visual tree of the element at the given location.</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">reference</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The main element which is used to perform</span>
        <span class="c">///</span><span class="c"> hit testing.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">point</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to be evaluated on the origin.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static</b> <span class="r32 r t">T</span>? <a id="4b65ad6aec6c2821" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TryFindFromPoint</a>&lt;<span id="r32 rd t" class="r32 r t">T</span>&gt;(<a href="@0@PresentationCore/A.html#7911653ccb506216" class="t t">UIElement</a> <span id="r33 rd" class="r33 r">reference</span>, <a href="@0@WindowsBase/A.html#9120327717fc513d" class="t t">Point</a> <span id="r34 rd" class="r34 r">point</span>)
            <b>where</b> <span class="r32 r t">T</span> : <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>
        {
            <b>if</b> (!(<span class="r33 r">reference</span>.<a href="@0@PresentationCore/A.html#fda173037d49d286" class="i method">InputHitTest</a>(<span class="r34 r">point</span>) <b>is</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a> <span id="r35 rd" class="r35 r">element</span>))
            {
                <b>return</b> <b>null</b>;
            }

            <b>if</b> (<span class="r35 r">element</span> <b>is</b> <span class="r32 r t">T</span> <span id="r36 rd" class="r36 r">theObject</span>)
            {
                <b>return</b> <span class="r36 r">theObject</span>;
            }

            <b>return</b> <a href="#cbbe3a66a5b55955" class="i method">TryFindParent</a>&lt;<span class="r32 r t">T</span>&gt;(<span class="r35 r">element</span>);
        }

        <b>public static bool</b> <a id="d6cdfcdae5025cfd" href="../R/d6cdfcdae5025cfd.html" target="n" data-glyph="220,1" class="i method">IsDescendantOf</a>(<b>this</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a> <span id="r37 rd" class="r37 r">node</span>, <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a> <span id="r38 rd" class="r38 r">reference</span>)
        {
            <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>? <span id="r39 rd" class="r39 r">currentNode</span> = <span class="r37 r">node</span>;

            <b>while</b> (<span class="r39 r">currentNode</span> <b>is not null</b>)
            {
                <b>if</b> (<span class="r39 r">currentNode</span> == <span class="r38 r">reference</span>)
                {
                    <b>return</b> <b>true</b>;
                }

                <b>if</b> (<span class="r39 r">currentNode</span> <b>is</b> <a href="@0@PresentationFramework/A.html#40ab7810a8f8c8f6" class="t t">Popup</a> <span id="r40 rd" class="r40 r">popup</span>)
                {
                    <span class="c">// Try the Parent of the Popup</span>
                    <span class="c">// Otherwise fall back to placement target</span>
                    <span class="r39 r">currentNode</span> = <span class="r40 r">popup</span>.<a href="@0@PresentationFramework/A.html#f649907cbc82d1a0" class="i property">Parent</a> ?? <span class="r40 r">popup</span>.<a href="@0@PresentationFramework/A.html#6710517f0af5ce90" class="i property">PlacementTarget</a>;
                }
                <b>else</b>
                {
                    <span class="c">// Otherwise walk tree</span>
                    <span class="r39 r">currentNode</span> = <span class="r39 r">currentNode</span>.<a href="#4d2f2246d14fb6bb" class="i method">GetParentObject</a>();
                }
            }

            <b>return</b> <b>false</b>;
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is an alternative to WPF&#39;s</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#31ea065317da8a39" class="i method">GetParent</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> method, which also supports content elements. Keep in mind that for content element,</span>
        <span class="c">///</span><span class="c"> this method falls back to the logical tree of the element!</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">child</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The item to be processed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The submitted item&#39;s parent, if available. Otherwise</span>
        <span class="c">///</span><span class="c"> null.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>? <a id="4d2f2246d14fb6bb" href="../R/4d2f2246d14fb6bb.html" target="n" data-glyph="220,1" class="i method">GetParentObject</a>(<b>this</b> <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a>? <span id="r41 rd" class="r41 r">child</span>)
        {
            <b>if</b> (<span class="r41 r">child</span> <b>is null</b>)
            {
                <b>return</b> <b>null</b>;
            }

            <span class="c">// handle content elements separately</span>
            <b>if</b> (<span class="r41 r">child</span> <b>is</b> <a href="@0@PresentationCore/A.html#110a5eca64130d8f" class="t t">ContentElement</a> <span id="r42 rd" class="r42 r">contentElement</span>)
            {
                <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a> <span id="r43 rd" class="r43 r">parent</span> = <a href="@0@PresentationCore/A.html#e38ffae243d4044c" class="t t">ContentOperations</a>.<a href="@0@PresentationCore/A.html#f051563b4926eb39" class="i method">GetParent</a>(<span class="r42 r">contentElement</span>);
                <b>if</b> (<span class="r43 r">parent</span> <b>is not null</b>)
                {
                    <b>return</b> <span class="r43 r">parent</span>;
                }

                <b>return</b> <span class="r42 r">contentElement</span> <b>is</b> <a href="@0@PresentationFramework/A.html#12f57ec65f270e8f" class="t t">FrameworkContentElement</a> <span id="r44 rd" class="r44 r">fce</span> ? <span class="r44 r">fce</span>.<a href="@0@PresentationFramework/A.html#6e6e89698f99eb50" class="i property">Parent</a> : <b>null</b>;
            }

            <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="k">var</a> <span id="r45 rd" class="r45 r">childParent</span> = <a href="@0@PresentationCore/A.html#7f1e2538afba01e7" class="t t">VisualTreeHelper</a>.<a href="@0@PresentationCore/A.html#31ea065317da8a39" class="i method">GetParent</a>(<span class="r41 r">child</span>);
            <b>if</b> (<span class="r45 r">childParent</span> <b>is not null</b>)
            {
                <b>return</b> <span class="r45 r">childParent</span>;
            }

            <span class="c">// also try searching for parent in framework elements (such as DockPanel, etc)</span>
            <b>if</b> (<span class="r41 r">child</span> <b>is</b> <a href="@0@PresentationFramework/A.html#d2d98a3022fbac2f" class="t t">FrameworkElement</a> <span id="r46 rd" class="r46 r">frameworkElement</span>)
            {
                <a href="@0@WindowsBase/A.html#3ce192f6633decc8" class="t t">DependencyObject</a> <span id="r47 rd" class="r47 r">parent</span> = <span class="r46 r">frameworkElement</span>.<a href="@0@PresentationFramework/A.html#f649907cbc82d1a0" class="i property">Parent</a>;
                <b>if</b> (<span class="r47 r">parent</span> <b>is not null</b>)
                {
                    <b>return</b> <span class="r47 r">parent</span>;
                }
            }

            <b>return</b> <b>null</b>;
        }
    }
}</pre></td></tr></table></div></body></html>
