<!DOCTYPE html>
<html><head><title>WinApiHelper.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(194);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#MahApps.Metro/Controls/WinApiHelper.cs" target="_top">Controls\WinApiHelper.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#MahApps.Metro" target="_top">HelpProjects\WPF-MAIN\MahApps.Metro\src\MahApps.Metro\MahApps.Metro.csproj</a> (MahApps.Metro)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Licensed to the .NET Foundation under one or more agreements.</span>
<span class="c">// The .NET Foundation licenses this file to you under the MIT license.</span>
<span class="c">// See the LICENSE file in the project root for more information.</span>

<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Interop</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>;
<b>using</b> <span class="i n">Windows</span>.<span class="i n">Win32</span>;
<b>using</b> <span class="i n">Windows</span>.<span class="i n">Win32</span>.<span class="i n">Foundation</span>;
<b>using</b> <span class="i n">Windows</span>.<span class="i n">Win32</span>.<span class="i n">Graphics</span>.<span class="i n">Gdi</span>;
<b>using</b> <span class="i n">Windows</span>.<span class="i n">Win32</span>.<span class="i n">UI</span>.<span class="i n">WindowsAndMessaging</span>;

<b>namespace</b> <span class="i n">MahApps</span>.<span class="i n">Metro</span>.<span class="i n">Controls</span>
{
    <b>internal static class</b> <a id="b24ca23dca93d100" href="../R/b24ca23dca93d100.html" target="n" data-glyph="2,0" class="t t">WinApiHelper</a>
    {
        <b>private static</b> <a href="@0@mscorlib/A.html#743afbddafaea263" class="t t">SafeHandle</a>? <a id="404471206f185c80" href="../R/404471206f185c80.html" target="n" data-glyph="46,1" class="i field">user32</a>;

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get caption for the given id from the user32.dll</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The id for the caption.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The caption from the id.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static unsafe string</b> <a id="e019b9c6a120f60e" href="../R/e019b9c6a120f60e.html" target="n" data-glyph="72,1" class="i method">GetCaption</a>(<b>uint</b> <span id="r0 rd" class="r0 r">id</span>)
        {
            <b>if</b> (<a href="#404471206f185c80" class="i field">user32</a> <b>is null</b>)
            {
                <a href="#404471206f185c80" class="i field">user32</a> = <span class="t">PInvoke</span>.<span class="i">LoadLibrary</span>(<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#2d7263f86a526264" class="i method">Combine</a>(<a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#a8b03265b7938604" class="i property">SystemDirectory</a>, <span class="s">&quot;User32.dll&quot;</span>));
            }

            <b>var</b> <span id="r1 rd" class="r1 r">chars</span> = <b>new</b> <b>char</b>[256];

            <b>fixed</b> (<b>char</b>* <span id="r2 rd" class="r2 r">pchars</span> = <span class="r1 r">chars</span>)
            {
                <span class="c">//PWSTR str = new PWSTR()</span>
                <b>if</b> (<span class="t">PInvoke</span>.<span class="i">LoadString</span>(<a href="#404471206f185c80" class="i field">user32</a>, <span class="r0 r">id</span>, <span class="r2 r">pchars</span>, <span class="r1 r">chars</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>) == 0)
                {
                    <b>return</b> <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#9d5604d4425b216f" class="i method">Format</a>(<span class="s">&quot;String with id &#39;{0}&#39; could not be found.&quot;</span>, <span class="r0 r">id</span>);
                }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> <span class="i">CA1307</span> <span class="c">// Specify StringComparison for clarity</span>
                <b>return</b> <b>new</b> <a href="@0@mscorlib/A.html#ec408439366007e6" class="k">string</a>(<span class="r1 r">chars</span>).<a href="@0@mscorlib/A.html#69fc1d0aa6df8a90" class="i method">Replace</a>(<span class="s">&quot;&amp;&quot;</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> <span class="i">CA1307</span> <span class="c">// Specify StringComparison for clarity</span>
            }
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the working area size of the monitor from where the visual stays.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">visual</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The visual element to get the monitor information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The working area size of the monitor.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static unsafe</b> <a href="@0@WindowsBase/A.html#a844b9b525c2088c" class="t t">Size</a> <a id="5c821574dcc19668" href="../R/5c821574dcc19668.html" target="n" data-glyph="220,1" class="i method">GetMonitorWorkSize</a>(<b>this</b> <a href="@0@PresentationCore/A.html#5dae7b267e6db0d6" class="t t">Visual</a>? <span id="r3 rd" class="r3 r">visual</span>)
        {
            <b>if</b> (<span class="r3 r">visual</span> <b>is null</b> == <b>false</b>
                &amp;&amp; <a href="@0@PresentationCore/A.html#317e126bb0affb36" class="t t">PresentationSource</a>.<a href="@0@PresentationCore/A.html#5fd0a5ffda5383c7" class="i method">FromVisual</a>(<span class="r3 r">visual</span>) <b>is</b> <a href="@0@PresentationCore/A.html#47ce6b5ad70db257" class="t t">HwndSource</a> <span id="r4 rd" class="r4 r">source</span>
                &amp;&amp; <span class="r4 r">source</span>.<a href="@0@PresentationCore/A.html#bad90e8fd5b0eaa5" class="i property">IsDisposed</a> == <b>false</b>
                &amp;&amp; <span class="r4 r">source</span>.<a href="@0@PresentationCore/A.html#8efe439e9c8c22c5" class="i property">RootVisual</a> <b>is null</b> == <b>false</b>
                &amp;&amp; <span class="r4 r">source</span>.<a href="@0@PresentationCore/A.html#a2b8bde522dda7e9" class="i property">Handle</a> != <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a>.<a href="@0@mscorlib/A.html#d46202ed9b6005b2" class="i field">Zero</a>)
            {
                <span class="c">// Try to get the monitor from where the owner stays and use the working area for window size properties</span>
                <b>var</b> <span id="r5 rd" class="r5 r">monitor</span> = <span class="t">PInvoke</span>.<span class="i">MonitorFromWindow</span>(<b>new</b> <span class="t">HWND</span>(<span class="r4 r">source</span>.<a href="@0@PresentationCore/A.html#a2b8bde522dda7e9" class="i property">Handle</a>), <span class="t">MONITOR_FROM_FLAGS</span>.<span class="i">MONITOR_DEFAULTTONEAREST</span>);
                <b>if</b> (<span class="r5 r">monitor</span> != <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a>.<a href="@0@mscorlib/A.html#d46202ed9b6005b2" class="i field">Zero</a>)
                {
                    <b>var</b> <span id="r6 rd" class="r6 r">monitorInfo</span> = <b>new</b> <span class="t">MONITORINFO</span>
                                      {
                                          <span class="i">cbSize</span> = (<b>uint</b>)<a href="@0@mscorlib/A.html#489a61c84168b119" class="t t">Marshal</a>.<a href="@0@mscorlib/A.html#9fef1d6bb6a505fe" class="i method">SizeOf</a>&lt;<span class="t">MONITORINFO</span>&gt;()
                                      };
                    <span class="t">PInvoke</span>.<span class="i">GetMonitorInfo</span>(<span class="r5 r">monitor</span>, &amp;<span class="r6 r">monitorInfo</span>);
                    <b>return</b> <b>new</b> <span class="t">Size</span>(<span class="r6 r">monitorInfo</span>.<span class="i">rcWork</span>.<span class="i">right</span> - <span class="r6 r">monitorInfo</span>.<span class="i">rcWork</span>.<span class="i">left</span>, <span class="r6 r">monitorInfo</span>.<span class="i">rcWork</span>.<span class="i">bottom</span> - <span class="r6 r">monitorInfo</span>.<span class="i">rcWork</span>.<span class="i">top</span>);
                }
            }

            <b>return</b> <b>default</b>;
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a window placement to a window.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">window</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The window which should get the window placement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">wp</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The window placement for the window.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static unsafe void</b> <a id="bc23172d210ce1df" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetWindowPlacement</a>(<a href="@0@PresentationFramework/A.html#e438dc91640a8d15" class="t t">Window</a>? <span id="r7 rd" class="r7 r">window</span>, <span class="t">WINDOWPLACEMENT</span>? <span id="r8 rd" class="r8 r">wp</span>)
        {
            <b>if</b> (<span class="r7 r">window</span> <b>is null</b>)
            {
                <b>return</b>;
            }

            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r9 rd" class="r9 r">x</span> = <span class="i">CalcIntValue</span>(<span class="r8 r">wp</span>?.<span class="i">rcNormalPosition</span>.<span class="i">left</span>, <span class="r7 r">window</span>.<a href="@0@PresentationFramework/A.html#c3f9155c7db6905b" class="i property">Left</a>);
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r10 rd" class="r10 r">y</span> = <span class="i">CalcIntValue</span>(<span class="r8 r">wp</span>?.<span class="i">rcNormalPosition</span>.<span class="i">top</span>, <span class="r7 r">window</span>.<a href="@0@PresentationFramework/A.html#d6db15f2bca39f0b" class="i property">Top</a>);
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r11 rd" class="r11 r">width</span> = <span class="i">CalcIntValue</span>(<span class="r8 r">wp</span>?.<span class="i">rcNormalPosition</span>.<span class="i">GetWidth</span>(), <span class="r7 r">window</span>.<a href="@0@PresentationFramework/A.html#7cc64ed9667c9f70" class="i property">ActualWidth</a>);
            <a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r12 rd" class="r12 r">height</span> = <span class="i">CalcIntValue</span>(<span class="r8 r">wp</span>?.<span class="i">rcNormalPosition</span>.<span class="i">GetHeight</span>(), <span class="r7 r">window</span>.<a href="@0@PresentationFramework/A.html#5554a4892ffe2cfc" class="i property">ActualHeight</a>);

            <b>var</b> <span id="r13 rd" class="r13 r">placement</span> = <b>new</b> <span class="t">WINDOWPLACEMENT</span>
                            {
                                <span class="i">length</span> = (<b>uint</b>)<a href="@0@mscorlib/A.html#489a61c84168b119" class="t t">Marshal</a>.<a href="@0@mscorlib/A.html#9fef1d6bb6a505fe" class="i method">SizeOf</a>&lt;<span class="t">WINDOWPLACEMENT</span>&gt;(),
                                <span class="i">showCmd</span> = (<span class="r8 r">wp</span> <b>is null</b> || <span class="r8 r">wp</span>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>.<span class="i">showCmd</span> == <span class="t">SHOW_WINDOW_CMD</span>.<span class="i">SW_SHOWMINIMIZED</span> ? <span class="t">SHOW_WINDOW_CMD</span>.<span class="i">SW_SHOWNORMAL</span> : <span class="r8 r">wp</span>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>.<span class="i">showCmd</span>),
                                <span class="i">rcNormalPosition</span> = <b>new</b> <span class="t">RECT</span> { <span class="i">left</span> = <span class="r9 r">x</span>, <span class="i">top</span> = <span class="r10 r">y</span>, <span class="i">right</span> = <span class="r9 r">x</span> + <span class="r11 r">width</span>, <span class="i">bottom</span> = <span class="r10 r">y</span> + <span class="r12 r">height</span> }
                            };

            <b>if</b> (<span class="r8 r">wp</span> <b>is not null</b>)
            {
                <span class="r13 r">placement</span>.<span class="i">ptMinPosition</span> = <b>new</b> <span class="i n">System</span>.<span class="i n">Drawing</span>.<span class="t">Point</span>(<span class="r8 r">wp</span>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>.<span class="i">ptMinPosition</span>.<span class="i">X</span>, <span class="r8 r">wp</span>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>.<span class="i">ptMinPosition</span>.<span class="i">Y</span>);
                <span class="r13 r">placement</span>.<span class="i">ptMaxPosition</span> = <b>new</b> <span class="i n">System</span>.<span class="i n">Drawing</span>.<span class="t">Point</span>(<span class="r8 r">wp</span>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>.<span class="i">ptMaxPosition</span>.<span class="i">X</span>, <span class="r8 r">wp</span>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>.<span class="i">ptMaxPosition</span>.<span class="i">Y</span>);
            }

            <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="k">var</a> <span id="r14 rd" class="r14 r">hWnd</span> = <b>new</b> <a href="@0@PresentationFramework/A.html#fdbf322c4b24b279" class="t constructor">WindowInteropHelper</a>(<span class="r7 r">window</span>).<a href="@0@PresentationFramework/A.html#471dc96303f6513d" class="i method">EnsureHandle</a>();
            <b>if</b> (<span class="t">PInvoke</span>.<span class="i">SetWindowPlacement</span>(<b>new</b> <span class="t">HWND</span>(<span class="r14 r">hWnd</span>), &amp;<span class="r13 r">placement</span>) == <b>false</b>)
            {
                <a href="@0@System/A.html#c63a0f19b2d4db69" class="t t">Trace</a>.<a href="@0@System/A.html#ed0a145461a37c94" class="i method">TraceWarning</a>(<span class="s">$&quot;</span>{<span class="r7 r">window</span>}<span class="s">: The window placement </span>{<span class="r8 r">wp</span>}<span class="s"> could not be (SetWindowPlacement)!</span><span class="s">&quot;</span>);
            }
        }

        <b>private static int</b> <a id="e930ae37a3affe46" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CalcIntValue</a>(<b>double</b>? <span id="r15 rd" class="r15 r">value</span>, <b>double</b> <span id="r16 rd" class="r16 r">fallback</span>)
        {
            <b>if</b> (<span class="r15 r">value</span> <b>is null</b>)
            {
                <b>return</b> (<b>int</b>)<span class="r16 r">fallback</span>;
            }

            <a href="@0@mscorlib/A.html#1a65cbdb09544ba1" class="k">var</a> <span id="r17 rd" class="r17 r">d</span> = (<b>double</b>)<span class="r15 r">value</span>;
            <b>if</b> (!<b>double</b>.<a href="@0@mscorlib/A.html#b3843db5f359a0fd" class="i method">IsNaN</a>(<span class="r17 r">d</span>) &amp;&amp; <span class="r17 r">d</span> &gt; <b>int</b>.<a href="@0@mscorlib/A.html#e3cfc4661f06e948" class="i field">MinValue</a> &amp;&amp; <span class="r17 r">d</span> &lt; <b>int</b>.<a href="@0@mscorlib/A.html#c45153c0501d7122" class="i field">MaxValue</a>)
            {
                <b>return</b> (<b>int</b>)<span class="r17 r">d</span>;
            }

            <b>return</b> (<b>int</b>)<span class="r16 r">fallback</span>;
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c"> Gets the text associated with the given window handle. </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">window</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c"> The window to act on. </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c"> The window text. </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b>? <a id="e8b17a2c8d8e2040" href="../R/../../0000000000.html" target="n" data-glyph="221,1" class="i method">GetWindowText</a>(<b>this</b> <a href="@0@PresentationFramework/A.html#e438dc91640a8d15" class="t t">Window</a>? <span id="r18 rd" class="r18 r">window</span>)
        {
            <b>if</b> (<span class="r18 r">window</span> <b>is null</b> == <b>false</b>
                &amp;&amp; <a href="@0@PresentationCore/A.html#317e126bb0affb36" class="t t">PresentationSource</a>.<a href="@0@PresentationCore/A.html#5fd0a5ffda5383c7" class="i method">FromVisual</a>(<span class="r18 r">window</span>) <b>is</b> <a href="@0@PresentationCore/A.html#47ce6b5ad70db257" class="t t">HwndSource</a> <span id="r19 rd" class="r19 r">source</span>
                &amp;&amp; <span class="r19 r">source</span>.<a href="@0@PresentationCore/A.html#bad90e8fd5b0eaa5" class="i property">IsDisposed</a> == <b>false</b>
                &amp;&amp; <span class="r19 r">source</span>.<a href="@0@PresentationCore/A.html#8efe439e9c8c22c5" class="i property">RootVisual</a> <b>is null</b> == <b>false</b>
                &amp;&amp; <span class="r19 r">source</span>.<a href="@0@PresentationCore/A.html#a2b8bde522dda7e9" class="i property">Handle</a> != <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a>.<a href="@0@mscorlib/A.html#d46202ed9b6005b2" class="i field">Zero</a>)
            {
                <b>int</b> <span id="r20 rd" class="r20 r">bufferSize</span> = <span class="t">PInvoke</span>.<span class="i">GetWindowTextLength</span>(<b>new</b> <span class="t">HWND</span>(<span class="r19 r">source</span>.<a href="@0@PresentationCore/A.html#a2b8bde522dda7e9" class="i property">Handle</a>)) + 1;
                <b>unsafe</b>
                {
                    <b>fixed</b> (<b>char</b>* <span id="r21 rd" class="r21 r">windowNameChars</span> = <b>new</b> <b>char</b>[<span class="r20 r">bufferSize</span>])
                    {
                        <span class="t">PInvoke</span>.<span class="i">GetWindowText</span>(<b>new</b> <span class="t">HWND</span>(<span class="r19 r">source</span>.<a href="@0@PresentationCore/A.html#a2b8bde522dda7e9" class="i property">Handle</a>), <span class="r21 r">windowNameChars</span>, <span class="r20 r">bufferSize</span>);
                        <b>return</b> <b>new</b> <a href="@0@mscorlib/A.html#fb675472d0615e88" class="k">string</a>(<span class="r21 r">windowNameChars</span>);
                    }
                }
            }

            <b>return</b> <b>default</b>;
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c"> Gets the text associated with the given window handle. </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">window</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c"> The window to act on. </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c"> The window text. </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="@0@WindowsBase/A.html#fc387a6f7a1c2856" class="t t">Rect</a> <a id="cb084012d1df8f3e" href="../R/../../0000000000.html" target="n" data-glyph="221,1" class="i method">GetWindowBoundingRectangle</a>(<b>this</b> <a href="@0@PresentationFramework/A.html#e438dc91640a8d15" class="t t">Window</a>? <span id="r22 rd" class="r22 r">window</span>)
        {
            <a href="@0@WindowsBase/A.html#fc387a6f7a1c2856" class="k">var</a> <span id="r23 rd" class="r23 r">bounds</span> = <b>new</b> <a href="@0@WindowsBase/A.html#299a3fd614724168" class="t constructor">Rect</a>(0, 0, 0, 0);

            <b>if</b> (<span class="r22 r">window</span> <b>is null</b> == <b>false</b>
                &amp;&amp; <a href="@0@PresentationCore/A.html#317e126bb0affb36" class="t t">PresentationSource</a>.<a href="@0@PresentationCore/A.html#5fd0a5ffda5383c7" class="i method">FromVisual</a>(<span class="r22 r">window</span>) <b>is</b> <a href="@0@PresentationCore/A.html#47ce6b5ad70db257" class="t t">HwndSource</a> <span id="r24 rd" class="r24 r">source</span>
                &amp;&amp; <span class="r24 r">source</span>.<a href="@0@PresentationCore/A.html#bad90e8fd5b0eaa5" class="i property">IsDisposed</a> == <b>false</b>
                &amp;&amp; <span class="r24 r">source</span>.<a href="@0@PresentationCore/A.html#8efe439e9c8c22c5" class="i property">RootVisual</a> <b>is null</b> == <b>false</b>
                &amp;&amp; <span class="r24 r">source</span>.<a href="@0@PresentationCore/A.html#a2b8bde522dda7e9" class="i property">Handle</a> != <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a>.<a href="@0@mscorlib/A.html#d46202ed9b6005b2" class="i field">Zero</a>)
            {
                <b>var</b> <span id="r25 rd" class="r25 r">rc</span> = <b>new</b> <span class="t">RECT</span>();

                <b>try</b>
                {
                    <b>unsafe</b>
                    {
                        <span class="t">PInvoke</span>.<span class="i">GetWindowRect</span>((<span class="t">HWND</span>)<span class="r24 r">source</span>.<a href="@0@PresentationCore/A.html#a2b8bde522dda7e9" class="i property">Handle</a>, &amp;<span class="r25 r">rc</span>);
                    }
                }
                <span class="c">// Allow empty catch statements.</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56502
                <b>catch</b> (<a href="@0@System/A.html#824f982cf95a6267" class="t t">Win32Exception</a>)
                {
                }
                <span class="c">// Disallow empty catch statements.</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56502

                <span class="r23 r">bounds</span> = <b>new</b> <a href="@0@WindowsBase/A.html#299a3fd614724168" class="t constructor">Rect</a>(<span class="r25 r">rc</span>.<span class="i">left</span>, <span class="r25 r">rc</span>.<span class="i">top</span>, <span class="r25 r">rc</span>.<a href="../Internal/PInvokeExtensions.cs.html#81927e96e7ef9335" class="i method">GetWidth</a>(), <span class="r25 r">rc</span>.<a href="../Internal/PInvokeExtensions.cs.html#34f27272896067ac" class="i method">GetHeight</a>());
            }

            <b>return</b> <span class="r23 r">bounds</span>;
        }
    }
}</pre></td></tr></table></div></body></html>
