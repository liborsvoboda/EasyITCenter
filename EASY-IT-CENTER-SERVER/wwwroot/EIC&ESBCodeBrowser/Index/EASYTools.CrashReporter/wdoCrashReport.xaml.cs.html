<!DOCTYPE html>
<html><head><title>wdoCrashReport.xaml.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(508);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EASYTools.CrashReporter/wdoCrashReport.xaml.cs" target="_top">wdoCrashReport.xaml.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EASYTools.CrashReporter" target="_top">..\..\..\EASY-TOOLS\EASYTools.CrashReporter\EASYTools.CrashReporter.csproj</a> (EASYTools.CrashReporter)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Controls</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Data</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Documents</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Input</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>.<span class="i n">Imaging</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Shapes</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>.<span class="i n">Mail</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>.<span class="i n">RegularExpressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>.<span class="i n">Packaging</span>;
<b>using</b> <span class="i n">Ionic</span>.<span class="i n">Zip</span>;
<b>using</b> <span class="i n">MahApps</span>.<span class="i n">Metro</span>.<span class="i n">Controls</span>;
 
<b>namespace</b> <span class="i n">EASYTools</span>.<span class="i n">CrashReporter</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Interaction logic for wdoCrashReport.xaml</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public</b> <a href="P/8ec3030a4cdd9e46.html" target="s" class="k">partial</a> <b>class</b> <a id="8ec3030a4cdd9e46" href="R/8ec3030a4cdd9e46.html" target="n" data-glyph="0,0" class="t t">wdoCrashReport</a> : <a href="/MahApps.Metro/A.html#5a37f9897ea7f8e0" class="t t">MetroWindow</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="P/8ec3030a4cdd9e46.html#8ec3030a4cdd9e46" class="t t">wdoCrashReport</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="1fb10cfce6d36e43" href="R/1fb10cfce6d36e43.html" target="n" data-glyph="72,1" class="t constructor">wdoCrashReport</a>()
        {
            <a href="obj/Debug/wdoCrashReport.g.cs.html#4e5167f5f20f8477" class="i method">InitializeComponent</a>();
        }
 
        <a href="ReportEx.cs.html#10ac1ef30451420e" class="t t">ReportEx</a> <a id="9848f74ffc6bc6c5" href="R/9848f74ffc6bc6c5.html" target="n" data-glyph="46,1" class="i field">mReportEx</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsQuit.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="63506f3d09588e54" href="R/63506f3d09588e54.html" target="n" data-glyph="42,1" class="i field">isQuit</a>=<b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="P/8ec3030a4cdd9e46.html#8ec3030a4cdd9e46" class="t t">wdoCrashReport</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">pExcep</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The p excep.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">pFromAddress</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The p from address.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">pToAddress</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The p to address.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">pSmtpCl</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The p SMTP cl.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="a3ad00d12e464850" href="R/a3ad00d12e464850.html" target="n" data-glyph="72,1" class="t constructor">wdoCrashReport</a>(<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r0 rd" class="r0 r">pExcep</span>, <a href="@0@System/A.html#b23cf10c5d2b82f1" class="t t">MailAddress</a> <span id="r1 rd" class="r1 r">pFromAddress</span>, <a href="@0@System/A.html#b23cf10c5d2b82f1" class="t t">MailAddress</a> <span id="r2 rd" class="r2 r">pToAddress</span>, <a href="@0@System/A.html#ebaa2d61cfed8051" class="t t">SmtpClient</a> <span id="r3 rd" class="r3 r">pSmtpCl</span>):<a href="#1fb10cfce6d36e43" class="k">this</a>()
        {
            <a href="obj/Debug/wdoCrashReport.g.cs.html#4e5167f5f20f8477" class="i method">InitializeComponent</a>();
            <a href="#e30104b04b5f0812" class="i property">Excep</a> = <span class="r0 r">pExcep</span>;
            <a href="#af0de9d701ae8061" class="i property">ToAddress</a> = <span class="r2 r">pToAddress</span>;
            <a href="#dd350e3288ba7c76" class="i property">FromAddress</a> = <span class="r1 r">pFromAddress</span>;
            <a href="#16f5da88af5fe138" class="i property">SmtpCl</a> = <span class="r3 r">pSmtpCl</span>;
            <a href="#e26fd1435746805e" class="i method">LoadReportEx</a>();
            <a href="P/8ec3030a4cdd9e46.html#8ec3030a4cdd9e46" class="k">this</a>.<a href="@0@PresentationFramework/A.html#5002b3a8c196a7d1" class="i property">Title</a>= <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;{0} {1} crashed&quot;</span>, <span class="i n">System</span>.<span class="i n">Reflection</span>.<a href="@0@mscorlib/A.html#73b5be5e9c2474b2" class="t t">Assembly</a>.<a href="@0@mscorlib/A.html#0b58cbf47b813b13" class="i method">GetEntryAssembly</a>().<a href="@0@mscorlib/A.html#1fd23b897ffa9a75" class="i method">GetName</a>().<a href="@0@mscorlib/A.html#917bceeed23fe2ae" class="i property">Name</a>, 
                <span class="i n">System</span>.<span class="i n">Reflection</span>.<a href="@0@mscorlib/A.html#73b5be5e9c2474b2" class="t t">Assembly</a>.<a href="@0@mscorlib/A.html#0b58cbf47b813b13" class="i method">GetEntryAssembly</a>().<a href="@0@mscorlib/A.html#1fd23b897ffa9a75" class="i method">GetName</a>().<a href="@0@mscorlib/A.html#c36677aa25838c8c" class="i property">Version</a>.<a href="@0@mscorlib/A.html#3b32a91c30a49c52" class="i method">ToString</a>());
            <span class="c">//saveFileDialog.FileName = _appTitle + &quot; &quot; + _appVersion + &quot; Crash Report&quot;;</span>
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r4 rd" class="r4 r">osArchitecture</span>;
            <b>try</b>
            {
                <span class="r4 r">osArchitecture</span> = <a href="#e4c33cadf6cdd2af" class="i method">IsOS64Bit</a>() ? <span class="s">&quot;64&quot;</span> : <span class="s">&quot;32&quot;</span>;
            }
            <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
            {
                <span class="r4 r">osArchitecture</span> = <span class="s">&quot;32/64 bit (Undetermine)&quot;</span>;
            }
            <b>if</b> (<a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#3360368484a9f131" class="i method">Exists</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;{0}\\{1}CrashScreenshot.png&quot;</span>, <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#3a7a8c72321c6e1d" class="i method">GetTempPath</a>(), <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a>)))
            {
                <span class="c">//pictureBoxScreenshot.ImageLocation = string.Format(&quot;{0}\\{1}CrashScreenshot.png&quot;, System.IO.Path.GetTempPath(), AppTitle);</span>
                <span class="c">//pictureBoxScreenshot.Show();</span>
            }
            <b>switch</b> (<a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#7ed000628190bd24" class="i property">Version</a>.<a href="@0@mscorlib/A.html#22e3177b6b55f6bc" class="i property">Major</a>)
            {
                <b>case</b> 5:
                    <b>switch</b> (<a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#7ed000628190bd24" class="i property">Version</a>.<a href="@0@mscorlib/A.html#a09c5fdb7ad8b87d" class="i property">Minor</a>)
                    {
                        <b>case</b> 0:
                            <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#e2d3a86223ef56a6" class="i property">Windows_Version</a> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#6e5f254563fed78e" class="i method">Format</a>(<span class="s">&quot;Windows 2000 {0} {1} Version {2}&quot;</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#485bad6a756afb61" class="i property">ServicePack</a>, <span class="r4 r">osArchitecture</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#7ed000628190bd24" class="i property">Version</a>);
                            <b>break</b>;
                        <b>case</b> 1:
                            <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#e2d3a86223ef56a6" class="i property">Windows_Version</a> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#6e5f254563fed78e" class="i method">Format</a>(<span class="s">&quot;Windows XP {0} {1} Version {2}&quot;</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#485bad6a756afb61" class="i property">ServicePack</a>, <span class="r4 r">osArchitecture</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#7ed000628190bd24" class="i property">Version</a>);
                            <b>break</b>;
                    }
                    <b>break</b>;
                <b>case</b> 6:
                    <b>switch</b> (<a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#7ed000628190bd24" class="i property">Version</a>.<a href="@0@mscorlib/A.html#a09c5fdb7ad8b87d" class="i property">Minor</a>)
                    {
                        <b>case</b> 0:
                            <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#e2d3a86223ef56a6" class="i property">Windows_Version</a> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#6e5f254563fed78e" class="i method">Format</a>(<span class="s">&quot;Windows Vista {0} {1} bit Version {2}&quot;</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#485bad6a756afb61" class="i property">ServicePack</a>, <span class="r4 r">osArchitecture</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#7ed000628190bd24" class="i property">Version</a>);
                            <b>break</b>;
                        <b>case</b> 1:
                            <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#e2d3a86223ef56a6" class="i property">Windows_Version</a> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#6e5f254563fed78e" class="i method">Format</a>(<span class="s">&quot;Windows 7 {0} {1} bit Version {2}&quot;</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#485bad6a756afb61" class="i property">ServicePack</a>, <span class="r4 r">osArchitecture</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#7ed000628190bd24" class="i property">Version</a>);
                            <b>break</b>;
                        <b>case</b> 2:
                            <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#e2d3a86223ef56a6" class="i property">Windows_Version</a> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#6e5f254563fed78e" class="i method">Format</a>(<span class="s">&quot;Windows 8 {0} {1} bit Version {2}&quot;</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#485bad6a756afb61" class="i property">ServicePack</a>, <span class="r4 r">osArchitecture</span>, <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#7ed000628190bd24" class="i property">Version</a>);
                            <b>break</b>;
                    }
                    <b>break</b>;
            }
        }
 
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="e26fd1435746805e" href="R/e26fd1435746805e.html" target="n" data-glyph="76,1" class="i method">LoadReportEx</a>()
        {
            <b>try</b>
            {
                <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a> = <b>new</b> <a href="ReportEx.cs.html#10ac1ef30451420e" class="t constructor">ReportEx</a>();
                <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#4ee9787bee3390ab" class="i property">DataEx</a> = <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>.<a href="@0@mscorlib/A.html#1cd5dd408a32124f" class="i property">Now</a>;
                <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#7cdcdc0bf750d8bb" class="i property">Exception_Type</a> = <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#cf7a3679f8b67db4" class="i method">GetType</a>().<a href="@0@mscorlib/A.html#3b264aebc8d4c084" class="i method">ToString</a>();
                <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#8f2e4c070fb3922f" class="i property">Stack_Trace</a> = <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#950d763693dd32d3" class="i property">StackTrace</a>.<a href="@0@mscorlib/A.html#efa5e6c14683e022" class="i method">ToString</a>();
                <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#a8bd48210ae3a416" class="i property">Source</a> = <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#c89c9e649c0d2b6c" class="i property">Source</a>.<a href="@0@mscorlib/A.html#efa5e6c14683e022" class="i method">ToString</a>();
                <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#8e2c1221eda8dfb3" class="i property">Error_Message</a> = <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>;
                <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a> = <span class="i n">System</span>.<span class="i n">Reflection</span>.<a href="@0@mscorlib/A.html#73b5be5e9c2474b2" class="t t">Assembly</a>.<a href="@0@mscorlib/A.html#0b58cbf47b813b13" class="i method">GetEntryAssembly</a>().<a href="@0@mscorlib/A.html#1fd23b897ffa9a75" class="i method">GetName</a>().<a href="@0@mscorlib/A.html#917bceeed23fe2ae" class="i property">Name</a>;
                <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#17ab574d54ebb678" class="i property">ApplicationVersione</a> = <span class="i n">System</span>.<span class="i n">Reflection</span>.<a href="@0@mscorlib/A.html#73b5be5e9c2474b2" class="t t">Assembly</a>.<a href="@0@mscorlib/A.html#0b58cbf47b813b13" class="i method">GetEntryAssembly</a>().<a href="@0@mscorlib/A.html#1fd23b897ffa9a75" class="i method">GetName</a>().<a href="@0@mscorlib/A.html#c36677aa25838c8c" class="i property">Version</a>.<a href="@0@mscorlib/A.html#3b32a91c30a49c52" class="i method">ToString</a>();
                <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#460ae3fcb9cc641f" class="i property">ImagePath</a> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;{0}\\{1}CrashScreenshot.png&quot;</span>, <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#3a7a8c72321c6e1d" class="i method">GetTempPath</a>(), <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a>);
            }
            <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r5 rd" class="r5 r">ex</span>)
            {               
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#05c83504cb63f57a" class="t constructor">ApplicationException</a>(<span class="s">&quot; &quot;</span> + <a href="#a0dce6df9ab4d65e" class="i field">mClassName</a> + <span class="s">&quot;.&quot;</span>
                    + <span class="i n">System</span>.<span class="i n">Reflection</span>.<a href="@0@mscorlib/A.html#1383b72169c6b2ae" class="t t">MethodBase</a>.<a href="@0@mscorlib/A.html#11305a9ceab0d732" class="i method">GetCurrentMethod</a>().<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a>, <span class="r5 r">ex</span>);
            }
        }
 
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Loads the library.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">libraryName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the library.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<a href="@0@mscorlib/A.html#19ddb78edbb90890" class="t constructor">DllImport</a>(<span class="s">&quot;kernel32&quot;</span>, <a href="@0@mscorlib/A.html#e0fee96b37c60a97" class="i field">SetLastError</a> = <b>true</b>, <a href="@0@mscorlib/A.html#d8513dda3a9e952f" class="i field">CallingConvention</a> = <a href="@0@mscorlib/A.html#4355426ed72dcae3" class="t t">CallingConvention</a>.<a href="@0@mscorlib/A.html#96be7cf2b5cb1397" class="i field">Winapi</a>)]
        <b>public extern static</b> <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a> <a id="8865d331b45f44d0" href="R/8865d331b45f44d0.html" target="n" data-glyph="72,1" class="i method">LoadLibrary</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r6 rd" class="r6 r">libraryName</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the proc address.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">hwnd</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The HWND.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">procedureName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the procedure.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<a href="@0@mscorlib/A.html#19ddb78edbb90890" class="t constructor">DllImport</a>(<span class="s">&quot;kernel32&quot;</span>, <a href="@0@mscorlib/A.html#e0fee96b37c60a97" class="i field">SetLastError</a> = <b>true</b>, <a href="@0@mscorlib/A.html#d8513dda3a9e952f" class="i field">CallingConvention</a> = <a href="@0@mscorlib/A.html#4355426ed72dcae3" class="t t">CallingConvention</a>.<a href="@0@mscorlib/A.html#96be7cf2b5cb1397" class="i field">Winapi</a>)]
        <b>public extern static</b> <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a> <a id="f2eb1fd64e326b4d" href="R/f2eb1fd64e326b4d.html" target="n" data-glyph="72,1" class="i method">GetProcAddress</a>(<a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a> <span id="r7 rd" class="r7 r">hwnd</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r8 rd" class="r8 r">procedureName</span>);
 
        <b>private delegate bool</b> <a id="b6d739778130bc12" href="R/b6d739778130bc12.html" target="n" data-glyph="16,1" class="t t"><span id="1794f94afae469cb">IsWow64processsDelegate</span></a>([<span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">InteropServices</span>.<a href="@0@mscorlib/A.html#ca1f72525eec46fb" class="t constructor">In</a>] <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a> <span id="r9 rd" class="r9 r">handle</span>, [<span class="i n">System</span>.<span class="i n">Runtime</span>.<span class="i n">InteropServices</span>.<a href="@0@mscorlib/A.html#fd277621fdfde8f1" class="t constructor">Out</a>] <b>out bool</b> <span id="r10 rd" class="r10 r">isWow64processs</span>);
       
        <b>private static</b> <a href="#b6d739778130bc12" class="t t">IsWow64processsDelegate</a> <a id="6dd22ef813959ada" href="R/6dd22ef813959ada.html" target="n" data-glyph="76,1" class="i method">GetIsWow64processsDelegate</a>()
        {
            <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="k">var</a> <span id="r11 rd" class="r11 r">handle</span> = <a href="#8865d331b45f44d0" class="i method">LoadLibrary</a>(<span class="s">&quot;kernel32&quot;</span>);
 
            <b>if</b> (<span class="r11 r">handle</span> != <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a>.<a href="@0@mscorlib/A.html#d46202ed9b6005b2" class="i field">Zero</a>)
            {
                <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="k">var</a> <span id="r12 rd" class="r12 r">fnPtr</span> = <a href="#f2eb1fd64e326b4d" class="i method">GetProcAddress</a>(<span class="r11 r">handle</span>, <span class="s">&quot;IsWow64processs&quot;</span>);
 
                <b>if</b> (<span class="r12 r">fnPtr</span> != <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a>.<a href="@0@mscorlib/A.html#d46202ed9b6005b2" class="i field">Zero</a>)
                {
                    <b>return</b> (<a href="#b6d739778130bc12" class="t t">IsWow64processsDelegate</a>)<a href="@0@mscorlib/A.html#489a61c84168b119" class="t t">Marshal</a>.<a href="@0@mscorlib/A.html#e940b359fbc7e97c" class="i method">GetDelegateForFunctionPointer</a>(<span class="r12 r">fnPtr</span>, <b>typeof</b>(<a href="#b6d739778130bc12" class="t t">IsWow64processsDelegate</a>));
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is32s the bit processs on64 bit processsor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="0696e6a9b720ce32" href="R/0696e6a9b720ce32.html" target="n" data-glyph="76,1" class="i method">Is32BitprocesssOn64Bitprocesssor</a>()
        {
            <a href="#b6d739778130bc12" class="t t">IsWow64processsDelegate</a> <span id="r13 rd" class="r13 r">fnDelegate</span> = <a href="#6dd22ef813959ada" class="i method">GetIsWow64processsDelegate</a>();
 
            <b>if</b> (<span class="r13 r">fnDelegate</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>bool</b> <span id="r14 rd" class="r14 r">isWow64</span>;
            <a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r15 rd" class="r15 r">retVal</span> = <span class="r13 r">fnDelegate</span>.<a href="#5c6c8934b9c3ec39" class="i method">Invoke</a>(<span class="i n">System</span>.<span class="i n">Diagnostics</span>.<a href="@0@System/A.html#f8b2e604d6f1fe04" class="t t">Process</a>.<a href="@0@System/A.html#a106ad886675f6a5" class="i method">GetCurrentProcess</a>().<a href="@0@System/A.html#41ed61685806ec61" class="i property">Handle</a>, <b>out</b> <span class="r14 r">isWow64</span>);
 
            <b>if</b> (<span class="r15 r">retVal</span> == <b>false</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <span class="r14 r">isWow64</span>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether [is O S64 bit].</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if [is O S64 bit]; otherwise, </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="e4c33cadf6cdd2af" href="R/e4c33cadf6cdd2af.html" target="n" data-glyph="72,1" class="i method">IsOS64Bit</a>()
        {
            <b>return</b> <a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a>.<a href="@0@mscorlib/A.html#25b4f94fb6dd34fe" class="i property">Size</a> == 8 || (<a href="@0@mscorlib/A.html#d99bf6ad49979009" class="t t">IntPtr</a>.<a href="@0@mscorlib/A.html#25b4f94fb6dd34fe" class="i property">Size</a> == 4 &amp;&amp; <a href="#0696e6a9b720ce32" class="i method">Is32BitprocesssOn64Bitprocesssor</a>());
        }
 
        <b>private</b> <a href="@0@System/A.html#ebaa2d61cfed8051" class="t t">SmtpClient</a> <a id="72f9114d2f4c0068" href="R/72f9114d2f4c0068.html" target="n" data-glyph="46,1" class="i field">mSmtpCl</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Property SmtpCl.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The Property SmtpCl.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@System/A.html#ebaa2d61cfed8051" class="t t">SmtpClient</a> <a id="16f5da88af5fe138" href="R/16f5da88af5fe138.html" target="n" data-glyph="102,1" class="i property">SmtpCl</a>
        {
            <b>get</b> { <b>return</b> <a href="#72f9114d2f4c0068" class="i field">mSmtpCl</a>; }
            <b>set</b> { <a href="#72f9114d2f4c0068" class="i field">mSmtpCl</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="@0@System/A.html#b23cf10c5d2b82f1" class="t t">MailAddress</a> <a id="ebb33e39bc81ed61" href="R/ebb33e39bc81ed61.html" target="n" data-glyph="46,1" class="i field">mToAddress</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Property ToAddress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The Property ToAddress.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@System/A.html#b23cf10c5d2b82f1" class="t t">MailAddress</a> <a id="af0de9d701ae8061" href="R/af0de9d701ae8061.html" target="n" data-glyph="102,1" class="i property">ToAddress</a>
        {
            <b>get</b> { <b>return</b> <a href="#ebb33e39bc81ed61" class="i field">mToAddress</a>; }
            <b>set</b> { <a href="#ebb33e39bc81ed61" class="i field">mToAddress</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="@0@System/A.html#b23cf10c5d2b82f1" class="t t">MailAddress</a> <a id="88f876be81f66316" href="R/88f876be81f66316.html" target="n" data-glyph="46,1" class="i field">mFromAddress</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Property FromAddress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The Property FromAddress.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@System/A.html#b23cf10c5d2b82f1" class="t t">MailAddress</a> <a id="dd350e3288ba7c76" href="R/dd350e3288ba7c76.html" target="n" data-glyph="102,1" class="i property">FromAddress</a>
        {
            <b>get</b> { <b>return</b> <a href="#88f876be81f66316" class="i field">mFromAddress</a>; }
            <b>set</b> { <a href="#88f876be81f66316" class="i field">mFromAddress</a> = <b>value</b>; }
        }
        <b>private</b> <a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <a id="09477b5c8523caac" href="R/09477b5c8523caac.html" target="n" data-glyph="46,1" class="i field">mExcep</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Property Excep.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The Property Excep.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <a id="e30104b04b5f0812" href="R/e30104b04b5f0812.html" target="n" data-glyph="102,1" class="i property">Excep</a>
        {
            <b>get</b> { <b>return</b> <a href="#09477b5c8523caac" class="i field">mExcep</a>; }
            <b>set</b> { <a href="#09477b5c8523caac" class="i field">mExcep</a> = <b>value</b>; }
        }
 
        <b>private void</b> <a id="5795b91748f5160c" href="R/5795b91748f5160c.html" target="n" data-glyph="76,1" class="i method">btn_Click</a>(<b>object</b> <span id="r16 rd" class="r16 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r17 rd" class="r17 r">e</span>)
        {
            <a href="@0@mscorlib/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r18 rd" class="r18 r">mess1</span> = <b>new</b> <a href="@0@mscorlib/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();
            <b>switch</b> (((<a href="@0@PresentationFramework/A.html#bfc2d93e5b6e9a96" class="t t">Button</a>)<span class="r16 r">sender</span>).<a href="@0@PresentationFramework/A.html#1d519a9bdfa176e6" class="i property">Name</a>)
            {
                <b>case</b> <span class="s">&quot;btnSendReport&quot;</span>:
                    <a href="@0@PresentationCore/A.html#580181d27512685c" class="t t">Mouse</a>.<a href="@0@PresentationCore/A.html#1400f4c4e69963ac" class="i property">OverrideCursor</a> = <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Input</span>.<a href="@0@PresentationCore/A.html#09092748875d5e78" class="t t">Cursors</a>.<a href="@0@PresentationCore/A.html#24959022806807f4" class="i property">Wait</a>;
 
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r19 rd" class="r19 r">mess</span> = <span class="s">@&quot;Crash report by &quot;</span> + <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a> + <span class="s">&quot; &quot;</span> + <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#17ab574d54ebb678" class="i property">ApplicationVersione</a>;
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r20 rd" class="r20 r">subject</span>;           
                    <span class="r20 r">subject</span> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;{0} {1} Crash Report&quot;</span>, <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a>, <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#17ab574d54ebb678" class="i property">ApplicationVersione</a>);
 
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a> + <span class="s">&quot; &quot;</span> + <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#17ab574d54ebb678" class="i property">ApplicationVersione</a> + <span class="s">&quot; Crash Report&quot;</span> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#4ee9787bee3390ab" class="i property">DataEx</a>.<a href="@0@mscorlib/A.html#11d38858dedad166" class="i method">ToString</a>() + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;****************************************************&quot;</span> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Exception Type:  &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#cf7a3679f8b67db4" class="i method">GetType</a>() + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Windows Version: &quot;</span> + <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#e2d3a86223ef56a6" class="i property">Windows_Version</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Error Message:   &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;InnerException:  &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#89c20b39fb04108b" class="i property">InnerException</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Source:          &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#c89c9e649c0d2b6c" class="i property">Source</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Stack Trace:     &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#950d763693dd32d3" class="i property">StackTrace</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;****************************************************&quot;</span> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot; User Message:    &quot;</span> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#04d116a29a2c8f43" class="i property">MessageForUser</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
 
                    <span class="c">//MailMessage message = new MailMessage(FromAddress, ToAddress)</span>
                    <span class="c">//{</span>
                    <span class="c">//    Subject = subject,</span>
                    <span class="c">//    Body = mess1.ToString(),</span>
                    <span class="c">//};</span>
                    <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#7d5e5cde5fa8cb0d" class="i method">SaveToXMLFile</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;{0}\\{1}CrashScreenshot.xml&quot;</span>, <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#3a7a8c72321c6e1d" class="i method">GetTempPath</a>(), <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a>));
 
                    <span class="c">//if (File.Exists(string.Format(&quot;{0}\\{1}CrashScreenshot.xml&quot;, System.IO.Path.GetTempPath(), mReportEx.ApplicationName)))</span>
                    <span class="c">//{</span>
                    <span class="c">//    message.Attachments.Add(new Attachment(string.Format(&quot;{0}\\{1}CrashScreenshot.xml&quot;, System.IO.Path.GetTempPath(), </span>
                    <span class="c">//    mReportEx.ApplicationName)));</span>
                    <span class="c">//}</span>
                    <span class="c">//if (File.Exists(string.Format(&quot;{0}\\{1}CrashScreenshot.png&quot;, System.IO.Path.GetTempPath(), mReportEx.ApplicationName)))</span>
                    <span class="c">//{</span>
                    <span class="c">//    message.Attachments.Add(new Attachment(string.Format(&quot;{0}\\{1}CrashScreenshot.png&quot;, System.IO.Path.GetTempPath(), mReportEx.ApplicationName)));</span>
                    <span class="c">//}</span>
                    <span class="c">//const string crashReport = &quot;Crash report&quot;;</span>
 
                    <span class="c">//SmtpCl.SendCompleted += new SendCompletedEventHandler(SmtpCl_SendCompleted);</span>
                    <span class="c">//SmtpCl.SendAsync(message, crashReport);</span>
                    <span class="c">//----------------------------------------------------------</span>
                    <span class="c">//string userName = System.Security.Principal.WindowsIdentity.GetCurrent().Name;</span>
 
                    <a href="@0@System/A.html#f2761ed0ab9eca88" class="k">var</a> <span id="r21 rd" class="r21 r">mailMessage</span> = <b>new</b> <a href="@0@System/A.html#90c65893552c77f0" class="t constructor">MailMessage</a>(<a href="#dd350e3288ba7c76" class="i property">FromAddress</a>, <a href="#af0de9d701ae8061" class="i property">ToAddress</a>);
                    <span class="c">////mailMessage.From = new MailAddress(&quot;someone@yourdomain.com&quot;);</span>
                    <span class="c">//mailMessage.From = new MailAddress(FromAddress.Address);</span>
                    <span class="c">//mailMessage.Subject = &quot;Your subject here&quot;;</span>
                    <span class="r21 r">mailMessage</span>.<a href="@0@System/A.html#261883959dfc71bd" class="i property">Subject</a> = <span class="r20 r">subject</span>;
                    <span class="r21 r">mailMessage</span>.<a href="@0@System/A.html#c64a0d2b355eb3ad" class="i property">IsBodyHtml</a> = <b>true</b>;
                    <span class="c">//mailMessage.Body = &quot;&lt;span style=&#39;font-size: 12pt; color: red;&#39;&gt;My HTML formatted body&lt;/span&gt;&quot;;</span>
                    <span class="r21 r">mailMessage</span>.<a href="@0@System/A.html#8a4fd36de4145dc5" class="i property">Body</a> = <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>();
 
                    <span class="c">//mailMessage.Attachments.Add(new Attachment(&quot;C://Myfile.pdf&quot;));</span>
                    <b>if</b> (<a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#3360368484a9f131" class="i method">Exists</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;{0}\\{1}CrashScreenshot.xml&quot;</span>, <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#3a7a8c72321c6e1d" class="i method">GetTempPath</a>(), <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a>)))
                    {
                        <span class="r21 r">mailMessage</span>.<a href="@0@System/A.html#4744c5d4ebe3752c" class="i property">Attachments</a>.<a href="@0@mscorlib/A.html#5c61cc24de82f7e7" class="i method">Add</a>(<b>new</b> <a href="@0@System/A.html#64f23a50184edbc9" class="t constructor">Attachment</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;{0}\\{1}CrashScreenshot.xml&quot;</span>, <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#3a7a8c72321c6e1d" class="i method">GetTempPath</a>(),
                        <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a>)));
                    }
 
                    <b>if</b> (<a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#3360368484a9f131" class="i method">Exists</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;{0}\\{1}CrashScreenshot.png&quot;</span>, <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#3a7a8c72321c6e1d" class="i method">GetTempPath</a>(), <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a>)))
                    {
                        <span class="r21 r">mailMessage</span>.<a href="@0@System/A.html#4744c5d4ebe3752c" class="i property">Attachments</a>.<a href="@0@mscorlib/A.html#5c61cc24de82f7e7" class="i method">Add</a>(<b>new</b> <a href="@0@System/A.html#64f23a50184edbc9" class="t constructor">Attachment</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;{0}\\{1}CrashScreenshot.png&quot;</span>, <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#3a7a8c72321c6e1d" class="i method">GetTempPath</a>(), <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a>)));
                    }
 
                    <span class="c">//var filename = &quot;C://Temp/mymessage.eml&quot;;</span>
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r22 rd" class="r22 r">filename</span> = <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#3a7a8c72321c6e1d" class="i method">GetTempPath</a>()+<span class="s">&quot;/mymessage.eml&quot;</span>;
                    <span class="c">//save the MailMessage to the filesystem</span>
                    <span class="r21 r">mailMessage</span>.<a href="MailUtility.cs.html#bb1107636fc35c40" class="i method">Save</a>(<span class="r22 r">filename</span>);
 
                    <span class="c">//Open the file with the default associated application registered on the local machine</span>
                    <a href="@0@System/A.html#f8b2e604d6f1fe04" class="t t">Process</a>.<a href="@0@System/A.html#5a01d1705abb24d6" class="i method">Start</a>(<span class="r22 r">filename</span>);
 
                    <span class="r21 r">mailMessage</span>.<a href="@0@System/A.html#149b686c70a3e745" class="i method">Dispose</a>();
                    <span class="c">//--------------------------------------------------------</span>
                    <a href="@0@PresentationCore/A.html#580181d27512685c" class="t t">Mouse</a>.<a href="@0@PresentationCore/A.html#1400f4c4e69963ac" class="i property">OverrideCursor</a> = <b>null</b>;
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;btnSaveReport&quot;</span>:
                    <a href="#5692ef85e7064ff9" class="i method">SaveReport</a>();
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;btnAnnulla&quot;</span>:
                    <a href="P/8ec3030a4cdd9e46.html#8ec3030a4cdd9e46" class="k">this</a>.<a href="@0@PresentationFramework/A.html#9eff3c5633604c43" class="i method">Close</a>();
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;btnCopy&quot;</span>:
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a> + <span class="s">&quot; &quot;</span> + <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#17ab574d54ebb678" class="i property">ApplicationVersione</a> + <span class="s">&quot; Crash Report&quot;</span> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#4ee9787bee3390ab" class="i property">DataEx</a>.<a href="@0@mscorlib/A.html#11d38858dedad166" class="i method">ToString</a>() + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;****************************************************&quot;</span> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Exception Type:  &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#cf7a3679f8b67db4" class="i method">GetType</a>() + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Windows Version: &quot;</span> + <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#e2d3a86223ef56a6" class="i property">Windows_Version</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Error Message:   &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;InnerException:  &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#89c20b39fb04108b" class="i property">InnerException</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Source:          &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#c89c9e649c0d2b6c" class="i property">Source</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;Stack Trace:     &quot;</span> + <a href="#e30104b04b5f0812" class="i property">Excep</a>.<a href="@0@mscorlib/A.html#950d763693dd32d3" class="i property">StackTrace</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot;****************************************************&quot;</span> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<span class="s">&quot; User Message:   &quot;</span> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                    <span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#73bc75596acbac77" class="i method">AppendLine</a>(<a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#04d116a29a2c8f43" class="i property">MessageForUser</a> + <span class="s">&quot;&lt;br&gt;&quot;</span>);
 
                    <a href="@0@PresentationCore/A.html#bb14b599507febfc" class="t t">Clipboard</a>.<a href="@0@PresentationCore/A.html#d31b87b662282548" class="i method">SetText</a>(<span class="r18 r">mess1</span>.<a href="@0@mscorlib/A.html#5a97da49a158a3c9" class="i method">ToString</a>());
                    <span class="c">//this.Close();</span>
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;btnQuit&quot;</span>:
                    <a href="#63506f3d09588e54" class="i field">isQuit</a> = <b>true</b>;
                    <a href="P/8ec3030a4cdd9e46.html#8ec3030a4cdd9e46" class="k">this</a>.<a href="@0@PresentationFramework/A.html#9eff3c5633604c43" class="i method">Close</a>();
                    <b>break</b>;
                <b>default</b>:
                    <b>break</b>;
            }
        }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="5692ef85e7064ff9" href="R/5692ef85e7064ff9.html" target="n" data-glyph="76,1" class="i method">SaveReport</a>()
        {
            <b>try</b>
            {
                <span class="i n">Microsoft</span>.<span class="i n">Win32</span>.<a href="@0@PresentationFramework/A.html#1cc3303b6fe0d095" class="t t">SaveFileDialog</a> <span id="r23 rd" class="r23 r">CReport</span> = <b>new</b> <span class="i n">Microsoft</span>.<span class="i n">Win32</span>.<a href="@0@PresentationFramework/A.html#809a6b4d2cea3900" class="t constructor">SaveFileDialog</a>();
                <span class="r23 r">CReport</span>.<a href="@0@PresentationFramework/A.html#a11e062052c3f85d" class="i property">DefaultExt</a> = <span class="s">&quot;.xml&quot;</span>;
                <span class="r23 r">CReport</span>.<a href="@0@PresentationFramework/A.html#592779c62eeddaa8" class="i property">Filter</a> = <span class="s">&quot;CrashReport (.xml)|*.xml&quot;</span>;
                <a href="@0@mscorlib/A.html#ffebe438fd9cbf0e" class="t t">Nullable</a>&lt;<b>bool</b>&gt; <span id="r24 rd" class="r24 r">result</span> = <span class="r23 r">CReport</span>.<a href="@0@PresentationFramework/A.html#6ac596e833103ec6" class="i method">ShowDialog</a>();
                <b>if</b> (<span class="r24 r">result</span> == <b>true</b>)
                {
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r25 rd" class="r25 r">onlyFileName</span> = <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#e36b3edc1f3e2c8d" class="i method">GetFileNameWithoutExtension</a>(<span class="r23 r">CReport</span>.<a href="@0@PresentationFramework/A.html#df29941779e9aecf" class="i property">FileName</a>);
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r26 rd" class="r26 r">folderPath</span> = <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#f9128b02ffd0d3ea" class="i method">GetDirectoryName</a>(<span class="r23 r">CReport</span>.<a href="@0@PresentationFramework/A.html#df29941779e9aecf" class="i property">FileName</a>);
 
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r27 rd" class="r27 r">XMLFileName</span> = <span class="r26 r">folderPath</span> + <span class="s">&quot;\\&quot;</span> + <span class="r25 r">onlyFileName</span> + <span class="s">&quot;_&quot;</span> + <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>.<a href="@0@mscorlib/A.html#1cd5dd408a32124f" class="i property">Now</a>.<a href="@0@mscorlib/A.html#5088b43558351160" class="i method">ToString</a>(<span class="s">&quot;yyyyMMdd_HHmm&quot;</span>) + <span class="s">&quot;.xml&quot;</span>;
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r28 rd" class="r28 r">screenShotPath</span> = <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#3a7a8c72321c6e1d" class="i method">GetTempPath</a>() + <span class="s">&quot;EASYTools.CrashReporter.TestCrashScreenshot.png&quot;</span>;
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r29 rd" class="r29 r">pictureFileName</span>=<span class="r26 r">folderPath</span> + <span class="s">&quot;\\&quot;</span> + <span class="r25 r">onlyFileName</span> + <span class="s">&quot;_&quot;</span> + <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>.<a href="@0@mscorlib/A.html#1cd5dd408a32124f" class="i property">Now</a>.<a href="@0@mscorlib/A.html#5088b43558351160" class="i method">ToString</a>(<span class="s">&quot;yyyyMMdd_HHmm&quot;</span>) + <span class="s">&quot;.png&quot;</span>;
                    <span class="c">//string ZIPFileName = folderPath + &quot;\\&quot; + onlyFileName + &quot;_&quot; + DateTime.Now.ToString(&quot;yyyyMMdd_HHmm&quot;) + &quot;.zip&quot;;</span>
                    <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r30 rd" class="r30 r">ZIPFileName</span> = <span class="r26 r">folderPath</span> + <span class="s">&quot;\\&quot;</span> + <span class="r25 r">onlyFileName</span> + <span class="s">&quot;_&quot;</span> + <a href="@0@mscorlib/A.html#df6b1eba7461813b" class="t t">DateTime</a>.<a href="@0@mscorlib/A.html#1cd5dd408a32124f" class="i property">Now</a>.<a href="@0@mscorlib/A.html#5088b43558351160" class="i method">ToString</a>(<span class="s">&quot;yyyyMMdd_HHmm&quot;</span>) + <span class="s">&quot;.zip&quot;</span>;
 
                    <b>if</b> (<a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#3360368484a9f131" class="i method">Exists</a>(<span class="r27 r">XMLFileName</span>))
                    {
                        <a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#c4e7406e837331d5" class="i method">Delete</a>(<span class="r27 r">XMLFileName</span>);
                    }
                    <b>if</b> (<a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#3360368484a9f131" class="i method">Exists</a>(<span class="r29 r">pictureFileName</span>))
                    {
                        <a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#c4e7406e837331d5" class="i method">Delete</a>(<span class="r29 r">pictureFileName</span>);
                    }
                    <b>if</b> (<a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#3360368484a9f131" class="i method">Exists</a>(<span class="r30 r">ZIPFileName</span>))
                    {
                        <a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#c4e7406e837331d5" class="i method">Delete</a>(<span class="r30 r">ZIPFileName</span>);
                    }
 
                    <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#7d5e5cde5fa8cb0d" class="i method">SaveToXMLFile</a>(<span class="r27 r">XMLFileName</span>);
                    <b>if</b> (<a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#3360368484a9f131" class="i method">Exists</a>(<span class="r28 r">screenShotPath</span>))
                    {
                        <a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#5316fbd411f08f1d" class="i method">Copy</a>(<span class="r28 r">screenShotPath</span>, <span class="r29 r">pictureFileName</span>);
                    }
 
                    <span class="c">//ZipFile zip = new ZipFile(onlyFileName+&quot;.zip&quot;);</span>
                    <span class="t t">ZipFile</span> <span id="r31 rd" class="r31 r">zip</span> = <b>new</b> <span class="t constructor">ZipFile</span>(<span class="r30 r">ZIPFileName</span>);
                    <b>if</b> (<a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#3360368484a9f131" class="i method">Exists</a>(<span class="r27 r">XMLFileName</span>))
                    {
                        <span class="c">//AddFileToZip(ZIPFileName, XMLFileName);</span>
                        <span class="r31 r">zip</span>.<span class="i method">AddFile</span>(<span class="r27 r">XMLFileName</span>,<span class="s">&quot;.&quot;</span>);
                    }
                    <b>if</b> (<a href="@0@mscorlib/A.html#1c7421e464f67b7e" class="t t">File</a>.<a href="@0@mscorlib/A.html#3360368484a9f131" class="i method">Exists</a>(<span class="r29 r">pictureFileName</span>))
                    {
                        <span class="c">//AddFileToZip(ZIPFileName, pictureFileName);</span>
                        <span class="r31 r">zip</span>.<span class="i method">AddFile</span>(<span class="r29 r">pictureFileName</span>, <span class="s">&quot;.&quot;</span>);
                    }
                    <span class="r31 r">zip</span>.<span class="i method">Save</span>();
                    <span class="r31 r">zip</span>.<span class="i method">Dispose</span>();
 
                }   
            }
            <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r32 rd" class="r32 r">ex</span>)
            {
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#05c83504cb63f57a" class="t constructor">ApplicationException</a>(<span class="s">&quot; &quot;</span> + <a href="#a0dce6df9ab4d65e" class="i field">mClassName</a> + <span class="s">&quot;.&quot;</span>
                    + <span class="i n">System</span>.<span class="i n">Reflection</span>.<a href="@0@mscorlib/A.html#1383b72169c6b2ae" class="t t">MethodBase</a>.<a href="@0@mscorlib/A.html#11305a9ceab0d732" class="i method">GetCurrentMethod</a>().<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a>, <span class="r32 r">ex</span>);
            }
        }
 
        <b>private const long</b> <a id="cfd67d53e0976bd5" href="R/cfd67d53e0976bd5.html" target="n" data-glyph="10,1" class="i field">BUFFER_SIZE</a> = 4096;
 
        <b>private static void</b> <a id="65a58ce87d7e22ba" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AddFileToZip</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r33 rd" class="r33 r">zipFilename</span>, <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r34 rd" class="r34 r">fileToAdd</span>)
        {
            <b>using</b> (<a href="@0@WindowsBase/A.html#fe33e1006e363b7e" class="t t">Package</a> <span id="r35 rd" class="r35 r">zip</span> = <span class="i n">System</span>.<span class="i n">IO</span>.<span class="i n">Packaging</span>.<a href="@0@WindowsBase/A.html#fe33e1006e363b7e" class="t t">Package</a>.<a href="@0@WindowsBase/A.html#5d2456020064c9bd" class="i method">Open</a>(<span class="r33 r">zipFilename</span>, <a href="@0@mscorlib/A.html#c0cb6ba6af625b3a" class="t t">FileMode</a>.<a href="@0@mscorlib/A.html#80a500db887477f8" class="i field">OpenOrCreate</a>))
            {
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r36 rd" class="r36 r">destFilename</span> = <span class="s">&quot;.\\&quot;</span> + <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#090eca8621a248ee" class="t t">Path</a>.<a href="@0@mscorlib/A.html#95facc58d06cadd0" class="i method">GetFileName</a>(<span class="r34 r">fileToAdd</span>);
                <a href="@0@System/A.html#991565dd25f47c90" class="t t">Uri</a> <span id="r37 rd" class="r37 r">uri</span> = <a href="@0@WindowsBase/A.html#a803377c3482cea5" class="t t">PackUriHelper</a>.<a href="@0@WindowsBase/A.html#5daf389cf60f7b14" class="i method">CreatePartUri</a>(<b>new</b> <a href="@0@System/A.html#d9fc45d783ee73ff" class="t constructor">Uri</a>(<span class="r36 r">destFilename</span>, <a href="@0@System/A.html#ac43655101ad74be" class="t t">UriKind</a>.<a href="@0@System/A.html#c6d780fc34e3f702" class="i field">Relative</a>));
                <b>if</b> (<span class="r35 r">zip</span>.<a href="@0@WindowsBase/A.html#11aa4f03cdfbfd60" class="i method">PartExists</a>(<span class="r37 r">uri</span>))
                {
                    <span class="r35 r">zip</span>.<a href="@0@WindowsBase/A.html#4c25d0b20832faca" class="i method">DeletePart</a>(<span class="r37 r">uri</span>);
                }
                <a href="@0@WindowsBase/A.html#45edbdb1a278f92d" class="t t">PackagePart</a> <span id="r38 rd" class="r38 r">part</span> = <span class="r35 r">zip</span>.<a href="@0@WindowsBase/A.html#50e5d09bff636fef" class="i method">CreatePart</a>(<span class="r37 r">uri</span>, <span class="s">&quot;&quot;</span>, <a href="@0@WindowsBase/A.html#e08e51fc6bbc2d4c" class="t t">CompressionOption</a>.<a href="@0@WindowsBase/A.html#6ff99140b098b5ba" class="i field">Normal</a>);
                <b>using</b> (<a href="@0@mscorlib/A.html#e23a38af5d11ddd3" class="t t">FileStream</a> <span id="r39 rd" class="r39 r">fileStream</span> = <b>new</b> <a href="@0@mscorlib/A.html#234a29d0d3012e5c" class="t constructor">FileStream</a>(<span class="r34 r">fileToAdd</span>, <a href="@0@mscorlib/A.html#c0cb6ba6af625b3a" class="t t">FileMode</a>.<a href="@0@mscorlib/A.html#f4421e1d202f76fa" class="i field">Open</a>, <a href="@0@mscorlib/A.html#5cc5644ae3acd24b" class="t t">FileAccess</a>.<a href="@0@mscorlib/A.html#0f1c68c756d0636b" class="i field">Read</a>))
                {
                    <b>using</b> (<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r40 rd" class="r40 r">dest</span> = <span class="r38 r">part</span>.<a href="@0@WindowsBase/A.html#aa00933b816cf234" class="i method">GetStream</a>())
                    {
                        <a href="#ae6e9a527c471a48" class="i method">CopyStream</a>(<span class="r39 r">fileStream</span>, <span class="r40 r">dest</span>);
                    }
                }
            }
        }
 
        <b>private static void</b> <a id="ae6e9a527c471a48" href="R/ae6e9a527c471a48.html" target="n" data-glyph="76,1" class="i method">CopyStream</a>(<span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#e23a38af5d11ddd3" class="t t">FileStream</a> <span id="r41 rd" class="r41 r">inputStream</span>, <span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#f956b0c07e86df64" class="t t">Stream</a> <span id="r42 rd" class="r42 r">outputStream</span>)
        {
            <b>long</b> <span id="r43 rd" class="r43 r">bufferSize</span> = <span class="r41 r">inputStream</span>.<a href="@0@mscorlib/A.html#fa88edfdb51ed91c" class="i property">Length</a> &lt; <a href="#cfd67d53e0976bd5" class="i field">BUFFER_SIZE</a> ? <span class="r41 r">inputStream</span>.<a href="@0@mscorlib/A.html#fa88edfdb51ed91c" class="i property">Length</a> : <a href="#cfd67d53e0976bd5" class="i field">BUFFER_SIZE</a>;
            <b>byte</b>[] <span id="r44 rd" class="r44 r">buffer</span> = <b>new</b> <b>byte</b>[<span class="r43 r">bufferSize</span>];
            <b>int</b> <span id="r45 rd" class="r45 r">bytesRead</span> = 0;
            <b>long</b> <span id="r46 rd" class="r46 r">bytesWritten</span> = 0;
            <b>while</b> ((<span class="r45 r">bytesRead</span> = <span class="r41 r">inputStream</span>.<a href="@0@mscorlib/A.html#f54c954df34d7a92" class="i method">Read</a>(<span class="r44 r">buffer</span>, 0, <span class="r44 r">buffer</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)) != 0)
            {
                <span class="r42 r">outputStream</span>.<a href="@0@mscorlib/A.html#809202cd37ae53a9" class="i method">Write</a>(<span class="r44 r">buffer</span>, 0, <span class="r45 r">bytesRead</span>);
                <span class="r46 r">bytesWritten</span> += <span class="r45 r">bytesRead</span>;
            }
        }
 
        <b>private string</b> <a id="e6d5f8e9e6b93b6e" href="R/e6d5f8e9e6b93b6e.html" target="n" data-glyph="46,1" class="i field">mWindowsVersion</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Property WindowsVersion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The Property WindowsVersion.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="255874f56dc37566" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">WindowsVersion</a>
        {
            <b>get</b> { <b>return</b> <a href="#e6d5f8e9e6b93b6e" class="i field">mWindowsVersion</a>; }
            <b>set</b> { <a href="#e6d5f8e9e6b93b6e" class="i field">mWindowsVersion</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>void</b> <a id="8742dbfbf3e0dfc6" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SmtpCl_SendCompleted</a>(<b>object</b> <span id="r47 rd" class="r47 r">sender</span>, <span class="i n">System</span>.<span class="i n">ComponentModel</span>.<a href="@0@System/A.html#980c700ea7987b02" class="t t">AsyncCompletedEventArgs</a> <span id="r48 rd" class="r48 r">e</span>)
        {
            <b>if</b> (<span class="r48 r">e</span>.<a href="@0@System/A.html#ba3ecd676e414bfc" class="i property">Error</a> != <b>null</b>)
            {
                <a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#27a5faa8fab7f6ba" class="i method">Show</a>(<span class="r48 r">e</span>.<a href="@0@System/A.html#ba3ecd676e414bfc" class="i property">Error</a>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>, <span class="r48 r">e</span>.<a href="@0@System/A.html#ba3ecd676e414bfc" class="i property">Error</a>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>(), <a href="@0@PresentationFramework/A.html#57cf33522d50233a" class="t t">MessageBoxButton</a>.<a href="@0@PresentationFramework/A.html#6f4d7963ffc6793b" class="i field">OK</a>, <a href="@0@PresentationFramework/A.html#26947fb9108271b2" class="t t">MessageBoxImage</a>.<a href="@0@PresentationFramework/A.html#bb06bda657335264" class="i field">Error</a>);
            }
            <b>else</b>
            {
                <a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#27a5faa8fab7f6ba" class="i method">Show</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;Crash report di {0} {1} is sent to the developer. Grazie per il supporto.&quot;</span>, <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#ce8363fb2f5e761c" class="i property">ApplicationName</a>,
                   <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>.<a href="ReportEx.cs.html#17ab574d54ebb678" class="i property">ApplicationVersione</a>), <span class="s">&quot;Crash report Inviato&quot;</span>, <a href="@0@PresentationFramework/A.html#57cf33522d50233a" class="t t">MessageBoxButton</a>.<a href="@0@PresentationFramework/A.html#6f4d7963ffc6793b" class="i field">OK</a>, <a href="@0@PresentationFramework/A.html#26947fb9108271b2" class="t t">MessageBoxImage</a>.<a href="@0@PresentationFramework/A.html#b7a101ba7eeff4cc" class="i field">Information</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Field
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Nome della classe usato per debug nella generazione delle eccezioni </span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly static string</b> <a id="a0dce6df9ab4d65e" href="R/a0dce6df9ab4d65e.html" target="n" data-glyph="46,1" class="i field">mClassName</a> = <span class="i n">System</span>.<span class="i n">Reflection</span>.<a href="@0@mscorlib/A.html#1383b72169c6b2ae" class="t t">MethodBase</a>.<a href="@0@mscorlib/A.html#11305a9ceab0d732" class="i method">GetCurrentMethod</a>().<a href="@0@mscorlib/A.html#212afcb9b0002edf" class="i property">ReflectedType</a>.<a href="@0@mscorlib/A.html#aa4f112f79364b6e" class="i property">Name</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private void</b> <a id="e7e35aaaa2723c04" href="R/e7e35aaaa2723c04.html" target="n" data-glyph="76,1" class="i method">Window_Loaded</a>(<b>object</b> <span id="r49 rd" class="r49 r">sender</span>, <a href="@0@PresentationCore/A.html#3089ebf2139eba9d" class="t t">RoutedEventArgs</a> <span id="r50 rd" class="r50 r">e</span>)
        {
            <a href="P/8ec3030a4cdd9e46.html#8ec3030a4cdd9e46" class="k">this</a>.<a href="@0@PresentationFramework/A.html#e4aaca7514916173" class="i property">DataContext</a> = <a href="#9848f74ffc6bc6c5" class="i field">mReportEx</a>;
 
            <span class="c">//textBoxApplicationName.Text = _appTitle;</span>
            <span class="c">//textBoxApplicationVersion.Text = _appVersion;</span>
            <span class="c">//textBoxMessage.Text = _exception.Message;</span>
            <span class="c">//textBoxTime.Text = DateTime.Now.ToString(CultureInfo.InvariantCulture);</span>
            <span class="c">//textBoxSource.Text = _exception.Source;</span>
            <span class="c">//textBoxStackTrace.Text = string.Format(&quot;{0}\n{1}&quot;, _exception.InnerException, _exception.StackTrace);</span>
        }
    }
}
</pre></td></tr></table></div></body></html>
