<!DOCTYPE html>
<html><head><title>HtmlFromXamlConverter.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(577);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#HtmlToXamlDemo/HtmlFromXamlConverter.cs" target="_top">HtmlFromXamlConverter.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#HtmlToXamlDemo" target="_top">HelpProjects\WPF-MORE\Sample Applications\HtmlToXamlDemo\HtmlToXamlDemo.csproj</a> (HtmlToXamlDemo)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// // Copyright (c) Microsoft. All rights reserved.</span>
<span class="c">// // Licensed under the MIT license. See LICENSE file in the project root for full license information.</span>

<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Xml</span>;

<b>namespace</b> <span class="i n">HtmlToXamlDemo</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     HtmlToXamlConverter is a static class that takes an HTML string</span>
    <span class="c">///</span><span class="c">     and converts it into XAML</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="cf44709be3d8032c" href="R/cf44709be3d8032c.html" target="n" data-glyph="2,0" class="t t">HtmlFromXamlConverter</a>
    {
        <span class="c">// ---------------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Internal Methods</span>
        <span class="c">//</span>
        <span class="c">// ---------------------------------------------------------------------</span>

        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Main entry point for Xaml-to-Html converter.</span>
        <span class="c">///</span><span class="c">     Converts a xaml string into html string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">xamlString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Xaml strinng to convert.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Html string produced from a source xaml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="1611f05387c065bb" href="R/1611f05387c065bb.html" target="n" data-glyph="74,1" class="i method">ConvertXamlToHtml</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r0 rd" class="r0 r">xamlString</span>)
        {
            <span class="t t">XmlTextReader</span> <span id="r1 rd" class="r1 r">xamlReader</span>;
            <a href="@1@System.Runtime/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r2 rd" class="r2 r">htmlStringBuilder</span>;
            <span class="t t">XmlTextWriter</span> <span id="r3 rd" class="r3 r">htmlWriter</span>;

            <span class="r1 r">xamlReader</span> = <b>new</b> <span class="t constructor">XmlTextReader</span>(<b>new</b> <span class="t constructor">StringReader</span>(<span class="r0 r">xamlString</span>));

            <span class="r2 r">htmlStringBuilder</span> = <b>new</b> <a href="@1@System.Runtime/A.html#ec674e2123a44860" class="t constructor">StringBuilder</a>(100);
            <span class="r3 r">htmlWriter</span> = <b>new</b> <a href="HtmlEncodedTextWriter.cs.html#7f7bc81fdd5e9ad8" class="t constructor">HtmlEncodedTextWriter</a>(<b>new</b> <span class="t constructor">StringWriter</span>(<span class="r2 r">htmlStringBuilder</span>));

            <b>if</b> (!<a href="#313fd6fcecac3e29" class="i method">WriteFlowDocument</a>(<span class="r1 r">xamlReader</span>, <span class="r3 r">htmlWriter</span>))
            {
                <b>return</b> <span class="s">&quot;&quot;</span>;
            }

            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r4 rd" class="r4 r">htmlString</span> = <span class="r2 r">htmlStringBuilder</span>.<a href="@1@System.Runtime/A.html#5a97da49a158a3c9" class="i method">ToString</a>();

            <b>return</b> <span class="r4 r">htmlString</span>;
        }

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Methods

        <span class="c">// ---------------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Private Methods</span>
        <span class="c">//</span>
        <span class="c">// ---------------------------------------------------------------------</span>

        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Processes a root level element of XAML (normally it&#39;s FlowDocument element).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     XmlTextReader for a source xaml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">htmlWriter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     XmlTextWriter producing resulting html</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="313fd6fcecac3e29" href="R/313fd6fcecac3e29.html" target="n" data-glyph="76,1" class="i method">WriteFlowDocument</a>(<span class="t t">XmlTextReader</span> <span id="r5 rd" class="r5 r">xamlReader</span>, <span class="t t">XmlTextWriter</span> <span id="r6 rd" class="r6 r">htmlWriter</span>)
        {
            <b>if</b> (!<a href="#1c0a8899fc6bfcf7" class="i method">ReadNextToken</a>(<span class="r5 r">xamlReader</span>))
            {
                <span class="c">// Xaml content is empty - nothing to convert</span>
                <b>return</b> <b>false</b>;
            }

            <b>if</b> (<span class="r5 r">xamlReader</span>.<span class="i property">NodeType</span> != <span class="t t">XmlNodeType</span>.<span class="i field">Element</span> || <span class="r5 r">xamlReader</span>.<span class="i property">Name</span> != <span class="s">&quot;FlowDocument&quot;</span>)
            {
                <span class="c">// Root FlowDocument elemet is missing</span>
                <b>return</b> <b>false</b>;
            }

            <span class="c">// Create a buffer StringBuilder for collecting css properties for inline STYLE attributes</span>
            <span class="c">// on every element level (it will be re-initialized on every level).</span>
            <a href="@1@System.Runtime/A.html#adf60ee46ebd299f" class="k">var</a> <span id="r7 rd" class="r7 r">inlineStyle</span> = <b>new</b> <a href="@1@System.Runtime/A.html#6e631639c1e2746b" class="t constructor">StringBuilder</a>();

            <span class="r6 r">htmlWriter</span>.<span class="i method">WriteStartElement</span>(<span class="s">&quot;html&quot;</span>);
            <span class="r6 r">htmlWriter</span>.<span class="i method">WriteStartElement</span>(<span class="s">&quot;body&quot;</span>);

            <a href="#55c026d68ce7f084" class="i method">WriteFormattingProperties</a>(<span class="r5 r">xamlReader</span>, <span class="r6 r">htmlWriter</span>, <span class="r7 r">inlineStyle</span>);

            <a href="#54efde1ec7b94e1d" class="i method">WriteElementContent</a>(<span class="r5 r">xamlReader</span>, <span class="r6 r">htmlWriter</span>, <span class="r7 r">inlineStyle</span>);

            <span class="r6 r">htmlWriter</span>.<span class="i method">WriteEndElement</span>();
            <span class="r6 r">htmlWriter</span>.<span class="i method">WriteEndElement</span>();

            <b>return</b> <b>true</b>;
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Reads attributes of the current xaml element and converts</span>
        <span class="c">///</span><span class="c">     them into appropriate html attributes or css styles.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     XmlTextReader which is expected to be at XmlNodeType.Element</span>
        <span class="c">///</span><span class="c">     (opening element tag) position.</span>
        <span class="c">///</span><span class="c">     The reader will remain at the same level after function complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">htmlWriter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     XmlTextWriter for output html, which is expected to be in</span>
        <span class="c">///</span><span class="c">     after WriteStartElement state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">inlineStyle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     String builder for collecting css properties for inline STYLE attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="55c026d68ce7f084" href="R/55c026d68ce7f084.html" target="n" data-glyph="76,1" class="i method">WriteFormattingProperties</a>(<span class="t t">XmlTextReader</span> <span id="r8 rd" class="r8 r">xamlReader</span>, <span class="t t">XmlTextWriter</span> <span id="r9 rd" class="r9 r">htmlWriter</span>,
            <a href="@1@System.Runtime/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r10 rd" class="r10 r">inlineStyle</span>)
        {
            <span class="t t">Debug</span>.<span class="i method">Assert</span>(<span class="r8 r">xamlReader</span>.<span class="i property">NodeType</span> == <span class="t t">XmlNodeType</span>.<span class="i field">Element</span>);

            <span class="c">// Clear string builder for the inline style</span>
            <span class="r10 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#db619a22e1b3d912" class="i method">Remove</a>(0, <span class="r10 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#7d7729bd88adac53" class="i property">Length</a>);

            <b>if</b> (!<span class="r8 r">xamlReader</span>.<span class="i property">HasAttributes</span>)
            {
                <b>return</b>;
            }

            <a href="@1@System.Runtime/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r11 rd" class="r11 r">borderSet</span> = <b>false</b>;

            <b>while</b> (<span class="r8 r">xamlReader</span>.<span class="i method">MoveToNextAttribute</span>())
            {
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r12 rd" class="r12 r">css</span> = <b>null</b>;

                <b>switch</b> (<span class="r8 r">xamlReader</span>.<span class="i property">Name</span>)
                {
                    <span class="c">// Character fomatting properties</span>
                    <span class="c">// ------------------------------</span>
                    <b>case</b> <span class="s">&quot;Background&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;background-color:&quot;</span> + <a href="#5b1f481b6229a35f" class="i method">ParseXamlColor</a>(<span class="r8 r">xamlReader</span>.<span class="i property">Value</span>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontFamily&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;font-family:&quot;</span> + <span class="r8 r">xamlReader</span>.<span class="i property">Value</span> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontStyle&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;font-style:&quot;</span> + <span class="r8 r">xamlReader</span>.<span class="i property">Value</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>() + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontWeight&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;font-weight:&quot;</span> + <span class="r8 r">xamlReader</span>.<span class="i property">Value</span>.<a href="@1@System.Runtime/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>() + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontStretch&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FontSize&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;font-size:&quot;</span> + <span class="r8 r">xamlReader</span>.<span class="i property">Value</span> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Foreground&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;color:&quot;</span> + <a href="#5b1f481b6229a35f" class="i method">ParseXamlColor</a>(<span class="r8 r">xamlReader</span>.<span class="i property">Value</span>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TextDecorations&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;text-decoration:underline;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TextEffects&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Emphasis&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;StandardLigatures&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Variants&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Capitals&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Fraction&quot;</span>:
                        <b>break</b>;

                    <span class="c">// Paragraph formatting properties</span>
                    <span class="c">// -------------------------------</span>
                    <b>case</b> <span class="s">&quot;Padding&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;padding:&quot;</span> + <a href="#d5f57768b75a1ecf" class="i method">ParseXamlThickness</a>(<span class="r8 r">xamlReader</span>.<span class="i property">Value</span>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Margin&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;margin:&quot;</span> + <a href="#d5f57768b75a1ecf" class="i method">ParseXamlThickness</a>(<span class="r8 r">xamlReader</span>.<span class="i property">Value</span>) + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;BorderThickness&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;border-width:&quot;</span> + <a href="#d5f57768b75a1ecf" class="i method">ParseXamlThickness</a>(<span class="r8 r">xamlReader</span>.<span class="i property">Value</span>) + <span class="s">&quot;;&quot;</span>;
                        <span class="r11 r">borderSet</span> = <b>true</b>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;BorderBrush&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;border-color:&quot;</span> + <a href="#5b1f481b6229a35f" class="i method">ParseXamlColor</a>(<span class="r8 r">xamlReader</span>.<span class="i property">Value</span>) + <span class="s">&quot;;&quot;</span>;
                        <span class="r11 r">borderSet</span> = <b>true</b>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;LineHeight&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TextIndent&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;text-indent:&quot;</span> + <span class="r8 r">xamlReader</span>.<span class="i property">Value</span> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TextAlignment&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;text-align:&quot;</span> + <span class="r8 r">xamlReader</span>.<span class="i property">Value</span> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;IsKeptTogether&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;IsKeptWithNext&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;ColumnBreakBefore&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;PageBreakBefore&quot;</span>:
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;FlowDirection&quot;</span>:
                        <b>break</b>;

                    <span class="c">// Table attributes</span>
                    <span class="c">// ----------------</span>
                    <b>case</b> <span class="s">&quot;Width&quot;</span>:
                        <span class="r12 r">css</span> = <span class="s">&quot;width:&quot;</span> + <span class="r8 r">xamlReader</span>.<span class="i property">Value</span> + <span class="s">&quot;;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;ColumnSpan&quot;</span>:
                        <span class="r9 r">htmlWriter</span>.<span class="i method">WriteAttributeString</span>(<span class="s">&quot;colspan&quot;</span>, <span class="r8 r">xamlReader</span>.<span class="i property">Value</span>);
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;RowSpan&quot;</span>:
                        <span class="r9 r">htmlWriter</span>.<span class="i method">WriteAttributeString</span>(<span class="s">&quot;rowspan&quot;</span>, <span class="r8 r">xamlReader</span>.<span class="i property">Value</span>);
                        <b>break</b>;
                }

                <b>if</b> (<span class="r12 r">css</span> != <b>null</b>)
                {
                    <span class="r10 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="r12 r">css</span>);
                }
            }

            <b>if</b> (<span class="r11 r">borderSet</span>)
            {
                <span class="r10 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;border-style:solid;mso-element:para-border-div;&quot;</span>);
            }

            <span class="c">// Return the xamlReader back to element level</span>
            <span class="r8 r">xamlReader</span>.<span class="i method">MoveToElement</span>();
            <span class="t t">Debug</span>.<span class="i method">Assert</span>(<span class="r8 r">xamlReader</span>.<span class="i property">NodeType</span> == <span class="t t">XmlNodeType</span>.<span class="i field">Element</span>);
        }

        <b>private static string</b> <a id="5b1f481b6229a35f" href="R/5b1f481b6229a35f.html" target="n" data-glyph="76,1" class="i method">ParseXamlColor</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r13 rd" class="r13 r">color</span>)
        {
            <b>if</b> (<span class="r13 r">color</span>.<a href="@1@System.Runtime/A.html#23804789ea4c9c0e" class="i method">StartsWith</a>(<span class="s">&quot;#&quot;</span>))
            {
                <span class="c">// Remove transparancy value</span>
                <span class="r13 r">color</span> = <span class="s">&quot;#&quot;</span> + <span class="r13 r">color</span>.<a href="@1@System.Runtime/A.html#882fa7998d6ca35a" class="i method">Substring</a>(3);
            }
            <b>return</b> <span class="r13 r">color</span>;
        }

        <b>private static string</b> <a id="d5f57768b75a1ecf" href="R/d5f57768b75a1ecf.html" target="n" data-glyph="76,1" class="i method">ParseXamlThickness</a>(<a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r14 rd" class="r14 r">thickness</span>)
        {
            <b>var</b> <span id="r15 rd" class="r15 r">values</span> = <span class="r14 r">thickness</span>.<a href="@1@System.Runtime/A.html#b06c6275ef677846" class="i method">Split</a>(<span class="s">&#39;,&#39;</span>);

            <b>for</b> (<a href="@1@System.Runtime/A.html#225942ed7b7a3252" class="k">var</a> <span id="r16 rd" class="r16 r">i</span> = 0; <span class="r16 r">i</span> &lt; <span class="r15 r">values</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r16 r">i</span>++)
            {
                <b>if</b> (<b>double</b>.<a href="@1@System.Runtime/A.html#4decccd0a1012765" class="i method">TryParse</a>(<span class="r15 r">values</span>[<span class="r16 r">i</span>], <a href="@1@System.Runtime/A.html#4523c5163ff35e41" class="t t">NumberStyles</a>.<a href="@1@System.Runtime/A.html#b90b0743418305c0" class="i field">Any</a>, <a href="@1@System.Runtime/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@System.Runtime/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>, <b>out double</b> <span id="r17 rd" class="r17 r">value</span>))
                {
                    <span class="r15 r">values</span>[<span class="r16 r">i</span>] = <span class="t t">Math</span>.<span class="i method">Ceiling</span>(<span class="r17 r">value</span>).<a href="@1@System.Runtime/A.html#102b12e1c4385406" class="i method">ToString</a>(<a href="@1@System.Runtime/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@1@System.Runtime/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>);
                }
                <b>else</b>
                {
                    <span class="r15 r">values</span>[<span class="r16 r">i</span>] = <span class="s">&quot;1&quot;</span>;
                }
            }

            <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r18 rd" class="r18 r">cssThickness</span>;
            <b>switch</b> (<span class="r15 r">values</span>.<a href="@1@System.Runtime/A.html#42e9b7616956cf94" class="i property">Length</a>)
            {
                <b>case</b> 1:
                    <span class="r18 r">cssThickness</span> = <span class="r14 r">thickness</span>;
                    <b>break</b>;
                <b>case</b> 2:
                    <span class="r18 r">cssThickness</span> = <span class="r15 r">values</span>[1] + <span class="s">&quot; &quot;</span> + <span class="r15 r">values</span>[0];
                    <b>break</b>;
                <b>case</b> 4:
                    <span class="r18 r">cssThickness</span> = <span class="r15 r">values</span>[1] + <span class="s">&quot; &quot;</span> + <span class="r15 r">values</span>[2] + <span class="s">&quot; &quot;</span> + <span class="r15 r">values</span>[3] + <span class="s">&quot; &quot;</span> + <span class="r15 r">values</span>[0];
                    <b>break</b>;
                <b>default</b>:
                    <span class="r18 r">cssThickness</span> = <span class="r15 r">values</span>[0];
                    <b>break</b>;
            }

            <b>return</b> <span class="r18 r">cssThickness</span>;
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Reads a content of current xaml element, converts it</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     XmlTextReader which is expected to be at XmlNodeType.Element</span>
        <span class="c">///</span><span class="c">     (opening element tag) position.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">htmlWriter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     May be null, in which case we are skipping the xaml element;</span>
        <span class="c">///</span><span class="c">     witout producing any output to html.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">inlineStyle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     StringBuilder used for collecting css properties for inline STYLE attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="54efde1ec7b94e1d" href="R/54efde1ec7b94e1d.html" target="n" data-glyph="76,1" class="i method">WriteElementContent</a>(<span class="t t">XmlTextReader</span> <span id="r19 rd" class="r19 r">xamlReader</span>, <span class="t t">XmlTextWriter</span> <span id="r20 rd" class="r20 r">htmlWriter</span>,
            <a href="@1@System.Runtime/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r21 rd" class="r21 r">inlineStyle</span>)
        {
            <span class="t t">Debug</span>.<span class="i method">Assert</span>(<span class="r19 r">xamlReader</span>.<span class="i property">NodeType</span> == <span class="t t">XmlNodeType</span>.<span class="i field">Element</span>);

            <a href="@1@System.Runtime/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r22 rd" class="r22 r">elementContentStarted</span> = <b>false</b>;

            <b>if</b> (<span class="r19 r">xamlReader</span>.<span class="i property">IsEmptyElement</span>)
            {
                <b>if</b> (<span class="r20 r">htmlWriter</span> != <b>null</b> &amp;&amp; !<span class="r22 r">elementContentStarted</span> &amp;&amp; <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#7d7729bd88adac53" class="i property">Length</a> &gt; 0)
                {
                    <span class="c">// Output STYLE attribute and clear inlineStyle buffer.</span>
                    <span class="r20 r">htmlWriter</span>.<span class="i method">WriteAttributeString</span>(<span class="s">&quot;STYLE&quot;</span>, <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#5a97da49a158a3c9" class="i method">ToString</a>());
                    <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#db619a22e1b3d912" class="i method">Remove</a>(0, <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#7d7729bd88adac53" class="i property">Length</a>);
                }
                <span class="r22 r">elementContentStarted</span> = <b>true</b>;
            }
            <b>else</b>
            {
                <b>while</b> (<a href="#1c0a8899fc6bfcf7" class="i method">ReadNextToken</a>(<span class="r19 r">xamlReader</span>) &amp;&amp; <span class="r19 r">xamlReader</span>.<span class="i property">NodeType</span> != <span class="t t">XmlNodeType</span>.<span class="i field">EndElement</span>)
                {
                    <b>switch</b> (<span class="r19 r">xamlReader</span>.<span class="i property">NodeType</span>)
                    {
                        <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">Element</span>:
                            <b>if</b> (<span class="r19 r">xamlReader</span>.<span class="i property">Name</span>.<a href="@1@System.Runtime/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;.&quot;</span>))
                            {
                                <a href="#f7b7254bf56a9309" class="i method">AddComplexProperty</a>(<span class="r19 r">xamlReader</span>, <span class="r21 r">inlineStyle</span>);
                            }
                            <b>else</b>
                            {
                                <b>if</b> (<span class="r20 r">htmlWriter</span> != <b>null</b> &amp;&amp; !<span class="r22 r">elementContentStarted</span> &amp;&amp; <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#7d7729bd88adac53" class="i property">Length</a> &gt; 0)
                                {
                                    <span class="c">// Output STYLE attribute and clear inlineStyle buffer.</span>
                                    <span class="r20 r">htmlWriter</span>.<span class="i method">WriteAttributeString</span>(<span class="s">&quot;style&quot;</span>, <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#5a97da49a158a3c9" class="i method">ToString</a>());
                                    <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#db619a22e1b3d912" class="i method">Remove</a>(0, <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#7d7729bd88adac53" class="i property">Length</a>);
                                }
                                <span class="r22 r">elementContentStarted</span> = <b>true</b>;
                                <a href="#552bd4380eeef2c6" class="i method">WriteElement</a>(<span class="r19 r">xamlReader</span>, <span class="r20 r">htmlWriter</span>, <span class="r21 r">inlineStyle</span>);
                            }
                            <span class="t t">Debug</span>.<span class="i method">Assert</span>(<span class="r19 r">xamlReader</span>.<span class="i property">NodeType</span> == <span class="t t">XmlNodeType</span>.<span class="i field">EndElement</span> ||
                                         <span class="r19 r">xamlReader</span>.<span class="i property">NodeType</span> == <span class="t t">XmlNodeType</span>.<span class="i field">Element</span> &amp;&amp; <span class="r19 r">xamlReader</span>.<span class="i property">IsEmptyElement</span>);
                            <b>break</b>;
                        <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">Comment</span>:
                            <b>if</b> (<span class="r20 r">htmlWriter</span> != <b>null</b>)
                            {
                                <b>if</b> (!<span class="r22 r">elementContentStarted</span> &amp;&amp; <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#7d7729bd88adac53" class="i property">Length</a> &gt; 0)
                                {
                                    <span class="r20 r">htmlWriter</span>.<span class="i method">WriteAttributeString</span>(<span class="s">&quot;style&quot;</span>, <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#5a97da49a158a3c9" class="i method">ToString</a>());
                                }
                                <span class="r20 r">htmlWriter</span>.<span class="i method">WriteComment</span>(<span class="r19 r">xamlReader</span>.<span class="i property">Value</span>);
                            }
                            <span class="r22 r">elementContentStarted</span> = <b>true</b>;
                            <b>break</b>;
                        <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">CDATA</span>:
                        <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">Text</span>:
                        <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">SignificantWhitespace</span>:
                            <b>if</b> (<span class="r20 r">htmlWriter</span> != <b>null</b>)
                            {
                                <b>if</b> (!<span class="r22 r">elementContentStarted</span> &amp;&amp; <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#7d7729bd88adac53" class="i property">Length</a> &gt; 0)
                                {
                                    <span class="r20 r">htmlWriter</span>.<span class="i method">WriteAttributeString</span>(<span class="s">&quot;style&quot;</span>, <span class="r21 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#5a97da49a158a3c9" class="i method">ToString</a>());
                                }
                                <span class="r20 r">htmlWriter</span>.<span class="i method">WriteString</span>(<span class="r19 r">xamlReader</span>.<span class="i property">Value</span>);
                            }
                            <span class="r22 r">elementContentStarted</span> = <b>true</b>;
                            <b>break</b>;
                    }
                }

                <span class="t t">Debug</span>.<span class="i method">Assert</span>(<span class="r19 r">xamlReader</span>.<span class="i property">NodeType</span> == <span class="t t">XmlNodeType</span>.<span class="i field">EndElement</span>);
            }
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Conberts an element notation of complex property into</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     On entry this XmlTextReader must be on Element start tag;</span>
        <span class="c">///</span><span class="c">     on exit - on EndElement tag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">inlineStyle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     StringBuilder containing a value for STYLE attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="f7b7254bf56a9309" href="R/f7b7254bf56a9309.html" target="n" data-glyph="76,1" class="i method">AddComplexProperty</a>(<span class="t t">XmlTextReader</span> <span id="r23 rd" class="r23 r">xamlReader</span>, <a href="@1@System.Runtime/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r24 rd" class="r24 r">inlineStyle</span>)
        {
            <span class="t t">Debug</span>.<span class="i method">Assert</span>(<span class="r23 r">xamlReader</span>.<span class="i property">NodeType</span> == <span class="t t">XmlNodeType</span>.<span class="i field">Element</span>);

            <b>if</b> (<span class="r24 r">inlineStyle</span> != <b>null</b> &amp;&amp; <span class="r23 r">xamlReader</span>.<span class="i property">Name</span>.<a href="@1@System.Runtime/A.html#cb74053b3f2d03f4" class="i method">EndsWith</a>(<span class="s">&quot;.TextDecorations&quot;</span>))
            {
                <span class="r24 r">inlineStyle</span>.<a href="@1@System.Runtime/A.html#e8eaef3c361184bc" class="i method">Append</a>(<span class="s">&quot;text-decoration:underline;&quot;</span>);
            }

            <span class="c">// Skip the element representing the complex property</span>
            <a href="#54efde1ec7b94e1d" class="i method">WriteElementContent</a>(<span class="r23 r">xamlReader</span>, <span class="c">/*htmlWriter:*/</span><b>null</b>, <span class="c">/*inlineStyle:*/</span><b>null</b>);
        }

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Converts a xaml element into an appropriate html element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     On entry this XmlTextReader must be on Element start tag;</span>
        <span class="c">///</span><span class="c">     on exit - on EndElement tag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">htmlWriter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     May be null, in which case we are skipping xaml content</span>
        <span class="c">///</span><span class="c">     without producing any html output</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">inlineStyle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     StringBuilder used for collecting css properties for inline STYLE attributes on every level.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="552bd4380eeef2c6" href="R/552bd4380eeef2c6.html" target="n" data-glyph="76,1" class="i method">WriteElement</a>(<span class="t t">XmlTextReader</span> <span id="r25 rd" class="r25 r">xamlReader</span>, <span class="t t">XmlTextWriter</span> <span id="r26 rd" class="r26 r">htmlWriter</span>, <a href="@1@System.Runtime/A.html#adf60ee46ebd299f" class="t t">StringBuilder</a> <span id="r27 rd" class="r27 r">inlineStyle</span>)
        {
            <span class="t t">Debug</span>.<span class="i method">Assert</span>(<span class="r25 r">xamlReader</span>.<span class="i property">NodeType</span> == <span class="t t">XmlNodeType</span>.<span class="i field">Element</span>);

            <b>if</b> (<span class="r26 r">htmlWriter</span> == <b>null</b>)
            {
                <span class="c">// Skipping mode; recurse into the xaml element without any output</span>
                <a href="#54efde1ec7b94e1d" class="i method">WriteElementContent</a>(<span class="r25 r">xamlReader</span>, <span class="c">/*htmlWriter:*/</span><b>null</b>, <b>null</b>);
            }
            <b>else</b>
            {
                <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">string</a> <span id="r28 rd" class="r28 r">htmlElementName</span> = <b>null</b>;

                <b>switch</b> (<span class="r25 r">xamlReader</span>.<span class="i property">Name</span>)
                {
                    <b>case</b> <span class="s">&quot;Run&quot;</span>:
                    <b>case</b> <span class="s">&quot;Span&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;span&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;InlineUIContainer&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;span&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Bold&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;b&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Italic&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;i&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Paragraph&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;p&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;BlockUIContainer&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;div&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Section&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;div&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;Table&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;table&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TableColumn&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;col&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TableRowGroup&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;tbody&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TableRow&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;tr&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;TableCell&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;td&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;List&quot;</span>:
                        <a href="@1@System.Runtime/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r29 rd" class="r29 r">marker</span> = <span class="r25 r">xamlReader</span>.<span class="i method">GetAttribute</span>(<span class="s">&quot;MarkerStyle&quot;</span>);
                        <b>if</b> (<span class="r29 r">marker</span> == <b>null</b> || <span class="r29 r">marker</span> == <span class="s">&quot;None&quot;</span> || <span class="r29 r">marker</span> == <span class="s">&quot;Disc&quot;</span> || <span class="r29 r">marker</span> == <span class="s">&quot;Circle&quot;</span> ||
                            <span class="r29 r">marker</span> == <span class="s">&quot;Square&quot;</span> ||
                            <span class="r29 r">marker</span> == <span class="s">&quot;Box&quot;</span>)
                        {
                            <span class="r28 r">htmlElementName</span> = <span class="s">&quot;ul&quot;</span>;
                        }
                        <b>else</b>
                        {
                            <span class="r28 r">htmlElementName</span> = <span class="s">&quot;ol&quot;</span>;
                        }
                        <b>break</b>;
                    <b>case</b> <span class="s">&quot;ListItem&quot;</span>:
                        <span class="r28 r">htmlElementName</span> = <span class="s">&quot;li&quot;</span>;
                        <b>break</b>;
                    <b>default</b>:
                        <span class="r28 r">htmlElementName</span> = <b>null</b>; <span class="c">// Ignore the element</span>
                        <b>break</b>;
                }

                <b>if</b> (<span class="r26 r">htmlWriter</span> != <b>null</b> &amp;&amp; <span class="r28 r">htmlElementName</span> != <b>null</b>)
                {
                    <span class="r26 r">htmlWriter</span>.<span class="i method">WriteStartElement</span>(<span class="r28 r">htmlElementName</span>);

                    <a href="#55c026d68ce7f084" class="i method">WriteFormattingProperties</a>(<span class="r25 r">xamlReader</span>, <span class="r26 r">htmlWriter</span>, <span class="r27 r">inlineStyle</span>);

                    <a href="#54efde1ec7b94e1d" class="i method">WriteElementContent</a>(<span class="r25 r">xamlReader</span>, <span class="r26 r">htmlWriter</span>, <span class="r27 r">inlineStyle</span>);

                    <span class="r26 r">htmlWriter</span>.<span class="i method">WriteEndElement</span>();
                }
                <b>else</b>
                {
                    <span class="c">// Skip this unrecognized xaml element</span>
                    <a href="#54efde1ec7b94e1d" class="i method">WriteElementContent</a>(<span class="r25 r">xamlReader</span>, <span class="c">/*htmlWriter:*/</span><b>null</b>, <b>null</b>);
                }
            }
        }

        <span class="c">// Reader advance helpers</span>
        <span class="c">// ----------------------</span>

        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     Reads several items from xamlReader skipping all non-significant stuff.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">xamlReader</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     XmlTextReader from tokens are being read.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     True if new token is available; false if end of stream reached.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="1c0a8899fc6bfcf7" href="R/1c0a8899fc6bfcf7.html" target="n" data-glyph="76,1" class="i method">ReadNextToken</a>(<span class="t t">XmlReader</span> <span id="r30 rd" class="r30 r">xamlReader</span>)
        {
            <b>while</b> (<span class="r30 r">xamlReader</span>.<span class="i method">Read</span>())
            {
                <span class="t t">Debug</span>.<span class="i method">Assert</span>(<span class="r30 r">xamlReader</span>.<span class="i property">ReadState</span> == <span class="t t">ReadState</span>.<span class="i field">Interactive</span>,
                    <span class="s">&quot;Reader is expected to be in Interactive state (&quot;</span> + <span class="r30 r">xamlReader</span>.<span class="i property">ReadState</span> + <span class="s">&quot;)&quot;</span>);
                <b>switch</b> (<span class="r30 r">xamlReader</span>.<span class="i property">NodeType</span>)
                {
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">Element</span>:
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">EndElement</span>:
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">None</span>:
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">CDATA</span>:
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">Text</span>:
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">SignificantWhitespace</span>:
                        <b>return</b> <b>true</b>;

                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">Whitespace</span>:
                        <b>if</b> (<span class="r30 r">xamlReader</span>.<span class="i property">XmlSpace</span> == <span class="t t">XmlSpace</span>.<span class="i field">Preserve</span>)
                        {
                            <b>return</b> <b>true</b>;
                        }
                        <span class="c">// ignore insignificant whitespace</span>
                        <b>break</b>;

                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">EndEntity</span>:
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">EntityReference</span>:
                        <span class="c">//  Implement entity reading</span>
                        <span class="c">//xamlReader.ResolveEntity();</span>
                        <span class="c">//xamlReader.Read();</span>
                        <span class="c">//ReadChildNodes( parent, parentBaseUri, xamlReader, positionInfo);</span>
                        <b>break</b>; <span class="c">// for now we ignore entities as insignificant stuff</span>

                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">Comment</span>:
                        <b>return</b> <b>true</b>;
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">ProcessingInstruction</span>:
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">DocumentType</span>:
                    <b>case</b> <span class="t t">XmlNodeType</span>.<span class="i field">XmlDeclaration</span>:
                    <b>default</b>:
                        <span class="c">// Ignorable stuff</span>
                        <b>break</b>;
                }
            }
            <b>return</b> <b>false</b>;
        }

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods

        <span class="c">// ---------------------------------------------------------------------</span>
        <span class="c">//</span>
        <span class="c">// Private Fields</span>
        <span class="c">//</span>
        <span class="c">// ---------------------------------------------------------------------</span>

        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Fields

        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Fields
    }
}</pre></td></tr></table></div></body></html>
