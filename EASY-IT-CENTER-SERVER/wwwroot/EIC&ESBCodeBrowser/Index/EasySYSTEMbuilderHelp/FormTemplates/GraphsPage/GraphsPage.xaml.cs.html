<!DOCTYPE html>
<html><head><title>GraphsPage.xaml.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(157);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EasySYSTEMbuilderHelp/FormTemplates/GraphsPage/GraphsPage.xaml.cs" target="_top">FormTemplates\GraphsPage\GraphsPage.xaml.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EasySYSTEMbuilderHelp" target="_top">HelpProjects\EasySYSTEMbuilderHelp\EasySYSTEMbuilderHelp.vbproj</a> (EasySYSTEMbuilderHelp)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">Classes</span>;
<b>using</b> <span class="i">EasyITSystemCenter</span>.<span class="i">GlobalOperations</span>;
<b>using</b> <span class="i">LiveCharts</span>;
<b>using</b> <span class="i">LiveCharts</span>.<span class="i">Wpf</span>;
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Controls</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Media</span>;
 
<b>namespace</b> <span class="i n">EasyITSystemCenter</span>.<span class="i n">Pages</span> {
 
    <b>public</b> <b>partial</b> <b>class</b> <a id="8b92b4a2e05032d3" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="0662e6780145c32c">GraphsPage</span></a> : <span class="i">UserControl</span>, <span class="i">INotifyPropertyChanged</span> {
        <b>public static</b> <a id="843f718902a9c714" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">DataViewSupport</a> <span class="i">dataViewSupport</span> = <b>new</b> <span class="i">DataViewSupport</span>();
        <b>public static</b> <a id="6cd19fa5b11eaf54" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">BasicCalendarList</a> <span class="i">selectedRecord</span> = <b>new</b> <span class="i">BasicCalendarList</span>();
 
        <b>private</b> <a id="237238f4906f9334" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">bool</a> <span class="i">_mariaSeriesVisibility</span>;
        <b>private</b> <a id="237238f4906f9334" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">bool</a> <span class="i">_charlesSeriesVisibility</span>;
        <b>private</b> <a id="237238f4906f9334" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">bool</a> <span class="i">_johnSeriesVisibility</span>;
 
        <b>public</b> <a id="6d6074bf95b6e63d" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">GraphsPage</a>() {
            <span class="i">InitializeComponent</span>();
            _ = <span class="i">SystemOperations</span>.<span class="i">SetLanguageDictionary</span>(<span class="i">Resources</span>, <span class="i">App</span>.<span class="i">appRuntimeData</span>.<span class="i">AppClientSettings</span>.<span class="i">First</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">Key</span> == <span class="s">&quot;sys_defaultLanguage&quot;</span>).<span class="i">Value</span>);
 
            <span class="i">MariaSeriesVisibility</span> = <b>true</b>;
            <span class="i">CharlesSeriesVisibility</span> = <b>true</b>;
            <span class="i">JohnSeriesVisibility</span> = <b>false</b>;
            <span class="i">SeriesValues</span> = <span class="i">GetData</span>();
 
            <span class="i">SeriesCollection</span> = <b>new</b> <span class="i">SeriesCollection</span>
            {
                <b>new</b> <span class="i">LineSeries</span>
                {
                    <span class="i">Title</span> = <span class="s">&quot;Series 1&quot;</span>,
                    <span class="i">Values</span> = <b>new</b> <span class="i">ChartValues</span>&lt;<b>double</b>&gt; { 4, 6, 5, 2 ,4 }
                },
                <b>new</b> <span class="i">LineSeries</span>
                {
                    <span class="i">Title</span> = <span class="s">&quot;Series 2&quot;</span>,
                    <span class="i">Values</span> = <b>new</b> <span class="i">ChartValues</span>&lt;<b>double</b>&gt; { 6, 7, 3, 4 ,6 },
                    <span class="i">PointGeometry</span> = <span class="i">null</span>
                },
                <b>new</b> <span class="i">LineSeries</span>
                {
                    <span class="i">Title</span> = <span class="s">&quot;Series 3&quot;</span>,
                    <span class="i">Values</span> = <b>new</b> <span class="i">ChartValues</span>&lt;<b>double</b>&gt; { 4,2,7,2,7 },
                    <span class="i">PointGeometry</span> = <span class="i">DefaultGeometries</span>.<span class="i">Square</span>,
                    <span class="i">PointGeometrySize</span> = 15
                }
            };
 
            <span class="i">Labels</span> = <b>new</b>[] { <span class="s">&quot;Jan&quot;</span>, <span class="s">&quot;Feb&quot;</span>, <span class="s">&quot;Mar&quot;</span>, <span class="s">&quot;Apr&quot;</span>, <span class="s">&quot;May&quot;</span> };
            <span class="i">YFormatter</span> = <span class="i">value</span> =&gt; <span class="i">value</span>.<span class="i">ToString</span>(<span class="s">&quot;C&quot;</span>);
 
            //<span class="i">modifying</span> <span class="i">the</span> <span class="i">series</span> <span class="i">collection</span> <span class="i">will</span> <span class="i">animate</span> <b>and</b> <span class="i">update</span> <span class="i">the</span> <span class="i">chart</span>
            <span class="i">SeriesCollection</span>.<span class="i">Add</span>(<b>new</b> <span class="i">LineSeries</span> {
                <span class="i">Title</span> = <span class="s">&quot;Series 4&quot;</span>,
                <span class="i">Values</span> = <b>new</b> <span class="i">ChartValues</span>&lt;<b>double</b>&gt; { 5, 3, 2, 4 },
                <span class="i">LineSmoothness</span> = 0, //0: <span class="i">straight</span> <a id="d37bf3a666125374" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">lines</a>, 1: <span class="i">really</span> <a id="67756ff6612f527c" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">smooth</a> <span class="i">lines</span>
                <span class="i">PointGeometry</span> = <span class="i">Geometry</span>.<span class="i">Parse</span>(<span class="s">&quot;m 25 70.36218 20 -28 -20 22 -8 -6 z&quot;</span>),
                <span class="i">PointGeometrySize</span> = 50,
                <span class="i">PointForeground</span> = <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Media</span>.<span class="i">Brushes</span>.<span class="i">Gray</span>
            });
 
            //<span class="i">modifying</span> <span class="i">any</span> <span class="i">series</span> <span class="i">values</span> <span class="i">will</span> <span class="i">also</span> <span class="i">animate</span> <b>and</b> <span class="i">update</span> <span class="i">the</span> <span class="i">chart</span>
            <span class="i">SeriesCollection</span>[3].<span class="i">Values</span>.<span class="i">Add</span>(5d);
 
            //<span class="i">Second</span> <span class="i">Graph</span>
            <span class="i">PointLabel</span> = <span class="i">chartPoint</span> =&gt;
              <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;{0} ({1:P})&quot;</span>, <span class="i">chartPoint</span>.<span class="i">Y</span>, <span class="i">chartPoint</span>.<span class="i">Participation</span>);
            <span class="i">Value</span> = 160;
 
            <span class="i">var</span> <a id="a27d68bb45827b4c" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">r</a> = <b>new</b> <a href="@0@mscorlib/A.html#5d22f8880fc9f8d9" class="t constructor">Random</a>();
            <span class="i">var</span> <a id="7ea673767bd591be" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">Values</a> = <b>new</b> <a href="@0@mscorlib/A.html#bf6849e410b43c4c" class="t constructor">Dictionary</a>&lt;<b>string</b>, <a id="49ed01ac77ec62e7" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">double</a>&gt;();
 
            <span class="i">DataContext</span> = <span class="i">this</span>;
        }
 
        <b>public</b> <a id="08a67171027784c8" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">SeriesCollection</a> <span class="i">SeriesCollection</span> { <b>get; set</b>; }
        <b>public string</b>[] <span class="i">Labels</span> { <b>get; set</b>; }
        <b>public</b> <a id="1db3bb8cfa05f151" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">Func</a>&lt;<b>double</b>, <b>string</b>&gt; <span class="i">YFormatter</span> { <b>get; set</b>; }
        <b>private double</b> <span class="i">_value</span>;
        <b>public</b> <a id="1db3bb8cfa05f151" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">Func</a>&lt;<span class="i">ChartPoint</span>, <b>string</b>&gt; <span class="i">PointLabel</span> { <b>get; set</b>; }
 
        <b>private</b> <a id="3c18f85fde43da08" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">Chart_OnDataClick</span>(<b>object</b> <span class="i">sender</span>, <span class="i">ChartPoint</span> <span class="i">chartpoint</span>) {
            <span class="i">var</span> <a id="03c0267158e87e5d" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">chart</a> = (<span class="i">PieChart</span>)<span class="i">chartpoint</span>.<span class="i">ChartView</span>;
 
            //<span class="i">clear</span> <span class="i">selected</span> <span class="i">slice</span>.
            <span class="i">foreach</span> (<span class="i">PieSeries</span> <span class="i">series</span> <b>in</b> <span class="i">chart</span>.<span class="i">Series</span>.<span class="i">Cast</span>&lt;<span class="i">PieSeries</span>&gt;()) {
                <span class="i">series</span>.<span class="i">PushOut</span> = 0;
            }
 
            <span class="i">var</span> <a id="558857a7434a2344" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">selectedSeries</a> = (<span class="i">PieSeries</span>)<span class="i">chartpoint</span>.<span class="i">SeriesView</span>;
            <span class="i">selectedSeries</span>.<span class="i">PushOut</span> = 8;
        }
 
        <b>public double</b> <span class="i">Value</span> {
            <b>get</b> { <b>return</b> <span class="i">_value</span>; }
            <b>set</b> {
                <span class="i">_value</span> = <span class="i">value</span>;
                <span class="i">OnPropertyChanged</span>(<span class="s">&quot;Value&quot;</span>);
            }
        }
 
        <b>private</b> <a id="3c18f85fde43da08" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">ChangeValueOnClick</span>(<b>object</b> <span class="i">sender</span>, <span class="i">RoutedEventArgs</span> <span class="i">e</span>) {
            <span class="i">Value</span> = <b>new</b> <span class="i">Random</span>().<b>Next</b>(50, 250);
        }
 
        <b>public event</b> <a id="140d390c5153a272" href="../../R/../../0000000000.html" target="n" data-glyph="30,1" class="i">PropertyChangedEventHandler</a> <span class="i">PropertyChanged</span>;
 
        <b>protected</b> <a id="371aeec9f39cb3bd" href="../../R/../../0000000000.html" target="n" data-glyph="45,1" class="i field">virtual</a> <span class="i">void</span> <span class="i">OnPropertyChanged</span>(<b>string</b> <span class="i">propertyName</span> = <span class="i">null</span>) {
            <span class="i">PropertyChanged</span>?.<span class="i">Invoke</span>(<span class="i">this</span>, <b>new</b> <span class="i">PropertyChangedEventArgs</span>(<span class="i">propertyName</span>));
        }
 
        <b>public</b> <a id="a8fdfc3d866e8d1e" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">ChartValues</a>&lt;<b>double</b>&gt; <span class="i">SeriesValues</span> { <b>get; set</b>; }
 
        <b>private</b> <a id="a8fdfc3d866e8d1e" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">ChartValues</a>&lt;<b>double</b>&gt; <span class="i">GetData</span>() {
            <span class="i">var</span> <a id="a27d68bb45827b4c" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">r</a> = <b>new</b> <a href="@0@mscorlib/A.html#5d22f8880fc9f8d9" class="t constructor">Random</a>();
            <span class="i">var</span> <a id="d7862de342d3c535" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">trend</a> = 100;
            <span class="i">var</span> <a id="8e4d1d03b7f3bf68" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">values</a> = <b>new</b> <span class="i">ChartValues</span>&lt;<b>double</b>&gt;();
 
            <b>for</b> (<span class="i">var</span> <span class="i">i</span> = 0; <span class="i">i</span> &lt; 160; <span class="i">i</span>++) {
                <span class="i">var</span> <a id="b5c4e640bb46c14e" href="../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">seed</a> = <span class="i">r</span>.<span class="i">NextDouble</span>();
                <b>if</b> (<span class="i">seed</span> &gt; .8) <span class="i">trend</span> += <span class="i">seed</span> &gt; .9 ? 50 : -50;
                <span class="i">values</span>.<span class="i">Add</span>(<span class="i">trend</span> + <span class="i">r</span>.<b>Next</b>(0, 10));
            }
 
            <b>return</b> <span class="i">values</span>;
        }
 
        <b>public</b> <a id="237238f4906f9334" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">MariaSeriesVisibility</span> {
            <b>get</b> { <b>return</b> <span class="i">_mariaSeriesVisibility</span>; }
            <b>set</b> {
                <span class="i">_mariaSeriesVisibility</span> = <span class="i">value</span>;
                <span class="i">OnPropertyChanged</span>(<span class="s">&quot;MariaSeriesVisibility&quot;</span>);
            }
        }
 
        <b>public</b> <a id="237238f4906f9334" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">CharlesSeriesVisibility</span> {
            <b>get</b> { <b>return</b> <span class="i">_charlesSeriesVisibility</span>; }
            <b>set</b> {
                <span class="i">_charlesSeriesVisibility</span> = <span class="i">value</span>;
                <span class="i">OnPropertyChanged</span>(<span class="s">&quot;CharlesSeriesVisibility&quot;</span>);
            }
        }
 
        <b>public</b> <a id="237238f4906f9334" href="../../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">JohnSeriesVisibility</span> {
            <b>get</b> { <b>return</b> <span class="i">_johnSeriesVisibility</span>; }
            <b>set</b> {
                <span class="i">_johnSeriesVisibility</span> = <span class="i">value</span>;
                <span class="i">OnPropertyChanged</span>(<span class="s">&quot;JohnSeriesVisibility&quot;</span>);
            }
        }
    }
}</pre></td></tr></table></div></body></html>
