<!DOCTYPE html>
<html><head><title>DataOperations.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(92);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EasySYSTEMbuilderHelp/GlobalOperations/DataOperations.cs" target="_top">GlobalOperations\DataOperations.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EasySYSTEMbuilderHelp" target="_top">HelpProjects\EasySYSTEMbuilderHelp\EasySYSTEMbuilderHelp.vbproj</a> (EasySYSTEMbuilderHelp)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Threading</span>.<span class="i">Tasks</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Web</span>.<span class="i">Script</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Controls</span>;
 
<b>namespace</b> <span class="i n">EasyITSystemCenter</span>.<span class="i n">GlobalOperations</span> {
 
    /// &lt;<span class="i">summary</span>&gt;
    /// <span class="i">Centralized</span> <span class="i">DataOperations</span> <b>as</b> <span class="i">Cleaning</span> <span class="i">dataset</span> <span class="i">Language</span> <span class="i">Dictionary</span> <span class="i">Auto</span> <span class="i">filing</span>
    /// &lt;/<span class="i">summary</span>&gt;
    <span class="i">internal</span> <b>class</b> <a id="1a55950080b99087" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="e4ed1eb8574cff76">DataOperations</span></a> {
 
        /// &lt;<span class="i">summary</span>&gt; <span class="i">Convert</span> <span class="i">Dictionary</span>&lt;<b>string</b>,<b>string</b>&gt; <b>To</b> <span class="i">Json</span> <span class="i">Suportted</span> <span class="i">Values</span> <span class="i">Bool</span>, <span class="i">Int</span>, <b>String</b>
        /// &lt;/<span class="i">summary</span>&gt; &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static string</b> <span class="i">ConvertDataSetToJson</span>(<span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <span class="i">keyList</span>) {
            <span class="i">bool</span> <a id="a7e198cfaa252e3d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">tempBool</a>; <span class="i">int</span> <span class="i">tempInt</span> = 0;
            <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span class="i">exportJsonList</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;();
            <span class="i">keyList</span>.<span class="i">ToList</span>().<span class="i">ForEach</span>(<span class="i">key</span> =&gt; {
                <b>string</b> <span class="i">valueType</span> = <span class="i">bool</span>.<span class="i">TryParse</span>(<span class="i">key</span>.<span class="i">Value</span>, <span class="i">out</span> <span class="i">tempBool</span>) ? <span class="s">&quot;bool&quot;</span> : <span class="i">int</span>.<span class="i">TryParse</span>(<span class="i">key</span>.<span class="i">Value</span>, <span class="i">out</span> <span class="i">tempInt</span>) ? <span class="s">&quot;int&quot;</span> : <span class="s">&quot;string&quot;</span>;
                <span class="i">exportJsonList</span>.<span class="i">Add</span>(<span class="i">key</span>.<span class="i">Key</span>, (<span class="i">valueType</span> == <span class="s">&quot;bool&quot;</span> ? (<b>object</b>)<span class="i">tempBool</span> : <span class="i">valueType</span> == <span class="s">&quot;int&quot;</span> ? (<b>object</b>)<span class="i">tempInt</span> : (<b>object</b>)<span class="i">key</span>.<span class="i">Value</span>));
            });
            <b>return</b> <b>new</b> <span class="i">JavaScriptSerializer</span>().<span class="i">Serialize</span>(<span class="i">exportJsonList</span>);
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// !!! <span class="i">SYSTEM</span> <span class="i">RULE</span>: <span class="i">ClassList</span> <b>with</b> <span class="i">joining</span> <span class="i">fields</span> <span class="i">names</span> <span class="i">must</span> <span class="i">be</span> <span class="i">nullable</span> <span class="i">before</span> <span class="i">API</span>
        /// <span class="i">operation</span> !!! <span class="i">ClassName</span> <span class="i">must</span> <span class="i">contain</span>: <span class="s">&quot;Extended&quot;</span> <span class="i">WORD</span> <span class="i">Extension</span> <span class="i">field</span> <b>in Class</b> - <span class="i">Dataset</span>
        /// <span class="i">must</span> <span class="i">be</span> <b>set as</b> <span class="i">null</span> <span class="i">before</span> <span class="i">Database</span> <span class="i">Operation</span> <b>else is</b> <span class="i">joining</span> <b>to</b> <span class="i">other</span> <span class="i">dataset</span> <b>is</b> <span class="i">valid</span>
        /// <b>and</b> <span class="i">can</span> <span class="i">be</span> <span class="i">blocked</span> <span class="i">by</span> <span class="i">fail</span> <span class="i">key</span> <span class="i">Its</span> <span class="i">Check</span> <span class="i">Extended</span> <b>in</b> <span class="i">ClassName</span> - <span class="i">SYSTEM</span> <span class="i">RULE</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">typeparam</span> <span class="i">name</span>=<span class="s">&quot;T&quot;</span>&gt;&lt;/<span class="i">typeparam</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static</b> <a id="21b2eec8c2813ad3" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">NullSetInExtensionFields</span>&lt;<span class="i">T</span>&gt;(<span class="i">ref</span> <span class="i">T</span> <span class="i">dataset</span>) {
            <b>if</b> (<span class="i">dataset</span>.<span class="i">GetType</span>().<span class="i">Name</span>.<span class="i">ToLower</span>().<span class="i">Contains</span>(<span class="s">&quot;extended&quot;</span>)) {
                <span class="i">foreach</span> (<span class="i">PropertyInfo</span> <span class="i">prop</span> <b>in</b> <span class="i">dataset</span>.<b>GetType</b>().<span class="i">GetProperties</span>()) { <b>if</b> (<span class="i">prop</span>.<span class="i">DeclaringType</span>.<span class="i">Name</span>.<span class="i">Contains</span>(<span class="s">&quot;Extended&quot;</span>)) <span class="i">prop</span>.<span class="i">SetValue</span>(<span class="i">dataset</span>, <span class="i">null</span>); }
            }
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// !!! <span class="i">SYSTEM</span> <span class="i">RULE</span>: <span class="i">naming</span> <b>of</b> <span class="i">automatic</span> <span class="i">gtanslating</span> <span class="i">fields</span> <span class="i">must</span> <span class="i">be</span> <span class="i">type_fieldname</span> <span class="i">fieldname</span>
        /// <b>is</b> <span class="i">Translated</span> <span class="i">Over</span> <span class="i">DB</span> <span class="i">List</span> !!! <span class="i">Translation</span> <span class="i">List</span> <b>is</b> <span class="i">Automatic</span> <span class="i">Filling</span> <b>For</b> <span class="i">Logged</span> <span class="i">Agendas</span>
        /// <b>Function using</b> <span class="i">Referenced</span> <span class="i">Objects</span>
        /// <span class="i">Defined</span>: <span class="i">Grid</span>[label,<span class="i">button</span>],<span class="i">Label</span>, <span class="i">Button</span>, <span class="i">EXTEND</span> <span class="i">this</span> <span class="i">Fuction</span> <b>for</b> <span class="i">every</span> <span class="i">Parent</span> <span class="i">a</span> <span class="i">Direct</span>
        /// <span class="i">Types</span> <b>For</b> <span class="i">One</span> <b>Function</b> <span class="i">Translatings</span> !!! <span class="i">Translate</span> <span class="i">only</span> <span class="i">Empty</span> <span class="i">Contents</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static async</b> <a id="3d4639a50eb787bf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">Task</a>&lt;<span class="i">bool</span>&gt; <span class="i">TranslateFormFields</span>&lt;<span class="i">T</span>&gt;(<span class="i">T</span> <span class="i">parentObject</span>) {
            <b>try</b> {
                <b>if</b> (<span class="i">parentObject</span>.<span class="i">GetType</span>().<span class="i">Name</span>.<span class="i">ToLower</span>() == <span class="s">&quot;grid&quot;</span>) {
                    (<span class="i">parentObject</span> <b>as</b> <span class="i">Grid</span>).<span class="i">Children</span>.<span class="i">OfType</span>&lt;<span class="i">Label</span>&gt;().<span class="i">ToList</span>().<span class="i">ForEach</span>(<span class="i">async</span> <span class="i">label</span> =&gt; {
                        <b>if</b> (<span class="i">label</span>.<span class="i">Content</span> == <span class="i">null</span>) { <span class="i">label</span>.<span class="i">Content</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">label</span>.<span class="i">Name</span>.<span class="i">Split</span>(<span class="c">&#39;_&#39;)[1]); }</span>
                    });
                    (<span class="i">parentObject</span> <b>as</b> <span class="i">Grid</span>).<span class="i">Children</span>.<span class="i">OfType</span>&lt;<span class="i">Button</span>&gt;().<span class="i">ToList</span>().<span class="i">ForEach</span>(<span class="i">async</span> <span class="i">button</span> =&gt; {
                        <b>if</b> (<span class="i">button</span>.<span class="i">Content</span> == <span class="i">null</span>) { <span class="i">button</span>.<span class="i">Content</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="i">button</span>.<span class="i">Name</span>.<span class="i">Split</span>(<span class="c">&#39;_&#39;)[1]); }</span>
                    });
                }
                <b>if</b> (<span class="i">parentObject</span>.<span class="i">GetType</span>().<span class="i">Name</span>.<span class="i">ToLower</span>() == <span class="s">&quot;label&quot;</span>) {
                    <b>if</b> ((<span class="i">parentObject</span> <b>as</b> <span class="i">Label</span>).<span class="i">Content</span> == <span class="i">null</span>) { (<span class="i">parentObject</span> <b>as</b> <span class="i">Label</span>).<span class="i">Content</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>((<span class="i">parentObject</span> <b>as</b> <span class="i">Label</span>).<span class="i">Name</span>.<span class="i">Split</span>(<span class="c">&#39;_&#39;)[1]); }</span>
                }
                <b>if</b> (<span class="i">parentObject</span>.<span class="i">GetType</span>().<span class="i">Name</span>.<span class="i">ToLower</span>() == <span class="s">&quot;button&quot;</span>) {
                    <b>if</b> ((<span class="i">parentObject</span> <b>as</b> <span class="i">Button</span>).<span class="i">Content</span> == <span class="i">null</span>) { (<span class="i">parentObject</span> <b>as</b> <span class="i">Button</span>).<span class="i">Content</span> = <span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>((<span class="i">parentObject</span> <b>as</b> <span class="i">Button</span>).<span class="i">Name</span>.<span class="i">Split</span>(<span class="c">&#39;_&#39;)[1]); }</span>
                }
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">Ex</span>) { <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<span class="i">Ex</span>); }
            <b>return</b> <b>true</b>;
        }
 
        /// &lt;<span class="i">summary</span>&gt;
        /// <b>Return</b> <span class="i">Requested</span> <span class="i">User</span> <b>or if not</b> <span class="i">exist</span> <b>default</b> <span class="i">DB</span> <span class="i">parameter</span> <span class="i">CamelCase</span> <span class="i">Ignored</span>
        /// &lt;/<span class="i">summary</span>&gt;
        /// &lt;<span class="i">param</span> <span class="i">name</span>=<span class="s">&quot;parameterName&quot;</span>&gt;&lt;/<span class="i">param</span>&gt;
        /// &lt;<span class="i">returns</span>&gt;&lt;/<span class="i">returns</span>&gt;
        <b>public static async</b> <a id="3d4639a50eb787bf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">Task</a>&lt;<b>string</b>&gt; <span class="i">ParameterCheck</span>(<b>string</b> <span class="i">parameterName</span>) {
            <b>string</b> <span class="i">result</span> = <span class="i">null</span>;
            <b>try</b> {
                <b>if</b> (<span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span> != <span class="i">null</span>) {
                    <span class="i">result</span> = <span class="i">App</span>.<span class="i">ParameterList</span>.<span class="i">Where</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">SystemName</span>.<span class="i">ToLower</span>() == <span class="i">parameterName</span>.<span class="i">ToLower</span>() &amp;&amp; <span class="i">a</span>.<span class="i">UserId</span> == <span class="i">App</span>.<span class="i">UserData</span>.<span class="i">Authentification</span>.<span class="i">Id</span>).<b>Select</b>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">Value</span>).<span class="i">FirstOrDefault</span>();
                }
            } <b>catch</b> (<span class="i">Exception</span> <span class="i">Ex</span>) { <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<span class="i">Ex</span>); }
 
            <b>try</b> {
                <b>if</b> (<span class="i">result</span> == <span class="i">null</span>) {
                    <span class="i">result</span> = <span class="i">App</span>.<span class="i">ParameterList</span>.<span class="i">Where</span>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">SystemName</span>.<span class="i">ToLower</span>() == <span class="i">parameterName</span>.<span class="i">ToLower</span>() &amp;&amp; <span class="i">a</span>.<span class="i">UserId</span> == <span class="i">null</span>).<b>Select</b>(<span class="i">a</span> =&gt; <span class="i">a</span>.<span class="i">Value</span>).<span class="i">FirstOrDefault</span>();
                    <b>if</b> (<span class="i">result</span> == <span class="i">null</span>) <span class="i">App</span>.<span class="i">ApplicationLogging</span>(<b>new</b> <span class="i">Exception</span>(), $&quot;{<span class="i">await</span> <span class="i">DBOperations</span>.<span class="i">DBTranslation</span>(<span class="s">&quot;Missing Server Parameter&quot;</span>)}: {<span class="i">parameterName</span>}<span class="s">&quot;);
                }
                return result;
            } catch { return result; }
        }
    }
}</span></pre></td></tr></table></div></body></html>
