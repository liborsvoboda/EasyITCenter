<!DOCTYPE html>
<html><head><title>PhotoCollectionClasses.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(69);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EasySYSTEMbuilderHelp/GlobalClasses/PhotoCollectionClasses.cs" target="_top">GlobalClasses\PhotoCollectionClasses.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EasySYSTEMbuilderHelp" target="_top">HelpProjects\EasySYSTEMbuilderHelp\EasySYSTEMbuilderHelp.vbproj</a> (EasySYSTEMbuilderHelp)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Data</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Windows</span>.<span class="i">Media</span>.<span class="i">Imaging</span>;
 
<b>namespace</b> <span class="i n">EasyITSystemCenter</span>.<span class="i n">GlobalClasses</span> {
 
    <span class="i">internal</span> <b>class</b> <a id="c4c753e3750be954" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="28d54874febd9e64">UriToBitmapConverter</span></a> : <span class="i">IValueConverter</span> {
 
        <b>public object</b> <span class="i">Convert</span>
        (
            <b>object</b> <span class="i">value</span>,
            <span class="i">Type</span> <span class="i">targetType</span>,
            <b>object</b> <span class="i">parameter</span>,
            <span class="i">CultureInfo</span> <span class="i">culture</span>
        ) {
            <b>using</b> (<span class="i">var</span> <span class="i">stream</span> = <span class="i">File</span>.<span class="i">OpenRead</span>(<span class="i">value</span>?.<span class="i">ToString</span>())) {
                <span class="i">var</span> <a id="f0e177eb4ec2d12e" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">image</a> = <b>new</b> <a href="@0@PresentationCore/A.html#940e003698ec4c39" class="t constructor">BitmapImage</a>();
                <span class="i">image</span>.<span class="i">BeginInit</span>();
                <span class="i">image</span>.<span class="i">CacheOption</span> = <span class="i">BitmapCacheOption</span>.<span class="i">OnLoad</span>;
                <span class="i">image</span>.<span class="i">StreamSource</span> = <span class="i">stream</span>;
                <span class="i">image</span>.<span class="i">EndInit</span>();
                <b>return</b> <span class="i">value</span> = <span class="i">image</span>;
            }
        }
 
        <b>public object</b> <span class="i">ConvertBack</span>
        (
            <b>object</b> <span class="i">value</span>,
            <span class="i">Type</span> <span class="i">targetType</span>,
            <b>object</b> <span class="i">parameter</span>,
            <span class="i">CultureInfo</span> <span class="i">culture</span>
         ) {
            <b>throw</b> <b>new</b> <span class="t">Exception</span>(<span class="s">&quot;The method or operation is not implemented.&quot;</span>);
        }
    }
 
    <b>public class</b> <a id="53538988ac8360b6" href="../R/../../0000000000.html" target="n" data-glyph="0,1" class="t t"><span id="c88af7a433943ef4">PhotoCollection</span></a> : <span class="i">ObservableCollection</span>&lt;<span class="i">Photo</span>&gt; {
 
        <b>public</b> <a id="476ca5224319128e" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">PhotoCollection</a>() {
        }
 
        <b>public</b> <a id="c00ef8c409547ab4" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">void</a> <span class="i">Add</span>(<b>string</b> <span class="i">fullName</span>, <span class="i">int</span> <span class="i">dbId</span>, <span class="i">bool</span> <span class="i">isPrimary</span>) {
            <span class="i">Add</span>(<b>new</b> <span class="i">Photo</span>(<span class="i">fullName</span>, <span class="i">dbId</span>, <span class="i">isPrimary</span>));
        }
 
        <b>public</b> <b>new</b> <span class="i">void</span> <span class="i">Clear</span>() {
            <span class="i">Items</span>?.<span class="i">Clear</span>();
        }
    }
 
    <b>public class</b> <a id="3a4146833ee6e4e3" href="../R/../../0000000000.html" target="n" data-glyph="0,2" class="t t"><span id="70f77480960b47d0">Photo</span></a> {
        <b>private string</b> <span class="i">_path</span>;
        <b>private</b> <a id="01223df2e733231f" href="../R/../../0000000000.html" target="n" data-glyph="46,3" class="i field">bool</a> <span class="i">_isPrimary</span>;
        <b>private</b> <a id="c6f96772a6555a70" href="../R/../../0000000000.html" target="n" data-glyph="46,3" class="i field">int</a> <span class="i">_dbId</span>;
 
        <b>public</b> <a id="e23cf143569ca01d" href="../R/../../0000000000.html" target="n" data-glyph="42,3" class="i field">Photo</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">string</a> <span class="i">path</span>, <a id="c6f96772a6555a70" href="../R/../../0000000000.html" target="n" data-glyph="42,3" class="i field">int</a> <span class="i">dbId</span>, <span class="i">bool</span> <span class="i">isPrimary</span>) {
            <span class="i">_path</span> = <span class="i">path</span>;
            <span class="i">_isPrimary</span> = <span class="i">isPrimary</span>;
            <span class="i">_dbId</span> = <span class="i">dbId</span>;
        }
 
        <b>public</b> <a id="c6f96772a6555a70" href="../R/../../0000000000.html" target="n" data-glyph="42,3" class="i field">int</a> <span class="i">DbId</span> { <b>get</b> { <b>return</b> <span class="i">_dbId</span>; } <b>set</b> { <span class="i">_dbId</span> = <span class="i">value</span>; } }
        <b>public</b> <a id="01223df2e733231f" href="../R/../../0000000000.html" target="n" data-glyph="42,3" class="i field">bool</a> <span class="i">IsPrimary</span> { <b>get</b> { <b>return</b> <span class="i">_isPrimary</span>; } <b>set</b> { <span class="i">_isPrimary</span> = <span class="i">value</span>; } }
        <b>public string</b> <span class="i">Source</span> { <b>get</b> { <b>return</b> <span class="i">_path</span>; } <b>set</b> { <span class="i">_path</span> = <span class="i">value</span>; } }
    }
}</pre></td></tr></table></div></body></html>
