<!DOCTYPE html>
<html><head><title>ConcurrentObservableList.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(391);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#EasySYSTEMbuilderHelp/GlobalClasses/ConcurrentObservableList.cs" target="_top">GlobalClasses\ConcurrentObservableList.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#EasySYSTEMbuilderHelp" target="_top">HelpProjects\EasySYSTEMbuilderHelp\EasySYSTEMbuilderHelp.vbproj</a> (EasySYSTEMbuilderHelp)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Specialized</span>;
<b>using</b> <span class="i">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Linq</span>;
 
<b>namespace</b> <span class="i n">EasyITSystemCenter</span>.<span class="i n">GlobalClasses</span> {
 
    <b>public class</b> <a id="f7cc60fd5ae551f7" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="926f31c8b60850cb">ConcurrentObservableList</span></a>&lt;<span class="i">T</span>&gt; : <span class="i">IList</span>&lt;<span class="i">T</span>&gt;, <span class="i">INotifyCollectionChanged</span>, <span class="i">IDisposable</span> {
 
        <b>private delegate</b> <a id="324e9d7b4d7297f2" href="../R/../../0000000000.html" target="n" data-glyph="16,1" class="t t"><span id="dfd992fd84063723">void</span></a> <span class="i">_action</span>();
 
        <b>private</b> <a id="8179cac34eb38568" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">List</a>&lt;<span class="i">T</span>&gt; <span class="i">_list</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">T</span>&gt;();
 
        <b>private object</b> <span class="i">syncObject</span> = <b>new</b> <b>object</b>();
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> <span class="i">INotifyCollectionChanged</span> <span class="i">Members</span>
 
        <b>public event</b> <a id="e1137d6bc24bc32e" href="../R/../../0000000000.html" target="n" data-glyph="30,1" class="i">NotifyCollectionChangedEventHandler</a> <span class="i">CollectionChanged</span>;
 
        <b>private</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">RaiseCollectionChanged</span>(<span class="i">NotifyCollectionChangedAction</span> <span class="i">changeType</span>, <span class="i">T</span> <span class="i">oldItem</span>, <span class="i">T</span> <span class="i">newItem</span>, <span class="i">int</span> <span class="i">oldIndex</span>, <span class="i">int</span> <span class="i">newIndex</span>) {
            <b>if</b> (<span class="i">this</span>.<span class="i">CollectionChanged</span> != <span class="i">null</span>) {
                <b>try</b> {
                    <span class="i">switch</span> (<span class="i">changeType</span>) {
                        <b>case</b> <span class="i">NotifyCollectionChangedAction</span>.<span class="i">Reset</span>:
                            <b>if</b> (<span class="i">App</span>.<span class="i">Current</span> != <span class="i">null</span>)
                                <span class="i">App</span>.<span class="i">Current</span>.<span class="i">Dispatcher</span>.<span class="i">BeginInvoke</span>(<b>new</b> <span class="i">_action</span>(() =&gt; <span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">changeType</span>))));
                            <b>else</b>
                                <span class="i">this</span>.<span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">changeType</span>));
                            <span class="i">break</span>;
 
                        <b>case</b> <span class="i">NotifyCollectionChangedAction</span>.<span class="i">Add</span>:
                            <b>if</b> (<span class="i">App</span>.<span class="i">Current</span> != <span class="i">null</span>)
                                <span class="i">App</span>.<span class="i">Current</span>.<span class="i">Dispatcher</span>.<span class="i">BeginInvoke</span>(<b>new</b> <span class="i">_action</span>(() =&gt; <span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">changeType</span>, <span class="i">newItem</span>))));
                            <b>else</b>
                                <span class="i">this</span>.<span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">changeType</span>, <span class="i">newItem</span>));
                            <span class="i">break</span>;
 
                        <b>case</b> <span class="i">NotifyCollectionChangedAction</span>.<span class="i">Remove</span>:
                            <b>if</b> (<span class="i">App</span>.<span class="i">Current</span> != <span class="i">null</span>)
                                <span class="i">App</span>.<span class="i">Current</span>.<span class="i">Dispatcher</span>.<span class="i">BeginInvoke</span>(<b>new</b> <span class="i">_action</span>(() =&gt; <span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">changeType</span>, <span class="i">newItem</span>, <span class="i">oldIndex</span>))));
                            <b>else</b>
                                <span class="i">this</span>.<span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">changeType</span>, <span class="i">newItem</span>, <span class="i">oldIndex</span>));
                            <span class="i">break</span>;
 
                        <b>case</b> <span class="i">NotifyCollectionChangedAction</span>.<span class="i">Replace</span>:
                            <b>if</b> (<span class="i">App</span>.<span class="i">Current</span> != <span class="i">null</span>)
                                <span class="i">App</span>.<span class="i">Current</span>.<span class="i">Dispatcher</span>.<span class="i">BeginInvoke</span>(<b>new</b> <span class="i">_action</span>(() =&gt; <span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">changeType</span>, <span class="i">newItem</span>, <span class="i">oldItem</span>, <span class="i">oldIndex</span>))));
                            <b>else</b>
                                <span class="i">this</span>.<span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">changeType</span>, <span class="i">newItem</span>, <span class="i">oldItem</span>, <span class="i">oldIndex</span>));
                            <span class="i">break</span>;
 
                        <b>case</b> <span class="i">NotifyCollectionChangedAction</span>.<span class="i">Move</span>:
                            <b>if</b> (<span class="i">App</span>.<span class="i">Current</span> != <span class="i">null</span>)
                                <span class="i">App</span>.<span class="i">Current</span>.<span class="i">Dispatcher</span>.<span class="i">BeginInvoke</span>(<b>new</b> <span class="i">_action</span>(() =&gt; <span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Move</span>, <span class="i">newItem</span>, <span class="i">newIndex</span>, <span class="i">oldIndex</span>))));
                            <b>else</b>
                                <span class="i">this</span>.<span class="i">CollectionChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Move</span>, <span class="i">newItem</span>, <span class="i">newIndex</span>, <span class="i">oldIndex</span>));
                            <span class="i">break</span>;
                    }
                } <b>catch</b> (<span class="i">Exception</span> <span class="i">exceptio</span>) {
                    <b>throw</b>;
                }
            }
        }
 
        <b>private</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">RaiseCollectionChanged</span>(<span class="i">NotifyCollectionChangedEventArgs</span> <span class="i">e</span>) {
            <b>if</b> (<span class="i">this</span>.<span class="i">CollectionChanged</span> != <span class="i">null</span>) {
                <b>if</b> (<span class="i">App</span>.<span class="i">Current</span> != <span class="i">null</span>)
                    <span class="i">App</span>.<span class="i">Current</span>.<span class="i">Dispatcher</span>.<span class="i">BeginInvoke</span>(<b>new</b> <span class="i">_action</span>(() =&gt; <span class="i">this</span>.<span class="i">CollectionChanged</span>(<span class="i">this</span>, <span class="i">e</span>)));
                <b>else</b>
                    <span class="i">this</span>.<span class="i">CollectionChanged</span>(<span class="i">this</span>, <span class="i">e</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="i">endregion</span> <span class="i">INotifyCollectionChanged</span> <span class="i">Members</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> <span class="i">IList</span>&lt;<span class="i">T</span>&gt; <span class="i">Members</span>
 
        <b>public</b> <a id="cccc470bd8207b49" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">int</a> <span class="i">IndexOf</span>(<span class="i">T</span> <span class="i">item</span>) {
            <span class="i">int</span> <a id="1e60fb81104508ed" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">i</a> = -1;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <span class="i">i</span> = <span class="i">_list</span>.<span class="i">IndexOf</span>(<span class="i">item</span>);
            }
 
            <b>return</b> <span class="i">i</span>;
        }
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">Insert</span>(<span class="i">int</span> <span class="i">index</span>, <span class="i">T</span> <span class="i">item</span>) {
            <span class="i">bool</span> <a id="3d2246e7b78ab080" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">changed</a> = <b>false</b>;
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">_list</span>.<span class="i">Insert</span>(<span class="i">index</span>, <span class="i">item</span>);
                    <span class="i">changed</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="i">changed</span>) {
                <span class="i">RaisePropertyChanged</span>(<span class="s">&quot;Count&quot;</span>);
                <span class="i">RaiseCollectionChanged</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Add</span>, <span class="i">item</span>, <span class="i">item</span>, 0, 0);
            }
        }
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">RemoveAt</span>(<span class="i">int</span> <span class="i">index</span>) {
            <span class="i">bool</span> <a id="3d2246e7b78ab080" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">changed</a> = <b>false</b>;
            <span class="i">T</span> <a id="c87a9241f48e364c" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">oldItem</a> = (<a href="#a3a6527d7195b290" class="i field">T</a>)<span class="i">Activator</span>.<span class="i">CreateInstance</span>(<b>typeof</b>(<span class="i">T</span>), <b>new</b> <b>object</b>[] { 0, <b>string</b>.<span class="i">Empty</span> });
 
            <span class="i">T</span>[] <span class="i">arrT</span> = <b>new</b> <span class="i">T</span>[_list.<span class="i">Count</span>];
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">oldItem</span> = <span class="i">_list</span><span class="i">[index]</span>;
 
                    <span class="i">_list</span>.<span class="i">RemoveAt</span>(<span class="i">index</span>);
                    <span class="i">changed</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="i">changed</span>) {
                <span class="i">RaisePropertyChanged</span>(<span class="s">&quot;Count&quot;</span>);
                <span class="i">RaiseCollectionChanged</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Remove</span>, <span class="i">oldItem</span>, <span class="i">oldItem</span>, <span class="i">index</span>, <span class="i">index</span>);
            }
        }
 
        <b>public</b> <a id="a3a6527d7195b290" href="../R/a3a6527d7195b290.html" target="n" data-glyph="42,1" class="i field">T</a> <span class="i">this</span>[int <span class="i">index</span>] {
            <b>get</b> {
                <span class="i">T</span> <a id="57fe1ff02d41a60f" href="../R/57fe1ff02d41a60f.html" target="n" data-glyph="46,1" class="i field">newItem</a>;
 
                <span class="i">lock</span> (<span class="i">syncObject</span>) {
                    <span class="i">newItem</span> = <span class="i">_list</span>.<span class="i">ElementAt</span>&lt;<span class="i">T</span>&gt;(<span class="i">index</span>);
                }
 
                <b>return</b> <span class="i">newItem</span>;
            }
            <b>set</b> {
                <span class="i">bool</span> <a id="3dae710db0e0db0d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">isChanged</a> = <b>false</b>;
                <span class="i">T</span> <a id="c87a9241f48e364c" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">oldItem</a> = <span class="i">_list</span>.<span class="i">ElementAt</span>&lt;<a href="#a3a6527d7195b290" class="i field">T</a>&gt;(<span class="i">index</span>);
 
                <span class="i">lock</span> (<span class="i">syncObject</span>) {
                    <b>if</b> (<span class="i">oldItem</span>.<span class="i">Equals</span>(<span class="i">value</span>) == <b>false</b> &amp;&amp; <span class="i">_isReadOnly</span> == <b>false</b>) {
                        <span class="i">_list</span><a id="8bf39a9b54ee324a" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">[index]</a> = <span class="i">value</span>;
                        <span class="i">isChanged</span> = <b>true</b>;
                    }
                }
 
                <b>if</b> (<span class="i">isChanged</span>)
                    <span class="i">RaiseCollectionChanged</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Replace</span>, <span class="i">oldItem</span>, <span class="i">value</span>, <span class="i">index</span>, 0);
            }
        }
 
        <span class="k preprocess">#</span><span class="i">endregion</span> <span class="i">IList</span>&lt;<span class="i">T</span>&gt; <span class="i">Members</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> <span class="i">ICollection</span>&lt;<span class="i">T</span>&gt; <span class="i">Members</span>
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">Add</span>(<span class="i">T</span> <span class="i">item</span>) {
            <span class="i">bool</span> <a id="3dae710db0e0db0d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">isChanged</a> = <b>false</b>;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">_list</span>.<span class="i">Add</span>(<span class="i">item</span>);
                    <span class="i">isChanged</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="i">isChanged</span>) {
                <span class="i">RaisePropertyChanged</span>(<span class="s">&quot;Count&quot;</span>);
                <span class="i">RaiseCollectionChanged</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Add</span>, <span class="i">item</span>, <span class="i">item</span>, 0, 0);
            }
        }
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">Clear</span>() {
            <span class="i">bool</span> <a id="3dae710db0e0db0d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">isChanged</a> = <b>false</b>;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">_list</span>.<span class="i">Clear</span>();
                    <span class="i">isChanged</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="i">isChanged</span>) {
                <span class="i">RaisePropertyChanged</span>(<span class="s">&quot;Count&quot;</span>);
                <span class="i">RaiseCollectionChanged</span>(<b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Reset</span>));
            }
        }
 
        <b>public</b> <a id="ac01b7e8f55c2e09" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">Contains</span>(<span class="i">T</span> <span class="i">item</span>) {
            <span class="i">bool</span> <a id="fd93d4c82293b31c" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">contains</a> = <b>false</b>;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <span class="i">contains</span> = <span class="i">_list</span>.<span class="i">Contains</span>&lt;<span class="i">T</span>&gt;(<span class="i">item</span>);
            }
 
            <b>return</b> <span class="i">contains</span>;
        }
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">CopyTo</span>(<span class="i">T</span>[] <span class="i">array</span>, <span class="i">int</span> <span class="i">arrayIndex</span>) {
            <span class="i">bool</span> <a id="3dae710db0e0db0d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">isChanged</a> = <b>false</b>;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">_list</span>.<span class="i">CopyTo</span>(<span class="i">array</span>, <span class="i">arrayIndex</span>);
                    <span class="i">isChanged</span> = <b>true</b>;
                }
            }
 
            <span class="i">T</span> <a id="ec00e9ac040e4837" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">item</a> = (<a href="#a3a6527d7195b290" class="i field">T</a>)<span class="i">Activator</span>.<span class="i">CreateInstance</span>(<b>typeof</b>(<span class="i">T</span>), <b>new</b> <b>object</b>[] { 0, <b>string</b>.<span class="i">Empty</span> });
 
            <b>if</b> (<span class="i">isChanged</span>)
                <span class="i">RaiseCollectionChanged</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Reset</span>, <span class="i">item</span>, <span class="i">item</span>, 0, 0);
        }
 
        <b>public</b> <a id="cccc470bd8207b49" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">int</a> <span class="i">Count</span> {
            <b>get</b> {
                <span class="i">int</span> <a id="1e60fb81104508ed" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">i</a> = 0;
 
                <span class="i">lock</span> (<span class="i">syncObject</span>) {
                    <span class="i">i</span> = <span class="i">_list</span>.<span class="i">Count</span>;
                }
 
                <b>return</b> <span class="i">i</span>;
            }
        }
 
        <b>private</b> <a id="ac01b7e8f55c2e09" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">bool</a> <span class="i">_isReadOnly</span>;
 
        <b>public</b> <a id="ac01b7e8f55c2e09" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">IsReadOnly</span> {
            <b>get</b> { <b>return</b> <span class="i">_isReadOnly</span>; }
        }
 
        <b>public</b> <a id="ac01b7e8f55c2e09" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">Remove</span>(<span class="i">T</span> <span class="i">item</span>) {
            <span class="i">bool</span> <a id="3d2246e7b78ab080" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">changed</a> = <b>false</b>;
            <span class="i">int</span> <a id="8bf39a9b54ee324a" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">index</a> = 0;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">index</span> = <span class="i">_list</span>.<span class="i">IndexOf</span>(<span class="i">item</span>);
                    <span class="i">changed</span> = <span class="i">_list</span>.<span class="i">Remove</span>(<span class="i">item</span>);
                }
            }
 
            <b>if</b> (<span class="i">changed</span>) {
                <span class="i">RaisePropertyChanged</span>(<span class="s">&quot;Count&quot;</span>);
                <span class="i">RaiseCollectionChanged</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Remove</span>, <span class="i">item</span>, <span class="i">item</span>, <span class="i">index</span>, <span class="i">index</span>);
            }
 
            <b>return</b> <span class="i">changed</span>;
        }
 
        <span class="k preprocess">#</span><span class="i">endregion</span> <span class="i">ICollection</span>&lt;<span class="i">T</span>&gt; <span class="i">Members</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> <span class="i">IEnumerable</span>&lt;<span class="i">T</span>&gt; <span class="i">Members</span>
 
        <b>public</b> <a id="3340fd917beff40b" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">IEnumerator</a>&lt;<span class="i">T</span>&gt; <span class="i">GetEnumerator</span>() {
            <b>return</b> <span class="i">_list</span>.<span class="i">GetEnumerator</span>();
        }
 
        <span class="k preprocess">#</span><span class="i">endregion</span> <span class="i">IEnumerable</span>&lt;<span class="i">T</span>&gt; <span class="i">Members</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> <span class="i">IEnumerable</span> <span class="i">Members</span>
 
        <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">IEnumerator</span> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">IEnumerable</span>.<span class="i">GetEnumerator</span>() {
            <b>return</b> <span class="i">_list</span>.<span class="i">GetEnumerator</span>();
        }
 
        <span class="k preprocess">#</span><span class="i">endregion</span> <span class="i">IEnumerable</span> <span class="i">Members</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> <span class="i">INotifyPropertyChanged</span> <span class="i">Members</span>
 
        <b>public event</b> <a id="a7402331f49e4077" href="../R/../../0000000000.html" target="n" data-glyph="30,1" class="i">PropertyChangedEventHandler</a> <span class="i">PropertyChanged</span>;
 
        <b>private</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">void</a> <span class="i">RaisePropertyChanged</span>(<b>string</b> <span class="i">propertyName</span>) {
            <b>if</b> (<span class="i">PropertyChanged</span> != <span class="i">null</span>)
                <span class="i">this</span>.<span class="i">PropertyChanged</span>(<span class="i">this</span>, <b>new</b> <span class="i">PropertyChangedEventArgs</span>(<span class="i">propertyName</span>));
        }
 
        <span class="k preprocess">#</span><span class="i">endregion</span> <span class="i">INotifyPropertyChanged</span> <span class="i">Members</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> <span class="i">Range</span> <span class="i">Operations</span> <b>for</b> <span class="i">better</span> <span class="i">performance</span>
 
        <b>public</b> <a id="8179cac34eb38568" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">List</a>&lt;<span class="i">T</span>&gt; <span class="i">GetRange</span>(<span class="i">int</span> <span class="i">index</span>, <span class="i">int</span> <span class="i">count</span>) {
            <span class="i">List</span>&lt;<span class="i">T</span>&gt; <span class="i">range</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">T</span>&gt;();
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <span class="i">range</span> = <span class="i">_list</span>.<span class="i">GetRange</span>(<span class="i">index</span>, <span class="i">count</span>);
            }
 
            <b>return</b> <span class="i">range</span>;
        }
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">AddRange</span>(<span class="i">IEnumerable</span>&lt;<span class="i">T</span>&gt; <span class="i">range</span>) {
            <span class="i">bool</span> <a id="3dae710db0e0db0d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">isChanged</a> = <b>false</b>;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">_list</span>.<span class="i">AddRange</span>(<span class="i">range</span>);
                    <span class="i">isChanged</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="i">isChanged</span>) {
                <span class="i">RaisePropertyChanged</span>(<span class="s">&quot;Count&quot;</span>);
                <span class="i">RaiseCollectionChanged</span>(<b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Add</span>, <b>new</b> <span class="i">List</span>&lt;<span class="i">T</span>&gt;(<span class="i">range</span>)));
            }
        }
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">InsertRange</span>(<span class="i">int</span> <span class="i">index</span>, <span class="i">IEnumerable</span>&lt;<span class="i">T</span>&gt; <span class="i">range</span>) {
            <span class="i">bool</span> <a id="3dae710db0e0db0d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">isChanged</a> = <b>false</b>;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">_list</span>.<span class="i">InsertRange</span>(<span class="i">index</span>, <span class="i">range</span>);
                    <span class="i">isChanged</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="i">isChanged</span>) {
                <span class="i">RaisePropertyChanged</span>(<span class="s">&quot;Count&quot;</span>);
                <span class="i">RaiseCollectionChanged</span>(<b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Add</span>, <b>new</b> <span class="i">List</span>&lt;<span class="i">T</span>&gt;(<span class="i">range</span>), <span class="i">index</span>));
            }
        }
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">RemoveRange</span>(<span class="i">int</span> <span class="i">index</span>, <span class="i">int</span> <span class="i">count</span>) {
            <span class="i">bool</span> <a id="3dae710db0e0db0d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">isChanged</a> = <b>false</b>;
            <span class="i">IEnumerable</span>&lt;<span class="i">T</span>&gt; <span class="i">range</span> = <b>new</b> <span class="i">T</span>[0];
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">range</span> = <span class="i">_list</span>.<span class="i">GetRange</span>(<span class="i">index</span>, <span class="i">count</span>);
 
                    <span class="i">_list</span>.<span class="i">RemoveRange</span>(<span class="i">index</span>, <span class="i">count</span>);
                    <span class="i">isChanged</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="i">isChanged</span>) {
                <span class="i">RaisePropertyChanged</span>(<span class="s">&quot;Count&quot;</span>);
                <span class="i">RaiseCollectionChanged</span>(<b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Remove</span>, <b>new</b> <span class="i">List</span>&lt;<span class="i">T</span>&gt;(<span class="i">range</span>), <span class="i">index</span>));
            }
        }
 
        <span class="k preprocess">#</span><span class="i">endregion</span> <span class="i">Range</span> <span class="i">Operations</span> <b>for</b> <span class="i">better</span> <span class="i">performance</span>
 
        <b>public</b> <a id="ac01b7e8f55c2e09" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">bool</a> <span class="i">Replace</span>(<span class="i">T</span> <span class="i">oldItem</span>, <span class="i">T</span> <span class="i">newItem</span>) {
            <span class="i">bool</span> <a id="3d2246e7b78ab080" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">changed</a> = <b>false</b>;
            <span class="i">bool</span> <a id="47209d9462d531a5" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">result</a> = <b>false</b>;
            <span class="i">int</span> <a id="8bf39a9b54ee324a" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">index</a> = 0;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">index</span> = <span class="i">_list</span>.<span class="i">IndexOf</span>(<span class="i">oldItem</span>);
                    <b>if</b> (<span class="i">index</span> != -1) {
                        <span class="i">_list</span><a id="8bf39a9b54ee324a" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">[index]</a> = <a href="#57fe1ff02d41a60f" class="i field">newItem</a>;
                        <span class="i">result</span> = <b>true</b>;
                        <span class="i">changed</span> = <b>true</b>;
                    }
                }
            }
 
            <b>if</b> (<span class="i">changed</span>) {
                <span class="i">RaiseCollectionChanged</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Replace</span>, <span class="i">oldItem</span>, <span class="i">newItem</span>, <span class="i">index</span>, <span class="i">index</span>);
            }
 
            <b>return</b> <span class="i">result</span>;
        }
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">Sort</span>(<span class="i">Comparison</span>&lt;<span class="i">T</span>&gt; <span class="i">comparison</span>) {
            <span class="i">bool</span> <a id="3dae710db0e0db0d" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">isChanged</a> = <b>false</b>;
 
            <span class="i">lock</span> (<span class="i">syncObject</span>) {
                <b>if</b> (!<span class="i">_isReadOnly</span>) {
                    <span class="i">_list</span>.<span class="i">Sort</span>(<span class="i">comparison</span>);
                    <span class="i">isChanged</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="i">isChanged</span>) {
                <span class="i">RaiseCollectionChanged</span>(<b>new</b> <span class="i">NotifyCollectionChangedEventArgs</span>(<span class="i">NotifyCollectionChangedAction</span>.<span class="i">Reset</span>));
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> <span class="i">IDisposable</span> <span class="i">Members</span>
 
        <b>public</b> <a id="a3f2a2bb04865bdf" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">void</a> <span class="i">Dispose</span>() {
            <span class="i">this</span>.<span class="i">CollectionChanged</span> = <span class="i">null</span>;
            <span class="i">this</span>.<span class="i">_list</span>.<span class="i">Clear</span>();
        }
 
        <span class="k preprocess">#</span><span class="i">endregion</span> <span class="i">IDisposable</span> <span class="i">Members</span>
    }
}</pre></td></tr></table></div></body></html>
