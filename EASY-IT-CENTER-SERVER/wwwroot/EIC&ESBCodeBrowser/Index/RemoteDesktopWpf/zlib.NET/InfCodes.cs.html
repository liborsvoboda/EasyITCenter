<!DOCTYPE html>
<html><head><title>InfCodes.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(716);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#RemoteDesktopWpf/zlib.NET/InfCodes.cs" target="_top">zlib.NET\InfCodes.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#RemoteDesktopWpf" target="_top">..\..\..\EASY-TOOLS\EASYTools.VNCLib\EASYTools.VNCLib.csproj</a> (RemoteDesktopWpf)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) 2006, ComponentAce</span>
<span class="c">// http://www.componentace.com</span>
<span class="c">// All rights reserved.</span>
 
<span class="c">// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
 
<span class="c">// Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. </span>
<span class="c">// Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. </span>
<span class="c">// Neither the name of ComponentAce nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. </span>
<span class="c">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
 
<span class="c">/*
Copyright (c) 2000,2001,2002,2003 ymnk, JCraft,Inc. All rights reserved.
 
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
 
1. Redistributions of source code must retain the above copyright notice,
this list of conditions and the following disclaimer.
 
2. Redistributions in binary form must reproduce the above copyright 
notice, this list of conditions and the following disclaimer in 
the documentation and/or other materials provided with the distribution.
 
3. The names of the authors may not be used to endorse or promote products
derived from this software without specific prior written permission.
 
THIS SOFTWARE IS PROVIDED ``AS IS&#39;&#39; AND ANY EXPRESSED OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,
INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/</span>
<span class="c">/*
* This program is based on zlib-1.1.3, so all credit should go authors
* Jean-loup Gailly(jloup@gzip.org) and Mark Adler(madler@alumni.caltech.edu)
* and contributors of zlib.
*/</span>
<b>using</b> <span class="i n">System</span>;
<b>namespace</b> <span class="i n">ComponentAce</span>.<span class="i n">Compression</span>.<span class="i n">Libs</span>.<span class="i n">zlib</span>
{
	
	<b>sealed class</b> <a id="73c4600b5e76c805" href="../R/73c4600b5e76c805.html" target="n" data-glyph="2,0" class="t t">InfCodes</a>
	{
				
		<b>private static readonly int</b>[] <a id="c1cfa3b2be41907f" href="../R/c1cfa3b2be41907f.html" target="n" data-glyph="46,1" class="i field">inflate_mask</a> = <b>new</b> <b>int</b>[]{0x00000000, 0x00000001, 0x00000003, 0x00000007, 0x0000000f, 0x0000001f, 0x0000003f, 0x0000007f, 0x000000ff, 0x000001ff, 0x000003ff, 0x000007ff, 0x00000fff, 0x00001fff, 0x00003fff, 0x00007fff, 0x0000ffff};
		
		<b>private const int</b> <a id="91701606774014fa" href="../R/91701606774014fa.html" target="n" data-glyph="10,1" class="i field">Z_OK</a> = 0;
		<b>private const int</b> <a id="8eff6d61e4cb747a" href="../R/8eff6d61e4cb747a.html" target="n" data-glyph="10,1" class="i field">Z_STREAM_END</a> = 1;
		<b>private const int</b> <a id="b6d35206d6edfda0" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">Z_NEED_DICT</a> = 2;
		<b>private const int</b> <a id="94a80c4b1f3948ff" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">Z_ERRNO</a> = - 1;
		<b>private const int</b> <a id="3dc18c9302362335" href="../R/3dc18c9302362335.html" target="n" data-glyph="10,1" class="i field">Z_STREAM_ERROR</a> = - 2;
		<b>private const int</b> <a id="a48dccf3678d1b7c" href="../R/a48dccf3678d1b7c.html" target="n" data-glyph="10,1" class="i field">Z_DATA_ERROR</a> = - 3;
		<b>private const int</b> <a id="682b79de230631d9" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">Z_MEM_ERROR</a> = - 4;
		<b>private const int</b> <a id="d66baba2cac4d9f3" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">Z_BUF_ERROR</a> = - 5;
		<b>private const int</b> <a id="d441fa4adbf91f3c" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">Z_VERSION_ERROR</a> = - 6;
		
		<span class="c">// waiting for &quot;i:&quot;=input,</span>
		<span class="c">//             &quot;o:&quot;=output,</span>
		<span class="c">//             &quot;x:&quot;=nothing</span>
		<b>private const int</b> <a id="ed642cd58e2f4633" href="../R/ed642cd58e2f4633.html" target="n" data-glyph="10,1" class="i field">START</a> = 0; <span class="c">// x: set up for LEN</span>
		<b>private const int</b> <a id="c5b0af6fd5760ec8" href="../R/c5b0af6fd5760ec8.html" target="n" data-glyph="10,1" class="i field">LEN</a> = 1; <span class="c">// i: get length/literal/eob next</span>
		<b>private const int</b> <a id="8a0c1d266bd90219" href="../R/8a0c1d266bd90219.html" target="n" data-glyph="10,1" class="i field">LENEXT</a> = 2; <span class="c">// i: getting length extra (have base)</span>
		<b>private const int</b> <a id="f0089db72bf9347a" href="../R/f0089db72bf9347a.html" target="n" data-glyph="10,1" class="i field">DIST</a> = 3; <span class="c">// i: get distance next</span>
		<b>private const int</b> <a id="154e0d34d8284397" href="../R/154e0d34d8284397.html" target="n" data-glyph="10,1" class="i field">DISTEXT</a> = 4; <span class="c">// i: getting distance extra</span>
		<b>private const int</b> <a id="742abd21f41276ed" href="../R/742abd21f41276ed.html" target="n" data-glyph="10,1" class="i field">COPY</a> = 5; <span class="c">// o: copying bytes in window, waiting for space</span>
		<b>private const int</b> <a id="5b7d2e8c40c0c66b" href="../R/5b7d2e8c40c0c66b.html" target="n" data-glyph="10,1" class="i field">LIT</a> = 6; <span class="c">// o: got literal, waiting for output space</span>
		<b>private const int</b> <a id="f35f0496cea33ba3" href="../R/f35f0496cea33ba3.html" target="n" data-glyph="10,1" class="i field">WASH</a> = 7; <span class="c">// o: got eob, possibly still output waiting</span>
		<b>private const int</b> <a id="8271e609499e49ae" href="../R/8271e609499e49ae.html" target="n" data-glyph="10,1" class="i field">END</a> = 8; <span class="c">// x: got eob and all data flushed</span>
		<b>private const int</b> <a id="fff005b5419e4e89" href="../R/fff005b5419e4e89.html" target="n" data-glyph="10,1" class="i field">BADCODE</a> = 9; <span class="c">// x: got error</span>
		
		<b>internal int</b> <a id="25b2c3771b6c28b0" href="../R/25b2c3771b6c28b0.html" target="n" data-glyph="44,1" class="i field">mode</a>; <span class="c">// current inflate_codes mode</span>
		
		<span class="c">// mode dependent information</span>
		<b>internal int</b> <a id="44007efc60cd3bf8" href="../R/44007efc60cd3bf8.html" target="n" data-glyph="44,1" class="i field">len</a>;
		
		<b>internal int</b>[] <a id="ede69d9aa8a2890f" href="../R/ede69d9aa8a2890f.html" target="n" data-glyph="44,1" class="i field">tree</a>; <span class="c">// pointer into tree</span>
		<b>internal int</b> <a id="eba9a339d7648c50" href="../R/eba9a339d7648c50.html" target="n" data-glyph="44,1" class="i field">tree_index</a> = 0;
		<b>internal int</b> <a id="17b97a35bae47bc8" href="../R/17b97a35bae47bc8.html" target="n" data-glyph="44,1" class="i field">need</a>; <span class="c">// bits needed</span>
		
		<b>internal int</b> <a id="bb7c3370b655ec87" href="../R/bb7c3370b655ec87.html" target="n" data-glyph="44,1" class="i field">lit</a>;
		
		<span class="c">// if EXT or COPY, where and how much</span>
		<b>internal int</b> <a id="099fa332bd89d7a9" href="../R/099fa332bd89d7a9.html" target="n" data-glyph="44,1" class="i field">get_Renamed</a>; <span class="c">// bits to get for extra</span>
		<b>internal int</b> <a id="b8c032fa70cef3be" href="../R/b8c032fa70cef3be.html" target="n" data-glyph="44,1" class="i field">dist</a>; <span class="c">// distance back to copy from</span>
		
		<b>internal byte</b> <a id="940bba9638637993" href="../R/940bba9638637993.html" target="n" data-glyph="44,1" class="i field">lbits</a>; <span class="c">// ltree bits decoded per branch</span>
		<b>internal byte</b> <a id="f00976cb417244fc" href="../R/f00976cb417244fc.html" target="n" data-glyph="44,1" class="i field">dbits</a>; <span class="c">// dtree bits decoder per branch</span>
		<b>internal int</b>[] <a id="6e0ad375c8fad67b" href="../R/6e0ad375c8fad67b.html" target="n" data-glyph="44,1" class="i field">ltree</a>; <span class="c">// literal/length/eob tree</span>
		<b>internal int</b> <a id="36320e15af6dffbb" href="../R/36320e15af6dffbb.html" target="n" data-glyph="44,1" class="i field">ltree_index</a>; <span class="c">// literal/length/eob tree</span>
		<b>internal int</b>[] <a id="dadfe4d157e129dc" href="../R/dadfe4d157e129dc.html" target="n" data-glyph="44,1" class="i field">dtree</a>; <span class="c">// distance tree</span>
		<b>internal int</b> <a id="a19e53344e8a3e02" href="../R/a19e53344e8a3e02.html" target="n" data-glyph="44,1" class="i field">dtree_index</a>; <span class="c">// distance tree</span>
		
		<b>internal</b> <a id="7587a585c0ac4aa9" href="../R/7587a585c0ac4aa9.html" target="n" data-glyph="74,1" class="t constructor">InfCodes</a>(<b>int</b> <span id="r0 rd" class="r0 r">bl</span>, <b>int</b> <span id="r1 rd" class="r1 r">bd</span>, <b>int</b>[] <span id="r2 rd" class="r2 r">tl</span>, <b>int</b> <span id="r3 rd" class="r3 r">tl_index</span>, <b>int</b>[] <span id="r4 rd" class="r4 r">td</span>, <b>int</b> <span id="r5 rd" class="r5 r">td_index</span>, <a href="ZStream.cs.html#365c5b87c76eccc4" class="t t">ZStream</a> <span id="r6 rd" class="r6 r">z</span>)
		{
			<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#ed642cd58e2f4633" class="i field">START</a>;
			<a href="#940bba9638637993" class="i field">lbits</a> = (<b>byte</b>) <span class="r0 r">bl</span>;
			<a href="#f00976cb417244fc" class="i field">dbits</a> = (<b>byte</b>) <span class="r1 r">bd</span>;
			<a href="#6e0ad375c8fad67b" class="i field">ltree</a> = <span class="r2 r">tl</span>;
			<a href="#36320e15af6dffbb" class="i field">ltree_index</a> = <span class="r3 r">tl_index</span>;
			<a href="#dadfe4d157e129dc" class="i field">dtree</a> = <span class="r4 r">td</span>;
			<a href="#a19e53344e8a3e02" class="i field">dtree_index</a> = <span class="r5 r">td_index</span>;
		}
		
		<b>internal</b> <a id="bec6133bdbd9005d" href="../R/bec6133bdbd9005d.html" target="n" data-glyph="74,1" class="t constructor">InfCodes</a>(<b>int</b> <span id="r7 rd" class="r7 r">bl</span>, <b>int</b> <span id="r8 rd" class="r8 r">bd</span>, <b>int</b>[] <span id="r9 rd" class="r9 r">tl</span>, <b>int</b>[] <span id="r10 rd" class="r10 r">td</span>, <a href="ZStream.cs.html#365c5b87c76eccc4" class="t t">ZStream</a> <span id="r11 rd" class="r11 r">z</span>)
		{
			<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#ed642cd58e2f4633" class="i field">START</a>;
			<a href="#940bba9638637993" class="i field">lbits</a> = (<b>byte</b>) <span class="r7 r">bl</span>;
			<a href="#f00976cb417244fc" class="i field">dbits</a> = (<b>byte</b>) <span class="r8 r">bd</span>;
			<a href="#6e0ad375c8fad67b" class="i field">ltree</a> = <span class="r9 r">tl</span>;
			<a href="#36320e15af6dffbb" class="i field">ltree_index</a> = 0;
			<a href="#dadfe4d157e129dc" class="i field">dtree</a> = <span class="r10 r">td</span>;
			<a href="#a19e53344e8a3e02" class="i field">dtree_index</a> = 0;
		}
		
		<b>internal int</b> <a id="d52498f6d348d204" href="../R/d52498f6d348d204.html" target="n" data-glyph="74,1" class="i method">proc</a>(<a href="InfBlocks.cs.html#502251477a375329" class="t t">InfBlocks</a> <span id="r12 rd" class="r12 r">s</span>, <a href="ZStream.cs.html#365c5b87c76eccc4" class="t t">ZStream</a> <span id="r13 rd" class="r13 r">z</span>, <b>int</b> <span id="r14 rd" class="r14 r">r</span>)
		{
			<b>int</b> <span id="r15 rd" class="r15 r">j</span>; <span class="c">// temporary storage</span>
			 <span class="c">//int[] t; // temporary pointer</span>
			<b>int</b> <span id="r16 rd" class="r16 r">tindex</span>; <span class="c">// temporary pointer</span>
			<b>int</b> <span id="r17 rd" class="r17 r">e</span>; <span class="c">// extra bits or operation</span>
			<b>int</b> <span id="r18 rd" class="r18 r">b</span> = 0; <span class="c">// bit buffer</span>
			<b>int</b> <span id="r19 rd" class="r19 r">k</span> = 0; <span class="c">// bits in bit buffer</span>
			<b>int</b> <span id="r20 rd" class="r20 r">p</span> = 0; <span class="c">// input data pointer</span>
			<b>int</b> <span id="r21 rd" class="r21 r">n</span>; <span class="c">// bytes available there</span>
			<b>int</b> <span id="r22 rd" class="r22 r">q</span>; <span class="c">// output window write pointer</span>
			<b>int</b> <span id="r23 rd" class="r23 r">m</span>; <span class="c">// bytes to end of window or read pointer</span>
			<b>int</b> <span id="r24 rd" class="r24 r">f</span>; <span class="c">// pointer to copy strings from</span>
			
			<span class="c">// copy input/output information to locals (UPDATE macro restores)</span>
			<span class="r20 r">p</span> = <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r21 r">n</span> = <span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a>; <span class="r18 r">b</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a>; <span class="r19 r">k</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a>;
			<span class="r22 r">q</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a>; <span class="r23 r">m</span> = <span class="r22 r">q</span> &lt; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r22 r">q</span> - 1:<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r22 r">q</span>;
			
			<span class="c">// process input and output based on current state</span>
			<b>while</b> (<b>true</b>)
			{
				<b>switch</b> (<a href="#25b2c3771b6c28b0" class="i field">mode</a>)
				{
					
					<span class="c">// waiting for &quot;i:&quot;=input, &quot;o:&quot;=output, &quot;x:&quot;=nothing</span>
					<b>case</b> <a href="#ed642cd58e2f4633" class="i field">START</a>:  <span class="c">// x: set up for LEN</span>
						<b>if</b> (<span class="r23 r">m</span> &gt;= 258 &amp;&amp; <span class="r21 r">n</span> &gt;= 10)
						{
							
							<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
							<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
							<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
							<span class="r14 r">r</span> = <a href="#3a19c85662975b12" class="i method">inflate_fast</a>(<a href="#940bba9638637993" class="i field">lbits</a>, <a href="#f00976cb417244fc" class="i field">dbits</a>, <a href="#6e0ad375c8fad67b" class="i field">ltree</a>, <a href="#36320e15af6dffbb" class="i field">ltree_index</a>, <a href="#dadfe4d157e129dc" class="i field">dtree</a>, <a href="#a19e53344e8a3e02" class="i field">dtree_index</a>, <span class="r12 r">s</span>, <span class="r13 r">z</span>);
							
							<span class="r20 r">p</span> = <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r21 r">n</span> = <span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a>; <span class="r18 r">b</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a>; <span class="r19 r">k</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a>;
							<span class="r22 r">q</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a>; <span class="r23 r">m</span> = <span class="r22 r">q</span> &lt; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r22 r">q</span> - 1:<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r22 r">q</span>;
							
							<b>if</b> (<span class="r14 r">r</span> != <a href="#91701606774014fa" class="i field">Z_OK</a>)
							{
								<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <span class="r14 r">r</span> == <a href="#8eff6d61e4cb747a" class="i field">Z_STREAM_END</a>?<a href="#f35f0496cea33ba3" class="i field">WASH</a>:<a href="#fff005b5419e4e89" class="i field">BADCODE</a>;
								<b>break</b>;
							}
						}
						<a href="#17b97a35bae47bc8" class="i field">need</a> = <a href="#940bba9638637993" class="i field">lbits</a>;
						<a href="#ede69d9aa8a2890f" class="i field">tree</a> = <a href="#6e0ad375c8fad67b" class="i field">ltree</a>;
						<a href="#eba9a339d7648c50" class="i field">tree_index</a> = <a href="#36320e15af6dffbb" class="i field">ltree_index</a>;
						
						<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#c5b0af6fd5760ec8" class="i field">LEN</a>;
						<b>goto</b> <b>case</b> <a href="#c5b0af6fd5760ec8" class="i field">LEN</a>;
					
					<b>case</b> <a href="#c5b0af6fd5760ec8" class="i field">LEN</a>:  <span class="c">// i: get length/literal/eob next</span>
						<span class="r15 r">j</span> = <a href="#17b97a35bae47bc8" class="i field">need</a>;
						
						<b>while</b> (<span class="r19 r">k</span> &lt; (<span class="r15 r">j</span>))
						{
							<b>if</b> (<span class="r21 r">n</span> != 0)
								<span class="r14 r">r</span> = <a href="#91701606774014fa" class="i field">Z_OK</a>;
							<b>else</b>
							{
								
								<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
								<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
								<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
								<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
							}
							<span class="r21 r">n</span>--;
							<span class="r18 r">b</span> |= (<span class="r13 r">z</span>.<a href="ZStream.cs.html#cbc91141f69d3d83" class="i field">next_in</a>[<span class="r20 r">p</span>++] &amp; 0xff) &lt;&lt; <span class="r19 r">k</span>;
							<span class="r19 r">k</span> += 8;
						}
						
						<span class="r16 r">tindex</span> = (<a href="#eba9a339d7648c50" class="i field">tree_index</a> + (<span class="r18 r">b</span> &amp; <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r15 r">j</span>])) * 3;
						
						<span class="r18 r">b</span> = <a href="SupportClass.cs.html#c4a67d5e99725190" class="t t">SupportClass</a>.<a href="SupportClass.cs.html#1b50ae0c5479687b" class="i method">URShift</a>(<span class="r18 r">b</span>, (<a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span> + 1]));
						<span class="r19 r">k</span> -= (<a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span> + 1]);
						
						<span class="r17 r">e</span> = <a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span>];
						
						<b>if</b> (<span class="r17 r">e</span> == 0)
						{
							<span class="c">// literal</span>
							<a href="#bb7c3370b655ec87" class="i field">lit</a> = <a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span> + 2];
							<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#5b7d2e8c40c0c66b" class="i field">LIT</a>;
							<b>break</b>;
						}
						<b>if</b> ((<span class="r17 r">e</span> &amp; 16) != 0)
						{
							<span class="c">// length</span>
							<a href="#099fa332bd89d7a9" class="i field">get_Renamed</a> = <span class="r17 r">e</span> &amp; 15;
							<a href="#44007efc60cd3bf8" class="i field">len</a> = <a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span> + 2];
							<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#8a0c1d266bd90219" class="i field">LENEXT</a>;
							<b>break</b>;
						}
						<b>if</b> ((<span class="r17 r">e</span> &amp; 64) == 0)
						{
							<span class="c">// next table</span>
							<a href="#17b97a35bae47bc8" class="i field">need</a> = <span class="r17 r">e</span>;
							<a href="#eba9a339d7648c50" class="i field">tree_index</a> = <span class="r16 r">tindex</span> / 3 + <a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span> + 2];
							<b>break</b>;
						}
						<b>if</b> ((<span class="r17 r">e</span> &amp; 32) != 0)
						{
							<span class="c">// end of block</span>
							<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#f35f0496cea33ba3" class="i field">WASH</a>;
							<b>break</b>;
						}
						<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#fff005b5419e4e89" class="i field">BADCODE</a>; <span class="c">// invalid code</span>
						<span class="r13 r">z</span>.<a href="ZStream.cs.html#5fca80ad93aac623" class="i field">msg</a> = <span class="s">&quot;invalid literal/length code&quot;</span>;
						<span class="r14 r">r</span> = <a href="#a48dccf3678d1b7c" class="i field">Z_DATA_ERROR</a>;
						
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
						<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
						<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
					
					
					<b>case</b> <a href="#8a0c1d266bd90219" class="i field">LENEXT</a>:  <span class="c">// i: getting length extra (have base)</span>
						<span class="r15 r">j</span> = <a href="#099fa332bd89d7a9" class="i field">get_Renamed</a>;
						
						<b>while</b> (<span class="r19 r">k</span> &lt; (<span class="r15 r">j</span>))
						{
							<b>if</b> (<span class="r21 r">n</span> != 0)
								<span class="r14 r">r</span> = <a href="#91701606774014fa" class="i field">Z_OK</a>;
							<b>else</b>
							{
								
								<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
								<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
								<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
								<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
							}
							<span class="r21 r">n</span>--; <span class="r18 r">b</span> |= (<span class="r13 r">z</span>.<a href="ZStream.cs.html#cbc91141f69d3d83" class="i field">next_in</a>[<span class="r20 r">p</span>++] &amp; 0xff) &lt;&lt; <span class="r19 r">k</span>;
							<span class="r19 r">k</span> += 8;
						}
						
						<a href="#44007efc60cd3bf8" class="i field">len</a> += (<span class="r18 r">b</span> &amp; <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r15 r">j</span>]);
						
						<span class="r18 r">b</span> &gt;&gt;= <span class="r15 r">j</span>;
						<span class="r19 r">k</span> -= <span class="r15 r">j</span>;
						
						<a href="#17b97a35bae47bc8" class="i field">need</a> = <a href="#f00976cb417244fc" class="i field">dbits</a>;
						<a href="#ede69d9aa8a2890f" class="i field">tree</a> = <a href="#dadfe4d157e129dc" class="i field">dtree</a>;
						<a href="#eba9a339d7648c50" class="i field">tree_index</a> = <a href="#a19e53344e8a3e02" class="i field">dtree_index</a>;
						<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#f0089db72bf9347a" class="i field">DIST</a>;
						<b>goto</b> <b>case</b> <a href="#f0089db72bf9347a" class="i field">DIST</a>;
					
					<b>case</b> <a href="#f0089db72bf9347a" class="i field">DIST</a>:  <span class="c">// i: get distance next</span>
						<span class="r15 r">j</span> = <a href="#17b97a35bae47bc8" class="i field">need</a>;
						
						<b>while</b> (<span class="r19 r">k</span> &lt; (<span class="r15 r">j</span>))
						{
							<b>if</b> (<span class="r21 r">n</span> != 0)
								<span class="r14 r">r</span> = <a href="#91701606774014fa" class="i field">Z_OK</a>;
							<b>else</b>
							{
								
								<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
								<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
								<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
								<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
							}
							<span class="r21 r">n</span>--; <span class="r18 r">b</span> |= (<span class="r13 r">z</span>.<a href="ZStream.cs.html#cbc91141f69d3d83" class="i field">next_in</a>[<span class="r20 r">p</span>++] &amp; 0xff) &lt;&lt; <span class="r19 r">k</span>;
							<span class="r19 r">k</span> += 8;
						}
						
						<span class="r16 r">tindex</span> = (<a href="#eba9a339d7648c50" class="i field">tree_index</a> + (<span class="r18 r">b</span> &amp; <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r15 r">j</span>])) * 3;
						
						<span class="r18 r">b</span> &gt;&gt;= <a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span> + 1];
						<span class="r19 r">k</span> -= <a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span> + 1];
						
						<span class="r17 r">e</span> = (<a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span>]);
						<b>if</b> ((<span class="r17 r">e</span> &amp; 16) != 0)
						{
							<span class="c">// distance</span>
							<a href="#099fa332bd89d7a9" class="i field">get_Renamed</a> = <span class="r17 r">e</span> &amp; 15;
							<a href="#b8c032fa70cef3be" class="i field">dist</a> = <a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span> + 2];
							<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#154e0d34d8284397" class="i field">DISTEXT</a>;
							<b>break</b>;
						}
						<b>if</b> ((<span class="r17 r">e</span> &amp; 64) == 0)
						{
							<span class="c">// next table</span>
							<a href="#17b97a35bae47bc8" class="i field">need</a> = <span class="r17 r">e</span>;
							<a href="#eba9a339d7648c50" class="i field">tree_index</a> = <span class="r16 r">tindex</span> / 3 + <a href="#ede69d9aa8a2890f" class="i field">tree</a>[<span class="r16 r">tindex</span> + 2];
							<b>break</b>;
						}
						<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#fff005b5419e4e89" class="i field">BADCODE</a>; <span class="c">// invalid code</span>
						<span class="r13 r">z</span>.<a href="ZStream.cs.html#5fca80ad93aac623" class="i field">msg</a> = <span class="s">&quot;invalid distance code&quot;</span>;
						<span class="r14 r">r</span> = <a href="#a48dccf3678d1b7c" class="i field">Z_DATA_ERROR</a>;
						
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
						<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
						<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
					
					
					<b>case</b> <a href="#154e0d34d8284397" class="i field">DISTEXT</a>:  <span class="c">// i: getting distance extra</span>
						<span class="r15 r">j</span> = <a href="#099fa332bd89d7a9" class="i field">get_Renamed</a>;
						
						<b>while</b> (<span class="r19 r">k</span> &lt; (<span class="r15 r">j</span>))
						{
							<b>if</b> (<span class="r21 r">n</span> != 0)
								<span class="r14 r">r</span> = <a href="#91701606774014fa" class="i field">Z_OK</a>;
							<b>else</b>
							{
								
								<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
								<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
								<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
								<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
							}
							<span class="r21 r">n</span>--; <span class="r18 r">b</span> |= (<span class="r13 r">z</span>.<a href="ZStream.cs.html#cbc91141f69d3d83" class="i field">next_in</a>[<span class="r20 r">p</span>++] &amp; 0xff) &lt;&lt; <span class="r19 r">k</span>;
							<span class="r19 r">k</span> += 8;
						}
						
						<a href="#b8c032fa70cef3be" class="i field">dist</a> += (<span class="r18 r">b</span> &amp; <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r15 r">j</span>]);
						
						<span class="r18 r">b</span> &gt;&gt;= <span class="r15 r">j</span>;
						<span class="r19 r">k</span> -= <span class="r15 r">j</span>;
						
						<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#742abd21f41276ed" class="i field">COPY</a>;
						<b>goto</b> <b>case</b> <a href="#742abd21f41276ed" class="i field">COPY</a>;
					
					<b>case</b> <a href="#742abd21f41276ed" class="i field">COPY</a>:  <span class="c">// o: copying bytes in window, waiting for space</span>
						<span class="r24 r">f</span> = <span class="r22 r">q</span> - <a href="#b8c032fa70cef3be" class="i field">dist</a>;
						<b>while</b> (<span class="r24 r">f</span> &lt; 0)
						{
							<span class="c">// modulo window size-&quot;while&quot; instead</span>
							<span class="r24 r">f</span> += <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a>; <span class="c">// of &quot;if&quot; handles invalid distances</span>
						}
						<b>while</b> (<a href="#44007efc60cd3bf8" class="i field">len</a> != 0)
						{
							
							<b>if</b> (<span class="r23 r">m</span> == 0)
							{
								<b>if</b> (<span class="r22 r">q</span> == <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> &amp;&amp; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> != 0)
								{
									<span class="r22 r">q</span> = 0; <span class="r23 r">m</span> = <span class="r22 r">q</span> &lt; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r22 r">q</span> - 1:<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r22 r">q</span>;
								}
								<b>if</b> (<span class="r23 r">m</span> == 0)
								{
									<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>; <span class="r14 r">r</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
									<span class="r22 r">q</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a>; <span class="r23 r">m</span> = <span class="r22 r">q</span> &lt; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r22 r">q</span> - 1:<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r22 r">q</span>;
									
									<b>if</b> (<span class="r22 r">q</span> == <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> &amp;&amp; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> != 0)
									{
										<span class="r22 r">q</span> = 0; <span class="r23 r">m</span> = <span class="r22 r">q</span> &lt; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r22 r">q</span> - 1:<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r22 r">q</span>;
									}
									
									<b>if</b> (<span class="r23 r">m</span> == 0)
									{
										<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
										<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
										<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
										<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
									}
								}
							}
							
							<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r22 r">q</span>++] = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r24 r">f</span>++]; <span class="r23 r">m</span>--;
							
							<b>if</b> (<span class="r24 r">f</span> == <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a>)
								<span class="r24 r">f</span> = 0;
							<a href="#44007efc60cd3bf8" class="i field">len</a>--;
						}
						<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#ed642cd58e2f4633" class="i field">START</a>;
						<b>break</b>;
					
					<b>case</b> <a href="#5b7d2e8c40c0c66b" class="i field">LIT</a>:  <span class="c">// o: got literal, waiting for output space</span>
						<b>if</b> (<span class="r23 r">m</span> == 0)
						{
							<b>if</b> (<span class="r22 r">q</span> == <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> &amp;&amp; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> != 0)
							{
								<span class="r22 r">q</span> = 0; <span class="r23 r">m</span> = <span class="r22 r">q</span> &lt; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r22 r">q</span> - 1:<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r22 r">q</span>;
							}
							<b>if</b> (<span class="r23 r">m</span> == 0)
							{
								<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>; <span class="r14 r">r</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
								<span class="r22 r">q</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a>; <span class="r23 r">m</span> = <span class="r22 r">q</span> &lt; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r22 r">q</span> - 1:<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r22 r">q</span>;
								
								<b>if</b> (<span class="r22 r">q</span> == <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> &amp;&amp; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> != 0)
								{
									<span class="r22 r">q</span> = 0; <span class="r23 r">m</span> = <span class="r22 r">q</span> &lt; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r22 r">q</span> - 1:<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r22 r">q</span>;
								}
								<b>if</b> (<span class="r23 r">m</span> == 0)
								{
									<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
									<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
									<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
									<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
								}
							}
						}
						<span class="r14 r">r</span> = <a href="#91701606774014fa" class="i field">Z_OK</a>;
						
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r22 r">q</span>++] = (<b>byte</b>) <a href="#bb7c3370b655ec87" class="i field">lit</a>; <span class="r23 r">m</span>--;
						
						<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#ed642cd58e2f4633" class="i field">START</a>;
						<b>break</b>;
					
					<b>case</b> <a href="#f35f0496cea33ba3" class="i field">WASH</a>:  <span class="c">// o: got eob, possibly more output</span>
						<b>if</b> (<span class="r19 r">k</span> &gt; 7)
						{
							<span class="c">// return unused byte, if any</span>
							<span class="r19 r">k</span> -= 8;
							<span class="r21 r">n</span>++;
							<span class="r20 r">p</span>--; <span class="c">// can always return one</span>
						}
						
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>; <span class="r14 r">r</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
						<span class="r22 r">q</span> = <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a>; <span class="r23 r">m</span> = <span class="r22 r">q</span> &lt; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r22 r">q</span> - 1:<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r22 r">q</span>;
						
						<b>if</b> (<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> != <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a>)
						{
							<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
							<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
							<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
							<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
						}
						<a href="#25b2c3771b6c28b0" class="i field">mode</a> = <a href="#8271e609499e49ae" class="i field">END</a>;
						<b>goto</b> <b>case</b> <a href="#8271e609499e49ae" class="i field">END</a>;
					
					<b>case</b> <a href="#8271e609499e49ae" class="i field">END</a>: 
						<span class="r14 r">r</span> = <a href="#8eff6d61e4cb747a" class="i field">Z_STREAM_END</a>;
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
						<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
						<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
					
					
					<b>case</b> <a href="#fff005b5419e4e89" class="i field">BADCODE</a>:  <span class="c">// x: got error</span>
						
						<span class="r14 r">r</span> = <a href="#a48dccf3678d1b7c" class="i field">Z_DATA_ERROR</a>;
						
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
						<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
						<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
					
					
					<b>default</b>: 
						<span class="r14 r">r</span> = <a href="#3dc18c9302362335" class="i field">Z_STREAM_ERROR</a>;
						
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r18 r">b</span>; <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r19 r">k</span>;
						<span class="r13 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r21 r">n</span>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r20 r">p</span> - <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r13 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r20 r">p</span>;
						<span class="r12 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r22 r">q</span>;
						<b>return</b> <span class="r12 r">s</span>.<a href="InfBlocks.cs.html#6c3329c9483c3497" class="i method">inflate_flush</a>(<span class="r13 r">z</span>, <span class="r14 r">r</span>);
					
				}
			}
		}
		
		<b>internal void</b>  <a id="aa7f97621051092d" href="../R/aa7f97621051092d.html" target="n" data-glyph="74,1" class="i method">free</a>(<a href="ZStream.cs.html#365c5b87c76eccc4" class="t t">ZStream</a> <span id="r25 rd" class="r25 r">z</span>)
		{
			<span class="c">//  ZFREE(z, c);</span>
		}
		
		<span class="c">// Called with number of bytes left to write in window at least 258</span>
		<span class="c">// (the maximum string length) and number of input bytes available</span>
		<span class="c">// at least ten.  The ten bytes are six bytes for the longest length/</span>
		<span class="c">// distance pair plus four bytes for overloading the bit buffer.</span>
		
		<b>internal int</b> <a id="3a19c85662975b12" href="../R/3a19c85662975b12.html" target="n" data-glyph="74,1" class="i method">inflate_fast</a>(<b>int</b> <span id="r26 rd" class="r26 r">bl</span>, <b>int</b> <span id="r27 rd" class="r27 r">bd</span>, <b>int</b>[] <span id="r28 rd" class="r28 r">tl</span>, <b>int</b> <span id="r29 rd" class="r29 r">tl_index</span>, <b>int</b>[] <span id="r30 rd" class="r30 r">td</span>, <b>int</b> <span id="r31 rd" class="r31 r">td_index</span>, <a href="InfBlocks.cs.html#502251477a375329" class="t t">InfBlocks</a> <span id="r32 rd" class="r32 r">s</span>, <a href="ZStream.cs.html#365c5b87c76eccc4" class="t t">ZStream</a> <span id="r33 rd" class="r33 r">z</span>)
		{
			<b>int</b> <span id="r34 rd" class="r34 r">t</span>; <span class="c">// temporary pointer</span>
			<b>int</b>[] <span id="r35 rd" class="r35 r">tp</span>; <span class="c">// temporary pointer</span>
			<b>int</b> <span id="r36 rd" class="r36 r">tp_index</span>; <span class="c">// temporary pointer</span>
			<b>int</b> <span id="r37 rd" class="r37 r">e</span>; <span class="c">// extra bits or operation</span>
			<b>int</b> <span id="r38 rd" class="r38 r">b</span>; <span class="c">// bit buffer</span>
			<b>int</b> <span id="r39 rd" class="r39 r">k</span>; <span class="c">// bits in bit buffer</span>
			<b>int</b> <span id="r40 rd" class="r40 r">p</span>; <span class="c">// input data pointer</span>
			<b>int</b> <span id="r41 rd" class="r41 r">n</span>; <span class="c">// bytes available there</span>
			<b>int</b> <span id="r42 rd" class="r42 r">q</span>; <span class="c">// output window write pointer</span>
			<b>int</b> <span id="r43 rd" class="r43 r">m</span>; <span class="c">// bytes to end of window or read pointer</span>
			<b>int</b> <span id="r44 rd" class="r44 r">ml</span>; <span class="c">// mask for literal/length tree</span>
			<b>int</b> <span id="r45 rd" class="r45 r">md</span>; <span class="c">// mask for distance tree</span>
			<b>int</b> <span id="r46 rd" class="r46 r">c</span>; <span class="c">// bytes to copy</span>
			<b>int</b> <span id="r47 rd" class="r47 r">d</span>; <span class="c">// distance back to copy from</span>
			<b>int</b> <span id="r48 rd" class="r48 r">r</span>; <span class="c">// copy source pointer</span>
			
			<span class="c">// load input, output, bit values</span>
			<span class="r40 r">p</span> = <span class="r33 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r41 r">n</span> = <span class="r33 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a>; <span class="r38 r">b</span> = <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a>; <span class="r39 r">k</span> = <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a>;
			<span class="r42 r">q</span> = <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a>; <span class="r43 r">m</span> = <span class="r42 r">q</span> &lt; <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a>?<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#234622f49ee0a5cb" class="i field">read</a> - <span class="r42 r">q</span> - 1:<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r42 r">q</span>;
			
			<span class="c">// initialize masks</span>
			<span class="r44 r">ml</span> = <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r26 r">bl</span>];
			<span class="r45 r">md</span> = <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r27 r">bd</span>];
			
			<span class="c">// do until not enough input or output space for fast loop</span>
			<b>do</b> 
			{
				<span class="c">// assume called with m &gt;= 258 &amp;&amp; n &gt;= 10</span>
				<span class="c">// get literal/length code</span>
				<b>while</b> (<span class="r39 r">k</span> &lt; (20))
				{
					<span class="c">// max bits for literal/length code</span>
					<span class="r41 r">n</span>--;
					<span class="r38 r">b</span> |= (<span class="r33 r">z</span>.<a href="ZStream.cs.html#cbc91141f69d3d83" class="i field">next_in</a>[<span class="r40 r">p</span>++] &amp; 0xff) &lt;&lt; <span class="r39 r">k</span>; <span class="r39 r">k</span> += 8;
				}
				
				<span class="r34 r">t</span> = <span class="r38 r">b</span> &amp; <span class="r44 r">ml</span>;
				<span class="r35 r">tp</span> = <span class="r28 r">tl</span>;
				<span class="r36 r">tp_index</span> = <span class="r29 r">tl_index</span>;
				<b>if</b> ((<span class="r37 r">e</span> = <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3]) == 0)
				{
					<span class="r38 r">b</span> &gt;&gt;= (<span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 1]); <span class="r39 r">k</span> -= (<span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 1]);
					
					<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r42 r">q</span>++] = (<b>byte</b>) <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 2];
					<span class="r43 r">m</span>--;
					<b>continue</b>;
				}
				<b>do</b> 
				{
					
					<span class="r38 r">b</span> &gt;&gt;= (<span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 1]); <span class="r39 r">k</span> -= (<span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 1]);
					
					<b>if</b> ((<span class="r37 r">e</span> &amp; 16) != 0)
					{
						<span class="r37 r">e</span> &amp;= 15;
						<span class="r46 r">c</span> = <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 2] + ((<b>int</b>) <span class="r38 r">b</span> &amp; <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r37 r">e</span>]);
						
						<span class="r38 r">b</span> &gt;&gt;= <span class="r37 r">e</span>; <span class="r39 r">k</span> -= <span class="r37 r">e</span>;
						
						<span class="c">// decode distance base of block to copy</span>
						<b>while</b> (<span class="r39 r">k</span> &lt; (15))
						{
							<span class="c">// max bits for distance code</span>
							<span class="r41 r">n</span>--;
							<span class="r38 r">b</span> |= (<span class="r33 r">z</span>.<a href="ZStream.cs.html#cbc91141f69d3d83" class="i field">next_in</a>[<span class="r40 r">p</span>++] &amp; 0xff) &lt;&lt; <span class="r39 r">k</span>; <span class="r39 r">k</span> += 8;
						}
						
						<span class="r34 r">t</span> = <span class="r38 r">b</span> &amp; <span class="r45 r">md</span>;
						<span class="r35 r">tp</span> = <span class="r30 r">td</span>;
						<span class="r36 r">tp_index</span> = <span class="r31 r">td_index</span>;
						<span class="r37 r">e</span> = <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3];
						
						<b>do</b> 
						{
							
							<span class="r38 r">b</span> &gt;&gt;= (<span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 1]); <span class="r39 r">k</span> -= (<span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 1]);
							
							<b>if</b> ((<span class="r37 r">e</span> &amp; 16) != 0)
							{
								<span class="c">// get extra bits to add to distance base</span>
								<span class="r37 r">e</span> &amp;= 15;
								<b>while</b> (<span class="r39 r">k</span> &lt; (<span class="r37 r">e</span>))
								{
									<span class="c">// get extra bits (up to 13)</span>
									<span class="r41 r">n</span>--;
									<span class="r38 r">b</span> |= (<span class="r33 r">z</span>.<a href="ZStream.cs.html#cbc91141f69d3d83" class="i field">next_in</a>[<span class="r40 r">p</span>++] &amp; 0xff) &lt;&lt; <span class="r39 r">k</span>; <span class="r39 r">k</span> += 8;
								}
								
								<span class="r47 r">d</span> = <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 2] + (<span class="r38 r">b</span> &amp; <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r37 r">e</span>]);
								
								<span class="r38 r">b</span> &gt;&gt;= (<span class="r37 r">e</span>); <span class="r39 r">k</span> -= (<span class="r37 r">e</span>);
								
								<span class="c">// do the copy</span>
								<span class="r43 r">m</span> -= <span class="r46 r">c</span>;
								<b>if</b> (<span class="r42 r">q</span> &gt;= <span class="r47 r">d</span>)
								{
									<span class="c">// offset before dest</span>
									<span class="c">//  just copy</span>
									<span class="r48 r">r</span> = <span class="r42 r">q</span> - <span class="r47 r">d</span>;
									<b>if</b> (<span class="r42 r">q</span> - <span class="r48 r">r</span> &gt; 0 &amp;&amp; 2 &gt; (<span class="r42 r">q</span> - <span class="r48 r">r</span>))
									{
										<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r42 r">q</span>++] = <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r48 r">r</span>++]; <span class="r46 r">c</span>--; <span class="c">// minimum count is three,</span>
										<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r42 r">q</span>++] = <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r48 r">r</span>++]; <span class="r46 r">c</span>--; <span class="c">// so unroll loop a little</span>
									}
									<b>else</b>
									{
										<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>, <span class="r48 r">r</span>, <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>, <span class="r42 r">q</span>, 2);
										<span class="r42 r">q</span> += 2; <span class="r48 r">r</span> += 2; <span class="r46 r">c</span> -= 2;
									}
								}
								<b>else</b>
								{
									<span class="c">// else offset after destination</span>
									<span class="r48 r">r</span> = <span class="r42 r">q</span> - <span class="r47 r">d</span>;
									<b>do</b> 
									{
										<span class="r48 r">r</span> += <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a>; <span class="c">// force pointer in window</span>
									}
									<b>while</b> (<span class="r48 r">r</span> &lt; 0); <span class="c">// covers invalid distances</span>
									<span class="r37 r">e</span> = <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#3baa9d50341751a4" class="i field">end</a> - <span class="r48 r">r</span>;
									<b>if</b> (<span class="r46 r">c</span> &gt; <span class="r37 r">e</span>)
									{
										<span class="c">// if source crosses,</span>
										<span class="r46 r">c</span> -= <span class="r37 r">e</span>; <span class="c">// wrapped copy</span>
										<b>if</b> (<span class="r42 r">q</span> - <span class="r48 r">r</span> &gt; 0 &amp;&amp; <span class="r37 r">e</span> &gt; (<span class="r42 r">q</span> - <span class="r48 r">r</span>))
										{
											<b>do</b> 
											{
												<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r42 r">q</span>++] = <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r48 r">r</span>++];
											}
											<b>while</b> (--<span class="r37 r">e</span> != 0);
										}
										<b>else</b>
										{
											<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>, <span class="r48 r">r</span>, <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>, <span class="r42 r">q</span>, <span class="r37 r">e</span>);
											<span class="r42 r">q</span> += <span class="r37 r">e</span>; <span class="r48 r">r</span> += <span class="r37 r">e</span>; <span class="r37 r">e</span> = 0;
										}
										<span class="r48 r">r</span> = 0; <span class="c">// copy rest from start of window</span>
									}
								}
								
								<span class="c">// copy all or what&#39;s left</span>
								<b>if</b> (<span class="r42 r">q</span> - <span class="r48 r">r</span> &gt; 0 &amp;&amp; <span class="r46 r">c</span> &gt; (<span class="r42 r">q</span> - <span class="r48 r">r</span>))
								{
									<b>do</b> 
									{
										<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r42 r">q</span>++] = <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r48 r">r</span>++];
									}
									<b>while</b> (--<span class="r46 r">c</span> != 0);
								}
								<b>else</b>
								{
									<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>, <span class="r48 r">r</span>, <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>, <span class="r42 r">q</span>, <span class="r46 r">c</span>);
									<span class="r42 r">q</span> += <span class="r46 r">c</span>; <span class="r48 r">r</span> += <span class="r46 r">c</span>; <span class="r46 r">c</span> = 0;
								}
								<b>break</b>;
							}
							<b>else</b> <b>if</b> ((<span class="r37 r">e</span> &amp; 64) == 0)
							{
								<span class="r34 r">t</span> += <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 2];
								<span class="r34 r">t</span> += (<span class="r38 r">b</span> &amp; <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r37 r">e</span>]);
								<span class="r37 r">e</span> = <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3];
							}
							<b>else</b>
							{
								<span class="r33 r">z</span>.<a href="ZStream.cs.html#5fca80ad93aac623" class="i field">msg</a> = <span class="s">&quot;invalid distance code&quot;</span>;
								
								<span class="r46 r">c</span> = <span class="r33 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> - <span class="r41 r">n</span>; <span class="r46 r">c</span> = (<span class="r39 r">k</span> &gt;&gt; 3) &lt; <span class="r46 r">c</span>?<span class="r39 r">k</span> &gt;&gt; 3:<span class="r46 r">c</span>; <span class="r41 r">n</span> += <span class="r46 r">c</span>; <span class="r40 r">p</span> -= <span class="r46 r">c</span>; <span class="r39 r">k</span> -= (<span class="r46 r">c</span> &lt;&lt; 3);
								
								<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r38 r">b</span>; <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r39 r">k</span>;
								<span class="r33 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r41 r">n</span>; <span class="r33 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r40 r">p</span> - <span class="r33 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r33 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r40 r">p</span>;
								<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r42 r">q</span>;
								
								<b>return</b> <a href="#a48dccf3678d1b7c" class="i field">Z_DATA_ERROR</a>;
							}
						}
						<b>while</b> (<b>true</b>);
						<b>break</b>;
					}
					
					<b>if</b> ((<span class="r37 r">e</span> &amp; 64) == 0)
					{
						<span class="r34 r">t</span> += <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 2];
						<span class="r34 r">t</span> += (<span class="r38 r">b</span> &amp; <a href="#c1cfa3b2be41907f" class="i field">inflate_mask</a>[<span class="r37 r">e</span>]);
						<b>if</b> ((<span class="r37 r">e</span> = <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3]) == 0)
						{
							
							<span class="r38 r">b</span> &gt;&gt;= (<span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 1]); <span class="r39 r">k</span> -= (<span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 1]);
							
							<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#9871bb17d4542e31" class="i field">window</a>[<span class="r42 r">q</span>++] = (<b>byte</b>) <span class="r35 r">tp</span>[(<span class="r36 r">tp_index</span> + <span class="r34 r">t</span>) * 3 + 2];
							<span class="r43 r">m</span>--;
							<b>break</b>;
						}
					}
					<b>else</b> <b>if</b> ((<span class="r37 r">e</span> &amp; 32) != 0)
					{
						
						<span class="r46 r">c</span> = <span class="r33 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> - <span class="r41 r">n</span>; <span class="r46 r">c</span> = (<span class="r39 r">k</span> &gt;&gt; 3) &lt; <span class="r46 r">c</span>?<span class="r39 r">k</span> &gt;&gt; 3:<span class="r46 r">c</span>; <span class="r41 r">n</span> += <span class="r46 r">c</span>; <span class="r40 r">p</span> -= <span class="r46 r">c</span>; <span class="r39 r">k</span> -= (<span class="r46 r">c</span> &lt;&lt; 3);
						
						<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r38 r">b</span>; <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r39 r">k</span>;
						<span class="r33 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r41 r">n</span>; <span class="r33 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r40 r">p</span> - <span class="r33 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r33 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r40 r">p</span>;
						<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r42 r">q</span>;
						
						<b>return</b> <a href="#8eff6d61e4cb747a" class="i field">Z_STREAM_END</a>;
					}
					<b>else</b>
					{
						<span class="r33 r">z</span>.<a href="ZStream.cs.html#5fca80ad93aac623" class="i field">msg</a> = <span class="s">&quot;invalid literal/length code&quot;</span>;
						
						<span class="r46 r">c</span> = <span class="r33 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> - <span class="r41 r">n</span>; <span class="r46 r">c</span> = (<span class="r39 r">k</span> &gt;&gt; 3) &lt; <span class="r46 r">c</span>?<span class="r39 r">k</span> &gt;&gt; 3:<span class="r46 r">c</span>; <span class="r41 r">n</span> += <span class="r46 r">c</span>; <span class="r40 r">p</span> -= <span class="r46 r">c</span>; <span class="r39 r">k</span> -= (<span class="r46 r">c</span> &lt;&lt; 3);
						
						<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r38 r">b</span>; <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r39 r">k</span>;
						<span class="r33 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r41 r">n</span>; <span class="r33 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r40 r">p</span> - <span class="r33 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r33 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r40 r">p</span>;
						<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r42 r">q</span>;
						
						<b>return</b> <a href="#a48dccf3678d1b7c" class="i field">Z_DATA_ERROR</a>;
					}
				}
				<b>while</b> (<b>true</b>);
			}
			<b>while</b> (<span class="r43 r">m</span> &gt;= 258 &amp;&amp; <span class="r41 r">n</span> &gt;= 10);
			
			<span class="c">// not enough input or output--restore pointers and return</span>
			<span class="r46 r">c</span> = <span class="r33 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> - <span class="r41 r">n</span>; <span class="r46 r">c</span> = (<span class="r39 r">k</span> &gt;&gt; 3) &lt; <span class="r46 r">c</span>?<span class="r39 r">k</span> &gt;&gt; 3:<span class="r46 r">c</span>; <span class="r41 r">n</span> += <span class="r46 r">c</span>; <span class="r40 r">p</span> -= <span class="r46 r">c</span>; <span class="r39 r">k</span> -= (<span class="r46 r">c</span> &lt;&lt; 3);
			
			<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#e2d346d9187122f4" class="i field">bitb</a> = <span class="r38 r">b</span>; <span class="r32 r">s</span>.<a href="InfBlocks.cs.html#2803866fc8accfde" class="i field">bitk</a> = <span class="r39 r">k</span>;
			<span class="r33 r">z</span>.<a href="ZStream.cs.html#5d97a818af214217" class="i field">avail_in</a> = <span class="r41 r">n</span>; <span class="r33 r">z</span>.<a href="ZStream.cs.html#83fcde1b9cc10f8c" class="i field">total_in</a> += <span class="r40 r">p</span> - <span class="r33 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a>; <span class="r33 r">z</span>.<a href="ZStream.cs.html#248a6719ea8874c2" class="i field">next_in_index</a> = <span class="r40 r">p</span>;
			<span class="r32 r">s</span>.<a href="InfBlocks.cs.html#971fddb83f50f4d7" class="i field">write</a> = <span class="r42 r">q</span>;
			
			<b>return</b> <a href="#91701606774014fa" class="i field">Z_OK</a>;
		}
	}
}</pre></td></tr></table></div></body></html>
