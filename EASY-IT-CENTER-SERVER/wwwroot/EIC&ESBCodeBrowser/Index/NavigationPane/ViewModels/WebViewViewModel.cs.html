<!DOCTYPE html>
<html><head><title>WebViewViewModel.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(112);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#NavigationPane/ViewModels/WebViewViewModel.cs" target="_top">ViewModels\WebViewViewModel.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#NavigationPane" target="_top">HelpProjects\WPF-MAIN\WPFprism\NavigationPane\NavigationPane\NavigationPane.csproj</a> (NavigationPane)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Input</span>;

<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Toolkit</span>.<span class="i n">Win32</span>.<span class="i n">UI</span>.<span class="i n">Controls</span>.<span class="i n">Interop</span>.<span class="i n">WinRT</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Toolkit</span>.<span class="i n">Wpf</span>.<span class="i n">UI</span>.<span class="i n">Controls</span>;

<b>using</b> <span class="i n">NavigationPane</span>.<span class="i n">Contracts</span>.<span class="i n">Services</span>;

<b>using</b> <span class="i n">Prism</span>.<span class="i n">Commands</span>;
<b>using</b> <span class="i n">Prism</span>.<span class="i n">Mvvm</span>;

<b>namespace</b> <span class="i n">NavigationPane</span>.<span class="i n">ViewModels</span>
{
    <b>public class</b> <a id="64c58fd71a55be25" href="../R/64c58fd71a55be25.html" target="n" data-glyph="0,0" class="t t">WebViewViewModel</a> : <span class="t t">BindableBase</span>
    {
        <span class="c">// TODO WTS: Set the URI of the page to show by default</span>
        <b>private const string</b> <a id="f81f0fa505e7aac3" href="../R/f81f0fa505e7aac3.html" target="n" data-glyph="10,1" class="i field">DefaultUrl</a> = <span class="s">&quot;https://docs.microsoft.com/windows/apps/&quot;</span>;

        <b>private readonly</b> <a href="../Contracts/Services/ISystemService.cs.html#76cf1fe8d8a56b7d" class="t t">ISystemService</a> <a id="423fb193e483932e" href="../R/423fb193e483932e.html" target="n" data-glyph="46,1" class="i field">_systemService</a>;

        <b>private string</b> <a id="c5824f19b44debc7" href="../R/c5824f19b44debc7.html" target="n" data-glyph="46,1" class="i field">_source</a>;
        <b>private bool</b> <a id="94758b51ed6feaef" href="../R/94758b51ed6feaef.html" target="n" data-glyph="46,1" class="i field">_isLoading</a> = <b>true</b>;
        <b>private bool</b> <a id="f52c276ef74a87bc" href="../R/f52c276ef74a87bc.html" target="n" data-glyph="46,1" class="i field">_isShowingFailedMessage</a> = <b>false</b>;
        <b>private</b> <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a> <a id="dc071b96a5527bed" href="../R/dc071b96a5527bed.html" target="n" data-glyph="46,1" class="i field">_isLoadingVisibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#02d18b751f37c2fd" class="i field">Visible</a>;
        <b>private</b> <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a> <a id="ded3fba66d2d8cbe" href="../R/ded3fba66d2d8cbe.html" target="n" data-glyph="46,1" class="i field">_failedMesageVisibility</a> = <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#b5dcd78ae53c5916" class="i field">Collapsed</a>;
        <b>private</b> <span class="t t">ICommand</span> <a id="b7801f99aef12fad" href="../R/b7801f99aef12fad.html" target="n" data-glyph="46,1" class="i field">_refreshCommand</a>;
        <b>private</b> <span class="t t">DelegateCommand</span> <a id="88e8ca8951470932" href="../R/88e8ca8951470932.html" target="n" data-glyph="46,1" class="i field">_browserBackCommand</a>;
        <b>private</b> <span class="t t">DelegateCommand</span> <a id="cfd52fd28d65b47e" href="../R/cfd52fd28d65b47e.html" target="n" data-glyph="46,1" class="i field">_browserForwardCommand</a>;
        <b>private</b> <span class="t t">ICommand</span> <a id="4f3d7c5064095c58" href="../R/4f3d7c5064095c58.html" target="n" data-glyph="46,1" class="i field">_openInBrowserCommand</a>;
        <b>private</b> <span class="t t">WebView</span> <a id="0cfefccae9badf6b" href="../R/0cfefccae9badf6b.html" target="n" data-glyph="46,1" class="i field">_webView</a>;

        <b>public string</b> <a id="3f281a0ffaaa9302" href="../R/3f281a0ffaaa9302.html" target="n" data-glyph="102,1" class="i property">Source</a>
        {
            <b>get</b> { <b>return</b> <a href="#c5824f19b44debc7" class="i field">_source</a>; }
            <b>set</b> { <span class="i method">SetProperty</span>(<b>ref</b> <a href="#c5824f19b44debc7" class="i field">_source</a>, <b>value</b>); }
        }

        <b>public bool</b> <a id="9c965ae9b36b3dd2" href="../R/9c965ae9b36b3dd2.html" target="n" data-glyph="102,1" class="i property">IsLoading</a>
        {
            <b>get</b> =&gt; <a href="#94758b51ed6feaef" class="i field">_isLoading</a>;
            <b>set</b>
            {
                <span class="i method">SetProperty</span>(<b>ref</b> <a href="#94758b51ed6feaef" class="i field">_isLoading</a>, <b>value</b>);
                <a href="#c15af03210040d80" class="i property">IsLoadingVisibility</a> = <b>value</b> ? <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#02d18b751f37c2fd" class="i field">Visible</a> : <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#b5dcd78ae53c5916" class="i field">Collapsed</a>;
            }
        }

        <b>public bool</b> <a id="b248c487776c7c27" href="../R/b248c487776c7c27.html" target="n" data-glyph="102,1" class="i property">IsShowingFailedMessage</a>
        {
            <b>get</b> =&gt; <a href="#f52c276ef74a87bc" class="i field">_isShowingFailedMessage</a>;
            <b>set</b>
            {
                <span class="i method">SetProperty</span>(<b>ref</b> <a href="#f52c276ef74a87bc" class="i field">_isShowingFailedMessage</a>, <b>value</b>);
                <a href="#de32d90322d6966a" class="i property">FailedMesageVisibility</a> = <b>value</b> ? <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#02d18b751f37c2fd" class="i field">Visible</a> : <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a>.<a href="@0@PresentationCore/A.html#b5dcd78ae53c5916" class="i field">Collapsed</a>;
            }
        }

        <b>public</b> <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a> <a id="c15af03210040d80" href="../R/c15af03210040d80.html" target="n" data-glyph="102,1" class="i property">IsLoadingVisibility</a>
        {
            <b>get</b> { <b>return</b> <a href="#dc071b96a5527bed" class="i field">_isLoadingVisibility</a>; }
            <b>set</b> { <span class="i method">SetProperty</span>(<b>ref</b> <a href="#dc071b96a5527bed" class="i field">_isLoadingVisibility</a>, <b>value</b>); }
        }

        <b>public</b> <a href="@0@PresentationCore/A.html#2668d640196eddd0" class="t t">Visibility</a> <a id="de32d90322d6966a" href="../R/de32d90322d6966a.html" target="n" data-glyph="102,1" class="i property">FailedMesageVisibility</a>
        {
            <b>get</b> { <b>return</b> <a href="#ded3fba66d2d8cbe" class="i field">_failedMesageVisibility</a>; }
            <b>set</b> { <span class="i method">SetProperty</span>(<b>ref</b> <a href="#ded3fba66d2d8cbe" class="i field">_failedMesageVisibility</a>, <b>value</b>); }
        }

        <b>public</b> <span class="t t">ICommand</span> <a id="ad95423900cf605f" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">RefreshCommand</a> =&gt; <a href="#b7801f99aef12fad" class="i field">_refreshCommand</a> ?? (<a href="#b7801f99aef12fad" class="i field">_refreshCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#f0a0fa3ee0c726c3" class="i method">OnRefresh</a>));

        <b>public</b> <span class="t t">DelegateCommand</span> <a id="3983b75e699f2d36" href="../R/3983b75e699f2d36.html" target="n" data-glyph="102,1" class="i property">BrowserBackCommand</a> =&gt; <a href="#88e8ca8951470932" class="i field">_browserBackCommand</a> ?? (<a href="#88e8ca8951470932" class="i field">_browserBackCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(() =&gt; <a href="#0cfefccae9badf6b" class="i field">_webView</a>?.<span class="i method">GoBack</span>(), () =&gt; <a href="#0cfefccae9badf6b" class="i field">_webView</a>?.<span class="i property">CanGoBack</span> ?? <b>false</b>));

        <b>public</b> <span class="t t">DelegateCommand</span> <a id="78568a6a23847e05" href="../R/78568a6a23847e05.html" target="n" data-glyph="102,1" class="i property">BrowserForwardCommand</a> =&gt; <a href="#cfd52fd28d65b47e" class="i field">_browserForwardCommand</a> ?? (<a href="#cfd52fd28d65b47e" class="i field">_browserForwardCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(() =&gt; <a href="#0cfefccae9badf6b" class="i field">_webView</a>?.<span class="i method">GoForward</span>(), () =&gt; <a href="#0cfefccae9badf6b" class="i field">_webView</a>?.<span class="i property">CanGoForward</span> ?? <b>false</b>));

        <b>public</b> <span class="t t">ICommand</span> <a id="268b15da0e1d2883" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">OpenInBrowserCommand</a> =&gt; <a href="#4f3d7c5064095c58" class="i field">_openInBrowserCommand</a> ?? (<a href="#4f3d7c5064095c58" class="i field">_openInBrowserCommand</a> = <b>new</b> <span class="t constructor">DelegateCommand</span>(<a href="#6dcf05003f8d8958" class="i method">OnOpenInBrowser</a>));

        <b>public</b> <a id="c4003dcc1dc2d181" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">WebViewViewModel</a>(<a href="../Contracts/Services/ISystemService.cs.html#76cf1fe8d8a56b7d" class="t t">ISystemService</a> <span id="r0 rd" class="r0 r">systemService</span>)
        {
            <a href="#423fb193e483932e" class="i field">_systemService</a> = <span class="r0 r">systemService</span>;
            <a href="#3f281a0ffaaa9302" class="i property">Source</a> = <a href="#f81f0fa505e7aac3" class="i field">DefaultUrl</a>;
            <a href="#3983b75e699f2d36" class="i property">BrowserBackCommand</a>.<span class="i method">ObservesProperty</span>(() =&gt; <a href="#3f281a0ffaaa9302" class="i property">Source</a>);
            <a href="#78568a6a23847e05" class="i property">BrowserForwardCommand</a>.<span class="i method">ObservesProperty</span>(() =&gt; <a href="#3f281a0ffaaa9302" class="i property">Source</a>);
        }

        <b>public void</b> <a id="bfbe84a4a924cb46" href="../R/bfbe84a4a924cb46.html" target="n" data-glyph="72,1" class="i method">Initialize</a>(<span class="t t">WebView</span> <span id="r1 rd" class="r1 r">webView</span>)
        {
            <a href="#0cfefccae9badf6b" class="i field">_webView</a> = <span class="r1 r">webView</span>;
        }

        <b>public void</b> <a id="b270d0dee1034f9a" href="../R/b270d0dee1034f9a.html" target="n" data-glyph="72,1" class="i method">OnNavigationCompleted</a>(<span class="t t">WebViewControlNavigationCompletedEventArgs</span> <span id="r2 rd" class="r2 r">e</span>)
        {
            <a href="#9c965ae9b36b3dd2" class="i property">IsLoading</a> = <b>false</b>;
            <b>if</b> (<span class="r2 r">e</span> != <b>null</b> &amp;&amp; !<span class="r2 r">e</span>.<span class="i property">IsSuccess</span>)
            {
                <span class="c">// Use `args.WebErrorStatus` to vary the displayed message based on the error reason</span>
                <a href="#b248c487776c7c27" class="i property">IsShowingFailedMessage</a> = <b>true</b>;
            }
        }

        <b>private void</b> <a id="f0a0fa3ee0c726c3" href="../R/f0a0fa3ee0c726c3.html" target="n" data-glyph="76,1" class="i method">OnRefresh</a>()
        {
            <a href="#b248c487776c7c27" class="i property">IsShowingFailedMessage</a> = <b>false</b>;
            <a href="#9c965ae9b36b3dd2" class="i property">IsLoading</a> = <b>true</b>;
            <a href="#0cfefccae9badf6b" class="i field">_webView</a>?.<span class="i method">Refresh</span>();
        }

        <b>private void</b> <a id="6dcf05003f8d8958" href="../R/6dcf05003f8d8958.html" target="n" data-glyph="76,1" class="i method">OnOpenInBrowser</a>()
            =&gt; <a href="#423fb193e483932e" class="i field">_systemService</a>.<a href="../Contracts/Services/ISystemService.cs.html#57a78feb2aa20a23" class="i method">OpenInWebBrowser</a>(<a href="#3f281a0ffaaa9302" class="i property">Source</a>);
    }
}
</pre></td></tr></table></div></body></html>
