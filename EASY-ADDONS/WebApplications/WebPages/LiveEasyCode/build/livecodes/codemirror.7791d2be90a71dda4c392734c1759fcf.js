import{Compartment as C,EditorState as ue}from"@codemirror/state";import{oneDark as Br}from"@codemirror/theme-one-dark";import{EditorView as q,keymap as F}from"@codemirror/view";import{indentWithTab as Ir,undo as Dr,redo as Nr}from"@codemirror/commands";import{defaultHighlightStyle as Rr,syntaxHighlighting as Nt,indentUnit as Pr,HighlightStyle as $r}from"@codemirror/language";import{tags as Fr}from"@lezer/highlight";var ve=()=>document.querySelector("#editor-mode");var Kt=e=>{let t=e.trim(),r,o;return e.includes(":")&&([r,t]=t.split(":"),r!=="monaco"&&r!=="codemirror"&&r!=="codejar"&&(r=void 0)),e.includes("@")&&([t,o]=t.split("@"),o!=="light"&&o!=="dark"&&(o=void 0)),{editor:r,editorTheme:t,theme:o}},qe=({editor:e,editorTheme:t,theme:r,editorThemes:o})=>{if(!t)return null;let a=(typeof t=="string"?t.split(",").map(c=>c.trim()):t).map(Kt);for(let c of a)if((c.editor===e||c.editor===void 0)&&(c.theme===r||c.theme===void 0)&&o.includes(c.editorTheme))return c.editorTheme;return null};import{keymap as Ue,highlightSpecialChars as Ce,drawSelection as Be,highlightActiveLine as Jt,dropCursor as Qt,rectangularSelection as Yt,crosshairCursor as _t,lineNumbers as Y,highlightActiveLineGutter as Zt}from"@codemirror/view";import{EditorState as Xt}from"@codemirror/state";import{defaultHighlightStyle as Ie,syntaxHighlighting as De,indentOnInput as eo,bracketMatching as to,foldGutter as oo,foldKeymap as ro}from"@codemirror/language";import{defaultKeymap as Ne,history as Re,historyKeymap as Pe}from"@codemirror/commands";import{searchKeymap as no,highlightSelectionMatches as so}from"@codemirror/search";import{autocompletion as co,completionKeymap as lo,closeBrackets as _,closeBracketsKeymap as ao}from"@codemirror/autocomplete";import{lintKeymap as io}from"@codemirror/lint";import{EditorView as rn}from"@codemirror/view";var $e=(()=>[Zt(),Ce(),Re(),oo(),Be(),Qt(),Xt.allowMultipleSelections.of(!0),eo(),De(Ie,{fallback:!0}),to(),co(),Yt(),_t(),Jt(),so(),Ue.of([...ao,...Ne,...no,...Pe,...ro,...lo,...io])])(),en=(()=>[Ce(),Re(),Be(),De(Ie,{fallback:!0}),Ue.of([...Ne,...Pe])])();import{LanguageSupport as mo,StreamLanguage as uo}from"@codemirror/language";var T=e=>new mo(uo.define(e)),h=e=>`./vendor/codemirror/v6.0.1/${e}`,m={core:h("codemirror-core.js"),vue:h("codemirror-lang-vue.js"),json:h("codemirror-lang-json.js"),markdown:h("codemirror-lang-markdown.js"),python:h("codemirror-lang-python.js"),php:h("codemirror-lang-php.js"),cpp:h("codemirror-lang-cpp.js"),sql:h("codemirror-lang-sql.js"),wast:h("codemirror-lang-wast.js"),scss:h("codemirror-lang-scss.js"),coffeescript:h("codemirror-lang-coffeescript.js"),livescript:h("codemirror-lang-livescript.js"),ruby:h("codemirror-lang-ruby.js"),go:h("codemirror-lang-go.js"),perl:h("codemirror-lang-perl.js"),lua:h("codemirror-lang-lua.js"),r:h("codemirror-lang-r.js"),julia:h("codemirror-lang-julia.js"),scheme:h("codemirror-lang-scheme.js"),clojure:h("codemirror-lang-clojure.js"),tcl:h("codemirror-lang-tcl.js"),less:h("codemirror-lang-less.js"),stylus:h("codemirror-lang-stylus.js")},Z={html:async()=>(await import(m.core)).html(),css:async()=>(await import(m.core)).css(),javascript:async()=>(await import(m.core)).javascript(),typescript:async()=>(await import(m.core)).javascript({typescript:!0}),jsx:async()=>(await import(m.core)).javascript({jsx:!0}),tsx:async()=>(await import(m.core)).javascript({jsx:!0,typescript:!0}),vue:async()=>(await import(m.vue)).vue(),json:async()=>(await import(m.json)).json(),markdown:async()=>(await import(m.markdown)).markdown(),python:async()=>(await import(m.python)).python(),php:async()=>(await import(m.php)).php(),cpp:async()=>(await import(m.cpp)).cpp(),sql:async()=>(await import(m.sql)).sql(),wat:async()=>(await import(m.wast)).wast(),scss:async()=>(await import(m.scss)).sass(),sass:async()=>(await import(m.scss)).sass({indented:!0}),coffeescript:async()=>T((await import(m.coffeescript)).coffeeScript),livescript:async()=>T((await import(m.livescript)).liveScript),ruby:async()=>T((await import(m.ruby)).ruby),go:async()=>T((await import(m.go)).go),perl:async()=>T((await import(m.perl)).perl),lua:async()=>T((await import(m.lua)).lua),r:async()=>T((await import(m.r)).r),julia:async()=>T((await import(m.julia)).julia),scheme:async()=>T((await import(m.scheme)).scheme),clojure:async()=>T((await import(m.clojure)).clojure),tcl:async()=>T((await import(m.tcl)).tcl),less:async()=>T((await import(m.less)).less),stylus:async()=>T((await import(m.stylus)).stylus)};import{Decoration as ee,EditorView as po,ViewPlugin as go,WidgetType as fo}from"@codemirror/view";import{getIndentUnit as Ve}from"@codemirror/language";import{RangeSet as ho}from"@codemirror/state";var yo=ee.mark({class:"cm-indentation-marker",tagName:"span"}),xo=ee.mark({class:"cm-indentation-marker active",tagName:"span"}),X=class extends fo{constructor(t,r,o){super(),this.numIndent=t,this.indentSize=r,this.activeIndent=o}eq(t){return this.numIndent===t.numIndent&&this.indentSize===t.indentSize&&this.activeIndent===t.activeIndent}toDOM(t){let r=Ve(t.state),o=document.createElement("span");o.style.top="0",o.style.left="4px",o.style.position="absolute",o.style.pointerEvents="none";for(let n=0;n<this.numIndent;n++){let a=document.createElement("span");a.className="cm-indentation-marker",a.classList.toggle("active",n===this.activeIndent),a.innerHTML=" ".repeat(r),o.appendChild(a)}return o}};function Oe(e,t,r){let o=0,n=0,a=null;for(let c=0;c<e.length;c++){if(e[c]!==" "&&e[c]!=="	")return n%t===0&&c!==0&&o++,o;(a==="	"||n%t===0)&&(o++,r&&r(c)),e[c]===" "?n++:n=0,a=e[c]}return o}function bo(e,t){let r=Math.min(e,t),o=Math.max(e,t);return r===0&&o>0?1:r===o&&r>0?r-1:r}function Lo(e,t,r){let o=e.lines,n=t;for(;n<=o;){let{text:a}=e.line(n);if(a.trim().length===0){n++;continue}let c=Oe(a,r);return[n,c]}return[o+1,0]}function Fe(e){let t=Ve(e.state),r=new Map,o=[];for(let{from:a,to:c}of e.visibleRanges){let s=a,u=0,p=0,g=0;for(;s<=c;){let y=e.state.doc.lineAt(s),{text:k}=y;if(k.trim().length===0){if(g<y.number){let[b,j]=Lo(e.state.doc,y.number+1,t);g=b,p=j}let E=bo(u,p);r.set(y.number,E),o.push({from:s,to:s,lineNumber:y.number,create:b=>ee.widget({widget:new X(E,t,b)})})}else{let E=[];u=Oe(k,t,b=>E.push(b)),r.set(y.number,E.length),o.push(...E.map((b,j)=>({from:y.from+b,to:y.from+b+1,lineNumber:y.number,create:I=>I===j?xo:yo})))}s=y.to+1}}let n=Eo(e.state,r);return ho.of(Array.from(o).map(({lineNumber:a,from:c,to:s,create:u})=>{let p=a>=n.start&&a<=n.end?n.activeIndent-1:void 0;return{from:c,to:s,value:u(p)}}),!0)}function Eo(e,t){let r=e.doc.lineAt(e.selection.main.head),o=t.get(r.number),n=r.number,a=t.get(n+1);a&&o!=null&&a>o&&(o=a,n++);let c=t.get(n-1);if(c&&o!=null&&c>o&&(o=c,n--),!o)return{start:-1,end:-1,activeIndent:NaN};let s,u;for(s=n;s>=0;s--){let p=t.get(s-1);if(!p||p<o)break}for(u=n;;u++){let p=t.get(u+1);if(!p||p<o)break}return{start:s,end:u,activeIndent:o}}function To(){return go.define(e=>({decorations:Fe(e),update(t){(t.docChanged||t.viewportChanged||t.selectionSet)&&(this.decorations=Fe(t.view))}}),{decorations:e=>e.decorations})}var Mo=po.baseTheme({".cm-line":{position:"relative"},".cm-indentation-marker":{display:"inline-block"},"&light .cm-indentation-marker":{background:'url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") left repeat-y'},"&light .cm-indentation-marker.active":{background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACAQMAAACjTyRkAAAABlBMVEX///+goKD0a5EfAAAADElEQVR4nGNgYGgAAACEAIHJde6SAAAAAElFTkSuQmCC) left repeat-y"},"&dark .cm-indentation-marker":{background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWNgYGBgYHB3d/8PAAOIAdULw8qMAAAAAElFTkSuQmCC) left repeat-y"},"&dark .cm-indentation-marker.active":{background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACAQMAAACjTyRkAAAABlBMVEUAAACFhYWZv3sFAAAAAnRSTlMA/1uRIrUAAAAMSURBVHicY2BgaAAAAIQAgcl17pIAAAAASUVORK5CYII=) left repeat-y"}});function te(){return[To(),Mo]}import{insertNewlineAndIndent as Ge,cursorCharLeft as We,selectCharLeft as ze,cursorGroupLeft as ko,selectGroupLeft as So,cursorCharRight as Ke,selectCharRight as Je,cursorGroupRight as wo,selectGroupRight as Ho,cursorLineUp as Qe,selectLineUp as Ye,cursorLineDown as _e,selectLineDown as Ze,cursorLineBoundaryBackward as Xe,selectLineBoundaryBackward as et,cursorDocStart as tt,selectDocStart as ot,cursorPageUp as oe,selectPageUp as rt,cursorPageDown as re,selectPageDown as nt,cursorLineBoundaryForward as st,selectLineBoundaryForward as ct,cursorDocEnd as lt,selectDocEnd as at,selectAll as Ao,deleteCharBackward as ne,deleteCharForward as it,deleteGroupBackward as mt,deleteGroupForward as jo,deleteToLineStart as vo,deleteToLineEnd as ut,cursorLineStart as qo,selectLineStart as Uo,cursorLineEnd as Co,selectLineEnd as Bo,splitLine as Io,transposeChars as Do,deleteLine as No,moveLineDown as Ro,moveLineUp as Po,copyLineDown as $o,copyLineUp as Fo,selectLine as Vo,cursorMatchingBracket as Oo,indentMore as pt,indentLess as dt,lineComment as Go,lineUncomment as Wo,toggleComment as zo,toggleBlockComment as Ko,undo as Jo,redo as gt,undoSelection as Qo}from"@codemirror/commands";import{openSearchPanel as Yo,closeSearchPanel as _o,selectMatches as Zo,replaceAll as Xo,gotoLine as er,selectNextOccurrence as tr,selectSelectionMatches as or}from"@codemirror/search";import{foldCode as rr,unfoldCode as nr,foldAll as sr,unfoldAll as cr}from"@codemirror/language";import{startCompletion as lr,closeCompletion as ar,moveCompletionSelection as R,acceptCompletion as ft,deleteBracketPair as ir}from"@codemirror/autocomplete";import{openLintPanel as mr,nextDiagnostic as ur}from"@codemirror/lint";import{EditorSelection as ht}from"@codemirror/state";var yt=e=>t=>{let r=e==="down",o=t.state.selection;for(let n of o.ranges)o=o.addRange(t.moveVertically(n,r));return t.dispatch({selection:o}),!0},pr=yt("up"),dr=yt("down"),gr=e=>{let t=null;for(let r of e.state.selection.ranges)if(!r.empty)for(let o=r.from;o<=r.to;){let n=e.state.doc.lineAt(o),a=Math.min(n.to,r.to);t?t=t.addRange(ht.range(a,a)):t=ht.single(a),o=n.to+1}return t?(e.dispatch({selection:t}),!0):!1},se=[{key:"Ctrl-Space",run:lr},{key:"Escape",run:ar},{key:"ArrowDown",run:R(!0)},{key:"ArrowUp",run:R(!1)},{key:"PageDown",run:R(!0,"page")},{key:"PageUp",run:R(!1,"page")},{key:"Enter",run:ft},{key:"Tab",run:ft},{key:"Mod-f",run:Yo,scope:"editor search-panel"},{key:"Escape",run:_o,scope:"editor search-panel"},{key:"Alt-Enter",run:Zo,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:Xo,scope:"editor search-panel"},{key:"Ctrl-g",run:er},{key:"Mod-d",run:tr,preventDefault:!0},{key:"Shift-Mod-l",run:or},{key:"Enter",run:Ge,shift:Ge},{key:"ArrowLeft",run:We,shift:ze,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:ko,shift:So},{key:"ArrowRight",run:Ke,shift:Je,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:wo,shift:Ho},{key:"ArrowUp",run:Qe,shift:Ye,preventDefault:!0},{key:"ArrowDown",run:_e,shift:Ze,preventDefault:!0},{key:"Home",run:Xe,shift:et},{mac:"Cmd-ArrowLeft",run:Xe,shift:et},{key:"Mod-Home",run:tt,shift:ot},{mac:"Cmd-ArrowUp",run:tt,shift:ot},{key:"PageUp",run:oe,shift:rt},{mac:"Ctrl-ArrowUp",run:oe,shift:rt},{key:"PageDown",run:re,shift:nt},{mac:"Ctrl-ArrowDown",run:re,shift:nt},{key:"End",run:st,shift:ct},{mac:"Cmd-ArrowRight",run:st,shift:ct},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:pr,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:dr,preventDefault:!0},{key:"Shift-Alt-i",run:gr},{key:"Mod-End",run:lt,shift:at},{mac:"Cmd-ArrowDown",run:lt,shift:at},{key:"Mod-a",run:Ao},{key:"Backspace",run:ir},{key:"Backspace",run:ne,shift:ne},{key:"Delete",run:it},{key:"Mod-Backspace",mac:"Alt-Backspace",run:mt},{key:"Mod-Delete",mac:"Alt-Delete",run:jo},{mac:"Mod-Backspace",run:vo},{mac:"Mod-Delete",run:ut},{mac:"Ctrl-b",run:We,shift:ze,preventDefault:!0},{mac:"Ctrl-f",run:Ke,shift:Je},{mac:"Ctrl-p",run:Qe,shift:Ye},{mac:"Ctrl-n",run:_e,shift:Ze},{mac:"Ctrl-a",run:qo,shift:Uo},{mac:"Ctrl-e",run:Co,shift:Bo},{mac:"Ctrl-d",run:it},{mac:"Ctrl-h",run:ne},{mac:"Ctrl-k",run:ut},{mac:"Ctrl-Alt-h",run:mt},{mac:"Ctrl-o",run:Io},{mac:"Ctrl-t",run:Do},{mac:"Ctrl-v",run:re},{mac:"Alt-v",run:oe},{key:"Shift-Mod-k",run:No},{key:"Alt-ArrowDown",run:Ro},{key:"Alt-ArrowUp",run:Po},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:$o},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:Fo},{key:"Mod-l",run:Vo,preventDefault:!0},{key:"Shift-Mod-\\",run:Oo},{key:"Tab",run:pt,shift:dt,preventDefault:!0},{key:"Mod-[",run:dt},{key:"Mod-]",run:pt},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:rr},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:nr},{key:"Mod-k Mod-0",run:sr},{key:"Mod-k Mod-j",run:cr},{key:"Mod-k Mod-c",run:Go},{key:"Mod-k Mod-u",run:Wo},{key:"Mod-/",run:zo},{key:"Shift-Alt-a",run:Ko},{key:"Mod-z",run:Jo,preventDefault:!0},{key:"Mod-y",run:gt,preventDefault:!0},{key:"Mod-Shift-z",run:gt,preventDefault:!0},{key:"Mod-u",run:Qo,preventDefault:!0},{key:"Mod-Shift-m",run:mr},{key:"F8",run:ur}];import{EditorView as fr,ViewPlugin as hr,Decoration as B,WidgetType as yr}from"@codemirror/view";import{syntaxTree as xr}from"@codemirror/language";var ae=new Map([["aliceblue","#f0f8ff"],["antiquewhite","#faebd7"],["aqua","#00ffff"],["aquamarine","#7fffd4"],["azure","#f0ffff"],["beige","#f5f5dc"],["bisque","#ffe4c4"],["black","#000000"],["blanchedalmond","#ffebcd"],["blue","#0000ff"],["blueviolet","#8a2be2"],["brown","#a52a2a"],["burlywood","#deb887"],["cadetblue","#5f9ea0"],["chartreuse","#7fff00"],["chocolate","#d2691e"],["coral","#ff7f50"],["cornflowerblue","#6495ed"],["cornsilk","#fff8dc"],["crimson","#dc143c"],["cyan","#00ffff"],["darkblue","#00008b"],["darkcyan","#008b8b"],["darkgoldenrod","#b8860b"],["darkgray","#a9a9a9"],["darkgreen","#006400"],["darkgrey","#a9a9a9"],["darkkhaki","#bdb76b"],["darkmagenta","#8b008b"],["darkolivegreen","#556b2f"],["darkorange","#ff8c00"],["darkorchid","#9932cc"],["darkred","#8b0000"],["darksalmon","#e9967a"],["darkseagreen","#8fbc8f"],["darkslateblue","#483d8b"],["darkslategray","#2f4f4f"],["darkslategrey","#2f4f4f"],["darkturquoise","#00ced1"],["darkviolet","#9400d3"],["deeppink","#ff1493"],["deepskyblue","#00bfff"],["dimgray","#696969"],["dimgrey","#696969"],["dodgerblue","#1e90ff"],["firebrick","#b22222"],["floralwhite","#fffaf0"],["forestgreen","#228b22"],["fuchsia","#ff00ff"],["gainsboro","#dcdcdc"],["ghostwhite","#f8f8ff"],["goldenrod","#daa520"],["gold","#ffd700"],["gray","#808080"],["green","#008000"],["greenyellow","#adff2f"],["grey","#808080"],["honeydew","#f0fff0"],["hotpink","#ff69b4"],["indianred","#cd5c5c"],["indigo","#4b0082"],["ivory","#fffff0"],["khaki","#f0e68c"],["lavenderblush","#fff0f5"],["lavender","#e6e6fa"],["lawngreen","#7cfc00"],["lemonchiffon","#fffacd"],["lightblue","#add8e6"],["lightcoral","#f08080"],["lightcyan","#e0ffff"],["lightgoldenrodyellow","#fafad2"],["lightgray","#d3d3d3"],["lightgreen","#90ee90"],["lightgrey","#d3d3d3"],["lightpink","#ffb6c1"],["lightsalmon","#ffa07a"],["lightseagreen","#20b2aa"],["lightskyblue","#87cefa"],["lightslategray","#778899"],["lightslategrey","#778899"],["lightsteelblue","#b0c4de"],["lightyellow","#ffffe0"],["lime","#00ff00"],["limegreen","#32cd32"],["linen","#faf0e6"],["magenta","#ff00ff"],["maroon","#800000"],["mediumaquamarine","#66cdaa"],["mediumblue","#0000cd"],["mediumorchid","#ba55d3"],["mediumpurple","#9370db"],["mediumseagreen","#3cb371"],["mediumslateblue","#7b68ee"],["mediumspringgreen","#00fa9a"],["mediumturquoise","#48d1cc"],["mediumvioletred","#c71585"],["midnightblue","#191970"],["mintcream","#f5fffa"],["mistyrose","#ffe4e1"],["moccasin","#ffe4b5"],["navajowhite","#ffdead"],["navy","#000080"],["oldlace","#fdf5e6"],["olive","#808000"],["olivedrab","#6b8e23"],["orange","#ffa500"],["orangered","#ff4500"],["orchid","#da70d6"],["palegoldenrod","#eee8aa"],["palegreen","#98fb98"],["paleturquoise","#afeeee"],["palevioletred","#db7093"],["papayawhip","#ffefd5"],["peachpuff","#ffdab9"],["peru","#cd853f"],["pink","#ffc0cb"],["plum","#dda0dd"],["powderblue","#b0e0e6"],["purple","#800080"],["rebeccapurple","#663399"],["red","#ff0000"],["rosybrown","#bc8f8f"],["royalblue","#4169e1"],["saddlebrown","#8b4513"],["salmon","#fa8072"],["sandybrown","#f4a460"],["seagreen","#2e8b57"],["seashell","#fff5ee"],["sienna","#a0522d"],["silver","#c0c0c0"],["skyblue","#87ceeb"],["slateblue","#6a5acd"],["slategray","#708090"],["slategrey","#708090"],["snow","#fffafa"],["springgreen","#00ff7f"],["steelblue","#4682b4"],["tan","#d2b48c"],["teal","#008080"],["thistle","#d8bfd8"],["tomato","#ff6347"],["turquoise","#40e0d0"],["violet","#ee82ee"],["wheat","#f5deb3"],["white","#ffffff"],["whitesmoke","#f5f5f5"],["yellow","#ffff00"],["yellowgreen","#9acd32"]]),br=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]]);return r},Et=new WeakMap,H=function(e){return e.rgb="RGB",e.hex="HEX",e.named="NAMED",e.hsl="HSL",e}(H||(H={})),Lr=/rgb\(\s*(\d{1,3}%?)\s*,?\s*(\d{1,3}%?)\s*,?\s*(\d{1,3}%?)\s*(,\s*0?\.\d+)?\)/,Er=/hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*(,\s*0?\.\d+)?\)/;function xt(e){let t=[];for(let r of e.visibleRanges)xr(e.state).iterate({from:r.from,to:r.to,enter:({type:o,from:n,to:a})=>{if(o.name==="CallExpression"){let c=e.state.doc.sliceString(n,a);if(c.startsWith("rgb")){let s=Lr.exec(c);if(!s)return;let[u,p,g,y,k]=s,E=Mr(p,g,y),b=B.widget({widget:new U({colorType:H.rgb,color:E,from:n,to:a,alpha:k||""}),side:1});t.push(b.range(n));return}if(c.startsWith("hsl")){let s=Er.exec(c);if(!s)return;let[u,p,g,y,k]=s,E=kr(p,g,y),b=B.widget({widget:new U({colorType:H.hsl,color:E,from:n,to:a,alpha:k||""}),side:1});t.push(b.range(n));return}}if(o.name==="ColorLiteral"){let[c,s]=Tr(e.state.doc.sliceString(n,a)),u=B.widget({widget:new U({colorType:H.hex,color:c,from:n,to:a,alpha:s}),side:1});t.push(u.range(n))}if(o.name==="ValueName"){let c=e.state.doc.sliceString(n,a);if(ae.has(c)){let s=ae.get(c),u=B.widget({widget:new U({colorType:H.named,color:s,from:n,to:a,alpha:""}),side:1});t.push(u.range(n))}}}});return B.set(t)}function Tr(e){return e.length===4?[`#${e[1].repeat(2)}${e[2].repeat(2)}${e[3].repeat(2)}`,""]:e.length===5?[`#${e[1].repeat(2)}${e[2].repeat(2)}${e[3].repeat(2)}`,e[4].repeat(2)]:e.length===9?[`#${e.slice(1,-2)}`,e.slice(-2)]:[e,""]}function ce(e){let t;if(e.endsWith("%")){let r=Number(e.slice(0,-1));t=Math.round(r/100*255)}else t=Number(e);return P(t)}function P(e){let t=e.toString(16);return t.length==1?"0"+t:t}function bt(e){let t=e.slice(1,3),r=e.slice(3,5),o=e.slice(5,7);return[parseInt(t,16),parseInt(r,16),parseInt(o,16)]}function Mr(e,t,r){return`#${ce(e)}${ce(t)}${ce(r)}`}function kr(e,t,r){let o=Number(t)/100,n=Number(r)/100,[a,c,s]=Sr(Number(e),o,n);return`#${P(a)}${P(c)}${P(s)}`}function Sr(e,t,r){if(t===0){let y=Math.round(r*255);return[y,y,y]}let o;r<.5?o=r*(1+t):o=r+t-r*t;let n=2*r-o;e=e/360;let a=Lt(e+.333),c=e,s=Lt(e-.333),u=le(o,n,a),p=le(o,n,c),g=le(o,n,s);return[Math.round(u*255),Math.round(p*255),Math.round(g*255)]}function Lt(e){return e<0?e+1:e>1?e-1:e}function le(e,t,r){return 6*r<1?t+(e-t)*6*r:2*r<1?e:3*r<2?t+(e-t)*(.666-r)*6:t}function wr(e,t,r){let o=e/255,n=t/255,a=r/255,c=Math.min(o,n,a),s=Math.max(o,n,a),u=(s+c)/2;if(s===c)return[0,0,u];let p;u<=.5?p=(s-c)/(s+c):p=(s-c)/(2-s-c);let g;for(s===o?g=(n-a)/(s-c):n===s?g=2+(a-o)/(s-c):g=4+(o-n)/(s-c),g=Math.round(g*60);g<0;)g+=360;return[g,p,u]}var $="cm-css-color-picker-wrapper",U=class extends yr{constructor(t){var{color:r}=t,o=br(t,["color"]);super(),this.state=o,this.color=r}eq(t){return t.state.colorType===this.state.colorType&&t.color===this.color&&t.state.from===this.state.from&&t.state.to===this.state.to&&t.state.alpha===this.state.alpha}toDOM(){let t=document.createElement("input");Et.set(t,this.state),t.type="color",t.value=this.color;let r=document.createElement("span");return r.appendChild(t),r.className=$,r}ignoreEvent(){return!1}},Hr=fr.baseTheme({[`.${$}`]:{display:"inline-block",outline:"1px solid #eee",marginRight:"0.6ch",height:"1em",width:"1em",transform:"translateY(1px)"},[`.${$} input[type="color"]`]:{cursor:"pointer",height:"100%",width:"100%",padding:0,border:"none","&::-webkit-color-swatch-wrapper":{padding:0},"&::-webkit-color-swatch":{border:"none"},"&::-moz-color-swatch":{border:"none"}}}),Ar=hr.fromClass(class{constructor(t){this.decorations=xt(t)}update(t){(t.docChanged||t.viewportChanged)&&(this.decorations=xt(t.view))}},{decorations:e=>e.decorations,eventHandlers:{change:(e,t)=>{let r=e.target;if(r.nodeName!=="INPUT"||!r.parentElement||!r.parentElement.classList.contains($))return!1;let o=Et.get(r),n=r.value+o.alpha;if(o.colorType===H.rgb)n=`rgb(${bt(r.value).join(", ")}${o.alpha})`;else if(o.colorType===H.named)for(let[a,c]of ae.entries())c===r.value&&(n=a);else if(o.colorType===H.hsl){let[a,c,s]=bt(r.value),[u,p,g]=wr(a,c,s);n=`hsl(${u}, ${Math.round(p*100)}%, ${Math.round(g*100)}%${o.alpha})`}return t.dispatch({changes:{from:o.from,to:o.to,insert:n}}),!0}}}),ie=[Ar,Hr];import{lineNumbers as Hn,highlightActiveLineGutter as An,highlightSpecialChars as jn,drawSelection as vn,dropCursor as qn,rectangularSelection as Un,crosshairCursor as Cn,highlightActiveLine as Bn,keymap as In}from"@codemirror/view";import{EditorView as Tt}from"@codemirror/view";import{EditorState as Nn}from"@codemirror/state";import{foldGutter as Pn,indentOnInput as $n,syntaxHighlighting as Fn,defaultHighlightStyle as Vn,bracketMatching as On,foldKeymap as Gn}from"@codemirror/language";import{history as zn,defaultKeymap as Kn,historyKeymap as Jn}from"@codemirror/commands";import{highlightSelectionMatches as Yn,searchKeymap as _n}from"@codemirror/search";import{closeBrackets as Xn,autocompletion as es,closeBracketsKeymap as ts,completionKeymap as os}from"@codemirror/autocomplete";import{lintKeymap as ns}from"@codemirror/lint";import{HighlightStyle as Ur,syntaxHighlighting as Cr}from"@codemirror/language";var kt=["esm.sh","skypack","jspm"],St=["unpkg","jsdelivr","fastly.jsdelivr"],wt=["fastly.jsdelivr.gh","jsdelivr.gh","statically"],v={getModuleUrl:(e,{isModule:t=!0,defaultCDN:r="esm.sh"}={})=>{e=e.replace(/#nobundle/g,"");let o=Mt(e,t,r);return o||(t?"https://esm.sh/"+e:"https://cdn.jsdelivr.net/npm/"+e)},getUrl:(e,t)=>e.startsWith("http")||e.startsWith("data:")?e:Mt(e,!1,t||jr())||e,cdnLists:{npm:St,module:kt,gh:wt},checkCDNs:async(e,t)=>{let r=[t,...v.cdnLists.npm].filter(Boolean);for(let o of r)try{if((await fetch(v.getUrl(e,o),{method:"HEAD"})).ok)return o}catch{}return v.cdnLists.npm[0]}},jr=()=>{if(globalThis.appCDN)return globalThis.appCDN;try{return new URL(location.href).searchParams.get("appCDN")||v.cdnLists.npm[0]}catch{return v.cdnLists.npm[0]}},Mt=(e,t,r)=>{let o=t&&e.startsWith("unpkg:")?"?module":"";e.startsWith("gh:")?e=e.replace("gh",wt[0]):e.includes(":")||(e=(r||(t?kt[0]:St[0]))+":"+e);for(let n of vr){let[a,c]=n;if(a.test(e))return e.replace(a,c)+o}return null},vr=[[/^(jspm:)(.+)/i,"https://jspm.dev/$2"],[/^(npm:)(.+)/i,"https://esm.sh/$2"],[/^(node:)(.+)/i,"https://esm.sh/$2"],[/^(skypack:)(.+)/i,"https://cdn.skypack.dev/$2"],[/^(jsdelivr:)(.+)/i,"https://cdn.jsdelivr.net/npm/$2"],[/^(fastly.jsdelivr:)(.+)/i,"https://fastly.jsdelivr.net/npm/$2"],[/^(jsdelivr.gh:)(.+)/i,"https://cdn.jsdelivr.net/gh/$2"],[/^(fastly.jsdelivr.gh:)(.+)/i,"https://fastly.jsdelivr.net/gh/$2"],[/^(statically:)(.+)/i,"https://cdn.statically.io/gh/$2"],[/^(esm.run:)(.+)/i,"https://esm.run/$2"],[/^(esm.sh:)(.+)/i,"https://esm.sh/$2"],[/^(esbuild:)(.+)/i,"https://esbuild.vercel.app/$2"],[/^(bundle.run:)(.+)/i,"https://bundle.run/$2"],[/^(unpkg:)(.+)/i,"https://unpkg.com/$2"],[/^(bundlejs:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(bundle:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(deno:)(.+)/i,"https://deno.bundlejs.com/?file&q=https://deno.land/x/$2/mod.ts"],[/^(https:\/\/deno\.land\/.+)/i,"https://deno.bundlejs.com/?file&q=$1"],[/^(github:|https:\/\/github\.com\/)(.[^\/]+?)\/(.[^\/]+?)\/(?!releases\/)(?:(?:blob|raw)\/)?(.+?\/.+)/i,"https://deno.bundlejs.com/?file&q=https://cdn.jsdelivr.net/gh/$2/$3@$4"],[/^(gist\.github:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(gitlab:|https:\/\/gitlab\.com\/)([^\/]+.*\/[^\/]+)\/(?:raw|blob)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://gl.githack.com/$2/raw/$3"],[/^(bitbucket:|https:\/\/bitbucket\.org\/)([^\/]+\/[^\/]+)\/(?:raw|src)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://bb.githack.com/$2/raw/$3"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/]+)\/revisions\/([^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/$3/files/$4"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/HEAD/files/$3"],[/^(bitbucket:)\!api\/2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(api\.bitbucket:)2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(rawgit:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(rawgit:|https:\/\/raw\.githubusercontent\.com)(\/[^\/]+\/[^\/]+|[0-9A-Za-z-]+\/[0-9a-f]+\/raw)\/(.+)/i,"https://deno.bundlejs.com/?file&q=https://raw.githack.com/$2/$3"]];var{getUrl:M,getModuleUrl:is}=v;var Ht=M("cm6-theme-basic-light@0.2.0/dist/index.js"),At=M("cm6-theme-basic-dark@0.2.0/dist/index.js"),jt=M("cm6-theme-gruvbox-light@0.2.0/dist/index.js"),vt=M("cm6-theme-gruvbox-dark@0.2.0/dist/index.js"),qt=M("cm6-theme-material-dark@0.2.0/dist/index.js"),Ut=M("cm6-theme-nord@0.2.0/dist/index.js"),Ct=M("cm6-theme-solarized-light@0.2.0/dist/index.js"),Bt=M("cm6-theme-solarized-dark@0.2.0/dist/index.js");var A=M("@ddietr/codemirror-themes@1.4.2/dist/theme/");var qr="0.6.64",ms=M(`malinajs@${qr}/malina.js`);var L=M("thememirror@2.0.1/dist/themes/");var me=[{name:"amy",title:"Amy",url:L+"amy.js",exportName:"amy"},{name:"aura",title:"Aura",url:A+"aura.js",exportName:"aura"},{name:"ayu-light",title:"Ayu Light",url:L+"ayu-light.js",exportName:"ayuLight"},{name:"barf",title:"Barf",url:L+"barf.js",exportName:"barf"},{name:"basic-light",title:"Basic Light",url:Ht,exportName:"basicLight"},{name:"basic-dark",title:"Basic Dark",url:At,exportName:"basicDark"},{name:"bespin",title:"Bespin",url:L+"bespin.js",exportName:"bespin"},{name:"birds-of-paradise",title:"Birds of Paradise",url:L+"birds-of-paradise.js",exportName:"birdsOfParadise"},{name:"boys-and-girls",title:"Boys and Girls",url:L+"boys-and-girls.js",exportName:"boysAndGirls"},{name:"clouds",title:"Clouds",url:L+"clouds.js",exportName:"clouds"},{name:"cobalt",title:"Cobalt",url:L+"cobalt.js",exportName:"cobalt"},{name:"cm-light",title:"Codemirror Light"},{name:"cool-glow",title:"Cool Glow",url:L+"cool-glow.js",exportName:"coolGlow"},{name:"dracula",title:"Dracula",url:L+"dracula.js",exportName:"dracula"},{name:"espresso",title:"Espresso",url:L+"espresso.js",exportName:"espresso"},{name:"github-dark",title:"GitHub Dark",url:A+"github-dark.js",exportName:"githubDark"},{name:"github-light",title:"GitHub Light",url:A+"github-light.js",exportName:"githubLight"},{name:"gruvbox-dark",title:"Gruvbox Dark",url:vt,exportName:"gruvboxDark"},{name:"gruvbox-light",title:"Gruvbox Light",url:jt,exportName:"gruvboxLight"},{name:"material-dark",title:"Material Dark",url:qt,exportName:"materialDark"},{name:"material-light",title:"Material Light",url:A+"material-light.js",exportName:"materialLight"},{name:"monochrome",title:"Monochrome"},{name:"monochrome-dark",title:"Monochrome Dark"},{name:"noctis-lilac",title:"Noctis Lilac",url:L+"noctis-lilac.js",exportName:"noctisLilac"},{name:"nord",title:"Nord",url:Ut,exportName:"nord"},{name:"one-dark",title:"One Dark"},{name:"rose-pine-dawn",title:"Ros\xE9 Pine Dawn",url:L+"rose-pine-dawn.js",exportName:"rosePineDawn"},{name:"smoothy",title:"Smoothy",url:L+"smoothy.js",exportName:"smoothy"},{name:"solarized-dark",title:"Solarized Dark",url:Bt,exportName:"solarizedDark"},{name:"solarized-light",title:"Solarized Light",url:Ct,exportName:"solarizedLight"},{name:"tokyo-night",title:"Tokyo Night",url:A+"tokyo-night.js",exportName:"tokyoNight"},{name:"tokyo-night-day",title:"Tokyo Night Day",url:A+"tokyo-night-day.js",exportName:"tokyoNightDay"},{name:"tokyo-night-storm",title:"Tokyo Night Storm",url:A+"tokyo-night-storm.js",exportName:"tokyoNightStorm"},{name:"tomorrow",title:"Tomorrow",url:L+"tomorrow.js",exportName:"tomorrow"}],It=({variant:e,settings:t,styles:r})=>{let o=Tt.theme({"&":{backgroundColor:t.background,color:t.foreground},".cm-content":{caretColor:t.caret},".cm-cursor, .cm-dropCursor":{borderLeftColor:t.caret},"&.cm-focused .cm-selectionBackgroundm .cm-selectionBackground, .cm-selectionMatch, .cm-content ::selection":{backgroundColor:t.selection},".cm-activeLine":{backgroundColor:t.lineHighlight},".cm-gutters":{backgroundColor:t.gutterBackground,color:t.gutterForeground},".cm-activeLineGutter":{backgroundColor:t.lineHighlight}},{dark:e==="dark"}),n=Ur.define(r);return[o,Cr(n)]},Dt={monochrome:It({variant:"light",settings:{background:"#fffffe",foreground:"#24292e",caret:"#24292e",selection:"#c8c8fa",gutterBackground:"#fffffe",gutterForeground:"#24292e",lineHighlight:"#f1faff"},styles:[]}),"monochrome-dark":It({variant:"dark",settings:{background:"#24292e",foreground:"#e2e2e3",caret:"#e2e2e3",selection:"#444d56",gutterBackground:"#24292e",gutterForeground:"#e2e2e3",lineHighlight:"#444d56"},styles:[]})};var As=async e=>{let{container:t,readonly:r,isEmbed:o,editorId:n,getFormatterConfig:a,getFontFamily:c}=e,s={...e};if(!t)throw new Error("editor container not found");let u=async l=>Z[l]?.()||Z.html?.(),p=l=>["vue","vue3","vue2"].includes(l)?"vue":e.mapLanguage?.(l)||l,g={"one-dark":Br,"cm-light":[Nt(Rr),q.theme({"&":{backgroundColor:"#ffffff"}})],...Dt},y={dark:"one-dark",light:"cm-light"},k=()=>g[I]||g[y[e.theme]]||[],E=e.language,b=p(E),j=await u(b),I=await we(e.theme,e.editorTheme),D=[],V=[],Rt=l=>{l.docChanged&&V.forEach(i=>i(l))},O,G,W,pe=async l=>{let i={vim:"./vendor/codemirror/v6.0.1/codemirror-vim.js",emacs:"./vendor/codemirror/v6.0.1/codemirror-emacs.js",emmet:"./vendor/codemirror/v6.0.1/codemirror-emmet.js"};O=l.editorMode==="vim"?(await import(i.vim)).vim:void 0,G=l.editorMode==="emacs"?(await import(i.emacs)).emacs:void 0,W=l.emmet?(await import(i.emmet)).emmet:void 0};await pe(e);let de=new C,ge=new C,fe=new C,z=q.editable.of(!1),he=new C,ye=new C,xe=new C,Pt=$r.define([{tag:Fr.comment,fontStyle:"italic"}]),be=l=>{let i=(l.fontSize??s.fontSize)||(o?12:14),d=c(l.fontFamily??s.fontFamily),x=l.tabSize??s.tabSize,S=l.useTabs??s.useTabs,w=l.wordWrap??s.wordWrap,N=l.emmet??s.emmet,je=l.editorMode??s.editorMode;return[ue.tabSize.of(x),Pr.of(S?"	":" ".repeat(x)),...w?[q.lineWrapping]:[],...je==="vim"&&O?[O()]:je==="emacs"&&G?[G()]:[],...N&&W?[W]:[],q.theme({"&":{height:"100%",fontSize:i+"px"},".cm-scroller":{overflow:"auto",fontFamily:d}})]},Le=()=>{let l=[de.of(j),q.updateListener.of(Rt),fe.of(k()),Nt(Pt),he.of(be({})),ge.of(F.of(D)),ye.of(s.lineNumbers?Y():[]),xe.of(s.closeBrackets?_():[]),$e,r?z:[],F.of([Ir]),F.of(se),te(),ie],i=[z,...l],d=[z,...l],x=[...l];return n==="console"?x:n==="compiled"?d:e.mode==="codeblock"?i:l},Ee=async l=>{let i=ve(),d=x=>{i&&(i.textContent=x)};l||d(""),l==="vim"&&d("Vim"),l==="emacs"&&d("Emacs")},f=new q({state:ue.create({extensions:Le(),doc:e.value}),parent:t});Ee(e.editorMode);let $t=()=>n,Te=()=>f.state.doc.toString(),K=(l="",i=!0)=>{i?f.setState(ue.create({doc:l,extensions:Le()})):f.dispatch({changes:{from:0,to:f.state.doc.length,insert:l}})},Me=()=>f.focus(),Ft=()=>E,Vt=(l,i)=>{E=l,b=p(E),u(b).then(d=>{j=d,f.dispatch({effects:de.reconfigure(j)})}),i!=null&&K(i)},Ot=l=>{V.push(l)},ke={CtrlEnter:"Ctrl-Enter",ShiftEnter:"Shift-Enter",Enter:"Enter",UpArrow:"ArrowUp",DownArrow:"ArrowDown",ShiftAltF:"Shift-Alt-f"},J=(l,i,d)=>{D.push({key:i,run(){return d(),!0}}),f.dispatch({effects:ge.reconfigure(F.of(D))})},Q,Gt=l=>{l&&(Q=l,J("format",ke.ShiftAltF,async()=>{await Se(),Me()}))},Se=async()=>{if(!Q)return;let l=f.state.selection.main.to,i=Te(),d=await Q(i,l,a());K(d.formatted,!1);let x=d.cursorOffset>=0?d.cursorOffset:0;f.dispatch({selection:{anchor:x}})};async function we(l,i){let d=qe({editor:"codemirror",editorTheme:i,theme:l,editorThemes:me.map(w=>w.name)}),x=d||y[l],S=me.find(w=>w.name===x);if(!g[x]&&S?.url){let w=(await import(S.url))[S.exportName||"default"];g[x]=w}return x}let He=(l,i)=>{we(l,i).then(d=>{I=d,f.dispatch({effects:fe.reconfigure(k())})})},Wt=l=>{s={...l},pe(s).then(()=>{f.dispatch({effects:[he.reconfigure(be(s)),ye.reconfigure(s.lineNumbers?Y():[]),xe.reconfigure(s.closeBrackets?_():[])]}),He(s.theme,s.editorTheme),Ee(s.editorMode)})},zt=()=>{Dr({state:f.state,dispatch:f.dispatch})},Ae=()=>{Nr({state:f.state,dispatch:f.dispatch})};return J("redo","Mod-Shift-z",Ae),{getValue:Te,setValue:K,getLanguage:Ft,setLanguage:Vt,getEditorId:$t,focus:Me,getPosition:()=>{let l=f.state.selection.asSingle().ranges[0].from,i=f.state.doc.lineAt(l),d=i.number,x=l-i.from+1;return{lineNumber:d,column:x}},setPosition:({lineNumber:l,column:i=1})=>{let d=i-1,x=f.state.doc.lines>l?l:f.state.doc.lines,S=f.state.doc.line(x),w=S.length>d?d:S.length,N=S.from+w;f.dispatch({selection:{anchor:N},effects:[q.scrollIntoView(N,{x:"center",y:"center"})]})},onContentChanged:Ot,keyCodes:ke,addKeyBinding:J,changeSettings:Wt,registerFormatter:Gt,format:Se,isReadonly:r,setTheme:He,undo:zt,redo:Ae,destroy:()=>{V.length=0,D.length=0,f.destroy(),t.innerHTML=""},codemirror:f}};export{As as createEditor};
