@using System
@{
    ViewBag.Title = "Ad-hoc reporting application built with EasyData";
    ViewBag.SubTitle = "ad hoc reporting application built with EasyData";
    ViewBag.BrandTitle = "Reports";
}

@model SelectList
@section Styles {
    <link href="~/css/EasyReport.css" rel="stylesheet">
}

<div class="eqjs-process-bar" id="ProcessBar" style="display: none;"></div>
<div class="er-picker-and-report">
    <div class="er-report-picker show-picker animate-in">
        <div class="er-close-picker-container">
            <button type="button" class="btn btn-default er-close-button" title="Hide" id="HideReportListButton">
            </button>
        </div>
        <div class="er-picker-header">
            <div class="input-group">
                <i class="fa fa-search er-search-prepend"></i>
                <input type="text" class="form-control form-control-lg er-search-box" id="reportSearchBox" placeholder="Search reports">
            </div>
            <div class="er-add-button-container">
                <button id="OpenNewReportDlgButton" type="button" class="btn btn-default pull-right er-add-button" data-toggle="modal" data-target="#newReport" title="New Report">
                    <i class="fa fa-plus"></i>
                </button>
            </div>
        </div>

        <div class="er-report-list" id="ReportList"></div>
    </div>

    <div class="er-report-container">
        <div class="er-report-view">
            <div class="er-title-bar">
                <div class="er-picker-toggle-button-container">
                    <button id="TogglePickerButton" type="button" class="btn btn-default er-picker-toggle-button" title="Toggle report list">
                        <i class="fa fa-bars"></i>
                    </button>
                </div>
                <div class="er-report-refresh-button-container">
                    <button id="RefreshResultButton" type="button" class="btn btn-default er-report-refresh-button" title="Refresh">
                        <i class="fa fa-refresh"></i>
                    </button>
                </div>
                <span id="ReportTitle"></span>
                <button id="OpenEditReportDlgButton" type="button" class="btn btn-primary er-report-edit-button" title="Edit report">Edit</button> 
            </div>
            <div class="er-filter-bar">
                <span>Description:&nbsp;</span>
                <div id="ReportDescription" class="er-filter-text"></div>
            </div>
            <div class="er-result-block">
                <div id="ResultSet"></div>
            </div>
        </div>
    </div>

    <div class="er-noreport" id="NoReportPanel" style="display: none">
        <h3>
            It's empty here.
            <a href="javascript:void(0)" onclick="showNewReportDialog()">Create the first report</a> to start.
        </h3>
    </div>
</div>

<div id="EditReportDlg" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="card-header" id="EditReportHeader">
                <i class="fa fa-pencil-square"></i>Edit Report
            </div>
            <div class="card-header" id="AddReportHeader">
                <i class="fa fa-file"></i>New Report
            </div>
            <div class="modal-body card-body">
                <label class="">Report Name</label><br>
                <input type="text" class="form-control" id="ReportNameInput" /><br>
                <div class="custom-control custom-checkbox">
                    <input id="IsSharedCheckbox" type="checkbox" class="custom-control-input">
                    <label class="custom-control-label" for="IsSharedCheckbox">Share with other team members</label>
                </div>
                <div class='form-field'>
                    <label>Description: </label>
                    <textarea id="ReportDescTextArea" class="form-control" ></textarea>
                </div>
                <div class="form-field">
                    <label>SQL: </label>
                    <div id="ReportQueryEditor" style="height: 200px"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" type="button" data-dismiss="modal" id="SaveReportButton">Save Report</button>
                <button class="btn btn-primary" type="button" data-dismiss="modal" id="AddReportButton">Create Report</button>
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>

<div id="CloneReportDlg" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="card-header">
                <i class="fa fa-copy"></i>Duplicate Report
            </div>
            <div class="modal-body card-body">
                <input id="CloneReportIdInput" type="hidden" />
                <label class="">New Report Name</label><br />
                <input id="CloneReportNameInput" type="text" class="form-control" /><br>
            </div>
            <div class="modal-footer">
                <button id="CloneReportButton" class="btn btn-primary" type="button" data-dismiss="modal">Save</button>
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>

<div id="RemoveReportDlg" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="card-header">
                <i class="fa fa-recycle"></i>Remove report
            </div>
            <div class="modal-body card-body">
                <p>Do you want to delete this report?</p>
                <input id="RemoveReportIdInput" type="text" hidden  />
                <span id="RemoveReportTitle" class="report-title"></span>
            </div>
            <div class="modal-footer">
                <button id="RemoveReportButton" class="btn btn-danger" type="button" data-dismiss="modal">Delete</button>
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/mode-sql.min.js" type="text/javascript"></script>

    <script src="~/js/easyreport.js" type="text/javascript"></script>

    <script>
        window.addEventListener('load', function () {
            var view = new easyreport.EasyReportView();
            window['EasyReportView'] = view;
            view.init();

        });

        function showNewReportDialog() {
            var view = window['EasyReportView'];
            view.showNewReportDialog();
        }
    </script>
}